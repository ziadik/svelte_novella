(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();const ll=!1;var Cs=Array.isArray,Lu=Array.prototype.indexOf,Eo=Array.from,so=Object.defineProperty,bi=Object.getOwnPropertyDescriptor,ul=Object.getOwnPropertyDescriptors,$u=Object.prototype,Fu=Array.prototype,Ao=Object.getPrototypeOf,_a=Object.isExtensible;function Du(n){return n()}function vs(n){for(var e=0;e<n.length;e++)n[e]()}function Uu(){var n,e,t=new Promise((r,o)=>{n=r,e=o});return{promise:t,resolve:n,reject:e}}const Ht=2,So=4,Ts=8,ri=16,qn=32,wr=64,cl=128,Qt=256,ps=512,yt=1024,Zt=2048,Qn=4096,fn=8192,ii=16384,Co=32768,To=65536,ma=1<<17,qu=1<<18,ji=1<<19,hl=1<<20,oo=1<<21,Io=1<<22,_r=1<<23,Yn=Symbol("$state"),Po=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Nu(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Bu(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Wu(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Vu(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Hu(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function zu(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Gu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ku(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Yu(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ju(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Is=1,Ps=2,dl=4,Xu=8,Qu=16,Zu=1,ec=2,ft=Symbol(),tc="http://www.w3.org/1999/xhtml";function nc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let rc=!1;function fl(n){return n===this.v}function vl(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function ic(n,e){return n!==e}function pl(n){return!vl(n,this.v)}let Oi=!1,sc=!1;function oc(){Oi=!0}let st=null;function gs(n){st=n}function xi(n,e=!1,t){st={p:st,c:null,e:null,s:n,x:null,l:Oi&&!e?{s:null,u:null,$:[]}:null}}function Mi(n){var e=st,t=e.e;if(t!==null){e.e=null;for(var r of t)Rl(r)}return st=e.p,{}}function si(){return!Oi||st!==null&&st.l===null}const ac=new WeakMap;function lc(n){var e=xe;if(e===null)return Oe.f|=_r,n;if((e.f&Co)===0){if((e.f&cl)===0)throw!e.parent&&n instanceof Error&&gl(n),n;e.b.error(n)}else Ro(n,e)}function Ro(n,e){for(;e!==null;){if((e.f&cl)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&gl(n),n}function gl(n){const e=ac.get(n);e&&(so(n,"message",{value:e.message}),so(n,"stack",{value:e.stack}))}let Ci=[],ao=[];function _l(){var n=Ci;Ci=[],vs(n)}function uc(){var n=ao;ao=[],vs(n)}function jo(n){Ci.length===0&&queueMicrotask(_l),Ci.push(n)}function cc(){Ci.length>0&&_l(),ao.length>0&&uc()}function hc(){for(var n=xe.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&Nu(),n}function Rs(n){var e=Ht|Zt,t=Oe!==null&&(Oe.f&Ht)!==0?Oe:null;return xe===null||t!==null&&(t.f&Qt)!==0?e|=Qt:xe.f|=ji,{ctx:st,deps:null,effects:null,equals:fl,f:e,fn:n,reactions:null,rv:0,v:ft,wv:0,parent:t??xe,ac:null}}function dc(n,e){let t=xe;t===null&&Wu();var r=t.b,o=void 0,l=Ti(ft),c=null,f=!Oe;return Cc(()=>{try{var p=n();c&&Promise.resolve(p).catch(()=>{})}catch(_){p=Promise.reject(_)}var g=()=>p;o=c?.then(g,g)??Promise.resolve(p),c=o;var y=Ge,k=r.pending;f&&(r.update_pending_count(1),k||y.increment());const E=(_,I=void 0)=>{c=null,k||y.activate(),I?I!==Po&&(l.f|=_r,Ii(l,I)):((l.f&_r)!==0&&(l.f^=_r),Ii(l,_)),f&&(r.update_pending_count(-1),k||y.decrement()),bl()};if(o.then(E,_=>E(null,_||"unknown")),y)return()=>{queueMicrotask(()=>y.neuter())}}),new Promise(p=>{function g(y){function k(){y===o?p(l):g(o)}y.then(k,k)}g(o)})}function Kr(n){const e=Rs(n);return Fl(e),e}function ml(n){const e=Rs(n);return e.equals=pl,e}function yl(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Un(e[t])}}function fc(n){for(var e=n.parent;e!==null;){if((e.f&Ht)===0)return e;e=e.parent}return null}function Oo(n){var e,t=xe;Xn(fc(n));try{yl(n),e=Nl(n)}finally{Xn(t)}return e}function wl(n){var e=Oo(n);if(n.equals(e)||(n.v=e,n.wv=Ul()),!oi){var t=(Kn||(n.f&Qt)!==0)&&n.deps!==null?Qn:yt;Lt(n,t)}}function vc(n,e,t){const r=si()?Rs:ml;if(e.length===0){t(n.map(r));return}var o=Ge,l=xe,c=pc(),f=hc();Promise.all(e.map(p=>dc(p))).then(p=>{o?.activate(),c();try{t([...n.map(r),...p])}catch(g){(l.f&ii)===0&&Ro(g,l)}o?.deactivate(),bl()}).catch(p=>{f.error(p)})}function pc(){var n=xe,e=Oe,t=st,r=Ge;return function(){Xn(n),An(e),gs(t),r?.activate()}}function bl(){Xn(null),An(null),gs(null)}const zs=new Set;let Ge=null,hs=null,ya=new Set,_s=[];function kl(){const n=_s.shift();_s.length>0&&queueMicrotask(kl),n()}let yr=[],js=null,lo=!1,ds=!1;class Zr{current=new Map;#n=new Map;#t=new Set;#e=0;#r=null;#i=!1;#o=[];#l=[];#a=[];#s=[];#u=[];#h=[];#d=[];skipped_effects=new Set;process(e){yr=[],hs=null;for(const o of e)this.#v(o);if(this.#o.length===0&&this.#e===0){this.#f();var t=this.#a,r=this.#s;this.#a=[],this.#s=[],this.#u=[],hs=Ge,Ge=null,wa(t),wa(r),Ge===null?Ge=this:zs.delete(this),this.#r?.resolve()}else this.#c(this.#a),this.#c(this.#s),this.#c(this.#u);for(const o of this.#o)Qr(o);for(const o of this.#l)Qr(o);this.#o=[],this.#l=[]}#v(e){e.f^=yt;for(var t=e.first;t!==null;){var r=t.f,o=(r&(qn|wr))!==0,l=o&&(r&yt)!==0,c=l||(r&fn)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(o)t.f^=yt;else if((r&So)!==0)this.#s.push(t);else if((r&yt)===0)if((r&Io)!==0){var f=t.b?.pending?this.#l:this.#o;f.push(t)}else Ls(t)&&((t.f&ri)!==0&&this.#u.push(t),Qr(t));var p=t.first;if(p!==null){t=p;continue}}var g=t.parent;for(t=t.next;t===null&&g!==null;)t=g.next,g=g.parent}}#c(e){for(const t of e)((t.f&Zt)!==0?this.#h:this.#d).push(t),Lt(t,yt);e.length=0}capture(e,t){this.#n.has(e)||this.#n.set(e,t),this.current.set(e,e.v)}activate(){Ge=this}deactivate(){Ge=null,hs=null;for(const e of ya)if(ya.delete(e),e(),Ge!==null)break}neuter(){this.#i=!0}flush(){yr.length>0?El():this.#f(),Ge===this&&(this.#e===0&&zs.delete(this),this.deactivate())}#f(){if(!this.#i)for(const e of this.#t)e();this.#t.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)Lt(e,Zt),ei(e);for(const e of this.#d)Lt(e,Qn),ei(e);this.#a=[],this.#s=[],this.flush()}else this.deactivate()}add_callback(e){this.#t.add(e)}settled(){return(this.#r??=Uu()).promise}static ensure(){if(Ge===null){const e=Ge=new Zr;zs.add(Ge),ds||Zr.enqueue(()=>{Ge===e&&e.flush()})}return Ge}static enqueue(e){_s.length===0&&queueMicrotask(kl),_s.unshift(e)}}function gc(n){var e=ds;ds=!0;try{for(var t;;){if(cc(),yr.length===0&&(Ge?.flush(),yr.length===0))return js=null,t;El()}}finally{ds=e}}function El(){var n=Xr;lo=!0;try{var e=0;for(Aa(!0);yr.length>0;){var t=Zr.ensure();if(e++>1e3){var r,o;_c()}t.process(yr),Jn.clear()}}finally{lo=!1,Aa(n),js=null}}function _c(){try{Gu()}catch(n){Ro(n,js)}}let fr=null;function wa(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(ii|fn))===0&&Ls(r)&&(fr=[],Qr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Ml(r):r.fn=null),fr?.length>0)){Jn.clear();for(const o of fr)Qr(o);fr=[]}}fr=null}}function ei(n){for(var e=js=n;e.parent!==null;){e=e.parent;var t=e.f;if(lo&&e===xe&&(t&ri)!==0)return;if((t&(wr|qn))!==0){if((t&yt)===0)return;e.f^=yt}}yr.push(e)}const Jn=new Map;function Ti(n,e){var t={f:0,v:n,reactions:null,equals:fl,rv:0,wv:0};return t}function Ze(n,e){const t=Ti(n);return Fl(t),t}function mc(n,e=!1,t=!0){const r=Ti(n);return e||(r.equals=pl),Oi&&t&&st!==null&&st.l!==null&&(st.l.s??=[]).push(r),r}function fe(n,e,t=!1){Oe!==null&&(!kn||(Oe.f&ma)!==0)&&si()&&(Oe.f&(Ht|ri|Io|ma))!==0&&!Dn?.includes(n)&&Ju();let r=t?En(e):e;return Ii(n,r)}function Ii(n,e){if(!n.equals(e)){var t=n.v;oi?Jn.set(n,e):Jn.set(n,t),n.v=e;var r=Zr.ensure();r.capture(n,t),(n.f&Ht)!==0&&((n.f&Zt)!==0&&Oo(n),Lt(n,(n.f&Qt)===0?yt:Qn)),n.wv=Ul(),Al(n,Zt),si()&&xe!==null&&(xe.f&yt)!==0&&(xe.f&(qn|wr))===0&&(Jt===null?Pc([n]):Jt.push(n))}return e}function Gs(n){fe(n,n.v+1)}function Al(n,e){var t=n.reactions;if(t!==null)for(var r=si(),o=t.length,l=0;l<o;l++){var c=t[l],f=c.f;if(!(!r&&c===xe)){var p=(f&Zt)===0;p&&Lt(c,e),(f&Ht)!==0?Al(c,Qn):p&&((f&ri)!==0&&fr!==null&&fr.push(c),ei(c))}}}function En(n){if(typeof n!="object"||n===null||Yn in n)return n;const e=Ao(n);if(e!==$u&&e!==Fu)return n;var t=new Map,r=Cs(n),o=Ze(0),l=mr,c=f=>{if(mr===l)return f();var p=Oe,g=mr;An(null),Ca(l);var y=f();return An(p),Ca(g),y};return r&&t.set("length",Ze(n.length)),new Proxy(n,{defineProperty(f,p,g){(!("value"in g)||g.configurable===!1||g.enumerable===!1||g.writable===!1)&&Ku();var y=t.get(p);return y===void 0?y=c(()=>{var k=Ze(g.value);return t.set(p,k),k}):fe(y,g.value,!0),!0},deleteProperty(f,p){var g=t.get(p);if(g===void 0){if(p in f){const y=c(()=>Ze(ft));t.set(p,y),Gs(o)}}else fe(g,ft),Gs(o);return!0},get(f,p,g){if(p===Yn)return n;var y=t.get(p),k=p in f;if(y===void 0&&(!k||bi(f,p)?.writable)&&(y=c(()=>{var _=En(k?f[p]:ft),I=Ze(_);return I}),t.set(p,y)),y!==void 0){var E=C(y);return E===ft?void 0:E}return Reflect.get(f,p,g)},getOwnPropertyDescriptor(f,p){var g=Reflect.getOwnPropertyDescriptor(f,p);if(g&&"value"in g){var y=t.get(p);y&&(g.value=C(y))}else if(g===void 0){var k=t.get(p),E=k?.v;if(k!==void 0&&E!==ft)return{enumerable:!0,configurable:!0,value:E,writable:!0}}return g},has(f,p){if(p===Yn)return!0;var g=t.get(p),y=g!==void 0&&g.v!==ft||Reflect.has(f,p);if(g!==void 0||xe!==null&&(!y||bi(f,p)?.writable)){g===void 0&&(g=c(()=>{var E=y?En(f[p]):ft,_=Ze(E);return _}),t.set(p,g));var k=C(g);if(k===ft)return!1}return y},set(f,p,g,y){var k=t.get(p),E=p in f;if(r&&p==="length")for(var _=g;_<k.v;_+=1){var I=t.get(_+"");I!==void 0?fe(I,ft):_ in f&&(I=c(()=>Ze(ft)),t.set(_+"",I))}if(k===void 0)(!E||bi(f,p)?.writable)&&(k=c(()=>Ze(void 0)),fe(k,En(g)),t.set(p,k));else{E=k.v!==ft;var L=c(()=>En(g));fe(k,L)}var $=Reflect.getOwnPropertyDescriptor(f,p);if($?.set&&$.set.call(y,g),!E){if(r&&typeof p=="string"){var z=t.get("length"),U=Number(p);Number.isInteger(U)&&U>=z.v&&fe(z,U+1)}Gs(o)}return!0},ownKeys(f){C(o);var p=Reflect.ownKeys(f).filter(k=>{var E=t.get(k);return E===void 0||E.v!==ft});for(var[g,y]of t)y.v!==ft&&!(g in f)&&p.push(g);return p},setPrototypeOf(){Yu()}})}function ba(n){try{if(n!==null&&typeof n=="object"&&Yn in n)return n[Yn]}catch{}return n}function yc(n,e){return Object.is(ba(n),ba(e))}var ka,Sl,Cl,Tl;function wc(){if(ka===void 0){ka=window,Sl=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Cl=bi(e,"firstChild").get,Tl=bi(e,"nextSibling").get,_a(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),_a(t)&&(t.__t=void 0)}}function br(n=""){return document.createTextNode(n)}function ms(n){return Cl.call(n)}function Os(n){return Tl.call(n)}function V(n,e){return ms(n)}function Xt(n,e){{var t=ms(n);return t instanceof Comment&&t.data===""?Os(t):t}}function Z(n,e=1,t=!1){let r=n;for(;e--;)r=Os(r);return r}function bc(n){n.textContent=""}function xo(){return!1}let Ea=!1;function kc(){Ea||(Ea=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function xs(n){var e=Oe,t=xe;An(null),Xn(null);try{return n()}finally{An(e),Xn(t)}}function Mo(n,e,t,r=t){n.addEventListener(e,()=>xs(t));const o=n.__on_r;o?n.__on_r=()=>{o(),r(!0)}:n.__on_r=()=>r(!0),kc()}function Il(n){xe===null&&Oe===null&&zu(),Oe!==null&&(Oe.f&Qt)!==0&&xe===null&&Hu(),oi&&Vu()}function Ec(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Sn(n,e,t,r=!0){var o=xe;o!==null&&(o.f&fn)!==0&&(n|=fn);var l={ctx:st,deps:null,nodes_start:null,nodes_end:null,f:n|Zt,first:null,fn:e,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Qr(l),l.f|=Co}catch(p){throw Un(l),p}else e!==null&&ei(l);if(r){var c=l;if(t&&c.deps===null&&c.teardown===null&&c.nodes_start===null&&c.first===c.last&&(c.f&ji)===0&&(c=c.first),c!==null&&(c.parent=o,o!==null&&Ec(c,o),Oe!==null&&(Oe.f&Ht)!==0&&(n&wr)===0)){var f=Oe;(f.effects??=[]).push(c)}}return l}function Pl(n){const e=Sn(Ts,null,!1);return Lt(e,yt),e.teardown=n,e}function ys(n){Il();var e=xe.f,t=!Oe&&(e&qn)!==0&&(e&Co)===0;if(t){var r=st;(r.e??=[]).push(n)}else return Rl(n)}function Rl(n){return Sn(So|hl,n,!1)}function Ac(n){return Il(),Sn(Ts|hl,n,!0)}function Sc(n){Zr.ensure();const e=Sn(wr|ji,n,!0);return(t={})=>new Promise(r=>{t.outro?Ms(e,()=>{Un(e),r(void 0)}):(Un(e),r(void 0))})}function jl(n){return Sn(So,n,!1)}function Cc(n){return Sn(Io|ji,n,!0)}function Lo(n,e=0){return Sn(Ts|e,n,!0)}function et(n,e=[],t=[]){vc(e,t,r=>{Sn(Ts,()=>n(...r.map(C)),!0)})}function $o(n,e=0){var t=Sn(ri|e,n,!0);return t}function ti(n,e=!0){return Sn(qn|ji,n,!0,e)}function Ol(n){var e=n.teardown;if(e!==null){const t=oi,r=Oe;Sa(!0),An(null);try{e.call(null)}finally{Sa(t),An(r)}}}function xl(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const o=t.ac;o!==null&&xs(()=>{o.abort(Po)});var r=t.next;(t.f&wr)!==0?t.parent=null:Un(t,e),t=r}}function Tc(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&qn)===0&&Un(e),e=t}}function Un(n,e=!0){var t=!1;(e||(n.f&qu)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Ic(n.nodes_start,n.nodes_end),t=!0),xl(n,e&&!t),ws(n,0),Lt(n,ii);var r=n.transitions;if(r!==null)for(const l of r)l.stop();Ol(n);var o=n.parent;o!==null&&o.first!==null&&Ml(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Ic(n,e){for(;n!==null;){var t=n===e?null:Os(n);n.remove(),n=t}}function Ml(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Ms(n,e){var t=[];Fo(n,t,!0),Ll(t,()=>{Un(n),e&&e()})}function Ll(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var o of n)o.out(r)}else e()}function Fo(n,e,t){if((n.f&fn)===0){if(n.f^=fn,n.transitions!==null)for(const c of n.transitions)(c.is_global||t)&&e.push(c);for(var r=n.first;r!==null;){var o=r.next,l=(r.f&To)!==0||(r.f&qn)!==0;Fo(r,e,l?t:!1),r=o}}}function Do(n){$l(n,!0)}function $l(n,e){if((n.f&fn)!==0){n.f^=fn,(n.f&yt)===0&&(Lt(n,Zt),ei(n));for(var t=n.first;t!==null;){var r=t.next,o=(t.f&To)!==0||(t.f&qn)!==0;$l(t,o?e:!1),t=r}if(n.transitions!==null)for(const l of n.transitions)(l.is_global||e)&&l.in()}}let Xr=!1;function Aa(n){Xr=n}let oi=!1;function Sa(n){oi=n}let Oe=null,kn=!1;function An(n){Oe=n}let xe=null;function Xn(n){xe=n}let Dn=null;function Fl(n){Oe!==null&&(Dn===null?Dn=[n]:Dn.push(n))}let Ct=null,Vt=0,Jt=null;function Pc(n){Jt=n}let Dl=1,Pi=0,mr=Pi;function Ca(n){mr=n}let Kn=!1;function Ul(){return++Dl}function Ls(n){var e=n.f;if((e&Zt)!==0)return!0;if((e&Qn)!==0){var t=n.deps,r=(e&Qt)!==0;if(t!==null){var o,l,c=(e&ps)!==0,f=r&&xe!==null&&!Kn,p=t.length;if((c||f)&&(xe===null||(xe.f&ii)===0)){var g=n,y=g.parent;for(o=0;o<p;o++)l=t[o],(c||!l?.reactions?.includes(g))&&(l.reactions??=[]).push(g);c&&(g.f^=ps),f&&y!==null&&(y.f&Qt)===0&&(g.f^=Qt)}for(o=0;o<p;o++)if(l=t[o],Ls(l)&&wl(l),l.wv>n.wv)return!0}(!r||xe!==null&&!Kn)&&Lt(n,yt)}return!1}function ql(n,e,t=!0){var r=n.reactions;if(r!==null&&!Dn?.includes(n))for(var o=0;o<r.length;o++){var l=r[o];(l.f&Ht)!==0?ql(l,e,!1):e===l&&(t?Lt(l,Zt):(l.f&yt)!==0&&Lt(l,Qn),ei(l))}}function Nl(n){var e=Ct,t=Vt,r=Jt,o=Oe,l=Kn,c=Dn,f=st,p=kn,g=mr,y=n.f;Ct=null,Vt=0,Jt=null,Kn=(y&Qt)!==0&&(kn||!Xr||Oe===null),Oe=(y&(qn|wr))===0?n:null,Dn=null,gs(n.ctx),kn=!1,mr=++Pi,n.ac!==null&&(xs(()=>{n.ac.abort(Po)}),n.ac=null);try{n.f|=oo;var k=n.fn,E=k(),_=n.deps;if(Ct!==null){var I;if(ws(n,Vt),_!==null&&Vt>0)for(_.length=Vt+Ct.length,I=0;I<Ct.length;I++)_[Vt+I]=Ct[I];else n.deps=_=Ct;if(!Kn||(y&Ht)!==0&&n.reactions!==null)for(I=Vt;I<_.length;I++)(_[I].reactions??=[]).push(n)}else _!==null&&Vt<_.length&&(ws(n,Vt),_.length=Vt);if(si()&&Jt!==null&&!kn&&_!==null&&(n.f&(Ht|Qn|Zt))===0)for(I=0;I<Jt.length;I++)ql(Jt[I],n);return o!==null&&o!==n&&(Pi++,Jt!==null&&(r===null?r=Jt:r.push(...Jt))),(n.f&_r)!==0&&(n.f^=_r),E}catch(L){return lc(L)}finally{n.f^=oo,Ct=e,Vt=t,Jt=r,Oe=o,Kn=l,Dn=c,gs(f),kn=p,mr=g}}function Rc(n,e){let t=e.reactions;if(t!==null){var r=Lu.call(t,n);if(r!==-1){var o=t.length-1;o===0?t=e.reactions=null:(t[r]=t[o],t.pop())}}t===null&&(e.f&Ht)!==0&&(Ct===null||!Ct.includes(e))&&(Lt(e,Qn),(e.f&(Qt|ps))===0&&(e.f^=ps),yl(e),ws(e,0))}function ws(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Rc(n,t[r])}function Qr(n){var e=n.f;if((e&ii)===0){Lt(n,yt);var t=xe,r=Xr;xe=n,Xr=!0;try{(e&ri)!==0?Tc(n):xl(n),Ol(n);var o=Nl(n);n.teardown=typeof o=="function"?o:null,n.wv=Dl;var l;ll&&sc&&(n.f&Zt)!==0&&n.deps}finally{Xr=r,xe=t}}}async function jc(){await Promise.resolve(),gc()}function C(n){var e=n.f,t=(e&Ht)!==0;if(Oe!==null&&!kn){var r=xe!==null&&(xe.f&ii)!==0;if(!r&&!Dn?.includes(n)){var o=Oe.deps;if((Oe.f&oo)!==0)n.rv<Pi&&(n.rv=Pi,Ct===null&&o!==null&&o[Vt]===n?Vt++:Ct===null?Ct=[n]:(!Kn||!Ct.includes(n))&&Ct.push(n));else{(Oe.deps??=[]).push(n);var l=n.reactions;l===null?n.reactions=[Oe]:l.includes(Oe)||l.push(Oe)}}}else if(t&&n.deps===null&&n.effects===null){var c=n,f=c.parent;f!==null&&(f.f&Qt)===0&&(c.f^=Qt)}if(oi){if(Jn.has(n))return Jn.get(n);if(t){c=n;var p=c.v;return((c.f&yt)===0&&c.reactions!==null||Bl(c))&&(p=Oo(c)),Jn.set(c,p),p}}else t&&(c=n,Ls(c)&&wl(c));if((n.f&_r)!==0)throw n.v;return n.v}function Bl(n){if(n.v===ft)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Jn.has(e)||(e.f&Ht)!==0&&Bl(e))return!0;return!1}function Li(n){var e=kn;try{return kn=!0,n()}finally{kn=e}}const Oc=-7169;function Lt(n,e){n.f=n.f&Oc|e}function xc(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Yn in n)uo(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Yn in t&&uo(t)}}}function uo(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{uo(n[r],e)}catch{}const t=Ao(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=ul(t);for(let o in r){const l=r[o].get;if(l)try{l.call(n)}catch{}}}}}const Mc=["touchstart","touchmove"];function Lc(n){return Mc.includes(n)}const Wl=new Set,co=new Set;function $c(n,e,t,r={}){function o(l){if(r.capture||yi.call(e,l),!l.cancelBubble)return xs(()=>t?.call(this,l))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?jo(()=>{e.addEventListener(n,o,r)}):e.addEventListener(n,o,r),o}function Ta(n,e,t,r,o){var l={capture:r,passive:o},c=$c(n,e,t,l);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Pl(()=>{e.removeEventListener(n,c,l)})}function Vl(n){for(var e=0;e<n.length;e++)Wl.add(n[e]);for(var t of co)t(n)}let Ia=null;function yi(n){var e=this,t=e.ownerDocument,r=n.type,o=n.composedPath?.()||[],l=o[0]||n.target;Ia=n;var c=0,f=Ia===n&&n.__root;if(f){var p=o.indexOf(f);if(p!==-1&&(e===document||e===window)){n.__root=e;return}var g=o.indexOf(e);if(g===-1)return;p<=g&&(c=p)}if(l=o[c]||n.target,l!==e){so(n,"currentTarget",{configurable:!0,get(){return l||t}});var y=Oe,k=xe;An(null),Xn(null);try{for(var E,_=[];l!==null;){var I=l.assignedSlot||l.parentNode||l.host||null;try{var L=l["__"+r];if(L!=null&&(!l.disabled||n.target===l))if(Cs(L)){var[$,...z]=L;$.apply(l,[n,...z])}else L.call(l,n)}catch(U){E?_.push(U):E=U}if(n.cancelBubble||I===e||I===null)break;l=I}if(E){for(let U of _)queueMicrotask(()=>{throw U});throw E}}finally{n.__root=e,delete n.currentTarget,An(y),Xn(k)}}}function Fc(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function bs(n,e){var t=xe;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function be(n,e){var t=(e&Zu)!==0,r=(e&ec)!==0,o,l=!n.startsWith("<!>");return()=>{o===void 0&&(o=Fc(l?n:"<!>"+n),t||(o=ms(o)));var c=r||Sl?document.importNode(o,!0):o.cloneNode(!0);if(t){var f=ms(c),p=c.lastChild;bs(f,p)}else bs(c,c);return c}}function Ks(n=""){{var e=br(n+"");return bs(e,e),e}}function Fn(){var n=document.createDocumentFragment(),e=document.createComment(""),t=br();return n.append(e,t),bs(e,t),n}function ae(n,e){n!==null&&n.before(e)}function nt(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Dc(n,e){return Uc(n,e)}const $r=new Map;function Uc(n,{target:e,anchor:t,props:r={},events:o,context:l,intro:c=!0}){wc();var f=new Set,p=k=>{for(var E=0;E<k.length;E++){var _=k[E];if(!f.has(_)){f.add(_);var I=Lc(_);e.addEventListener(_,yi,{passive:I});var L=$r.get(_);L===void 0?(document.addEventListener(_,yi,{passive:I}),$r.set(_,1)):$r.set(_,L+1)}}};p(Eo(Wl)),co.add(p);var g=void 0,y=Sc(()=>{var k=t??e.appendChild(br());return ti(()=>{if(l){xi({});var E=st;E.c=l}o&&(r.$$events=o),g=n(k,r)||{},l&&Mi()}),()=>{for(var E of f){e.removeEventListener(E,yi);var _=$r.get(E);--_===0?(document.removeEventListener(E,yi),$r.delete(E)):$r.set(E,_)}co.delete(p),k!==t&&k.parentNode?.removeChild(k)}});return qc.set(g,y),g}let qc=new WeakMap;function Qe(n,e,t=!1){var r=n,o=null,l=null,c=ft,f=t?To:0,p=!1;const g=(_,I=!0)=>{p=!0,E(I,_)};var y=null;function k(){y!==null&&(y.lastChild.remove(),r.before(y),y=null);var _=c?o:l,I=c?l:o;_&&Do(_),I&&Ms(I,()=>{c?l=null:o=null})}const E=(_,I)=>{if(c!==(c=_)){var L=xo(),$=r;if(L&&(y=document.createDocumentFragment(),y.append($=br())),c?o??=I&&ti(()=>I($)):l??=I&&ti(()=>I($)),L){var z=Ge,U=c?o:l,N=c?l:o;U&&z.skipped_effects.delete(U),N&&z.skipped_effects.add(N),z.add_callback(k)}else k()}};$o(()=>{p=!1,e(g),p||E(null,null)},f)}function Pa(n,e,t){var r=n,o=ft,l,c,f=null,p=si()?ic:vl;function g(){l&&Ms(l),f!==null&&(f.lastChild.remove(),r.before(f),f=null),l=c}$o(()=>{if(p(o,o=e())){var y=r,k=xo();k&&(f=document.createDocumentFragment(),f.append(y=br())),c=ti(()=>t(y)),k?Ge.add_callback(g):g()}})}function cn(n,e){return e}function Nc(n,e,t){for(var r=n.items,o=[],l=e.length,c=0;c<l;c++)Fo(e[c].e,o,!0);var f=l>0&&o.length===0&&t!==null;if(f){var p=t.parentNode;bc(p),p.append(t),r.clear(),wn(n,e[0].prev,e[l-1].next)}Ll(o,()=>{for(var g=0;g<l;g++){var y=e[g];f||(r.delete(y.k),wn(n,y.prev,y.next)),Un(y.e,!f)}})}function xt(n,e,t,r,o,l=null){var c=n,f={flags:e,items:new Map,first:null},p=(e&dl)!==0;if(p){var g=n;c=g.appendChild(br())}var y=null,k=!1,E=new Map,_=ml(()=>{var z=t();return Cs(z)?z:z==null?[]:Eo(z)}),I,L;function $(){Bc(L,I,f,E,c,o,e,r,t),l!==null&&(I.length===0?y?Do(y):y=ti(()=>l(c)):y!==null&&Ms(y,()=>{y=null}))}$o(()=>{L??=xe,I=C(_);var z=I.length;if(!(k&&z===0)){k=z===0;var U,N,G,K;if(xo()){var j=new Set,M=Ge;for(N=0;N<z;N+=1){G=I[N],K=r(G,N);var oe=f.items.get(K)??E.get(K);oe?(e&(Is|Ps))!==0&&Hl(oe,G,N,e):(U=zl(null,f,null,null,G,K,N,o,e,t,!0),E.set(K,U)),j.add(K)}for(const[le,ce]of f.items)j.has(le)||M.skipped_effects.add(ce.e);M.add_callback($)}else $();C(_)}})}function Bc(n,e,t,r,o,l,c,f,p){var g=(c&Xu)!==0,y=(c&(Is|Ps))!==0,k=e.length,E=t.items,_=t.first,I=_,L,$=null,z,U=[],N=[],G,K,j,M;if(g)for(M=0;M<k;M+=1)G=e[M],K=f(G,M),j=E.get(K),j!==void 0&&(j.a?.measure(),(z??=new Set).add(j));for(M=0;M<k;M+=1){if(G=e[M],K=f(G,M),j=E.get(K),j===void 0){var oe=r.get(K);if(oe!==void 0){r.delete(K),E.set(K,oe);var le=$?$.next:I;wn(t,$,oe),wn(t,oe,le),Ys(oe,le,o),$=oe}else{var ce=I?I.e.nodes_start:o;$=zl(ce,t,$,$===null?t.first:$.next,G,K,M,l,c,p)}E.set(K,$),U=[],N=[],I=$.next;continue}if(y&&Hl(j,G,M,c),(j.e.f&fn)!==0&&(Do(j.e),g&&(j.a?.unfix(),(z??=new Set).delete(j))),j!==I){if(L!==void 0&&L.has(j)){if(U.length<N.length){var Q=N[0],he;$=Q.prev;var De=U[0],Ke=U[U.length-1];for(he=0;he<U.length;he+=1)Ys(U[he],Q,o);for(he=0;he<N.length;he+=1)L.delete(N[he]);wn(t,De.prev,Ke.next),wn(t,$,De),wn(t,Ke,Q),I=Q,$=Ke,M-=1,U=[],N=[]}else L.delete(j),Ys(j,I,o),wn(t,j.prev,j.next),wn(t,j,$===null?t.first:$.next),wn(t,$,j),$=j;continue}for(U=[],N=[];I!==null&&I.k!==K;)(I.e.f&fn)===0&&(L??=new Set).add(I),N.push(I),I=I.next;if(I===null)continue;j=I}U.push(j),$=j,I=j.next}if(I!==null||L!==void 0){for(var Ve=L===void 0?[]:Eo(L);I!==null;)(I.e.f&fn)===0&&Ve.push(I),I=I.next;var wt=Ve.length;if(wt>0){var ke=(c&dl)!==0&&k===0?o:null;if(g){for(M=0;M<wt;M+=1)Ve[M].a?.measure();for(M=0;M<wt;M+=1)Ve[M].a?.fix()}Nc(t,Ve,ke)}}g&&jo(()=>{if(z!==void 0)for(j of z)j.a?.apply()}),n.first=t.first&&t.first.e,n.last=$&&$.e;for(var en of r.values())Un(en.e);r.clear()}function Hl(n,e,t,r){(r&Is)!==0&&Ii(n.v,e),(r&Ps)!==0?Ii(n.i,t):n.i=t}function zl(n,e,t,r,o,l,c,f,p,g,y){var k=(p&Is)!==0,E=(p&Qu)===0,_=k?E?mc(o,!1,!1):Ti(o):o,I=(p&Ps)===0?c:Ti(c),L={i:I,v:_,k:l,a:null,e:null,prev:t,next:r};try{if(n===null){var $=document.createDocumentFragment();$.append(n=br())}return L.e=ti(()=>f(n,_,I,g),rc),L.e.prev=t&&t.e,L.e.next=r&&r.e,t===null?y||(e.first=L):(t.next=L,t.e.next=L.e),r!==null&&(r.prev=L,r.e.prev=L.e),L}finally{}}function Ys(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,o=e?e.e.nodes_start:t,l=n.e.nodes_start;l!==null&&l!==r;){var c=Os(l);o.before(l),l=c}}function wn(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Wc(n,e,t){var r=n==null?"":""+n;return r=r?r+" "+e:e,r===""?null:r}function ss(n,e,t,r,o,l){var c=n.__className;if(c!==t||c===void 0){var f=Wc(t,r);f==null?n.removeAttribute("class"):n.className=f,n.__className=t}return l}function Gl(n,e,t=!1){if(n.multiple){if(e==null)return;if(!Cs(e))return nc();for(var r of n.options)r.selected=e.includes(ki(r));return}for(r of n.options){var o=ki(r);if(yc(o,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Vc(n){var e=new MutationObserver(()=>{Gl(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Pl(()=>{e.disconnect()})}function ur(n,e,t=e){var r=!0;Mo(n,"change",o=>{var l=o?"[selected]":":checked",c;if(n.multiple)c=[].map.call(n.querySelectorAll(l),ki);else{var f=n.querySelector(l)??n.querySelector("option:not([disabled])");c=f&&ki(f)}t(c)}),jl(()=>{var o=e();if(Gl(n,o,r),r&&o===void 0){var l=n.querySelector(":checked");l!==null&&(o=ki(l),t(o))}n.__value=o,r=!1}),Vc(n)}function ki(n){return"__value"in n?n.__value:n.value}const Hc=Symbol("is custom element"),zc=Symbol("is html");function Ra(n,e,t,r){var o=Gc(n);o[e]!==(o[e]=t)&&(t==null?n.removeAttribute(e):typeof t!="string"&&Kc(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Gc(n){return n.__attributes??={[Hc]:n.nodeName.includes("-"),[zc]:n.namespaceURI===tc}}var ja=new Map;function Kc(n){var e=n.getAttribute("is")||n.nodeName,t=ja.get(e);if(t)return t;ja.set(e,t=[]);for(var r,o=n,l=Element.prototype;l!==o;){r=ul(o);for(var c in r)r[c].set&&t.push(c);o=Ao(o)}return t}function Fr(n,e,t=e){var r=new WeakSet;Mo(n,"input",async o=>{var l=o?n.defaultValue:n.value;if(l=Js(n)?Xs(l):l,t(l),Ge!==null&&r.add(Ge),await jc(),l!==(l=e())){var c=n.selectionStart,f=n.selectionEnd;n.value=l??"",f!==null&&(n.selectionStart=c,n.selectionEnd=Math.min(f,n.value.length))}}),Li(e)==null&&n.value&&(t(Js(n)?Xs(n.value):n.value),Ge!==null&&r.add(Ge)),Lo(()=>{var o=e();if(n===document.activeElement){var l=hs??Ge;if(r.has(l))return}Js(n)&&o===Xs(n.value)||n.type==="date"&&!o&&!n.value||o!==n.value&&(n.value=o??"")})}function Oa(n,e,t=e){Mo(n,"change",r=>{var o=r?n.defaultChecked:n.checked;t(o)}),Li(e)==null&&t(n.checked),Lo(()=>{var r=e();n.checked=!!r})}function Js(n){var e=n.type;return e==="number"||e==="range"}function Xs(n){return n===""?null:+n}function xa(n,e){return n===e||n?.[Yn]===e}function Yc(n={},e,t,r){return jl(()=>{var o,l;return Lo(()=>{o=l,l=[],Li(()=>{n!==t(...l)&&(e(n,...l),o&&xa(t(...o),n)&&e(null,...o))})}),()=>{jo(()=>{l&&xa(t(...l),n)&&e(null,...l)})}}),n}function Jc(n=!1){const e=st,t=e.l.u;if(!t)return;let r=()=>xc(e.s);if(n){let o=0,l={};const c=Rs(()=>{let f=!1;const p=e.s;for(const g in p)p[g]!==l[g]&&(l[g]=p[g],f=!0);return f&&o++,o});r=()=>C(c)}t.b.length&&Ac(()=>{Ma(e,r),vs(t.b)}),ys(()=>{const o=Li(()=>t.m.map(Du));return()=>{for(const l of o)typeof l=="function"&&l()}}),t.a.length&&ys(()=>{Ma(e,r),vs(t.a)})}function Ma(n,e){if(n.l.s)for(const t of n.l.s)C(t);e()}function Uo(n){st===null&&Bu(),Oi&&st.l!==null?Xc(st).m.push(n):ys(()=>{const e=Li(n);if(typeof e=="function")return e})}function Xc(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const Qc="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Qc);oc();class Zc{#n=Ze(En({inventory:[],stats:{knowledge:0,courage:0,charisma:0}}));get player(){return C(this.#n)}set player(e){fe(this.#n,e,!0)}#t=Ze(null);get storyData(){return C(this.#t)}set storyData(e){fe(this.#t,e,!0)}#e=Ze("0");get currentDialogueId(){return C(this.#e)}set currentDialogueId(e){fe(this.#e,e,!0)}#r=Ze(!0);get isLoading(){return C(this.#r)}set isLoading(e){fe(this.#r,e,!0)}#i=Ze("");get error(){return C(this.#i)}set error(e){fe(this.#i,e,!0)}async loadStory(e){this.isLoading=!0;try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.storyData=await t.json(),this.currentDialogueId=this.storyData.dialogues[0]?.id||"0"}catch(t){this.error="Ошибка загрузки: "+t.message,console.error(t)}finally{this.isLoading=!1}}findDialogue(e){return this.storyData?.dialogues.find(t=>t.id===e)}getItem(e){return this.storyData?.items.find(t=>t.id===e)}hasItem(e){return this.player.inventory.includes(e)}addItem(e){this.player.inventory.includes(e)||(this.player.inventory=[...this.player.inventory,e])}runActions(e){e&&e.forEach(t=>{t.type==="add_item"&&t.id&&this.addItem(t.id),t.type==="stat_change"&&t.stat&&t.value!==void 0&&(this.player.stats[t.stat]+=t.value)})}goToDialogue(e){this.currentDialogueId=e}}const Mt=new Zc;function eh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function th(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var o=!1;try{o=this instanceof r}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var fs={exports:{}},nh=fs.exports,La;function rh(){return La||(La=1,(function(n,e){(function(r,o){n.exports=o()})(nh,()=>(()=>{var t=[,((c,f,p)=>{p.r(f),p.d(f,{default:()=>y});var g=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(E={}){var _=E,I,L;_.ready=new Promise((i,s)=>{I=i,L=s});function $(){function i(A){const R=d;u=s=0,d=new Map,R.forEach(x=>{try{x(A)}catch(P){console.error(P)}}),this.pb(),m&&m.Tb()}let s=0,u=0,d=new Map,m=null,b=null;this.requestAnimationFrame=function(A){s||(s=requestAnimationFrame(i.bind(this)));const R=++u;return d.set(R,A),R},this.cancelAnimationFrame=function(A){d.delete(A),s&&d.size==0&&(cancelAnimationFrame(s),s=0)},this.Rb=function(A){b&&(document.body.remove(b),b=null),A||(b=document.createElement("div"),b.style.backgroundColor="black",b.style.position="fixed",b.style.right=0,b.style.top=0,b.style.color="white",b.style.padding="4px",b.innerHTML="RIVE FPS",A=function(R){b.innerHTML="RIVE FPS "+R.toFixed(1)},document.body.appendChild(b)),m=new function(){let R=0,x=0;this.Tb=function(){var P=performance.now();x?(++R,P-=x,1e3<P&&(A(1e3*R/P),R=x=0)):(x=P,R=0)}}},this.Ob=function(){b&&(document.body.remove(b),b=null),m=null},this.pb=function(){}}function z(i){console.assert(!0);const s=new Map;let u=-1/0;this.push=function(d){return d=d+((1<<i)-1)>>i,s.has(d)&&clearTimeout(s.get(d)),s.set(d,setTimeout(function(){s.delete(d),s.length==0?u=-1/0:d==u&&(u=Math.max(...s.keys()),console.assert(u<d))},1e3)),u=Math.max(d,u),u<<i}}const U=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){U&&U();let i=_.decodeAudio;_.decodeAudio=function(m,b){m=i(m),b(m)};let s=_.decodeFont;_.decodeFont=function(m,b){m=s(m),b(m)};const u=_.FileAssetLoader;_.ptrToAsset=m=>{let b=_.ptrToFileAsset(m);return b.isImage?_.ptrToImageAsset(m):b.isFont?_.ptrToFontAsset(m):b.isAudio?_.ptrToAudioAsset(m):b},_.CustomFileAssetLoader=u.extend("CustomFileAssetLoader",{__construct:function({loadContents:m}){this.__parent.__construct.call(this),this.Gb=m},loadContents:function(m,b){return m=_.ptrToAsset(m),this.Gb(m,b)}}),_.CDNFileAssetLoader=u.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(m){let b=_.ptrToAsset(m);return m=b.cdnUuid,m===""?!1:((function(A,R){var x=new XMLHttpRequest;x.responseType="arraybuffer",x.onreadystatechange=function(){x.readyState==4&&x.status==200&&R(x)},x.open("GET",A,!0),x.send(null)})(b.cdnBaseUrl+"/"+m,A=>{b.decode(new Uint8Array(A.response))}),!0)}}),_.FallbackFileAssetLoader=u.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(m){this.lb.push(m)},loadContents:function(m,b){for(let A of this.lb)if(A.loadContents(m,b))return!0;return!1}});let d=_.computeAlignment;_.computeAlignment=function(m,b,A,R,x=1){return d.call(this,m,b,A,R,x)}};const N="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),G=new function(){function i(){if(!s){let ge=function(we,Y,ze){if(Y=q.createShader(Y),q.shaderSource(Y,ze),q.compileShader(Y),ze=q.getShaderInfoLog(Y),0<(ze||"").length)throw ze;q.attachShader(we,Y)};var S=document.createElement("canvas"),B={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let q;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(q=S.getContext("webgl",B),u=1,!q)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(q=S.getContext("webgl2",B))u=2;else if(q=S.getContext("webgl",B))u=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(q=new Proxy(q,{get(we,Y){if(we.isContextLost()){if(x||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",Y),x=!0),typeof we[Y]=="function")return function(){}}else return typeof we[Y]=="function"?function(...ze){return we[Y].apply(we,ze)}:we[Y]},set(we,Y,ze){if(we.isContextLost())x||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+Y),x=!0);else return we[Y]=ze,!0}}),d=Math.min(q.getParameter(q.MAX_RENDERBUFFER_SIZE),q.getParameter(q.MAX_TEXTURE_SIZE)),S=q.createProgram(),ge(S,q.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),ge(S,q.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),q.bindAttribLocation(S,0,"vertex"),q.bindAttribLocation(S,1,"uv"),q.linkProgram(S),B=q.getProgramInfoLog(S),0<(B||"").trim().length)throw B;m=q.getUniformLocation(S,"mat"),b=q.getUniformLocation(S,"translate"),q.useProgram(S),q.bindBuffer(q.ARRAY_BUFFER,q.createBuffer()),q.enableVertexAttribArray(0),q.enableVertexAttribArray(1),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,q.createBuffer()),q.uniform1i(q.getUniformLocation(S,"image"),0),q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s=q}return!0}let s=null,u=0,d=0,m=null,b=null,A=0,R=0,x=!1;i(),this.hc=function(){return i(),d},this.Mb=function(S){s.deleteTexture&&s.deleteTexture(S)},this.Lb=function(S){if(!i())return null;const B=s.createTexture();return B?(s.bindTexture(s.TEXTURE_2D,B),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,S),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),u==2?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.generateMipmap(s.TEXTURE_2D)):s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),B):null};const P=new z(8),W=new z(8),H=new z(10),te=new z(10);this.Qb=function(S,B,q,ge,we){if(i()){var Y=P.push(S),ze=W.push(B);if(s.canvas){(s.canvas.width!=Y||s.canvas.height!=ze)&&(s.canvas.width=Y,s.canvas.height=ze),s.viewport(0,ze-B,S,B),s.disable(s.SCISSOR_TEST),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.SCISSOR_TEST),q.sort((Pe,yn)=>yn.xb-Pe.xb),Y=H.push(ge),A!=Y&&(s.bufferData(s.ARRAY_BUFFER,8*Y,s.DYNAMIC_DRAW),A=Y),Y=0;for(var gt of q)s.bufferSubData(s.ARRAY_BUFFER,Y,gt.Ua),Y+=4*gt.Ua.length;console.assert(Y==4*ge);for(var mn of q)s.bufferSubData(s.ARRAY_BUFFER,Y,mn.Db),Y+=4*mn.Db.length;console.assert(Y==8*ge),Y=te.push(we),R!=Y&&(s.bufferData(s.ELEMENT_ARRAY_BUFFER,2*Y,s.DYNAMIC_DRAW),R=Y),gt=0;for(var or of q)s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,gt,or.indices),gt+=2*or.indices.length;console.assert(gt==2*we),or=0,mn=!0,Y=gt=0;for(const Pe of q){Pe.image.Ka!=or&&(s.bindTexture(s.TEXTURE_2D,Pe.image.Ja||null),or=Pe.image.Ka),Pe.mc?(s.scissor(Pe.Za,ze-Pe.$a-Pe.kb,Pe.Ac,Pe.kb),mn=!0):mn&&(s.scissor(0,ze-B,S,B),mn=!1),q=2/S;const yn=-2/B;s.uniform4f(m,Pe.ha[0]*q*Pe.Ba,Pe.ha[1]*yn*Pe.Ca,Pe.ha[2]*q*Pe.Ba,Pe.ha[3]*yn*Pe.Ca),s.uniform2f(b,Pe.ha[4]*q*Pe.Ba+q*(Pe.Za-Pe.ic*Pe.Ba)-1,Pe.ha[5]*yn*Pe.Ca+yn*(Pe.$a-Pe.jc*Pe.Ca)+1),s.vertexAttribPointer(0,2,s.FLOAT,!1,0,Y),s.vertexAttribPointer(1,2,s.FLOAT,!1,0,Y+4*ge),s.drawElements(s.TRIANGLES,Pe.indices.length,s.UNSIGNED_SHORT,gt),Y+=4*Pe.Ua.length,gt+=2*Pe.indices.length}console.assert(Y==4*ge),console.assert(gt==2*we)}}},this.canvas=function(){return i()&&s.canvas}},K=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){function i(D){switch(D){case P.srcOver:return"source-over";case P.screen:return"screen";case P.overlay:return"overlay";case P.darken:return"darken";case P.lighten:return"lighten";case P.colorDodge:return"color-dodge";case P.colorBurn:return"color-burn";case P.hardLight:return"hard-light";case P.softLight:return"soft-light";case P.difference:return"difference";case P.exclusion:return"exclusion";case P.multiply:return"multiply";case P.hue:return"hue";case P.saturation:return"saturation";case P.color:return"color";case P.luminosity:return"luminosity"}}function s(D){return"rgba("+((16711680&D)>>>16)+","+((65280&D)>>>8)+","+((255&D)>>>0)+","+((4278190080&D)>>>24)/255+")"}function u(){0<ze.length&&(G.Qb(Y.drawWidth(),Y.drawHeight(),ze,gt,mn),ze=[],mn=gt=0,Y.reset(512,512));for(const D of we){for(const X of D.H)X();D.H=[]}we.clear()}K&&K();var d=_.RenderPaintStyle;const m=_.RenderPath,b=_.RenderPaint,A=_.Renderer,R=_.StrokeCap,x=_.StrokeJoin,P=_.BlendMode,W=d.fill,H=d.stroke,te=_.FillRule.evenOdd;let S=1;var B=_.RenderImage.extend("CanvasRenderImage",{__construct:function({la:D,xa:X}={}){this.__parent.__construct.call(this),this.Ka=S,S=S+1&2147483647||1,this.la=D,this.xa=X},__destruct:function(){this.Ja&&(G.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(D){var X=this;X.xa&&X.xa(X);var Ce=new Image;X.Xa=URL.createObjectURL(new Blob([D],{type:"image/png"})),Ce.onload=function(){X.Fb=Ce,X.Ja=G.Lb(Ce),X.size(Ce.width,Ce.height),X.la&&X.la(X)},Ce.src=X.Xa}}),q=m.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(D,X,Ce,Re,_e,Ie,Le){var Fe=this.T,un=Fe.addPath;D=D.T;const ct=new DOMMatrix;ct.a=X,ct.b=Ce,ct.c=Re,ct.d=_e,ct.e=Ie,ct.f=Le,un.call(Fe,D,ct)},fillRule:function(D){this.Wa=D},moveTo:function(D,X){this.T.moveTo(D,X)},lineTo:function(D,X){this.T.lineTo(D,X)},cubicTo:function(D,X,Ce,Re,_e,Ie){this.T.bezierCurveTo(D,X,Ce,Re,_e,Ie)},close:function(){this.T.closePath()}}),ge=b.extend("CanvasRenderPaint",{color:function(D){this.Ya=s(D)},thickness:function(D){this.Ib=D},join:function(D){switch(D){case x.miter:this.Ia="miter";break;case x.round:this.Ia="round";break;case x.bevel:this.Ia="bevel"}},cap:function(D){switch(D){case R.butt:this.Ha="butt";break;case R.round:this.Ha="round";break;case R.square:this.Ha="square"}},style:function(D){this.Hb=D},blendMode:function(D){this.Eb=i(D)},clearGradient:function(){this.ja=null},linearGradient:function(D,X,Ce,Re){this.ja={zb:D,Ab:X,cb:Ce,eb:Re,Ra:[]}},radialGradient:function(D,X,Ce,Re){this.ja={zb:D,Ab:X,cb:Ce,eb:Re,Ra:[],ec:!0}},addStop:function(D,X){this.ja.Ra.push({color:D,stop:X})},completeGradient:function(){},draw:function(D,X,Ce){let Re=this.Hb;var _e=this.Ya,Ie=this.ja;if(D.globalCompositeOperation=this.Eb,Ie!=null){_e=Ie.zb;var Le=Ie.Ab;const un=Ie.cb;var Fe=Ie.eb;const ct=Ie.Ra;Ie.ec?(Ie=un-_e,Fe-=Le,_e=D.createRadialGradient(_e,Le,0,_e,Le,Math.sqrt(Ie*Ie+Fe*Fe))):_e=D.createLinearGradient(_e,Le,un,Fe);for(let Yt=0,ht=ct.length;Yt<ht;Yt++)Le=ct[Yt],_e.addColorStop(Le.stop,s(Le.color));this.Ya=_e,this.ja=null}switch(Re){case H:D.strokeStyle=_e,D.lineWidth=this.Ib,D.lineCap=this.Ha,D.lineJoin=this.Ia,D.stroke(X);break;case W:D.fillStyle=_e,D.fill(X,Ce)}}});const we=new Set;let Y=null,ze=[],gt=0,mn=0;var or=_.CanvasRenderer=A.extend("Renderer",{__construct:function(D){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=D.getContext("2d"),this.Va=D,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const D=this.S.length-6;if(6>D)throw"restore() called without matching save().";this.S.splice(D),this.H.push(this.C.restore.bind(this.C))},transform:function(D,X,Ce,Re,_e,Ie){const Le=this.S,Fe=Le.length-6;Le.splice(Fe,6,Le[Fe]*D+Le[Fe+2]*X,Le[Fe+1]*D+Le[Fe+3]*X,Le[Fe]*Ce+Le[Fe+2]*Re,Le[Fe+1]*Ce+Le[Fe+3]*Re,Le[Fe]*_e+Le[Fe+2]*Ie+Le[Fe+4],Le[Fe+1]*_e+Le[Fe+3]*Ie+Le[Fe+5]),this.H.push(this.C.transform.bind(this.C,D,X,Ce,Re,_e,Ie))},rotate:function(D){const X=Math.sin(D);D=Math.cos(D),this.transform(D,X,-X,D,0,0)},_drawPath:function(D,X){this.H.push(X.draw.bind(X,this.C,D.T,D.Wa===te?"evenodd":"nonzero"))},_drawRiveImage:function(D,X,Ce,Re){var _e=D.Fb;if(_e){var Ie=this.C,Le=i(Ce);this.H.push(function(){Ie.globalCompositeOperation=Le,Ie.globalAlpha=Re,Ie.drawImage(_e,0,0),Ie.globalAlpha=1})}},_getMatrix:function(D){const X=this.S,Ce=X.length-6;for(let Re=0;6>Re;++Re)D[Re]=X[Ce+Re]},_drawImageMesh:function(D,X,Ce,Re,_e,Ie,Le,Fe,un,ct,Yt){X=this.C.canvas.width;var ht=this.C.canvas.height;const da=ct-Fe,fa=Yt-un;Fe=Math.max(Fe,0),un=Math.max(un,0),ct=Math.min(ct,X),Yt=Math.min(Yt,ht);const _i=ct-Fe,mi=Yt-un;if(console.assert(_i<=Math.min(da,X)),console.assert(mi<=Math.min(fa,ht)),!(0>=_i||0>=mi)){ct=_i<da||mi<fa,X=Yt=1;var ar=Math.ceil(_i*Yt),lr=Math.ceil(mi*X);ht=G.hc(),ar>ht&&(Yt*=ht/ar,ar=ht),lr>ht&&(X*=ht/lr,lr=ht),Y||(Y=new _.DynamicRectanizer(ht),Y.reset(512,512)),ht=Y.addRect(ar,lr),0>ht&&(u(),we.add(this),ht=Y.addRect(ar,lr),console.assert(0<=ht));var va=ht&65535,pa=ht>>16;ze.push({ha:this.S.slice(this.S.length-6),image:D,Za:va,$a:pa,ic:Fe,jc:un,Ac:ar,kb:lr,Ba:Yt,Ca:X,Ua:new Float32Array(_e),Db:new Float32Array(Ie),indices:new Uint16Array(Le),mc:ct,xb:D.Ka<<1|(ct?1:0)}),gt+=_e.length,mn+=Le.length;var Lr=this.C,Mu=i(Ce);this.H.push(function(){Lr.save(),Lr.resetTransform(),Lr.globalCompositeOperation=Mu,Lr.globalAlpha=Re;const ga=G.canvas();ga&&Lr.drawImage(ga,va,pa,ar,lr,Fe,un,_i,mi),Lr.restore()})}},_clipPath:function(D){this.H.push(this.C.clip.bind(this.C,D.T,D.Wa===te?"evenodd":"nonzero"))},clear:function(){we.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(D,X){this.transform(1,0,0,1,D,X)}});_.makeRenderer=function(D){const X=new or(D),Ce=X.C;return new Proxy(X,{get(Re,_e){if(typeof Re[_e]=="function")return function(...Ie){return Re[_e].apply(Re,Ie)};if(typeof Ce[_e]=="function"){if(-1<N.indexOf(_e))throw Error("RiveException: Method call to '"+_e+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(...Ie){X.H.push(Ce[_e].bind(Ce,...Ie))}}return Re[_e]},set(Re,_e,Ie){if(_e in Ce)return X.H.push(()=>{Ce[_e]=Ie}),!0}})},_.decodeImage=function(D,X){new B({la:X}).decode(D)},_.renderFactory={makeRenderPaint:function(){return new ge},makeRenderPath:function(){return new q},makeRenderImage:function(){let D=yn;return new B({xa:()=>{D.total++},la:()=>{if(D.loaded++,D.loaded===D.total){const X=D.ready;X&&(X(),D.ready=null)}}})}};let Pe=_.load,yn=null;_.load=function(D,X,Ce=!0){const Re=new _.FallbackFileAssetLoader;return X!==void 0&&Re.addLoader(X),Ce&&(X=new _.CDNFileAssetLoader,Re.addLoader(X)),new Promise(function(_e){let Ie=null;yn={total:0,loaded:0,ready:function(){_e(Ie)}},Ie=Pe(D,Re),yn.total==0&&_e(Ie)})};let xu=_.RendererWrapper.prototype.align;_.RendererWrapper.prototype.align=function(D,X,Ce,Re,_e=1){xu.call(this,D,X,Ce,Re,_e)},d=new $,_.requestAnimationFrame=d.requestAnimationFrame.bind(d),_.cancelAnimationFrame=d.cancelAnimationFrame.bind(d),_.enableFPSCounter=d.Rb.bind(d),_.disableFPSCounter=d.Ob,d.pb=u,_.resolveAnimationFrame=u,_.cleanup=function(){Y&&Y.delete()}};var j=Object.assign({},_),M="./this.program",oe=typeof window=="object",le=typeof importScripts=="function",ce="",Q,he;(oe||le)&&(le?ce=self.location.href:typeof document<"u"&&document.currentScript&&(ce=document.currentScript.src),k&&(ce=k),ce.indexOf("blob:")!==0?ce=ce.substr(0,ce.replace(/[?#].*/,"").lastIndexOf("/")+1):ce="",le&&(he=i=>{var s=new XMLHttpRequest;return s.open("GET",i,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),Q=(i,s,u)=>{var d=new XMLHttpRequest;d.open("GET",i,!0),d.responseType="arraybuffer",d.onload=()=>{d.status==200||d.status==0&&d.response?s(d.response):u()},d.onerror=u,d.send(null)});var De=_.print||console.log.bind(console),Ke=_.printErr||console.error.bind(console);Object.assign(_,j),j=null,_.thisProgram&&(M=_.thisProgram);var Ve;_.wasmBinary&&(Ve=_.wasmBinary),_.noExitRuntime,typeof WebAssembly!="object"&&pn("no native wasm support detected");var wt,ke,en=!1,tt,He,ot,Tt,Ee,Te,$t,Me;function bt(){var i=wt.buffer;_.HEAP8=tt=new Int8Array(i),_.HEAP16=ot=new Int16Array(i),_.HEAP32=Ee=new Int32Array(i),_.HEAPU8=He=new Uint8Array(i),_.HEAPU16=Tt=new Uint16Array(i),_.HEAPU32=Te=new Uint32Array(i),_.HEAPF32=$t=new Float32Array(i),_.HEAPF64=Me=new Float64Array(i)}var Je,tn=[],vn=[],zt=[];function Cn(){var i=_.preRun.shift();tn.unshift(i)}var _t=0,Ft=null;function pn(i){throw _.onAbort&&_.onAbort(i),i="Aborted("+i+")",Ke(i),en=!0,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),L(i),i}function Nn(i){return i.startsWith("data:application/octet-stream;base64,")}var nn;if(nn="canvas_advanced.wasm",!Nn(nn)){var Er=nn;nn=_.locateFile?_.locateFile(Er,ce):ce+Er}function kt(i){if(i==nn&&Ve)return new Uint8Array(Ve);if(he)return he(i);throw"both async and sync fetching of the wasm failed"}function li(i){if(!Ve&&(oe||le)){if(typeof fetch=="function"&&!i.startsWith("file://"))return fetch(i,{credentials:"same-origin"}).then(s=>{if(!s.ok)throw"failed to load wasm binary file at '"+i+"'";return s.arrayBuffer()}).catch(()=>kt(i));if(Q)return new Promise((s,u)=>{Q(i,d=>s(new Uint8Array(d)),u)})}return Promise.resolve().then(()=>kt(i))}function Ar(i,s,u){return li(i).then(d=>WebAssembly.instantiate(d,s)).then(d=>d).then(u,d=>{Ke("failed to asynchronously prepare wasm: "+d),pn(d)})}function J(i,s){var u=nn;return Ve||typeof WebAssembly.instantiateStreaming!="function"||Nn(u)||u.startsWith("file://")||typeof fetch!="function"?Ar(u,i,s):fetch(u,{credentials:"same-origin"}).then(d=>WebAssembly.instantiateStreaming(d,i).then(s,function(m){return Ke("wasm streaming compile failed: "+m),Ke("falling back to ArrayBuffer instantiation"),Ar(u,i,s)}))}var re,v,a={460492:(i,s,u,d,m)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=i,window.h.I.capture=s,window.h.I.La=u,window.h.ga={},window.h.ga.stopped=d,window.h.ga.yb=m;let b=window.h;b.D=[],b.yc=function(A){for(var R=0;R<b.D.length;++R)if(b.D[R]==null)return b.D[R]=A,R;return b.D.push(A),b.D.length-1},b.Cb=function(A){for(b.D[A]=null;0<b.D.length&&b.D[b.D.length-1]==null;)b.D.pop()},b.Sc=function(A){for(var R=0;R<b.D.length;++R)if(b.D[R]==A)return b.Cb(R)},b.ra=function(A){return b.D[A]},b.Ta=["touchend","click"],b.unlock=function(){for(var A=0;A<b.D.length;++A){var R=b.D[A];R!=null&&R.J!=null&&R.state===b.ga.yb&&R.J.resume().then(()=>{aa(R.qb)},x=>{console.error("Failed to resume audiocontext",x)})}b.Ta.map(function(x){document.removeEventListener(x,b.unlock,!0)})},b.Ta.map(function(A){document.addEventListener(A,b.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(i){document.removeEventListener(i,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var i=new(window.AudioContext||window.webkitAudioContext),s=i.sampleRate;return i.close(),s}catch{return 0}},463249:(i,s,u,d,m,b)=>{if(typeof window.h>"u")return-1;var A={},R={};return i==window.h.I.ya&&u!=0&&(R.sampleRate=u),A.J=new(window.AudioContext||window.webkitAudioContext)(R),A.J.suspend(),A.state=window.h.ga.stopped,u=0,i!=window.h.I.ya&&(u=s),A.Z=A.J.createScriptProcessor(d,u,s),A.Z.onaudioprocess=function(x){if((A.sa==null||A.sa.length==0)&&(A.sa=new Float32Array($t.buffer,m,d*s)),i==window.h.I.capture||i==window.h.I.La){for(var P=0;P<s;P+=1)for(var W=x.inputBuffer.getChannelData(P),H=A.sa,te=0;te<d;te+=1)H[te*s+P]=W[te];la(b,d,m)}if(i==window.h.I.ya||i==window.h.I.La)for(ua(b,d,m),P=0;P<x.outputBuffer.numberOfChannels;++P)for(W=x.outputBuffer.getChannelData(P),H=A.sa,te=0;te<d;te+=1)W[te]=H[te*s+P];else for(P=0;P<x.outputBuffer.numberOfChannels;++P)x.outputBuffer.getChannelData(P).fill(0)},i!=window.h.I.capture&&i!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(x){A.Da=A.J.createMediaStreamSource(x),A.Da.connect(A.Z),A.Z.connect(A.J.destination)}).catch(function(x){console.log("Failed to get user media: "+x)}),i==window.h.I.ya&&A.Z.connect(A.J.destination),A.qb=b,window.h.yc(A)},466126:i=>window.h.ra(i).J.sampleRate,466199:i=>{i=window.h.ra(i),i.Z!==void 0&&(i.Z.onaudioprocess=function(){},i.Z.disconnect(),i.Z=void 0),i.Da!==void 0&&(i.Da.disconnect(),i.Da=void 0),i.J.close(),i.J=void 0,i.qb=void 0},466599:i=>{window.h.Cb(i)},466649:i=>{i=window.h.ra(i),i.J.resume(),i.state=window.h.ga.yb},466788:i=>{i=window.h.ra(i),i.J.suspend(),i.state=window.h.ga.stopped}},h=i=>{for(;0<i.length;)i.shift()(_)},w=(i,s)=>{for(var u=0,d=i.length-1;0<=d;d--){var m=i[d];m==="."?i.splice(d,1):m===".."?(i.splice(d,1),u++):u&&(i.splice(d,1),u--)}if(s)for(;u;u--)i.unshift("..");return i},T=i=>{var s=i.charAt(0)==="/",u=i.substr(-1)==="/";return(i=w(i.split("/").filter(d=>!!d),!s).join("/"))||s||(i="."),i&&u&&(i+="/"),(s?"/":"")+i},O=i=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(i).slice(1);return i=s[0],s=s[1],!i&&!s?".":(s&&(s=s.substr(0,s.length-1)),i+s)},F=i=>{if(i==="/")return"/";i=T(i),i=i.replace(/\/$/,"");var s=i.lastIndexOf("/");return s===-1?i:i.substr(s+1)},ie=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return i=>crypto.getRandomValues(i);pn("initRandomDevice")},de=i=>(de=ie())(i);function ne(){for(var i="",s=!1,u=arguments.length-1;-1<=u&&!s;u--){if(s=0<=u?arguments[u]:"/",typeof s!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)return"";i=s+"/"+i,s=s.charAt(0)==="/"}return i=w(i.split("/").filter(d=>!!d),!s).join("/"),(s?"/":"")+i||"."}var me=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,je=(i,s,u)=>{var d=s+u;for(u=s;i[u]&&!(u>=d);)++u;if(16<u-s&&i.buffer&&me)return me.decode(i.subarray(s,u));for(d="";s<u;){var m=i[s++];if(m&128){var b=i[s++]&63;if((m&224)==192)d+=String.fromCharCode((m&31)<<6|b);else{var A=i[s++]&63;m=(m&240)==224?(m&15)<<12|b<<6|A:(m&7)<<18|b<<12|A<<6|i[s++]&63,65536>m?d+=String.fromCharCode(m):(m-=65536,d+=String.fromCharCode(55296|m>>10,56320|m&1023))}}else d+=String.fromCharCode(m)}return d},rt=[],Be=i=>{for(var s=0,u=0;u<i.length;++u){var d=i.charCodeAt(u);127>=d?s++:2047>=d?s+=2:55296<=d&&57343>=d?(s+=4,++u):s+=3}return s},Dt=(i,s,u,d)=>{if(!(0<d))return 0;var m=u;d=u+d-1;for(var b=0;b<i.length;++b){var A=i.charCodeAt(b);if(55296<=A&&57343>=A){var R=i.charCodeAt(++b);A=65536+((A&1023)<<10)|R&1023}if(127>=A){if(u>=d)break;s[u++]=A}else{if(2047>=A){if(u+1>=d)break;s[u++]=192|A>>6}else{if(65535>=A){if(u+2>=d)break;s[u++]=224|A>>12}else{if(u+3>=d)break;s[u++]=240|A>>18,s[u++]=128|A>>12&63}s[u++]=128|A>>6&63}s[u++]=128|A&63}}return s[u]=0,u-m};function Et(i,s){var u=Array(Be(i)+1);return i=Dt(i,u,0,u.length),s&&(u.length=i),u}var ut=[];function vt(i,s){ut[i]={input:[],F:[],V:s},hi(i,It)}var It={open:function(i){var s=ut[i.node.za];if(!s)throw new ee(43);i.s=s,i.seekable=!1},close:function(i){i.s.V.qa(i.s)},qa:function(i){i.s.V.qa(i.s)},read:function(i,s,u,d){if(!i.s||!i.s.V.jb)throw new ee(60);for(var m=0,b=0;b<d;b++){try{var A=i.s.V.jb(i.s)}catch{throw new ee(29)}if(A===void 0&&m===0)throw new ee(6);if(A==null)break;m++,s[u+b]=A}return m&&(i.node.timestamp=Date.now()),m},write:function(i,s,u,d){if(!i.s||!i.s.V.Oa)throw new ee(60);try{for(var m=0;m<d;m++)i.s.V.Oa(i.s,s[u+m])}catch{throw new ee(29)}return d&&(i.node.timestamp=Date.now()),m}},rn={jb:function(){e:{if(!rt.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i){i=null;break e}rt=Et(i,!0)}i=rt.shift()}return i},Oa:function(i,s){s===null||s===10?(De(je(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(De(je(i.F,0)),i.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},sn={Oa:function(i,s){s===null||s===10?(Ke(je(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(Ke(je(i.F,0)),i.F=[])}};function Gt(i,s){var u=i.j?i.j.length:0;u>=s||(s=Math.max(s,u*(1048576>u?2:1.125)>>>0),u!=0&&(s=Math.max(s,256)),u=i.j,i.j=new Uint8Array(s),0<i.v&&i.j.set(u.subarray(0,i.v),0))}var ue={O:null,U(){return ue.createNode(null,"/",16895,0)},createNode(i,s,u,d){if((u&61440)===24576||(u&61440)===4096)throw new ee(63);return ue.O||(ue.O={dir:{node:{Y:ue.l.Y,P:ue.l.P,ka:ue.l.ka,va:ue.l.va,vb:ue.l.vb,Bb:ue.l.Bb,wb:ue.l.wb,tb:ue.l.tb,Ea:ue.l.Ea},stream:{ba:ue.m.ba}},file:{node:{Y:ue.l.Y,P:ue.l.P},stream:{ba:ue.m.ba,read:ue.m.read,write:ue.m.write,pa:ue.m.pa,mb:ue.m.mb,ob:ue.m.ob}},link:{node:{Y:ue.l.Y,P:ue.l.P,ma:ue.l.ma},stream:{}},ab:{node:{Y:ue.l.Y,P:ue.l.P},stream:Pr}}),u=ye(i,s,u,d),(u.mode&61440)===16384?(u.l=ue.O.dir.node,u.m=ue.O.dir.stream,u.j={}):(u.mode&61440)===32768?(u.l=ue.O.file.node,u.m=ue.O.file.stream,u.v=0,u.j=null):(u.mode&61440)===40960?(u.l=ue.O.link.node,u.m=ue.O.link.stream):(u.mode&61440)===8192&&(u.l=ue.O.ab.node,u.m=ue.O.ab.stream),u.timestamp=Date.now(),i&&(i.j[s]=u,i.timestamp=u.timestamp),u},Kc(i){return i.j?i.j.subarray?i.j.subarray(0,i.v):new Uint8Array(i.j):new Uint8Array(0)},l:{Y(i){var s={};return s.Jc=(i.mode&61440)===8192?i.id:1,s.Mc=i.id,s.mode=i.mode,s.Oc=1,s.uid=0,s.Lc=0,s.za=i.za,(i.mode&61440)===16384?s.size=4096:(i.mode&61440)===32768?s.size=i.v:(i.mode&61440)===40960?s.size=i.link.length:s.size=0,s.Bc=new Date(i.timestamp),s.Nc=new Date(i.timestamp),s.Ic=new Date(i.timestamp),s.Jb=4096,s.Cc=Math.ceil(s.size/s.Jb),s},P(i,s){if(s.mode!==void 0&&(i.mode=s.mode),s.timestamp!==void 0&&(i.timestamp=s.timestamp),s.size!==void 0&&(s=s.size,i.v!=s))if(s==0)i.j=null,i.v=0;else{var u=i.j;i.j=new Uint8Array(s),u&&i.j.set(u.subarray(0,Math.min(s,i.v))),i.v=s}},ka(){throw ci[44]},va(i,s,u,d){return ue.createNode(i,s,u,d)},vb(i,s,u){if((i.mode&61440)===16384){try{var d=se(s,u)}catch{}if(d)for(var m in d.j)throw new ee(55)}delete i.parent.j[i.name],i.parent.timestamp=Date.now(),i.name=u,s.j[u]=i,s.timestamp=i.parent.timestamp,i.parent=s},Bb(i,s){delete i.j[s],i.timestamp=Date.now()},wb(i,s){var u=se(i,s),d;for(d in u.j)throw new ee(55);delete i.j[s],i.timestamp=Date.now()},tb(i){var s=[".",".."],u;for(u in i.j)i.j.hasOwnProperty(u)&&s.push(u);return s},Ea(i,s,u){return i=ue.createNode(i,s,41471,0),i.link=u,i},ma(i){if((i.mode&61440)!==40960)throw new ee(28);return i.link}},m:{read(i,s,u,d,m){var b=i.node.j;if(m>=i.node.v)return 0;if(i=Math.min(i.node.v-m,d),8<i&&b.subarray)s.set(b.subarray(m,m+i),u);else for(d=0;d<i;d++)s[u+d]=b[m+d];return i},write(i,s,u,d,m,b){if(s.buffer===tt.buffer&&(b=!1),!d)return 0;if(i=i.node,i.timestamp=Date.now(),s.subarray&&(!i.j||i.j.subarray)){if(b)return i.j=s.subarray(u,u+d),i.v=d;if(i.v===0&&m===0)return i.j=s.slice(u,u+d),i.v=d;if(m+d<=i.v)return i.j.set(s.subarray(u,u+d),m),d}if(Gt(i,m+d),i.j.subarray&&s.subarray)i.j.set(s.subarray(u,u+d),m);else for(b=0;b<d;b++)i.j[m+b]=s[u+b];return i.v=Math.max(i.v,m+d),d},ba(i,s,u){if(u===1?s+=i.position:u===2&&(i.node.mode&61440)===32768&&(s+=i.node.v),0>s)throw new ee(28);return s},pa(i,s,u){Gt(i.node,s+u),i.node.v=Math.max(i.node.v,s+u)},mb(i,s,u,d,m){if((i.node.mode&61440)!==32768)throw new ee(43);if(i=i.node.j,m&2||i.buffer!==tt.buffer){if((0<u||u+s<i.length)&&(i.subarray?i=i.subarray(u,u+s):i=Array.prototype.slice.call(i,u,u+s)),u=!0,pn(),s=void 0,!s)throw new ee(48);tt.set(i,s)}else u=!1,s=i.byteOffset;return{o:s,M:u}},ob(i,s,u,d){return ue.m.write(i,s,0,d,u,!1),0}}};function Se(i,s){var u=0;return i&&(u|=365),s&&(u|=146),u}var Ut=null,Sr={},Cr=[],Di=1,er=null,ui=!0,ee=null,ci={},Tn=(i,s={})=>{if(i=ne(i),!i)return{path:"",node:null};if(s=Object.assign({hb:!0,Qa:0},s),8<s.Qa)throw new ee(32);i=i.split("/").filter(A=>!!A);for(var u=Ut,d="/",m=0;m<i.length;m++){var b=m===i.length-1;if(b&&s.parent)break;if(u=se(u,i[m]),d=T(d+"/"+i[m]),u.wa&&(!b||b&&s.hb)&&(u=u.wa.root),!b||s.gb){for(b=0;(u.mode&61440)===40960;)if(u=In(d),d=ne(O(d),u),u=Tn(d,{Qa:s.Qa+1}).node,40<b++)throw new ee(32)}}return{path:d,node:u}},Ui=i=>{for(var s;;){if(i===i.parent)return i=i.U.nb,s?i[i.length-1]!=="/"?`${i}/${s}`:i+s:i;s=s?`${i.name}/${s}`:i.name,i=i.parent}},$e=(i,s)=>{for(var u=0,d=0;d<s.length;d++)u=(u<<5)-u+s.charCodeAt(d)|0;return(i+u>>>0)%er.length},se=(i,s)=>{var u;if(u=(u=qe(i,"x"))?u:i.l.ka?0:2)throw new ee(u,i);for(u=er[$e(i.id,s)];u;u=u.lc){var d=u.name;if(u.parent.id===i.id&&d===s)return u}return i.l.ka(i,s)},ye=(i,s,u,d)=>(i=new ra(i,s,u,d),s=$e(i.parent.id,i.name),i.lc=er[s],er[s]=i),it=i=>{var s=["r","w","rw"][i&3];return i&512&&(s+="w"),s},qe=(i,s)=>{if(ui)return 0;if(!s.includes("r")||i.mode&292){if(s.includes("w")&&!(i.mode&146)||s.includes("x")&&!(i.mode&73))return 2}else return 2;return 0},on=(i,s)=>{try{return se(i,s),20}catch{}return qe(i,"wx")},Tr=()=>{for(var i=0;4096>=i;i++)if(!Cr[i])return i;throw new ee(33)},qt=i=>{if(i=Cr[i],!i)throw new ee(8);return i},Ir=(i,s=-1)=>(Bn||(Bn=function(){this.h={}},Bn.prototype={},Object.defineProperties(Bn.prototype,{object:{get(){return this.node},set(u){this.node=u}},flags:{get(){return this.h.flags},set(u){this.h.flags=u}},position:{get(){return this.h.position},set(u){this.h.position=u}}})),i=Object.assign(new Bn,i),s==-1&&(s=Tr()),i.X=s,Cr[s]=i),Pr={open:i=>{i.m=Sr[i.node.za].m,i.m.open&&i.m.open(i)},ba:()=>{throw new ee(70)}},hi=(i,s)=>{Sr[i]={m:s}},qi=(i,s)=>{var u=s==="/",d=!s;if(u&&Ut)throw new ee(10);if(!u&&!d){var m=Tn(s,{hb:!1});if(s=m.path,m=m.node,m.wa)throw new ee(10);if((m.mode&61440)!==16384)throw new ee(54)}s={type:i,Qc:{},nb:s,kc:[]},i=i.U(s),i.U=s,s.root=i,u?Ut=i:m&&(m.wa=s,m.U&&m.U.kc.push(s))},Nt=(i,s,u)=>{var d=Tn(i,{parent:!0}).node;if(i=F(i),!i||i==="."||i==="..")throw new ee(28);var m=on(d,i);if(m)throw new ee(m);if(!d.l.va)throw new ee(63);return d.l.va(d,i,s,u)},Rr=(i,s,u)=>{typeof u>"u"&&(u=s,s=438),Nt(i,s|8192,u)},Pt=(i,s)=>{if(!ne(i))throw new ee(44);var u=Tn(s,{parent:!0}).node;if(!u)throw new ee(44);s=F(s);var d=on(u,s);if(d)throw new ee(d);if(!u.l.Ea)throw new ee(63);u.l.Ea(u,s,i)},In=i=>{if(i=Tn(i).node,!i)throw new ee(44);if(!i.l.ma)throw new ee(28);return ne(Ui(i.parent),i.l.ma(i))},Pn=(i,s,u)=>{if(i==="")throw new ee(44);if(typeof s=="string"){var d={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[s];if(typeof d>"u")throw Error(`Unknown file open mode: ${s}`);s=d}if(u=s&64?(typeof u>"u"?438:u)&4095|32768:0,typeof i=="object")var m=i;else{i=T(i);try{m=Tn(i,{gb:!(s&131072)}).node}catch{}}if(d=!1,s&64)if(m){if(s&128)throw new ee(20)}else m=Nt(i,u,0),d=!0;if(!m)throw new ee(44);if((m.mode&61440)===8192&&(s&=-513),s&65536&&(m.mode&61440)!==16384)throw new ee(54);if(!d&&(u=m?(m.mode&61440)===40960?32:(m.mode&61440)===16384&&(it(s)!=="r"||s&512)?31:qe(m,it(s)):44))throw new ee(u);if(s&512&&!d){if(u=m,u=typeof u=="string"?Tn(u,{gb:!0}).node:u,!u.l.P)throw new ee(63);if((u.mode&61440)===16384)throw new ee(31);if((u.mode&61440)!==32768)throw new ee(28);if(d=qe(u,"w"))throw new ee(d);u.l.P(u,{size:0,timestamp:Date.now()})}return s&=-131713,m=Ir({node:m,path:Ui(m),flags:s,seekable:!0,position:0,m:m.m,zc:[],error:!1}),m.m.open&&m.m.open(m),!_.logReadFiles||s&1||(rr||(rr={}),i in rr||(rr[i]=1)),m},jr=(i,s,u)=>{if(i.X===null)throw new ee(8);if(!i.seekable||!i.m.ba)throw new ee(70);if(u!=0&&u!=1&&u!=2)throw new ee(28);i.position=i.m.ba(i,s,u),i.zc=[]},tr=()=>{ee||(ee=function(i,s){this.name="ErrnoError",this.node=s,this.pc=function(u){this.aa=u},this.pc(i),this.message="FS error"},ee.prototype=Error(),ee.prototype.constructor=ee,[44].forEach(i=>{ci[i]=new ee(i),ci[i].stack="<generic error, no stack>"}))},an,Kt=(i,s,u)=>{i=T("/dev/"+i);var d=Se(!!s,!!u);nr||(nr=64);var m=nr++<<8|0;hi(m,{open:b=>{b.seekable=!1},close:()=>{u&&u.buffer&&u.buffer.length&&u(10)},read:(b,A,R,x)=>{for(var P=0,W=0;W<x;W++){try{var H=s()}catch{throw new ee(29)}if(H===void 0&&P===0)throw new ee(6);if(H==null)break;P++,A[R+W]=H}return P&&(b.node.timestamp=Date.now()),P},write:(b,A,R,x)=>{for(var P=0;P<x;P++)try{u(A[R+P])}catch{throw new ee(29)}return x&&(b.node.timestamp=Date.now()),P}}),Rr(i,d,m)},nr,Rn={},Bn,rr,ir=void 0;function ln(){return ir+=4,Ee[ir-4>>2]}function Ni(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var s=i.charCodeAt(0);return 48<=s&&57>=s?`_${i}`:i}function Or(i,s){return i=Ni(i),{[i]:function(){return s.apply(this,arguments)}}[i]}function Bi(){this.M=[void 0],this.ib=[]}var Rt=new Bi,Wn=void 0;function ve(i){throw new Wn(i)}var jt=i=>(i||ve("Cannot use deleted val. handle = "+i),Rt.get(i).value),Ot=i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Rt.pa({ub:1,value:i})}};function Wi(i){var s=Error,u=Or(i,function(d){this.name=i,this.message=d,d=Error(d).stack,d!==void 0&&(this.stack=this.toString()+`
`+d.replace(/^Error(:[^\n]*)?\n/,""))});return u.prototype=Object.create(s.prototype),u.prototype.constructor=u,u.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},u}var di=void 0,Vi=void 0;function Ye(i){for(var s="";He[i];)s+=Vi[He[i++]];return s}var sr=[];function Ue(){for(;sr.length;){var i=sr.pop();i.g.fa=!1,i.delete()}}var Xe=void 0,Ne={};function At(i,s){for(s===void 0&&ve("ptr should not be undefined");i.A;)s=i.na(s),i=i.A;return s}var pt={};function gn(i){i=ca(i);var s=Ye(i);return Mn(i),s}function Bt(i,s){var u=pt[i];return u===void 0&&ve(s+" has unknown type "+gn(i)),u}function jn(){}var fi=!1;function vi(i){--i.count.value,i.count.value===0&&(i.G?i.L.W(i.G):i.u.i.W(i.o))}function Ho(i,s,u){return s===u?i:u.A===void 0?null:(i=Ho(i,s,u.A),i===null?null:u.Pb(i))}var zo={};function fu(i,s){return s=At(i,s),Ne[s]}var Go=void 0;function Hi(i){throw new Go(i)}function zi(i,s){return s.u&&s.o||Hi("makeClassHandle requires ptr and ptrType"),!!s.L!=!!s.G&&Hi("Both smartPtrType and smartPtr must be specified"),s.count={value:1},xr(Object.create(i,{g:{value:s}}))}function xr(i){return typeof FinalizationRegistry>"u"?(xr=s=>s,i):(fi=new FinalizationRegistry(s=>{vi(s.g)}),xr=s=>{var u=s.g;return u.G&&fi.register(s,{g:u},s),s},jn=s=>{fi.unregister(s)},xr(i))}var Gi={};function pi(i){for(;i.length;){var s=i.pop();i.pop()(s)}}function gi(i){return this.fromWireType(Ee[i>>2])}var Mr={},Ki={};function Wt(i,s,u){function d(R){R=u(R),R.length!==i.length&&Hi("Mismatched type converter count");for(var x=0;x<i.length;++x)_n(i[x],R[x])}i.forEach(function(R){Ki[R]=s});var m=Array(s.length),b=[],A=0;s.forEach((R,x)=>{pt.hasOwnProperty(R)?m[x]=pt[R]:(b.push(R),Mr.hasOwnProperty(R)||(Mr[R]=[]),Mr[R].push(()=>{m[x]=pt[R],++A,A===b.length&&d(m)}))}),b.length===0&&d(m)}function Yi(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${i}`)}}function vu(i,s,u={}){var d=s.name;if(i||ve(`type "${d}" must have a positive integer typeid pointer`),pt.hasOwnProperty(i)){if(u.$b)return;ve(`Cannot register type '${d}' twice`)}pt[i]=s,delete Ki[i],Mr.hasOwnProperty(i)&&(s=Mr[i],delete Mr[i],s.forEach(m=>m()))}function _n(i,s,u={}){if(!("argPackAdvance"in s))throw new TypeError("registerType registeredInstance requires argPackAdvance");vu(i,s,u)}function Fs(i){ve(i.g.u.i.name+" instance already deleted")}function Vn(){}function Ds(i,s,u){if(i[s].B===void 0){var d=i[s];i[s]=function(){return i[s].B.hasOwnProperty(arguments.length)||ve(`Function '${u}' called with an invalid number of arguments (${arguments.length}) - expects one of (${i[s].B})!`),i[s].B[arguments.length].apply(this,arguments)},i[s].B=[],i[s].B[d.ea]=d}}function Us(i,s,u){_.hasOwnProperty(i)?((u===void 0||_[i].B!==void 0&&_[i].B[u]!==void 0)&&ve(`Cannot register public name '${i}' twice`),Ds(_,i,i),_.hasOwnProperty(u)&&ve(`Cannot register multiple overloads of a function with the same number of arguments (${u})!`),_[i].B[u]=s):(_[i]=s,u!==void 0&&(_[i].Pc=u))}function pu(i,s,u,d,m,b,A,R){this.name=i,this.constructor=s,this.N=u,this.W=d,this.A=m,this.Ub=b,this.na=A,this.Pb=R,this.rb=[]}function Ji(i,s,u){for(;s!==u;)s.na||ve(`Expected null or instance of ${u.name}, got an instance of ${s.name}`),i=s.na(i),s=s.A;return i}function gu(i,s){return s===null?(this.Na&&ve(`null is not a valid ${this.name}`),0):(s.g||ve(`Cannot pass "${Ns(s)}" as a ${this.name}`),s.g.o||ve(`Cannot pass deleted object as a pointer of type ${this.name}`),Ji(s.g.o,s.g.u.i,this.i))}function _u(i,s){if(s===null){if(this.Na&&ve(`null is not a valid ${this.name}`),this.ua){var u=this.Pa();return i!==null&&i.push(this.W,u),u}return 0}if(s.g||ve(`Cannot pass "${Ns(s)}" as a ${this.name}`),s.g.o||ve(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&s.g.u.ta&&ve(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`),u=Ji(s.g.o,s.g.u.i,this.i),this.ua)switch(s.g.G===void 0&&ve("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:s.g.L===this?u=s.g.G:ve(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`);break;case 1:u=s.g.G;break;case 2:if(s.g.L===this)u=s.g.G;else{var d=s.clone();u=this.oc(u,Ot(function(){d.delete()})),i!==null&&i.push(this.W,u)}break;default:ve("Unsupporting sharing policy")}return u}function mu(i,s){return s===null?(this.Na&&ve(`null is not a valid ${this.name}`),0):(s.g||ve(`Cannot pass "${Ns(s)}" as a ${this.name}`),s.g.o||ve(`Cannot pass deleted object as a pointer of type ${this.name}`),s.g.u.ta&&ve(`Cannot convert argument of type ${s.g.u.name} to parameter type ${this.name}`),Ji(s.g.o,s.g.u.i,this.i))}function On(i,s,u,d){this.name=i,this.i=s,this.Na=u,this.ta=d,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,s.A!==void 0?this.toWireType=_u:(this.toWireType=d?gu:mu,this.K=null)}function Ko(i,s,u){_.hasOwnProperty(i)||Hi("Replacing nonexistant public symbol"),_[i].B!==void 0&&u!==void 0?_[i].B[u]=s:(_[i]=s,_[i].ea=u)}var Xi=[],Yo=i=>{var s=Xi[i];return s||(i>=Xi.length&&(Xi.length=i+1),Xi[i]=s=Je.get(i)),s},yu=(i,s)=>{var u=[];return function(){if(u.length=0,Object.assign(u,arguments),i.includes("j")){var d=_["dynCall_"+i];d=u&&u.length?d.apply(null,[s].concat(u)):d.call(null,s)}else d=Yo(s).apply(null,u);return d}};function mt(i,s){i=Ye(i);var u=i.includes("j")?yu(i,s):Yo(s);return typeof u!="function"&&ve(`unknown function pointer with signature ${i}: ${s}`),u}var Jo=void 0;function xn(i,s){function u(b){m[b]||pt[b]||(Ki[b]?Ki[b].forEach(u):(d.push(b),m[b]=!0))}var d=[],m={};throw s.forEach(u),new Jo(`${i}: `+d.map(gn).join([", "]))}function Qi(i,s,u,d,m){var b=s.length;2>b&&ve("argTypes array size mismatch! Must at least get return value and 'this' types!");var A=s[1]!==null&&u!==null,R=!1;for(u=1;u<s.length;++u)if(s[u]!==null&&s[u].K===void 0){R=!0;break}var x=s[0].name!=="void",P=b-2,W=Array(P),H=[],te=[];return function(){if(arguments.length!==P&&ve(`function ${i} called with ${arguments.length} arguments, expected ${P} args!`),te.length=0,H.length=A?2:1,H[0]=m,A){var S=s[1].toWireType(te,this);H[1]=S}for(var B=0;B<P;++B)W[B]=s[B+2].toWireType(te,arguments[B]),H.push(W[B]);if(B=d.apply(null,H),R)pi(te);else for(var q=A?1:2;q<s.length;q++){var ge=q===1?S:W[q-2];s[q].K!==null&&s[q].K(ge)}return S=x?s[0].fromWireType(B):void 0,S}}function Zi(i,s){for(var u=[],d=0;d<i;d++)u.push(Te[s+4*d>>2]);return u}function Xo(i,s,u){return i instanceof Object||ve(`${u} with invalid "this": ${i}`),i instanceof s.i.constructor||ve(`${u} incompatible with "this" of type ${i.constructor.name}`),i.g.o||ve(`cannot call emscripten binding method ${u} on deleted object`),Ji(i.g.o,i.g.u.i,s.i)}function qs(i){i>=Rt.h&&--Rt.get(i).ub===0&&Rt.Zb(i)}function wu(i,s,u){switch(s){case 0:return function(d){return this.fromWireType((u?tt:He)[d])};case 1:return function(d){return this.fromWireType((u?ot:Tt)[d>>1])};case 2:return function(d){return this.fromWireType((u?Ee:Te)[d>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Ns(i){if(i===null)return"null";var s=typeof i;return s==="object"||s==="array"||s==="function"?i.toString():""+i}function bu(i,s){switch(s){case 2:return function(u){return this.fromWireType($t[u>>2])};case 3:return function(u){return this.fromWireType(Me[u>>3])};default:throw new TypeError("Unknown float type: "+i)}}function ku(i,s,u){switch(s){case 0:return u?function(d){return tt[d]}:function(d){return He[d]};case 1:return u?function(d){return ot[d>>1]}:function(d){return Tt[d>>1]};case 2:return u?function(d){return Ee[d>>2]}:function(d){return Te[d>>2]};default:throw new TypeError("Unknown integer type: "+i)}}var Qo=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Eu=(i,s)=>{for(var u=i>>1,d=u+s/2;!(u>=d)&&Tt[u];)++u;if(u<<=1,32<u-i&&Qo)return Qo.decode(He.subarray(i,u));for(u="",d=0;!(d>=s/2);++d){var m=ot[i+2*d>>1];if(m==0)break;u+=String.fromCharCode(m)}return u},Au=(i,s,u)=>{if(u===void 0&&(u=2147483647),2>u)return 0;u-=2;var d=s;u=u<2*i.length?u/2:i.length;for(var m=0;m<u;++m)ot[s>>1]=i.charCodeAt(m),s+=2;return ot[s>>1]=0,s-d},Su=i=>2*i.length,Cu=(i,s)=>{for(var u=0,d="";!(u>=s/4);){var m=Ee[i+4*u>>2];if(m==0)break;++u,65536<=m?(m-=65536,d+=String.fromCharCode(55296|m>>10,56320|m&1023)):d+=String.fromCharCode(m)}return d},Tu=(i,s,u)=>{if(u===void 0&&(u=2147483647),4>u)return 0;var d=s;u=d+u-4;for(var m=0;m<i.length;++m){var b=i.charCodeAt(m);if(55296<=b&&57343>=b){var A=i.charCodeAt(++m);b=65536+((b&1023)<<10)|A&1023}if(Ee[s>>2]=b,s+=4,s+4>u)break}return Ee[s>>2]=0,s-d},Iu=i=>{for(var s=0,u=0;u<i.length;++u){var d=i.charCodeAt(u);55296<=d&&57343>=d&&++u,s+=4}return s},Pu={};function es(i){var s=Pu[i];return s===void 0?Ye(i):s}var ts=[];function Ru(i){var s=ts.length;return ts.push(i),s}function ju(i,s){for(var u=Array(i),d=0;d<i;++d)u[d]=Bt(Te[s+4*d>>2],"parameter "+d);return u}var Zo=[],Bs=[],Ws={},ea=()=>{if(!Vs){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:M||"./this.program"},s;for(s in Ws)Ws[s]===void 0?delete i[s]:i[s]=Ws[s];var u=[];for(s in i)u.push(`${s}=${i[s]}`);Vs=u}return Vs},Vs,ns=i=>i%4===0&&(i%100!==0||i%400===0),ta=[31,29,31,30,31,30,31,31,30,31,30,31],na=[31,28,31,30,31,30,31,31,30,31,30,31],Ou=(i,s,u,d)=>{function m(S,B,q){for(S=typeof S=="number"?S.toString():S||"";S.length<B;)S=q[0]+S;return S}function b(S,B){return m(S,B,"0")}function A(S,B){function q(we){return 0>we?-1:0<we?1:0}var ge;return(ge=q(S.getFullYear()-B.getFullYear()))===0&&(ge=q(S.getMonth()-B.getMonth()))===0&&(ge=q(S.getDate()-B.getDate())),ge}function R(S){switch(S.getDay()){case 0:return new Date(S.getFullYear()-1,11,29);case 1:return S;case 2:return new Date(S.getFullYear(),0,3);case 3:return new Date(S.getFullYear(),0,2);case 4:return new Date(S.getFullYear(),0,1);case 5:return new Date(S.getFullYear()-1,11,31);case 6:return new Date(S.getFullYear()-1,11,30)}}function x(S){var B=S.ca;for(S=new Date(new Date(S.da+1900,0,1).getTime());0<B;){var q=S.getMonth(),ge=(ns(S.getFullYear())?ta:na)[q];if(B>ge-S.getDate())B-=ge-S.getDate()+1,S.setDate(1),11>q?S.setMonth(q+1):(S.setMonth(0),S.setFullYear(S.getFullYear()+1));else{S.setDate(S.getDate()+B);break}}return q=new Date(S.getFullYear()+1,0,4),B=R(new Date(S.getFullYear(),0,4)),q=R(q),0>=A(B,S)?0>=A(q,S)?S.getFullYear()+1:S.getFullYear():S.getFullYear()-1}var P=Ee[d+40>>2];d={wc:Ee[d>>2],vc:Ee[d+4>>2],Fa:Ee[d+8>>2],Sa:Ee[d+12>>2],Ga:Ee[d+16>>2],da:Ee[d+20>>2],R:Ee[d+24>>2],ca:Ee[d+28>>2],Rc:Ee[d+32>>2],uc:Ee[d+36>>2],xc:P&&P?je(He,P):""},u=u?je(He,u):"",P={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var W in P)u=u.replace(new RegExp(W,"g"),P[W]);var H="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),te="January February March April May June July August September October November December".split(" ");P={"%a":S=>H[S.R].substring(0,3),"%A":S=>H[S.R],"%b":S=>te[S.Ga].substring(0,3),"%B":S=>te[S.Ga],"%C":S=>b((S.da+1900)/100|0,2),"%d":S=>b(S.Sa,2),"%e":S=>m(S.Sa,2," "),"%g":S=>x(S).toString().substring(2),"%G":S=>x(S),"%H":S=>b(S.Fa,2),"%I":S=>(S=S.Fa,S==0?S=12:12<S&&(S-=12),b(S,2)),"%j":S=>{for(var B=0,q=0;q<=S.Ga-1;B+=(ns(S.da+1900)?ta:na)[q++]);return b(S.Sa+B,3)},"%m":S=>b(S.Ga+1,2),"%M":S=>b(S.vc,2),"%n":()=>`
`,"%p":S=>0<=S.Fa&&12>S.Fa?"AM":"PM","%S":S=>b(S.wc,2),"%t":()=>"	","%u":S=>S.R||7,"%U":S=>b(Math.floor((S.ca+7-S.R)/7),2),"%V":S=>{var B=Math.floor((S.ca+7-(S.R+6)%7)/7);if(2>=(S.R+371-S.ca-2)%7&&B++,B)B==53&&(q=(S.R+371-S.ca)%7,q==4||q==3&&ns(S.da)||(B=1));else{B=52;var q=(S.R+7-S.ca-1)%7;(q==4||q==5&&ns(S.da%400-1))&&B++}return b(B,2)},"%w":S=>S.R,"%W":S=>b(Math.floor((S.ca+7-(S.R+6)%7)/7),2),"%y":S=>(S.da+1900).toString().substring(2),"%Y":S=>S.da+1900,"%z":S=>{S=S.uc;var B=0<=S;return S=Math.abs(S)/60,(B?"+":"-")+("0000"+(S/60*100+S%60)).slice(-4)},"%Z":S=>S.xc,"%%":()=>"%"},u=u.replace(/%%/g,"\0\0");for(W in P)u.includes(W)&&(u=u.replace(new RegExp(W,"g"),P[W](d)));return u=u.replace(/\0\0/g,"%"),W=Et(u,!1),W.length>s?0:(tt.set(W,i),W.length-1)};function ra(i,s,u,d){i||(i=this),this.parent=i,this.U=i.U,this.wa=null,this.id=Di++,this.name=s,this.mode=u,this.l={},this.m={},this.za=d}Object.defineProperties(ra.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(i){i?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(i){i?this.mode|=146:this.mode&=-147}}}),tr(),er=Array(4096),qi(ue,"/"),Nt("/tmp",16895,0),Nt("/home",16895,0),Nt("/home/web_user",16895,0),(()=>{Nt("/dev",16895,0),hi(259,{read:()=>0,write:(d,m,b,A)=>A}),Rr("/dev/null",259),vt(1280,rn),vt(1536,sn),Rr("/dev/tty",1280),Rr("/dev/tty1",1536);var i=new Uint8Array(1024),s=0,u=()=>(s===0&&(s=de(i).byteLength),i[--s]);Kt("random",u),Kt("urandom",u),Nt("/dev/shm",16895,0),Nt("/dev/shm/tmp",16895,0)})(),(()=>{Nt("/proc",16895,0);var i=Nt("/proc/self",16895,0);Nt("/proc/self/fd",16895,0),qi({U:()=>{var s=ye(i,"fd",16895,73);return s.l={ka:(u,d)=>{var m=qt(+d);return u={parent:null,U:{nb:"fake"},l:{ma:()=>m.path}},u.parent=u}},s}},"/proc/self/fd")})(),Object.assign(Bi.prototype,{get(i){return this.M[i]},has(i){return this.M[i]!==void 0},pa(i){var s=this.ib.pop()||this.M.length;return this.M[s]=i,s},Zb(i){this.M[i]=void 0,this.ib.push(i)}}),Wn=_.BindingError=class extends Error{constructor(i){super(i),this.name="BindingError"}},Rt.M.push({value:void 0},{value:null},{value:!0},{value:!1}),Rt.h=Rt.M.length,_.count_emval_handles=function(){for(var i=0,s=Rt.h;s<Rt.M.length;++s)Rt.M[s]!==void 0&&++i;return i},di=_.PureVirtualError=Wi("PureVirtualError");for(var ia=Array(256),rs=0;256>rs;++rs)ia[rs]=String.fromCharCode(rs);Vi=ia,_.getInheritedInstanceCount=function(){return Object.keys(Ne).length},_.getLiveInheritedInstances=function(){var i=[],s;for(s in Ne)Ne.hasOwnProperty(s)&&i.push(Ne[s]);return i},_.flushPendingDeletes=Ue,_.setDelayFunction=function(i){Xe=i,sr.length&&Xe&&Xe(Ue)},Go=_.InternalError=class extends Error{constructor(i){super(i),this.name="InternalError"}},Vn.prototype.isAliasOf=function(i){if(!(this instanceof Vn&&i instanceof Vn))return!1;var s=this.g.u.i,u=this.g.o,d=i.g.u.i;for(i=i.g.o;s.A;)u=s.na(u),s=s.A;for(;d.A;)i=d.na(i),d=d.A;return s===d&&u===i},Vn.prototype.clone=function(){if(this.g.o||Fs(this),this.g.ia)return this.g.count.value+=1,this;var i=xr,s=Object,u=s.create,d=Object.getPrototypeOf(this),m=this.g;return i=i(u.call(s,d,{g:{value:{count:m.count,fa:m.fa,ia:m.ia,o:m.o,u:m.u,G:m.G,L:m.L}}})),i.g.count.value+=1,i.g.fa=!1,i},Vn.prototype.delete=function(){this.g.o||Fs(this),this.g.fa&&!this.g.ia&&ve("Object already scheduled for deletion"),jn(this),vi(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},Vn.prototype.isDeleted=function(){return!this.g.o},Vn.prototype.deleteLater=function(){return this.g.o||Fs(this),this.g.fa&&!this.g.ia&&ve("Object already scheduled for deletion"),sr.push(this),sr.length===1&&Xe&&Xe(Ue),this.g.fa=!0,this},On.prototype.Vb=function(i){return this.sb&&(i=this.sb(i)),i},On.prototype.bb=function(i){this.W&&this.W(i)},On.prototype.argPackAdvance=8,On.prototype.readValueFromPointer=gi,On.prototype.deleteObject=function(i){i!==null&&i.delete()},On.prototype.fromWireType=function(i){function s(){return this.ua?zi(this.i.N,{u:this.nc,o:u,L:this,G:i}):zi(this.i.N,{u:this,o:i})}var u=this.Vb(i);if(!u)return this.bb(i),null;var d=fu(this.i,u);if(d!==void 0)return d.g.count.value===0?(d.g.o=u,d.g.G=i,d.clone()):(d=d.clone(),this.bb(i),d);if(d=this.i.Ub(u),d=zo[d],!d)return s.call(this);d=this.ta?d.Kb:d.pointerType;var m=Ho(u,this.i,d.i);return m===null?s.call(this):this.ua?zi(d.i.N,{u:d,o:m,L:this,G:i}):zi(d.i.N,{u:d,o:m})},Jo=_.UnboundTypeError=Wi("UnboundTypeError");var sa={__syscall_fcntl64:function(i,s,u){ir=u;try{var d=qt(i);switch(s){case 0:var m=ln();return 0>m?-28:Ir(d,m).X;case 1:case 2:return 0;case 3:return d.flags;case 4:return m=ln(),d.flags|=m,0;case 5:return m=ln(),ot[m+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Ee[oa()>>2]=28,-1;default:return-28}}catch(b){if(typeof Rn>"u"||b.name!=="ErrnoError")throw b;return-b.aa}},__syscall_ioctl:function(i,s,u){ir=u;try{var d=qt(i);switch(s){case 21509:return d.s?0:-59;case 21505:if(!d.s)return-59;if(d.s.V.bc){s=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var m=ln();Ee[m>>2]=25856,Ee[m+4>>2]=5,Ee[m+8>>2]=191,Ee[m+12>>2]=35387;for(var b=0;32>b;b++)tt[m+b+17>>0]=s[b]||0}return 0;case 21510:case 21511:case 21512:return d.s?0:-59;case 21506:case 21507:case 21508:if(!d.s)return-59;if(d.s.V.cc)for(m=ln(),s=[],b=0;32>b;b++)s.push(tt[m+b+17>>0]);return 0;case 21519:return d.s?(m=ln(),Ee[m>>2]=0):-59;case 21520:return d.s?-28:-59;case 21531:if(m=ln(),!d.m.ac)throw new ee(59);return d.m.ac(d,s,m);case 21523:return d.s?(d.s.V.dc&&(b=[24,80],m=ln(),ot[m>>1]=b[0],ot[m+2>>1]=b[1]),0):-59;case 21524:return d.s?0:-59;case 21515:return d.s?0:-59;default:return-28}}catch(A){if(typeof Rn>"u"||A.name!=="ErrnoError")throw A;return-A.aa}},__syscall_openat:function(i,s,u,d){ir=d;try{s=s?je(He,s):"";var m=s;if(m.charAt(0)==="/")s=m;else{var b=i===-100?"/":qt(i).path;if(m.length==0)throw new ee(44);s=T(b+"/"+m)}var A=d?ln():0;return Pn(s,u,A).X}catch(R){if(typeof Rn>"u"||R.name!=="ErrnoError")throw R;return-R.aa}},_embind_create_inheriting_constructor:function(i,s,u){i=Ye(i),s=Bt(s,"wrapper"),u=jt(u);var d=[].slice,m=s.i,b=m.N,A=m.A.N,R=m.A.constructor;i=Or(i,function(){m.A.rb.forEach((function(P){if(this[P]===A[P])throw new di(`Pure virtual function ${P} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:b}),this.__construct.apply(this,d.call(arguments))}),b.__construct=function(){this===b&&ve("Pass correct 'this' to __construct");var P=R.implement.apply(void 0,[this].concat(d.call(arguments)));jn(P);var W=P.g;P.notifyOnDestruction(),W.ia=!0,Object.defineProperties(this,{g:{value:W}}),xr(this),P=W.o,P=At(m,P),Ne.hasOwnProperty(P)?ve(`Tried to register registered instance: ${P}`):Ne[P]=this},b.__destruct=function(){this===b&&ve("Pass correct 'this' to __destruct"),jn(this);var P=this.g.o;P=At(m,P),Ne.hasOwnProperty(P)?delete Ne[P]:ve(`Tried to unregister unregistered instance: ${P}`)},i.prototype=Object.create(b);for(var x in u)i.prototype[x]=u[x];return Ot(i)},_embind_finalize_value_object:function(i){var s=Gi[i];delete Gi[i];var u=s.Pa,d=s.W,m=s.fb,b=m.map(A=>A.Yb).concat(m.map(A=>A.rc));Wt([i],b,A=>{var R={};return m.forEach((x,P)=>{var W=A[P],H=x.Wb,te=x.Xb,S=A[P+m.length],B=x.qc,q=x.sc;R[x.Sb]={read:ge=>W.fromWireType(H(te,ge)),write:(ge,we)=>{var Y=[];B(q,ge,S.toWireType(Y,we)),pi(Y)}}}),[{name:s.name,fromWireType:function(x){var P={},W;for(W in R)P[W]=R[W].read(x);return d(x),P},toWireType:function(x,P){for(var W in R)if(!(W in P))throw new TypeError(`Missing field: "${W}"`);var H=u();for(W in R)R[W].write(H,P[W]);return x!==null&&x.push(d,H),H},argPackAdvance:8,readValueFromPointer:gi,K:d}]})},_embind_register_bigint:function(){},_embind_register_bool:function(i,s,u,d,m){var b=Yi(u);s=Ye(s),_n(i,{name:s,fromWireType:function(A){return!!A},toWireType:function(A,R){return R?d:m},argPackAdvance:8,readValueFromPointer:function(A){if(u===1)var R=tt;else if(u===2)R=ot;else if(u===4)R=Ee;else throw new TypeError("Unknown boolean type size: "+s);return this.fromWireType(R[A>>b])},K:null})},_embind_register_class:function(i,s,u,d,m,b,A,R,x,P,W,H,te){W=Ye(W),b=mt(m,b),R&&(R=mt(A,R)),P&&(P=mt(x,P)),te=mt(H,te);var S=Ni(W);Us(S,function(){xn(`Cannot construct ${W} due to unbound types`,[d])}),Wt([i,s,u],d?[d]:[],function(B){if(B=B[0],d)var q=B.i,ge=q.N;else ge=Vn.prototype;B=Or(S,function(){if(Object.getPrototypeOf(this)!==we)throw new Wn("Use 'new' to construct "+W);if(Y.$===void 0)throw new Wn(W+" has no accessible constructor");var gt=Y.$[arguments.length];if(gt===void 0)throw new Wn(`Tried to invoke ctor of ${W} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(Y.$).toString()}) parameters instead!`);return gt.apply(this,arguments)});var we=Object.create(ge,{constructor:{value:B}});B.prototype=we;var Y=new pu(W,B,we,te,q,b,R,P);Y.A&&(Y.A.oa===void 0&&(Y.A.oa=[]),Y.A.oa.push(Y)),q=new On(W,Y,!0,!1),ge=new On(W+"*",Y,!1,!1);var ze=new On(W+" const*",Y,!1,!0);return zo[i]={pointerType:ge,Kb:ze},Ko(S,B),[q,ge,ze]})},_embind_register_class_class_function:function(i,s,u,d,m,b,A){var R=Zi(u,d);s=Ye(s),b=mt(m,b),Wt([],[i],function(x){function P(){xn(`Cannot call ${W} due to unbound types`,R)}x=x[0];var W=`${x.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]);var H=x.i.constructor;return H[s]===void 0?(P.ea=u-1,H[s]=P):(Ds(H,s,W),H[s].B[u-1]=P),Wt([],R,function(te){if(te=Qi(W,[te[0],null].concat(te.slice(1)),null,b,A),H[s].B===void 0?(te.ea=u-1,H[s]=te):H[s].B[u-1]=te,x.i.oa)for(const S of x.i.oa)S.constructor.hasOwnProperty(s)||(S.constructor[s]=te);return[]}),[]})},_embind_register_class_class_property:function(i,s,u,d,m,b,A,R){s=Ye(s),b=mt(m,b),Wt([],[i],function(x){x=x[0];var P=`${x.name}.${s}`,W={get(){xn(`Cannot access ${P} due to unbound types`,[u])},enumerable:!0,configurable:!0};return W.set=R?()=>{xn(`Cannot access ${P} due to unbound types`,[u])}:()=>{ve(`${P} is a read-only property`)},Object.defineProperty(x.i.constructor,s,W),Wt([],[u],function(H){H=H[0];var te={get(){return H.fromWireType(b(d))},enumerable:!0};return R&&(R=mt(A,R),te.set=S=>{var B=[];R(d,H.toWireType(B,S)),pi(B)}),Object.defineProperty(x.i.constructor,s,te),[]}),[]})},_embind_register_class_constructor:function(i,s,u,d,m,b){var A=Zi(s,u);m=mt(d,m),Wt([],[i],function(R){R=R[0];var x=`constructor ${R.name}`;if(R.i.$===void 0&&(R.i.$=[]),R.i.$[s-1]!==void 0)throw new Wn(`Cannot register multiple constructors with identical number of parameters (${s-1}) for class '${R.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return R.i.$[s-1]=()=>{xn(`Cannot construct ${R.name} due to unbound types`,A)},Wt([],A,function(P){return P.splice(1,0,null),R.i.$[s-1]=Qi(x,P,null,m,b),[]}),[]})},_embind_register_class_function:function(i,s,u,d,m,b,A,R){var x=Zi(u,d);s=Ye(s),b=mt(m,b),Wt([],[i],function(P){function W(){xn(`Cannot call ${H} due to unbound types`,x)}P=P[0];var H=`${P.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),R&&P.i.rb.push(s);var te=P.i.N,S=te[s];return S===void 0||S.B===void 0&&S.className!==P.name&&S.ea===u-2?(W.ea=u-2,W.className=P.name,te[s]=W):(Ds(te,s,H),te[s].B[u-2]=W),Wt([],x,function(B){return B=Qi(H,B,P,b,A),te[s].B===void 0?(B.ea=u-2,te[s]=B):te[s].B[u-2]=B,[]}),[]})},_embind_register_class_property:function(i,s,u,d,m,b,A,R,x,P){s=Ye(s),m=mt(d,m),Wt([],[i],function(W){W=W[0];var H=`${W.name}.${s}`,te={get(){xn(`Cannot access ${H} due to unbound types`,[u,A])},enumerable:!0,configurable:!0};return te.set=x?()=>{xn(`Cannot access ${H} due to unbound types`,[u,A])}:()=>{ve(H+" is a read-only property")},Object.defineProperty(W.i.N,s,te),Wt([],x?[u,A]:[u],function(S){var B=S[0],q={get(){var we=Xo(this,W,H+" getter");return B.fromWireType(m(b,we))},enumerable:!0};if(x){x=mt(R,x);var ge=S[1];q.set=function(we){var Y=Xo(this,W,H+" setter"),ze=[];x(P,Y,ge.toWireType(ze,we)),pi(ze)}}return Object.defineProperty(W.i.N,s,q),[]}),[]})},_embind_register_emval:function(i,s){s=Ye(s),_n(i,{name:s,fromWireType:function(u){var d=jt(u);return qs(u),d},toWireType:function(u,d){return Ot(d)},argPackAdvance:8,readValueFromPointer:gi,K:null})},_embind_register_enum:function(i,s,u,d){function m(){}u=Yi(u),s=Ye(s),m.values={},_n(i,{name:s,constructor:m,fromWireType:function(b){return this.constructor.values[b]},toWireType:function(b,A){return A.value},argPackAdvance:8,readValueFromPointer:wu(s,u,d),K:null}),Us(s,m)},_embind_register_enum_value:function(i,s,u){var d=Bt(i,"enum");s=Ye(s),i=d.constructor,d=Object.create(d.constructor.prototype,{value:{value:u},constructor:{value:Or(`${d.name}_${s}`,function(){})}}),i.values[u]=d,i[s]=d},_embind_register_float:function(i,s,u){u=Yi(u),s=Ye(s),_n(i,{name:s,fromWireType:function(d){return d},toWireType:function(d,m){return m},argPackAdvance:8,readValueFromPointer:bu(s,u),K:null})},_embind_register_function:function(i,s,u,d,m,b){var A=Zi(s,u);i=Ye(i),m=mt(d,m),Us(i,function(){xn(`Cannot call ${i} due to unbound types`,A)},s-1),Wt([],A,function(R){return Ko(i,Qi(i,[R[0],null].concat(R.slice(1)),null,m,b),s-1),[]})},_embind_register_integer:function(i,s,u,d,m){s=Ye(s),m===-1&&(m=4294967295),m=Yi(u);var b=R=>R;if(d===0){var A=32-8*u;b=R=>R<<A>>>A}u=s.includes("unsigned")?function(R,x){return x>>>0}:function(R,x){return x},_n(i,{name:s,fromWireType:b,toWireType:u,argPackAdvance:8,readValueFromPointer:ku(s,m,d!==0),K:null})},_embind_register_memory_view:function(i,s,u){function d(b){b>>=2;var A=Te;return new m(A.buffer,A[b+1],A[b])}var m=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][s];u=Ye(u),_n(i,{name:u,fromWireType:d,argPackAdvance:8,readValueFromPointer:d},{$b:!0})},_embind_register_std_string:function(i,s){s=Ye(s);var u=s==="std::string";_n(i,{name:s,fromWireType:function(d){var m=Te[d>>2],b=d+4;if(u)for(var A=b,R=0;R<=m;++R){var x=b+R;if(R==m||He[x]==0){if(A=A?je(He,A,x-A):"",P===void 0)var P=A;else P+="\0",P+=A;A=x+1}}else{for(P=Array(m),R=0;R<m;++R)P[R]=String.fromCharCode(He[b+R]);P=P.join("")}return Mn(d),P},toWireType:function(d,m){m instanceof ArrayBuffer&&(m=new Uint8Array(m));var b=typeof m=="string";b||m instanceof Uint8Array||m instanceof Uint8ClampedArray||m instanceof Int8Array||ve("Cannot pass non-string to std::string");var A=u&&b?Be(m):m.length,R=Hs(4+A+1),x=R+4;if(Te[R>>2]=A,u&&b)Dt(m,He,x,A+1);else if(b)for(b=0;b<A;++b){var P=m.charCodeAt(b);255<P&&(Mn(x),ve("String has UTF-16 code units that do not fit in 8 bits")),He[x+b]=P}else for(b=0;b<A;++b)He[x+b]=m[b];return d!==null&&d.push(Mn,R),R},argPackAdvance:8,readValueFromPointer:gi,K:function(d){Mn(d)}})},_embind_register_std_wstring:function(i,s,u){if(u=Ye(u),s===2)var d=Eu,m=Au,b=Su,A=()=>Tt,R=1;else s===4&&(d=Cu,m=Tu,b=Iu,A=()=>Te,R=2);_n(i,{name:u,fromWireType:function(x){for(var P=Te[x>>2],W=A(),H,te=x+4,S=0;S<=P;++S){var B=x+4+S*s;(S==P||W[B>>R]==0)&&(te=d(te,B-te),H===void 0?H=te:(H+="\0",H+=te),te=B+s)}return Mn(x),H},toWireType:function(x,P){typeof P!="string"&&ve(`Cannot pass non-string to C++ string type ${u}`);var W=b(P),H=Hs(4+W+s);return Te[H>>2]=W>>R,m(P,H+4,W+s),x!==null&&x.push(Mn,H),H},argPackAdvance:8,readValueFromPointer:gi,K:function(x){Mn(x)}})},_embind_register_value_object:function(i,s,u,d,m,b){Gi[i]={name:Ye(s),Pa:mt(u,d),W:mt(m,b),fb:[]}},_embind_register_value_object_field:function(i,s,u,d,m,b,A,R,x,P){Gi[i].fb.push({Sb:Ye(s),Yb:u,Wb:mt(d,m),Xb:b,rc:A,qc:mt(R,x),sc:P})},_embind_register_void:function(i,s){s=Ye(s),_n(i,{fc:!0,name:s,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(i,s,u){i=jt(i),s=Bt(s,"emval::as");var d=[],m=Ot(d);return Te[u>>2]=m,s.toWireType(d,i)},_emval_call_method:function(i,s,u,d,m){i=ts[i],s=jt(s),u=es(u);var b=[];return Te[d>>2]=Ot(b),i(s,u,b,m)},_emval_call_void_method:function(i,s,u,d){i=ts[i],s=jt(s),u=es(u),i(s,u,null,d)},_emval_decref:qs,_emval_get_method_caller:function(i,s){var u=ju(i,s),d=u[0];s=d.name+"_$"+u.slice(1).map(function(A){return A.name}).join("_")+"$";var m=Zo[s];if(m!==void 0)return m;var b=Array(i-1);return m=Ru((A,R,x,P)=>{for(var W=0,H=0;H<i-1;++H)b[H]=u[H+1].readValueFromPointer(P+W),W+=u[H+1].argPackAdvance;for(A=A[R].apply(A,b),H=0;H<i-1;++H)u[H+1].Nb&&u[H+1].Nb(b[H]);if(!d.fc)return d.toWireType(x,A)}),Zo[s]=m},_emval_get_module_property:function(i){return i=es(i),Ot(_[i])},_emval_get_property:function(i,s){return i=jt(i),s=jt(s),Ot(i[s])},_emval_incref:function(i){4<i&&(Rt.get(i).ub+=1)},_emval_new_array:function(){return Ot([])},_emval_new_cstring:function(i){return Ot(es(i))},_emval_new_object:function(){return Ot({})},_emval_run_destructors:function(i){var s=jt(i);pi(s),qs(i)},_emval_set_property:function(i,s,u){i=jt(i),s=jt(s),u=jt(u),i[s]=u},_emval_take_value:function(i,s){return i=Bt(i,"_emval_take_value"),i=i.readValueFromPointer(s),Ot(i)},abort:()=>{pn("")},emscripten_asm_const_int:(i,s,u)=>{Bs.length=0;var d;for(u>>=2;d=He[s++];)u+=d!=105&u,Bs.push(d==105?Ee[u]:Me[u++>>1]),++u;return a[i].apply(null,Bs)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(i,s,u)=>He.copyWithin(i,s,s+u),emscripten_resize_heap:i=>{var s=He.length;if(i>>>=0,2147483648<i)return!1;for(var u=1;4>=u;u*=2){var d=s*(1+.2/u);d=Math.min(d,i+100663296);var m=Math;d=Math.max(i,d);e:{m=m.min.call(m,2147483648,d+(65536-d%65536)%65536)-wt.buffer.byteLength+65535>>>16;try{wt.grow(m),bt();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},environ_get:(i,s)=>{var u=0;return ea().forEach(function(d,m){var b=s+u;for(m=Te[i+4*m>>2]=b,b=0;b<d.length;++b)tt[m++>>0]=d.charCodeAt(b);tt[m>>0]=0,u+=d.length+1}),0},environ_sizes_get:(i,s)=>{var u=ea();Te[i>>2]=u.length;var d=0;return u.forEach(function(m){d+=m.length+1}),Te[s>>2]=d,0},fd_close:function(i){try{var s=qt(i);if(s.X===null)throw new ee(8);s.Ma&&(s.Ma=null);try{s.m.close&&s.m.close(s)}catch(u){throw u}finally{Cr[s.X]=null}return s.X=null,0}catch(u){if(typeof Rn>"u"||u.name!=="ErrnoError")throw u;return u.aa}},fd_read:function(i,s,u,d){try{e:{var m=qt(i);i=s;for(var b,A=s=0;A<u;A++){var R=Te[i>>2],x=Te[i+4>>2];i+=8;var P=m,W=R,H=x,te=b,S=tt;if(0>H||0>te)throw new ee(28);if(P.X===null)throw new ee(8);if((P.flags&2097155)===1)throw new ee(8);if((P.node.mode&61440)===16384)throw new ee(31);if(!P.m.read)throw new ee(28);var B=typeof te<"u";if(!B)te=P.position;else if(!P.seekable)throw new ee(70);var q=P.m.read(P,S,W,H,te);B||(P.position+=q);var ge=q;if(0>ge){var we=-1;break e}if(s+=ge,ge<x)break;typeof b<"u"&&(b+=ge)}we=s}return Te[d>>2]=we,0}catch(Y){if(typeof Rn>"u"||Y.name!=="ErrnoError")throw Y;return Y.aa}},fd_seek:function(i,s,u,d,m){s=u+2097152>>>0<4194305-!!s?(s>>>0)+4294967296*u:NaN;try{if(isNaN(s))return 61;var b=qt(i);return jr(b,s,d),v=[b.position>>>0,(re=b.position,1<=+Math.abs(re)?0<re?+Math.floor(re/4294967296)>>>0:~~+Math.ceil((re-+(~~re>>>0))/4294967296)>>>0:0)],Ee[m>>2]=v[0],Ee[m+4>>2]=v[1],b.Ma&&s===0&&d===0&&(b.Ma=null),0}catch(A){if(typeof Rn>"u"||A.name!=="ErrnoError")throw A;return A.aa}},fd_write:function(i,s,u,d){try{e:{var m=qt(i);i=s;for(var b,A=s=0;A<u;A++){var R=Te[i>>2],x=Te[i+4>>2];i+=8;var P=m,W=R,H=x,te=b,S=tt;if(0>H||0>te)throw new ee(28);if(P.X===null)throw new ee(8);if((P.flags&2097155)===0)throw new ee(8);if((P.node.mode&61440)===16384)throw new ee(31);if(!P.m.write)throw new ee(28);P.seekable&&P.flags&1024&&jr(P,0,2);var B=typeof te<"u";if(!B)te=P.position;else if(!P.seekable)throw new ee(70);var q=P.m.write(P,S,W,H,te,void 0);B||(P.position+=q);var ge=q;if(0>ge){var we=-1;break e}s+=ge,typeof b<"u"&&(b+=ge)}we=s}return Te[d>>2]=we,0}catch(Y){if(typeof Rn>"u"||Y.name!=="ErrnoError")throw Y;return Y.aa}},strftime_l:(i,s,u,d)=>Ou(i,s,u,d)};(function(){function i(u){if(ke=u=u.exports,wt=ke.memory,bt(),Je=ke.__indirect_function_table,vn.unshift(ke.__wasm_call_ctors),_t--,_.monitorRunDependencies&&_.monitorRunDependencies(_t),_t==0&&Ft){var d=Ft;Ft=null,d()}return u}var s={env:sa,wasi_snapshot_preview1:sa};if(_t++,_.monitorRunDependencies&&_.monitorRunDependencies(_t),_.instantiateWasm)try{return _.instantiateWasm(s,i)}catch(u){Ke("Module.instantiateWasm callback failed with error: "+u),L(u)}return J(s,function(u){i(u.instance)}).catch(L),{}})();var Mn=i=>(Mn=ke.free)(i),Hs=i=>(Hs=ke.malloc)(i),oa=()=>(oa=ke.__errno_location)(),aa=_._ma_device__on_notification_unlocked=i=>(aa=_._ma_device__on_notification_unlocked=ke.ma_device__on_notification_unlocked)(i);_._ma_malloc_emscripten=(i,s)=>(_._ma_malloc_emscripten=ke.ma_malloc_emscripten)(i,s),_._ma_free_emscripten=(i,s)=>(_._ma_free_emscripten=ke.ma_free_emscripten)(i,s);var la=_._ma_device_process_pcm_frames_capture__webaudio=(i,s,u)=>(la=_._ma_device_process_pcm_frames_capture__webaudio=ke.ma_device_process_pcm_frames_capture__webaudio)(i,s,u),ua=_._ma_device_process_pcm_frames_playback__webaudio=(i,s,u)=>(ua=_._ma_device_process_pcm_frames_playback__webaudio=ke.ma_device_process_pcm_frames_playback__webaudio)(i,s,u),ca=i=>(ca=ke.__getTypeName)(i);_.__embind_initialize_bindings=()=>(_.__embind_initialize_bindings=ke._embind_initialize_bindings)(),_.dynCall_iiji=(i,s,u,d,m)=>(_.dynCall_iiji=ke.dynCall_iiji)(i,s,u,d,m),_.dynCall_jiji=(i,s,u,d,m)=>(_.dynCall_jiji=ke.dynCall_jiji)(i,s,u,d,m),_.dynCall_iiiji=(i,s,u,d,m,b)=>(_.dynCall_iiiji=ke.dynCall_iiiji)(i,s,u,d,m,b),_.dynCall_iij=(i,s,u,d)=>(_.dynCall_iij=ke.dynCall_iij)(i,s,u,d),_.dynCall_jii=(i,s,u)=>(_.dynCall_jii=ke.dynCall_jii)(i,s,u),_.dynCall_viijii=(i,s,u,d,m,b,A)=>(_.dynCall_viijii=ke.dynCall_viijii)(i,s,u,d,m,b,A),_.dynCall_iiiiij=(i,s,u,d,m,b,A)=>(_.dynCall_iiiiij=ke.dynCall_iiiiij)(i,s,u,d,m,b,A),_.dynCall_iiiiijj=(i,s,u,d,m,b,A,R,x)=>(_.dynCall_iiiiijj=ke.dynCall_iiiiijj)(i,s,u,d,m,b,A,R,x),_.dynCall_iiiiiijj=(i,s,u,d,m,b,A,R,x,P)=>(_.dynCall_iiiiiijj=ke.dynCall_iiiiiijj)(i,s,u,d,m,b,A,R,x,P);var is;Ft=function i(){is||ha(),is||(Ft=i)};function ha(){function i(){if(!is&&(is=!0,_.calledRun=!0,!en)){if(_.noFSInit||an||(an=!0,tr(),_.stdin=_.stdin,_.stdout=_.stdout,_.stderr=_.stderr,_.stdin?Kt("stdin",_.stdin):Pt("/dev/tty","/dev/stdin"),_.stdout?Kt("stdout",null,_.stdout):Pt("/dev/tty","/dev/stdout"),_.stderr?Kt("stderr",null,_.stderr):Pt("/dev/tty1","/dev/stderr"),Pn("/dev/stdin",0),Pn("/dev/stdout",1),Pn("/dev/stderr",1)),ui=!1,h(vn),I(_),_.onRuntimeInitialized&&_.onRuntimeInitialized(),_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;){var s=_.postRun.shift();zt.unshift(s)}h(zt)}}if(!(0<_t)){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)Cn();h(tn),0<_t||(_.setStatus?(_.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_.setStatus("")},1),i()},1)):i())}}if(_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);0<_.preInit.length;)_.preInit.pop()();return ha(),E.ready})})();const y=g}),(c=>{c.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((c,f,p)=>{p.r(f),p.d(f,{Animation:()=>g.Animation});var g=p(4)}),((c,f,p)=>{p.r(f),p.d(f,{Animation:()=>g});var g=(function(){function y(k,E,_,I){this.animation=k,this.artboard=E,this.playing=I,this.loopCount=0,this.scrubTo=null,this.instance=new _.LinearAnimationInstance(k,E)}return Object.defineProperty(y.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"time",{get:function(){return this.instance.time},set:function(k){this.instance.time=k},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),y.prototype.advance=function(k){this.scrubTo===null?this.instance.advance(k):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},y.prototype.apply=function(k){this.instance.apply(k)},y.prototype.cleanup=function(){this.instance.delete()},y})()}),((c,f,p)=>{p.r(f),p.d(f,{AudioAssetWrapper:()=>k.AudioAssetWrapper,AudioWrapper:()=>k.AudioWrapper,BLANK_URL:()=>y.BLANK_URL,CustomFileAssetLoaderWrapper:()=>k.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>k.FileAssetWrapper,Finalizable:()=>k.Finalizable,FontAssetWrapper:()=>k.FontAssetWrapper,FontWrapper:()=>k.FontWrapper,ImageAssetWrapper:()=>k.ImageAssetWrapper,ImageWrapper:()=>k.ImageWrapper,finalizationRegistry:()=>k.finalizationRegistry,registerTouchInteractions:()=>g.registerTouchInteractions,sanitizeUrl:()=>y.sanitizeUrl});var g=p(6),y=p(7),k=p(8)}),((c,f,p)=>{p.r(f),p.d(f,{registerTouchInteractions:()=>k});var g=void 0,y=function(E,_){var I,L;return["touchstart","touchmove"].indexOf(E.type)>-1&&(!((I=E.touches)===null||I===void 0)&&I.length)?(_||E.preventDefault(),{clientX:E.touches[0].clientX,clientY:E.touches[0].clientY}):E.type==="touchend"&&(!((L=E.changedTouches)===null||L===void 0)&&L.length)?{clientX:E.changedTouches[0].clientX,clientY:E.changedTouches[0].clientY}:{clientX:E.clientX,clientY:E.clientY}},k=function(E){var _=E.canvas,I=E.artboard,L=E.stateMachines,$=L===void 0?[]:L,z=E.renderer,U=E.rive,N=E.fit,G=E.alignment,K=E.isTouchScrollEnabled,j=K===void 0?!1:K,M=E.layoutScaleFactor,oe=M===void 0?1:M;if(!_||!$.length||!z||!U||!I||typeof window>"u")return null;var le=null,ce=!1,Q=function(De){if(ce&&De instanceof MouseEvent){De.type=="mouseup"&&(ce=!1);return}ce=j&&De.type==="touchend"&&le==="touchstart",le=De.type;var Ke=De.currentTarget.getBoundingClientRect(),Ve=y(De,j),wt=Ve.clientX,ke=Ve.clientY;if(!(!wt&&!ke)){var en=wt-Ke.left,tt=ke-Ke.top,He=U.computeAlignment(N,G,{minX:0,minY:0,maxX:Ke.width,maxY:Ke.height},I.bounds,oe),ot=new U.Mat2D;He.invert(ot);var Tt=new U.Vec2D(en,tt),Ee=U.mapXY(ot,Tt),Te=Ee.x(),$t=Ee.y();switch(Ee.delete(),ot.delete(),Tt.delete(),He.delete(),De.type){case"mouseout":for(var Me=0,bt=$;Me<bt.length;Me++){var Je=bt[Me];Je.pointerMove(Te,$t)}break;case"touchmove":case"mouseover":case"mousemove":{for(var tn=0,vn=$;tn<vn.length;tn++){var Je=vn[tn];Je.pointerMove(Te,$t)}break}case"touchstart":case"mousedown":{for(var zt=0,Cn=$;zt<Cn.length;zt++){var Je=Cn[zt];Je.pointerDown(Te,$t)}break}case"touchend":case"mouseup":{for(var _t=0,Ft=$;_t<Ft.length;_t++){var Je=Ft[_t];Je.pointerUp(Te,$t)}break}}}},he=Q.bind(g);return _.addEventListener("mouseover",he),_.addEventListener("mouseout",he),_.addEventListener("mousemove",he),_.addEventListener("mousedown",he),_.addEventListener("mouseup",he),_.addEventListener("touchmove",he,{passive:j}),_.addEventListener("touchstart",he,{passive:j}),_.addEventListener("touchend",he),function(){_.removeEventListener("mouseover",he),_.removeEventListener("mouseout",he),_.removeEventListener("mousemove",he),_.removeEventListener("mousedown",he),_.removeEventListener("mouseup",he),_.removeEventListener("touchmove",he),_.removeEventListener("touchstart",he),_.removeEventListener("touchend",he)}}}),((c,f,p)=>{p.r(f),p.d(f,{BLANK_URL:()=>L,sanitizeUrl:()=>U});var g=/^([^\w]*)(javascript|data|vbscript)/im,y=/&#(\w+)(^\w|;)?/g,k=/&(newline|tab);/gi,E=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,_=/^.+(:|&colon;)/gim,I=[".","/"],L="about:blank";function $(N){return I.indexOf(N[0])>-1}function z(N){var G=N.replace(E,"");return G.replace(y,function(K,j){return String.fromCharCode(j)})}function U(N){if(!N)return L;var G=z(N).replace(k,"").replace(E,"").trim();if(!G)return L;if($(G))return G;var K=G.match(_);if(!K)return G;var j=K[0];return g.test(j)?L:G}}),((c,f,p)=>{p.r(f),p.d(f,{AudioAssetWrapper:()=>z,AudioWrapper:()=>E,CustomFileAssetLoaderWrapper:()=>I,FileAssetWrapper:()=>L,Finalizable:()=>y,FontAssetWrapper:()=>U,FontWrapper:()=>_,ImageAssetWrapper:()=>$,ImageWrapper:()=>k,finalizationRegistry:()=>K});var g=(function(){var j=function(M,oe){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(le,ce){le.__proto__=ce}||function(le,ce){for(var Q in ce)Object.prototype.hasOwnProperty.call(ce,Q)&&(le[Q]=ce[Q])},j(M,oe)};return function(M,oe){if(typeof oe!="function"&&oe!==null)throw new TypeError("Class extends value "+String(oe)+" is not a constructor or null");j(M,oe);function le(){this.constructor=M}M.prototype=oe===null?Object.create(oe):(le.prototype=oe.prototype,new le)}})(),y=(function(){function j(){this.selfUnref=!1}return j})(),k=(function(j){g(M,j);function M(oe){var le=j.call(this)||this;return le._nativeImage=oe,le}return Object.defineProperty(M.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),M.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},M})(y),E=(function(j){g(M,j);function M(oe){var le=j.call(this)||this;return le._nativeAudio=oe,le}return Object.defineProperty(M.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),M.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},M})(y),_=(function(j){g(M,j);function M(oe){var le=j.call(this)||this;return le._nativeFont=oe,le}return Object.defineProperty(M.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),M.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},M})(y),I=(function(){function j(M,oe){this._assetLoaderCallback=oe,this.assetLoader=new M.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return j.prototype.loadContents=function(M,oe){var le;return M.isImage?le=new $(M):M.isAudio?le=new z(M):M.isFont&&(le=new U(M)),this._assetLoaderCallback(le,oe)},j})(),L=(function(){function j(M){this._nativeFileAsset=M}return j.prototype.decode=function(M){this._nativeFileAsset.decode(M)},Object.defineProperty(j.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),j})(),$=(function(j){g(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.setRenderImage=function(oe){this._nativeFileAsset.setRenderImage(oe.nativeImage)},M})(L),z=(function(j){g(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.setAudioSource=function(oe){this._nativeFileAsset.setAudioSource(oe.nativeAudio)},M})(L),U=(function(j){g(M,j);function M(){return j!==null&&j.apply(this,arguments)||this}return M.prototype.setFont=function(oe){this._nativeFileAsset.setFont(oe.nativeFont)},M})(L),N=(function(){function j(M){}return j.prototype.register=function(M){M.selfUnref=!0},j.prototype.unregister=function(M){},j})(),G=typeof FinalizationRegistry<"u"?FinalizationRegistry:N,K=new G(function(j){j.unref()})})],r={};function o(c){var f=r[c];if(f!==void 0)return f.exports;var p=r[c]={exports:{}};return t[c](p,p.exports,o),p.exports}o.d=(c,f)=>{for(var p in f)o.o(f,p)&&!o.o(c,p)&&Object.defineProperty(c,p,{enumerable:!0,get:f[p]})},o.o=(c,f)=>Object.prototype.hasOwnProperty.call(c,f),o.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var l={};return(()=>{o.r(l),o.d(l,{Alignment:()=>U,DataEnum:()=>$t,EventType:()=>Q,Fit:()=>z,Layout:()=>N,LoopType:()=>he,Rive:()=>Ee,RiveEventType:()=>M,RiveFile:()=>Tt,RuntimeLoader:()=>G,StateMachineInput:()=>j,StateMachineInputType:()=>K,Testing:()=>li,ViewModel:()=>Te,ViewModelInstance:()=>bt,ViewModelInstanceArtboard:()=>nn,ViewModelInstanceAssetImage:()=>Nn,ViewModelInstanceBoolean:()=>zt,ViewModelInstanceColor:()=>pn,ViewModelInstanceEnum:()=>_t,ViewModelInstanceList:()=>Ft,ViewModelInstanceNumber:()=>vn,ViewModelInstanceString:()=>tn,ViewModelInstanceTrigger:()=>Cn,ViewModelInstanceValue:()=>Je,decodeAudio:()=>Ar,decodeFont:()=>re,decodeImage:()=>J});var c=o(1),f=o(2),p=o(3),g=o(5),y=(function(){var v=function(a,h){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,T){w.__proto__=T}||function(w,T){for(var O in T)Object.prototype.hasOwnProperty.call(T,O)&&(w[O]=T[O])},v(a,h)};return function(a,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");v(a,h);function w(){this.constructor=a}a.prototype=h===null?Object.create(h):(w.prototype=h.prototype,new w)}})(),k=function(){return k=Object.assign||function(v){for(var a,h=1,w=arguments.length;h<w;h++){a=arguments[h];for(var T in a)Object.prototype.hasOwnProperty.call(a,T)&&(v[T]=a[T])}return v},k.apply(this,arguments)},E=function(v,a,h,w){function T(O){return O instanceof h?O:new h(function(F){F(O)})}return new(h||(h=Promise))(function(O,F){function ie(me){try{ne(w.next(me))}catch(je){F(je)}}function de(me){try{ne(w.throw(me))}catch(je){F(je)}}function ne(me){me.done?O(me.value):T(me.value).then(ie,de)}ne((w=w.apply(v,a||[])).next())})},_=function(v,a){var h={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},w,T,O,F=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return F.next=ie(0),F.throw=ie(1),F.return=ie(2),typeof Symbol=="function"&&(F[Symbol.iterator]=function(){return this}),F;function ie(ne){return function(me){return de([ne,me])}}function de(ne){if(w)throw new TypeError("Generator is already executing.");for(;F&&(F=0,ne[0]&&(h=0)),h;)try{if(w=1,T&&(O=ne[0]&2?T.return:ne[0]?T.throw||((O=T.return)&&O.call(T),0):T.next)&&!(O=O.call(T,ne[1])).done)return O;switch(T=0,O&&(ne=[ne[0]&2,O.value]),ne[0]){case 0:case 1:O=ne;break;case 4:return h.label++,{value:ne[1],done:!1};case 5:h.label++,T=ne[1],ne=[0];continue;case 7:ne=h.ops.pop(),h.trys.pop();continue;default:if(O=h.trys,!(O=O.length>0&&O[O.length-1])&&(ne[0]===6||ne[0]===2)){h=0;continue}if(ne[0]===3&&(!O||ne[1]>O[0]&&ne[1]<O[3])){h.label=ne[1];break}if(ne[0]===6&&h.label<O[1]){h.label=O[1],O=ne;break}if(O&&h.label<O[2]){h.label=O[2],h.ops.push(ne);break}O[2]&&h.ops.pop(),h.trys.pop();continue}ne=a.call(v,h)}catch(me){ne=[6,me],T=0}finally{w=O=0}if(ne[0]&5)throw ne[1];return{value:ne[0]?ne[1]:void 0,done:!0}}},I=function(v,a,h){if(h||arguments.length===2)for(var w=0,T=a.length,O;w<T;w++)(O||!(w in a))&&(O||(O=Array.prototype.slice.call(a,0,w)),O[w]=a[w]);return v.concat(O||Array.prototype.slice.call(a))},L=(function(v){y(a,v);function a(){var h=v!==null&&v.apply(this,arguments)||this;return h.isHandledError=!0,h}return a})(Error),$=function(v){return v&&v.isHandledError?v.message:"Problem loading file; may be corrupt!"},z;(function(v){v.Cover="cover",v.Contain="contain",v.Fill="fill",v.FitWidth="fitWidth",v.FitHeight="fitHeight",v.None="none",v.ScaleDown="scaleDown",v.Layout="layout"})(z||(z={}));var U;(function(v){v.Center="center",v.TopLeft="topLeft",v.TopCenter="topCenter",v.TopRight="topRight",v.CenterLeft="centerLeft",v.CenterRight="centerRight",v.BottomLeft="bottomLeft",v.BottomCenter="bottomCenter",v.BottomRight="bottomRight"})(U||(U={}));var N=(function(){function v(a){var h,w,T,O,F,ie,de;this.fit=(h=a?.fit)!==null&&h!==void 0?h:z.Contain,this.alignment=(w=a?.alignment)!==null&&w!==void 0?w:U.Center,this.layoutScaleFactor=(T=a?.layoutScaleFactor)!==null&&T!==void 0?T:1,this.minX=(O=a?.minX)!==null&&O!==void 0?O:0,this.minY=(F=a?.minY)!==null&&F!==void 0?F:0,this.maxX=(ie=a?.maxX)!==null&&ie!==void 0?ie:0,this.maxY=(de=a?.maxY)!==null&&de!==void 0?de:0}return v.new=function(a){var h=a.fit,w=a.alignment,T=a.minX,O=a.minY,F=a.maxX,ie=a.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new v({fit:h,alignment:w,minX:T,minY:O,maxX:F,maxY:ie})},v.prototype.copyWith=function(a){var h=a.fit,w=a.alignment,T=a.layoutScaleFactor,O=a.minX,F=a.minY,ie=a.maxX,de=a.maxY;return new v({fit:h??this.fit,alignment:w??this.alignment,layoutScaleFactor:T??this.layoutScaleFactor,minX:O??this.minX,minY:F??this.minY,maxX:ie??this.maxX,maxY:de??this.maxY})},v.prototype.runtimeFit=function(a){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var h;return this.fit===z.Cover?h=a.Fit.cover:this.fit===z.Contain?h=a.Fit.contain:this.fit===z.Fill?h=a.Fit.fill:this.fit===z.FitWidth?h=a.Fit.fitWidth:this.fit===z.FitHeight?h=a.Fit.fitHeight:this.fit===z.ScaleDown?h=a.Fit.scaleDown:this.fit===z.Layout?h=a.Fit.layout:h=a.Fit.none,this.cachedRuntimeFit=h,h},v.prototype.runtimeAlignment=function(a){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var h;return this.alignment===U.TopLeft?h=a.Alignment.topLeft:this.alignment===U.TopCenter?h=a.Alignment.topCenter:this.alignment===U.TopRight?h=a.Alignment.topRight:this.alignment===U.CenterLeft?h=a.Alignment.centerLeft:this.alignment===U.CenterRight?h=a.Alignment.centerRight:this.alignment===U.BottomLeft?h=a.Alignment.bottomLeft:this.alignment===U.BottomCenter?h=a.Alignment.bottomCenter:this.alignment===U.BottomRight?h=a.Alignment.bottomRight:h=a.Alignment.center,this.cachedRuntimeAlignment=h,h},v})(),G=(function(){function v(){}return v.loadRuntime=function(){c.default({locateFile:function(){return v.wasmURL}}).then(function(a){var h;for(v.runtime=a;v.callBackQueue.length>0;)(h=v.callBackQueue.shift())===null||h===void 0||h(v.runtime)}).catch(function(a){var h={message:a?.message||"Unknown error",type:a?.name||"Error",wasmError:a instanceof WebAssembly.CompileError||a instanceof WebAssembly.RuntimeError,originalError:a};console.debug("Rive WASM load error details:",h);var w="https://cdn.jsdelivr.net/npm/".concat(f.name,"@").concat(f.version,"/rive_fallback.wasm");if(v.wasmURL.toLowerCase()!==w)console.warn("Failed to load WASM from ".concat(v.wasmURL," (").concat(h.message,"), trying jsdelivr as a backup")),v.setWasmUrl(w),v.loadRuntime();else{var T=["Could not load Rive WASM file from ".concat(v.wasmURL," or ").concat(w,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(h.type),"- Message: ".concat(h.message),"- WebAssembly-specific error: ".concat(h.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(T)}})},v.getInstance=function(a){v.isLoading||(v.isLoading=!0,v.loadRuntime()),v.runtime?a(v.runtime):v.callBackQueue.push(a)},v.awaitInstance=function(){return new Promise(function(a){return v.getInstance(function(h){return a(h)})})},v.setWasmUrl=function(a){v.wasmURL=a},v.getWasmUrl=function(){return v.wasmURL},v.isLoading=!1,v.callBackQueue=[],v.wasmURL="https://unpkg.com/".concat(f.name,"@").concat(f.version,"/rive.wasm"),v})(),K;(function(v){v[v.Number=56]="Number",v[v.Trigger=58]="Trigger",v[v.Boolean=59]="Boolean"})(K||(K={}));var j=(function(){function v(a,h){this.type=a,this.runtimeInput=h}return Object.defineProperty(v.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(a){this.runtimeInput.value=a},enumerable:!1,configurable:!0}),v.prototype.fire=function(){this.type===K.Trigger&&this.runtimeInput.fire()},v.prototype.delete=function(){this.runtimeInput=null},v})(),M;(function(v){v[v.General=128]="General",v[v.OpenUrl=131]="OpenUrl"})(M||(M={}));var oe=(function(){function v(a){this.nativeArtboard=a}return v})(),le=(function(){function v(a,h,w,T){this.stateMachine=a,this.playing=w,this.artboard=T,this.inputs=[],this.instance=new h.StateMachineInstance(a,T),this.initInputs(h)}return Object.defineProperty(v.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"statesChanged",{get:function(){for(var a=[],h=0;h<this.instance.stateChangedCount();h++)a.push(this.instance.stateChangedNameByIndex(h));return a},enumerable:!1,configurable:!0}),v.prototype.advance=function(a){this.instance.advance(a)},v.prototype.advanceAndApply=function(a){this.instance.advanceAndApply(a)},v.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},v.prototype.reportedEventAt=function(a){return this.instance.reportedEventAt(a)},v.prototype.initInputs=function(a){for(var h=0;h<this.instance.inputCount();h++){var w=this.instance.input(h);this.inputs.push(this.mapRuntimeInput(w,a))}},v.prototype.mapRuntimeInput=function(a,h){if(a.type===h.SMIInput.bool)return new j(K.Boolean,a.asBool());if(a.type===h.SMIInput.number)return new j(K.Number,a.asNumber());if(a.type===h.SMIInput.trigger)return new j(K.Trigger,a.asTrigger())},v.prototype.cleanup=function(){this.inputs.forEach(function(a){a.delete()}),this.inputs.length=0,this.instance.delete()},v.prototype.bindViewModelInstance=function(a){a.runtimeInstance!=null&&this.instance.bindViewModelInstance(a.runtimeInstance)},v})(),ce=(function(){function v(a,h,w,T,O){T===void 0&&(T=[]),O===void 0&&(O=[]),this.runtime=a,this.artboard=h,this.eventManager=w,this.animations=T,this.stateMachines=O}return v.prototype.add=function(a,h,w){if(w===void 0&&(w=!0),a=kt(a),a.length===0)this.animations.forEach(function(Be){return Be.playing=h}),this.stateMachines.forEach(function(Be){return Be.playing=h});else for(var T=this.animations.map(function(Be){return Be.name}),O=this.stateMachines.map(function(Be){return Be.name}),F=0;F<a.length;F++){var ie=T.indexOf(a[F]),de=O.indexOf(a[F]);if(ie>=0||de>=0)ie>=0?this.animations[ie].playing=h:this.stateMachines[de].playing=h;else{var ne=this.artboard.animationByName(a[F]);if(ne){var me=new p.Animation(ne,this.artboard,this.runtime,h);me.advance(0),me.apply(1),this.animations.push(me)}else{var je=this.artboard.stateMachineByName(a[F]);if(je){var rt=new le(je,this.runtime,h,this.artboard);this.stateMachines.push(rt)}}}}return w&&(h?this.eventManager.fire({type:Q.Play,data:this.playing}):this.eventManager.fire({type:Q.Pause,data:this.paused})),h?this.playing:this.paused},v.prototype.initLinearAnimations=function(a,h){for(var w=this.animations.map(function(de){return de.name}),T=0;T<a.length;T++){var O=w.indexOf(a[T]);if(O>=0)this.animations[O].playing=h;else{var F=this.artboard.animationByName(a[T]);if(F){var ie=new p.Animation(F,this.artboard,this.runtime,h);ie.advance(0),ie.apply(1),this.animations.push(ie)}else console.error("Animation with name ".concat(a[T]," not found."))}}},v.prototype.initStateMachines=function(a,h){for(var w=this.stateMachines.map(function(de){return de.name}),T=0;T<a.length;T++){var O=w.indexOf(a[T]);if(O>=0)this.stateMachines[O].playing=h;else{var F=this.artboard.stateMachineByName(a[T]);if(F){var ie=new le(F,this.runtime,h,this.artboard);this.stateMachines.push(ie),h||ie.advanceAndApply(0)}else console.warn("State Machine with name ".concat(a[T]," not found.")),this.initLinearAnimations([a[T]],h)}}},v.prototype.play=function(a){return this.add(a,!0)},v.prototype.pause=function(a){return this.add(a,!1)},v.prototype.scrub=function(a,h){var w=this.animations.filter(function(T){return a.includes(T.name)});return w.forEach(function(T){return T.scrubTo=h}),w.map(function(T){return T.name})},Object.defineProperty(v.prototype,"playing",{get:function(){return this.animations.filter(function(a){return a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"paused",{get:function(){return this.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),v.prototype.stop=function(a){var h=this;a=kt(a);var w=[];if(a.length===0)w=this.animations.map(function(F){return F.name}).concat(this.stateMachines.map(function(F){return F.name})),this.animations.forEach(function(F){return F.cleanup()}),this.stateMachines.forEach(function(F){return F.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var T=this.animations.filter(function(F){return a.includes(F.name)});T.forEach(function(F){F.cleanup(),h.animations.splice(h.animations.indexOf(F),1)});var O=this.stateMachines.filter(function(F){return a.includes(F.name)});O.forEach(function(F){F.cleanup(),h.stateMachines.splice(h.stateMachines.indexOf(F),1)}),w=T.map(function(F){return F.name}).concat(O.map(function(F){return F.name}))}return this.eventManager.fire({type:Q.Stop,data:w}),w},Object.defineProperty(v.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(a,h){return a||h.playing},!1)||this.stateMachines.reduce(function(a,h){return a||h.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),v.prototype.atLeastOne=function(a,h){h===void 0&&(h=!0);var w;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([w=this.artboard.animationByIndex(0).name],a,h):this.artboard.stateMachineCount()>0&&this.add([w=this.artboard.stateMachineByIndex(0).name],a,h)),w},v.prototype.handleLooping=function(){for(var a=0,h=this.animations.filter(function(T){return T.playing});a<h.length;a++){var w=h[a];w.loopValue===0&&w.loopCount?(w.loopCount=0,this.stop(w.name)):w.loopValue===1&&w.loopCount?(this.eventManager.fire({type:Q.Loop,data:{animation:w.name,type:he.Loop}}),w.loopCount=0):w.loopValue===2&&w.loopCount>1&&(this.eventManager.fire({type:Q.Loop,data:{animation:w.name,type:he.PingPong}}),w.loopCount=0)}},v.prototype.handleStateChanges=function(){for(var a=[],h=0,w=this.stateMachines.filter(function(O){return O.playing});h<w.length;h++){var T=w[h];a.push.apply(a,T.statesChanged)}a.length>0&&this.eventManager.fire({type:Q.StateChange,data:a})},v.prototype.handleAdvancing=function(a){this.eventManager.fire({type:Q.Advance,data:a})},v})(),Q;(function(v){v.Load="load",v.LoadError="loaderror",v.Play="play",v.Pause="pause",v.Stop="stop",v.Loop="loop",v.Draw="draw",v.Advance="advance",v.StateChange="statechange",v.RiveEvent="riveevent",v.AudioStatusChange="audiostatuschange"})(Q||(Q={}));var he;(function(v){v.OneShot="oneshot",v.Loop="loop",v.PingPong="pingpong"})(he||(he={}));var De=(function(){function v(a){a===void 0&&(a=[]),this.listeners=a}return v.prototype.getListeners=function(a){return this.listeners.filter(function(h){return h.type===a})},v.prototype.add=function(a){this.listeners.includes(a)||this.listeners.push(a)},v.prototype.remove=function(a){for(var h=0;h<this.listeners.length;h++){var w=this.listeners[h];if(w.type===a.type&&w.callback===a.callback){this.listeners.splice(h,1);break}}},v.prototype.removeAll=function(a){var h=this;a?this.listeners.filter(function(w){return w.type===a}).forEach(function(w){return h.remove(w)}):this.listeners.splice(0,this.listeners.length)},v.prototype.fire=function(a){var h=this.getListeners(a.type);h.forEach(function(w){return w.callback(a)})},v})(),Ke=(function(){function v(a){this.eventManager=a,this.queue=[]}return v.prototype.add=function(a){this.queue.push(a)},v.prototype.process=function(){for(;this.queue.length>0;){var a=this.queue.shift();a?.action&&a.action(),a?.event&&this.eventManager.fire(a.event)}},v})(),Ve;(function(v){v[v.AVAILABLE=0]="AVAILABLE",v[v.UNAVAILABLE=1]="UNAVAILABLE"})(Ve||(Ve={}));var wt=(function(v){y(a,v);function a(){var h=v!==null&&v.apply(this,arguments)||this;return h._started=!1,h._enabled=!1,h._status=Ve.UNAVAILABLE,h}return a.prototype.delay=function(h){return E(this,void 0,void 0,function(){return _(this,function(w){return[2,new Promise(function(T){return setTimeout(T,h)})]})})},a.prototype.timeout=function(){return E(this,void 0,void 0,function(){return _(this,function(h){return[2,new Promise(function(w,T){return setTimeout(T,50)})]})})},a.prototype.reportToListeners=function(){this.fire({type:Q.AudioStatusChange}),this.removeAll()},a.prototype.enableAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(h){return this._enabled||(this._enabled=!0,this._status=Ve.AVAILABLE,this.reportToListeners()),[2]})})},a.prototype.testAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(h){switch(h.label){case 0:if(!(this._status===Ve.UNAVAILABLE&&this._audioContext!==null))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return h.sent(),this.enableAudio(),[3,4];case 3:return h.sent(),[3,4];case 4:return[2]}})})},a.prototype._establishAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(h){switch(h.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),h.label=2;case 2:return this._status!==Ve.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return h.sent(),[4,this.delay(1e3)];case 4:return h.sent(),[3,2];case 5:return[2]}})})},a.prototype.listenForUserAction=function(){var h=this,w=function(){return E(h,void 0,void 0,function(){return _(this,function(T){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",w,{once:!0})},a.prototype.establishAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(h){return this._establishAudio(),[2]})})},Object.defineProperty(a.prototype,"systemVolume",{get:function(){return this._status===Ve.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),a})(De),ke=new wt,en=(function(){function v(){}return v.prototype.observe=function(){},v.prototype.unobserve=function(){},v.prototype.disconnect=function(){},v})(),tt=globalThis.ResizeObserver||en,He=(function(){function v(){var a=this;this._elementsMap=new Map,this._onObservedEntry=function(h){var w=a._elementsMap.get(h.target);w!==null?w.onResize(h.target.clientWidth==0||h.target.clientHeight==0):a._resizeObserver.unobserve(h.target)},this._onObserved=function(h){h.forEach(a._onObservedEntry)},this._resizeObserver=new tt(this._onObserved)}return v.prototype.add=function(a,h){var w={onResize:h,element:a};return this._elementsMap.set(a,w),this._resizeObserver.observe(a),w},v.prototype.remove=function(a){this._resizeObserver.unobserve(a.element),this._elementsMap.delete(a.element)},v})(),ot=new He,Tt=(function(){function v(a){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=a.src,this.buffer=a.buffer,a.assetLoader&&(this.assetLoader=a.assetLoader),this.enableRiveAssetCDN=typeof a.enableRiveAssetCDN=="boolean"?a.enableRiveAssetCDN:!0,this.eventManager=new De,a.onLoad&&this.on(Q.Load,a.onLoad),a.onLoadError&&this.on(Q.LoadError,a.onLoadError)}return v.prototype.initData=function(){return E(this,void 0,void 0,function(){var a,h,w,T,O;return _(this,function(F){switch(F.label){case 0:return this.src?(a=this,[4,Er(this.src)]):[3,2];case 1:a.buffer=F.sent(),F.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(w=new g.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),h=w.assetLoader),T=this,[4,this.runtime.load(new Uint8Array(this.buffer),h,this.enableRiveAssetCDN)]);case 3:return T.file=F.sent(),this.destroyed?((O=this.file)===null||O===void 0||O.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:Q.Load,data:this}):this.fireLoadError(v.fileLoadErrorMessage),[2])}})})},v.prototype.init=function(){return E(this,void 0,void 0,function(){var a,h;return _(this,function(w){switch(w.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(v.missingErrorMessage),[2];w.label=1;case 1:return w.trys.push([1,4,,5]),a=this,[4,G.awaitInstance()];case 2:return a.runtime=w.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return w.sent(),[3,5];case 4:return h=w.sent(),this.fireLoadError(h instanceof Error?h.message:v.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},v.prototype.fireLoadError=function(a){throw this.eventManager.fire({type:Q.LoadError,data:a}),new Error(a)},v.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},v.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},v.prototype.cleanup=function(){var a;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(a=this.file)===null||a===void 0||a.delete(),this.file=null,this.destroyed=!0)},v.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},v.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},v.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},v.prototype.getArtboard=function(a){var h=this.file.artboardByName(a);return h!=null?new oe(h):null},v.missingErrorMessage="Rive source file or data buffer required",v.fileLoadErrorMessage="The file failed to load",v})(),Ee=(function(){function v(a){var h=this,w;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(T){var O=h._hasZeroSize!==T;h._hasZeroSize=T,T?(!h._layout.maxX||!h._layout.maxY)&&h.resizeToCanvas():O&&h.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=a.canvas,a.canvas.constructor===HTMLCanvasElement&&(this._observed=ot.add(this.canvas,this.onCanvasResize)),this.src=a.src,this.buffer=a.buffer,this.riveFile=a.riveFile,this.layout=(w=a.layout)!==null&&w!==void 0?w:new N,this.shouldDisableRiveListeners=!!a.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!a.isTouchScrollEnabled,this.automaticallyHandleEvents=!!a.automaticallyHandleEvents,this.enableRiveAssetCDN=a.enableRiveAssetCDN===void 0?!0:a.enableRiveAssetCDN,this.eventManager=new De,a.onLoad&&this.on(Q.Load,a.onLoad),a.onLoadError&&this.on(Q.LoadError,a.onLoadError),a.onPlay&&this.on(Q.Play,a.onPlay),a.onPause&&this.on(Q.Pause,a.onPause),a.onStop&&this.on(Q.Stop,a.onStop),a.onLoop&&this.on(Q.Loop,a.onLoop),a.onStateChange&&this.on(Q.StateChange,a.onStateChange),a.onAdvance&&this.on(Q.Advance,a.onAdvance),a.onload&&!a.onLoad&&this.on(Q.Load,a.onload),a.onloaderror&&!a.onLoadError&&this.on(Q.LoadError,a.onloaderror),a.onplay&&!a.onPlay&&this.on(Q.Play,a.onplay),a.onpause&&!a.onPause&&this.on(Q.Pause,a.onpause),a.onstop&&!a.onStop&&this.on(Q.Stop,a.onstop),a.onloop&&!a.onLoop&&this.on(Q.Loop,a.onloop),a.onstatechange&&!a.onStateChange&&this.on(Q.StateChange,a.onstatechange),a.assetLoader&&(this.assetLoader=a.assetLoader),this.taskQueue=new Ke(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:a.autoplay,autoBind:a.autoBind,animations:a.animations,stateMachines:a.stateMachines,artboard:a.artboard,useOffscreenRenderer:a.useOffscreenRenderer})}return Object.defineProperty(v.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),v.new=function(a){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new v(a)},v.prototype.onSystemAudioChanged=function(){this.volume=this._volume},v.prototype.init=function(a){var h=this,w=a.src,T=a.buffer,O=a.riveFile,F=a.animations,ie=a.stateMachines,de=a.artboard,ne=a.autoplay,me=ne===void 0?!1:ne,je=a.useOffscreenRenderer,rt=je===void 0?!1:je,Be=a.autoBind,Dt=Be===void 0?!1:Be;if(!this.destroyed){if(this.src=w,this.buffer=T,this.riveFile=O,!this.src&&!this.buffer&&!this.riveFile)throw new L(v.missingErrorMessage);var Et=kt(F),ut=kt(ie);this.loaded=!1,this.readyForPlaying=!1,G.awaitInstance().then(function(vt){h.destroyed||(h.runtime=vt,h.removeRiveListeners(),h.deleteRiveRenderer(),h.renderer=h.runtime.makeRenderer(h.canvas,rt),h.canvas.width||h.canvas.height||h.resizeDrawingSurfaceToCanvas(),h.initData(de,Et,ut,me,Dt).then(function(It){if(It)return h.setupRiveListeners()}).catch(function(It){console.error(It)}))}).catch(function(vt){console.error(vt)})}},v.prototype.setupRiveListeners=function(a){var h=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var w=(this.animator.stateMachines||[]).filter(function(O){return O.playing&&h.runtime.hasListeners(O.instance)}).map(function(O){return O.instance}),T=this.isTouchScrollEnabled;a&&"isTouchScrollEnabled"in a&&(T=a.isTouchScrollEnabled),this.eventCleanup=(0,g.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:w,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:T,layoutScaleFactor:this._layout.layoutScaleFactor})}},v.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},v.prototype.initializeAudio=function(){var a=this,h;ke.status==Ve.UNAVAILABLE&&!((h=this.artboard)===null||h===void 0)&&h.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:Q.AudioStatusChange,callback:function(){return a.onSystemAudioChanged()}},ke.add(this._audioEventListener),ke.establishAudio())},v.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},v.prototype.initData=function(a,h,w,T,O){return E(this,void 0,void 0,function(){var F,ie,de,ne;return _(this,function(me){switch(me.label){case 0:return me.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(F=new Tt({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=F,[4,F.init()]);case 1:if(me.sent(),this.destroyed)return F.destroyIfUnused(),[2,!1];me.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(a,h,w,T,O),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:Q.Load,data:(ne=this.src)!==null&&ne!==void 0?ne:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return ie=me.sent(),de=$(ie),console.warn(de),this.eventManager.fire({type:Q.LoadError,data:de}),[2,Promise.reject(de)];case 4:return[2]}})})},v.prototype.initArtboard=function(a,h,w,T,O){if(this.file){var F=a?this.file.artboardByName(a):this.file.defaultArtboard();if(!F){var ie="Invalid artboard name or no default artboard";console.warn(ie),this.eventManager.fire({type:Q.LoadError,data:ie});return}if(this.artboard=F,F.volume=this._volume*ke.systemVolume,this.artboard.animationCount()<1){var ie="Artboard has no animations";throw this.eventManager.fire({type:Q.LoadError,data:ie}),ie}this.animator=new ce(this.runtime,this.artboard,this.eventManager);var de;if(h.length>0||w.length>0?(de=h.concat(w),this.animator.initLinearAnimations(h,T),this.animator.initStateMachines(w,T)):de=[this.animator.atLeastOne(T,!1)],this.taskQueue.add({event:{type:T?Q.Play:Q.Pause,data:de}}),O){var ne=this.file.defaultArtboardViewModel(F);if(ne!==null){var me=ne.defaultInstance();if(me!==null){var je=new bt(me,null);this.bindViewModelInstance(je)}}}}},v.prototype.drawFrame=function(){var a,h;!((a=document?.timeline)===null||a===void 0)&&a.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(h=this.runtime)===null||h===void 0||h.resolveAnimationFrame()):this.startRendering()},v.prototype.draw=function(a,h){var w;this.frameRequestId=null;var T=performance.now();this.lastRenderTime||(this.lastRenderTime=a),this.renderSecondTimer+=a-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,h?.());var O=(a-this.lastRenderTime)/1e3;this.lastRenderTime=a;for(var F=this.animator.animations.filter(function(Ut){return Ut.playing||Ut.needsScrub}).sort(function(Ut){return Ut.needsScrub?-1:1}),ie=0,de=F;ie<de.length;ie++){var ne=de[ie];ne.advance(O),ne.instance.didLoop&&(ne.loopCount+=1),ne.apply(1)}for(var me=this.animator.stateMachines.filter(function(Ut){return Ut.playing}),je=0,rt=me;je<rt.length;je++){var Be=rt[je],Dt=Be.reportedEventCount();if(Dt)for(var Et=0;Et<Dt;Et++){var ut=Be.reportedEventAt(Et);if(ut)if(ut.type===M.OpenUrl){if(this.eventManager.fire({type:Q.RiveEvent,data:ut}),this.automaticallyHandleEvents){var vt=document.createElement("a"),It=ut,rn=It.url,sn=It.target,Gt=(0,g.sanitizeUrl)(rn);rn&&vt.setAttribute("href",Gt),sn&&vt.setAttribute("target",sn),Gt&&Gt!==g.BLANK_URL&&vt.click()}}else this.eventManager.fire({type:Q.RiveEvent,data:ut})}Be.advanceAndApply(O)}this.animator.stateMachines.length==0&&this.artboard.advance(O);var ue=this.renderer;ue.clear(),ue.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(ue),ue.restore(),ue.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(O),this.frameCount++;var Se=performance.now();for(this.frameTimes.push(Se),this.durations.push(Se-T);this.frameTimes[0]<=Se-1e3;)this.frameTimes.shift(),this.durations.shift();(w=this._viewModelInstance)===null||w===void 0||w.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},v.prototype.alignRenderer=function(){var a=this,h=a.renderer,w=a.runtime,T=a._layout,O=a.artboard;h.align(T.runtimeFit(w),T.runtimeAlignment(w),{minX:T.minX,minY:T.minY,maxX:T.maxX,maxY:T.maxY},O.bounds,this._devicePixelRatioUsed*T.layoutScaleFactor)},Object.defineProperty(v.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(a,h){return a+h},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),v.prototype.cleanup=function(){var a,h;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&ot.remove(this._observed),this.removeRiveListeners(),this.file&&((a=this.riveFile)===null||a===void 0||a.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(ke.remove(this._audioEventListener),this._audioEventListener=null),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=null,this._dataEnums=null},v.prototype.deleteRiveRenderer=function(){var a;(a=this.renderer)===null||a===void 0||a.delete(),this.renderer=null},v.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},v.prototype.retrieveTextRun=function(a){var h;if(!a){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var w=this.artboard.textRun(a);if(!w){console.warn("Could not access a text run with name '".concat(a,"' in the '").concat((h=this.artboard)===null||h===void 0?void 0:h.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return w},v.prototype.getTextRunValue=function(a){var h=this.retrieveTextRun(a);return h?h.text:void 0},v.prototype.setTextRunValue=function(a,h){var w=this.retrieveTextRun(a);w&&(w.text=h)},v.prototype.play=function(a,h){var w=this;if(a=kt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.play(a,h)}});return}this.animator.play(a),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},v.prototype.pause=function(a){var h=this;if(a=kt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.pause(a)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(a)},v.prototype.scrub=function(a,h){var w=this;if(a=kt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.scrub(a,h)}});return}this.animator.scrub(a,h||0),this.drawFrame()},v.prototype.stop=function(a){var h=this;if(a=kt(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.stop(a)}});return}this.animator&&this.animator.stop(a),this.eventCleanup&&this.eventCleanup()},v.prototype.reset=function(a){var h,w,T=a?.artboard,O=kt(a?.animations),F=kt(a?.stateMachines),ie=(h=a?.autoplay)!==null&&h!==void 0?h:!1,de=(w=a?.autoBind)!==null&&w!==void 0?w:!1;this.cleanupInstances(),this.initArtboard(T,O,F,ie,de),this.taskQueue.process()},v.prototype.load=function(a){this.file=null,this.stop(),this.init(a)},Object.defineProperty(v.prototype,"layout",{get:function(){return this._layout},set:function(a){this._layout=a,(!a.maxX||!a.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),v.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},v.prototype.resizeDrawingSurfaceToCanvas=function(a){if(this.canvas instanceof HTMLCanvasElement&&window){var h=this.canvas.getBoundingClientRect(),w=h.width,T=h.height,O=a||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=O,this.canvas.width=O*w,this.canvas.height=O*T,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===z.Layout){var F=this._layout.layoutScaleFactor;this.artboard.width=w/F,this.artboard.height=T/F}}},Object.defineProperty(v.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.animationCount();h++)a.push(this.artboard.animationByIndex(h).name);return a},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.stateMachineCount();h++)a.push(this.artboard.stateMachineByIndex(h).name);return a},enumerable:!1,configurable:!0}),v.prototype.stateMachineInputs=function(a){if(this.loaded){var h=this.animator.stateMachines.find(function(w){return w.name===a});return h?.inputs}},v.prototype.retrieveInputAtPath=function(a,h){if(!a){console.warn("No input name provided for path '".concat(h,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.inputByPath(a,h);if(!w){console.warn("Could not access an input with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},v.prototype.setBooleanStateAtPath=function(a,h,w){var T=this.retrieveInputAtPath(a,w);T&&(T.type===K.Boolean?T.asBool().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a boolean")))},v.prototype.setNumberStateAtPath=function(a,h,w){var T=this.retrieveInputAtPath(a,w);T&&(T.type===K.Number?T.asNumber().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a number")))},v.prototype.fireStateAtPath=function(a,h){var w=this.retrieveInputAtPath(a,h);w&&(w.type===K.Trigger?w.asTrigger().fire():console.warn("Input with name: '".concat(a,"', at path:'").concat(h,"' is not a trigger")))},v.prototype.retrieveTextAtPath=function(a,h){if(!a){console.warn("No text name provided for path '".concat(h,"'"));return}if(!h){console.warn("No path provided for text '".concat(a,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.textByPath(a,h);if(!w){console.warn("Could not access text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},v.prototype.getTextRunValueAtPath=function(a,h){var w=this.retrieveTextAtPath(a,h);if(!w){console.warn("Could not get text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w.text},v.prototype.setTextRunValueAtPath=function(a,h,w){var T=this.retrieveTextAtPath(a,w);if(!T){console.warn("Could not set text with name: '".concat(a,"', at path:'").concat(w,"'"));return}T.text=h},Object.defineProperty(v.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),v.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},v.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},v.prototype.unsubscribe=function(a,h){console.warn("This function is deprecated: please use `off()` instead."),this.off(a,h)},v.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},v.prototype.unsubscribeAll=function(a){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(a)},v.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},v.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},v.prototype.enableFPSCounter=function(a){this.runtime.enableFPSCounter(a)},v.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(v.prototype,"contents",{get:function(){if(this.loaded){for(var a={artboards:[]},h=0;h<this.file.artboardCount();h++){for(var w=this.file.artboardByIndex(h),T={name:w.name,animations:[],stateMachines:[]},O=0;O<w.animationCount();O++){var F=w.animationByIndex(O);T.animations.push(F.name)}for(var ie=0;ie<w.stateMachineCount();ie++){for(var de=w.stateMachineByIndex(ie),ne=de.name,me=new this.runtime.StateMachineInstance(de,w),je=[],rt=0;rt<me.inputCount();rt++){var Be=me.input(rt);je.push({name:Be.name,type:Be.type})}T.stateMachines.push({name:ne,inputs:je})}a.artboards.push(T)}return a}},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(a){this._volume=a,this.artboard&&(this.artboard.volume=a*ke.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"artboardWidth",{get:function(){var a;return this.artboard?this.artboard.width:(a=this._artboardWidth)!==null&&a!==void 0?a:0},set:function(a){this._artboardWidth=a,this.artboard&&(this.artboard.width=a)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"artboardHeight",{get:function(){var a;return this.artboard?this.artboard.height:(a=this._artboardHeight)!==null&&a!==void 0?a:0},set:function(a){this._artboardHeight=a,this.artboard&&(this.artboard.height=a)},enumerable:!1,configurable:!0}),v.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(v.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(a){this._devicePixelRatioUsed=a},enumerable:!1,configurable:!0}),v.prototype.bindViewModelInstance=function(a){var h;this.artboard&&!this.destroyed&&a&&a.runtimeInstance&&(a.internalIncrementReferenceCount(),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=a,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(w){return w.bindViewModelInstance(a)}):this.artboard.bindViewModelInstance(a.runtimeInstance))},Object.defineProperty(v.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),v.prototype.viewModelByIndex=function(a){var h=this.file.viewModelByIndex(a);return h!==null?new Te(h):null},v.prototype.viewModelByName=function(a){var h=this.file.viewModelByName(a);return h!==null?new Te(h):null},v.prototype.enums=function(){if(this._dataEnums===null){var a=this.file.enums();this._dataEnums=a.map(function(h){return new $t(h)})}return this._dataEnums},v.prototype.defaultViewModel=function(){if(this.artboard){var a=this.file.defaultArtboardViewModel(this.artboard);if(a)return new Te(a)}return null},v.prototype.getArtboard=function(a){var h,w;return(w=(h=this.riveFile)===null||h===void 0?void 0:h.getArtboard(a))!==null&&w!==void 0?w:null},v.missingErrorMessage="Rive source file or data buffer required",v.cleanupErrorMessage="Attempt to use file after calling cleanup.",v})(),Te=(function(){function v(a){this._viewModel=a}return Object.defineProperty(v.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),v.prototype.instanceByIndex=function(a){var h=this._viewModel.instanceByIndex(a);return h!==null?new bt(h,null):null},v.prototype.instanceByName=function(a){var h=this._viewModel.instanceByName(a);return h!==null?new bt(h,null):null},v.prototype.defaultInstance=function(){var a=this._viewModel.defaultInstance();return a!==null?new bt(a,null):null},v.prototype.instance=function(){var a=this._viewModel.instance();return a!==null?new bt(a,null):null},Object.defineProperty(v.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),v})(),$t=(function(){function v(a){this._dataEnum=a}return Object.defineProperty(v.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),v})(),Me;(function(v){v.Number="number",v.String="string",v.Boolean="boolean",v.Color="color",v.Trigger="trigger",v.Enum="enum",v.List="list",v.Image="image",v.Artboard="artboard"})(Me||(Me={}));var bt=(function(){function v(a,h){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=a,h!==null&&this._parents.push(h)}return Object.defineProperty(v.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),v.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(a){a.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(a){a.clearChanges()})),this._children.forEach(function(a){return a.handleCallbacks()})},v.prototype.addParent=function(a){this._parents.includes(a)||(this._parents.push(a),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&a.addToViewModelCallbacks(this))},v.prototype.removeParent=function(a){var h=this._parents.indexOf(a);if(h!==-1){var w=this._parents[h];w.removeFromViewModelCallbacks(this),this._parents.splice(h,1)}},v.prototype.addToPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)||(this._propertiesWithCallbacks.push(a),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},v.prototype.removeFromPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},v.prototype.addToViewModelCallbacks=function(a){var h=this;this._children.includes(a)||(this._children.push(a),this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},v.prototype.removeFromViewModelCallbacks=function(a){var h=this;this._children.includes(a)&&(this._children=this._children.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},v.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(a){a.clearCallbacks()})},v.prototype.propertyFromPath=function(a,h){var w=a.split("/");return this.propertyFromPathSegments(w,0,h)},v.prototype.viewModelFromPathSegments=function(a,h){var w=this.internalViewModelInstance(a[h]);return w!==null?h==a.length-1?w:w.viewModelFromPathSegments(a,h++):null},v.prototype.propertyFromPathSegments=function(a,h,w){var T,O,F,ie,de,ne,me,je,rt,Be,Dt,Et,ut,vt,It,rn,sn,Gt;if(h<a.length-1){var ue=this.internalViewModelInstance(a[h]);return ue!==null?ue.propertyFromPathSegments(a,h+1,w):null}var Se=null;switch(w){case Me.Number:if(Se=(O=(T=this._runtimeInstance)===null||T===void 0?void 0:T.number(a[h]))!==null&&O!==void 0?O:null,Se!==null)return new vn(Se,this);break;case Me.String:if(Se=(ie=(F=this._runtimeInstance)===null||F===void 0?void 0:F.string(a[h]))!==null&&ie!==void 0?ie:null,Se!==null)return new tn(Se,this);break;case Me.Boolean:if(Se=(ne=(de=this._runtimeInstance)===null||de===void 0?void 0:de.boolean(a[h]))!==null&&ne!==void 0?ne:null,Se!==null)return new zt(Se,this);break;case Me.Color:if(Se=(je=(me=this._runtimeInstance)===null||me===void 0?void 0:me.color(a[h]))!==null&&je!==void 0?je:null,Se!==null)return new pn(Se,this);break;case Me.Trigger:if(Se=(Be=(rt=this._runtimeInstance)===null||rt===void 0?void 0:rt.trigger(a[h]))!==null&&Be!==void 0?Be:null,Se!==null)return new Cn(Se,this);break;case Me.Enum:if(Se=(Et=(Dt=this._runtimeInstance)===null||Dt===void 0?void 0:Dt.enum(a[h]))!==null&&Et!==void 0?Et:null,Se!==null)return new _t(Se,this);break;case Me.List:if(Se=(vt=(ut=this._runtimeInstance)===null||ut===void 0?void 0:ut.list(a[h]))!==null&&vt!==void 0?vt:null,Se!==null)return new Ft(Se,this);break;case Me.Image:if(Se=(rn=(It=this._runtimeInstance)===null||It===void 0?void 0:It.image(a[h]))!==null&&rn!==void 0?rn:null,Se!==null)return new Nn(Se,this);break;case Me.Artboard:if(Se=(Gt=(sn=this._runtimeInstance)===null||sn===void 0?void 0:sn.artboard(a[h]))!==null&&Gt!==void 0?Gt:null,Se!==null)return new nn(Se,this);break}return null},v.prototype.internalViewModelInstance=function(a){var h;if(this._viewModelInstances.has(a))return this._viewModelInstances.get(a);var w=(h=this._runtimeInstance)===null||h===void 0?void 0:h.viewModel(a);if(w!==null){var T=new v(w,this);return T.internalIncrementReferenceCount(),this._viewModelInstances.set(a,T),T}return null},v.prototype.number=function(a){var h=this.propertyFromPath(a,Me.Number);return h},v.prototype.string=function(a){var h=this.propertyFromPath(a,Me.String);return h},v.prototype.boolean=function(a){var h=this.propertyFromPath(a,Me.Boolean);return h},v.prototype.color=function(a){var h=this.propertyFromPath(a,Me.Color);return h},v.prototype.trigger=function(a){var h=this.propertyFromPath(a,Me.Trigger);return h},v.prototype.enum=function(a){var h=this.propertyFromPath(a,Me.Enum);return h},v.prototype.list=function(a){var h=this.propertyFromPath(a,Me.List);return h},v.prototype.image=function(a){var h=this.propertyFromPath(a,Me.Image);return h},v.prototype.artboard=function(a){var h=this.propertyFromPath(a,Me.Artboard);return h},v.prototype.viewModel=function(a){var h=a.split("/"),w=h.length>1?this.viewModelFromPathSegments(h.slice(0,h.length-1),0):this;return w!=null?w.internalViewModelInstance(h[h.length-1]):null},v.prototype.internalReplaceViewModel=function(a,h){var w;if(h.runtimeInstance!==null){var T=((w=this._runtimeInstance)===null||w===void 0?void 0:w.replaceViewModel(a,h.runtimeInstance))||!1;if(T){h.internalIncrementReferenceCount();var O=this.internalViewModelInstance(a);O!==null&&(O.removeParent(this),this._children.includes(O)&&(this._children=this._children.filter(function(F){return F!==O})),O.cleanup()),this._viewModelInstances.set(a,h),h.addParent(this)}return T}return!1},v.prototype.replaceViewModel=function(a,h){var w,T=a.split("/"),O=T.length>1?this.viewModelFromPathSegments(T.slice(0,T.length-1),0):this;return(w=O?.internalReplaceViewModel(T[T.length-1],h))!==null&&w!==void 0?w:!1},v.prototype.incrementReferenceCount=function(){var a;this._referenceCount++,(a=this._runtimeInstance)===null||a===void 0||a.incrementReferenceCount()},v.prototype.decrementReferenceCount=function(){var a;this._referenceCount--,(a=this._runtimeInstance)===null||a===void 0||a.decrementReferenceCount()},Object.defineProperty(v.prototype,"properties",{get:function(){var a;return((a=this._runtimeInstance)===null||a===void 0?void 0:a.getProperties().map(function(h){return k({},h)}))||[]},enumerable:!1,configurable:!0}),v.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},v.prototype.cleanup=function(){var a=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(T){T.cleanup()}),this._viewModelInstances.clear();var h=I([],this._children,!0);this._children.length=0;var w=I([],this._parents,!0);this._parents.length=0,h.forEach(function(T){T.removeParent(a)}),w.forEach(function(T){T.removeFromViewModelCallbacks(a)})}},v})(),Je=(function(){function v(a,h){this.callbacks=[],this._viewModelInstanceValue=a,this._parentViewModel=h}return v.prototype.on=function(a){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(a)||(this.callbacks.push(a),this._parentViewModel.addToPropertyCallbacks(this))},v.prototype.off=function(a){a?this.callbacks=this.callbacks.filter(function(h){return h!==a}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},v.prototype.internalHandleCallback=function(a){},v.prototype.handleCallbacks=function(){var a=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(h){a.internalHandleCallback(h)})},v.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},v.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(v.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),v})(),tn=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Je),vn=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Je),zt=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Je),Cn=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return a.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},a.prototype.internalHandleCallback=function(h){h()},a})(Je),_t=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(h){this._viewModelInstanceValue.valueIndex=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Je),Ft=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),a.prototype.addInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(h.runtimeInstance),h.addParent(this._parentViewModel))},a.prototype.addInstanceAt=function(h,w){return h.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(h.runtimeInstance,w)?(h.addParent(this._parentViewModel),!0):!1},a.prototype.removeInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(h.runtimeInstance),h.removeParent(this._parentViewModel))},a.prototype.removeInstanceAt=function(h){this._viewModelInstanceValue.removeInstanceAt(h)},a.prototype.instanceAt=function(h){var w=this._viewModelInstanceValue.instanceAt(h);if(w!=null){var T=new bt(w,this._parentViewModel);return T}return null},a.prototype.swap=function(h,w){this._viewModelInstanceValue.swap(h,w)},a.prototype.internalHandleCallback=function(h){h()},a})(Je),pn=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.rgb=function(h,w,T){this._viewModelInstanceValue.rgb(h,w,T)},a.prototype.rgba=function(h,w,T,O){this._viewModelInstanceValue.argb(O,h,w,T)},a.prototype.argb=function(h,w,T,O){this._viewModelInstanceValue.argb(h,w,T,O)},a.prototype.alpha=function(h){this._viewModelInstanceValue.alpha(h)},a.prototype.opacity=function(h){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,h))*255))},a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Je),Nn=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeImage)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Je),nn=(function(v){y(a,v);function a(h,w){return v.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeArtboard)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Je),Er=function(v){return E(void 0,void 0,void 0,function(){var a,h,w;return _(this,function(T){switch(T.label){case 0:return a=new Request(v),[4,fetch(a)];case 1:return h=T.sent(),[4,h.arrayBuffer()];case 2:return w=T.sent(),[2,w]}})})},kt=function(v){return typeof v=="string"?[v]:v instanceof Array?v:[]},li={EventManager:De,TaskQueueManager:Ke},Ar=function(v){return E(void 0,void 0,void 0,function(){var a,h,w;return _(this,function(T){switch(T.label){case 0:return a=new Promise(function(O){return G.getInstance(function(F){F.decodeAudio(v,O)})}),[4,a];case 1:return h=T.sent(),w=new g.AudioWrapper(h),g.finalizationRegistry.register(w,h),[2,w]}})})},J=function(v){return E(void 0,void 0,void 0,function(){var a,h,w;return _(this,function(T){switch(T.label){case 0:return a=new Promise(function(O){return G.getInstance(function(F){F.decodeImage(v,O)})}),[4,a];case 1:return h=T.sent(),w=new g.ImageWrapper(h),g.finalizationRegistry.register(w,h),[2,w]}})})},re=function(v){return E(void 0,void 0,void 0,function(){var a,h,w;return _(this,function(T){switch(T.label){case 0:return a=new Promise(function(O){return G.getInstance(function(F){F.decodeFont(v,O)})}),[4,a];case 1:return h=T.sent(),w=new g.FontWrapper(h),g.finalizationRegistry.register(w,h),[2,w]}})})}})(),l})())})(fs)),fs.exports}var ih=rh();const ks="dracula",sh="dracula_story_v3.json",Es="https://vycjpmuyscfygstjjied.supabase.co";var oh=be('<div class="rive-wrapper svelte-nkuq4r"><canvas width="250" height="500" class="svelte-nkuq4r"></canvas></div>');function $a(n,e){xi(e,!0);let t=Ze(void 0);Uo(()=>{if(!C(t))return;const l=new ih.Rive({src:`${Es}/storage/v1/object/public/${ks}/${e.fileName}`,canvas:C(t),autoplay:!0,stateMachines:"SM1"});return()=>{l.cleanup()}});var r=oh(),o=V(r);Yc(o,l=>fe(t,l),()=>C(t)),ae(n,r),Mi()}function ah(n,e){C(e)?.nextDialogueId&&Mt.goToDialogue(C(e).nextDialogueId)}var lh=be('<img alt="BG" class="background-image svelte-ik8jti"/>'),uh=be('<div class="background-media svelte-ik8jti"><!></div>'),ch=be('<img alt="Char" class="character-image svelte-ik8jti"/>'),hh=be('<div class="character-media svelte-ik8jti"><!></div>'),dh=(n,e,t)=>e(C(t)),fh=be('<button class="option-button svelte-ik8jti"> </button>'),vh=be('<div class="options-container svelte-ik8jti"></div>'),ph=be('<div class="next-container svelte-ik8jti"><button class="next-button svelte-ik8jti">Далее...</button></div>'),gh=be('<div class="dialogue-container svelte-ik8jti"><!> <!> <div class="dialogue-content svelte-ik8jti"><div class="dialogue-text svelte-ik8jti"> </div> <!></div></div>'),_h=be("<p> </p>");function Kl(n,e){xi(e,!0);const t=Kr(()=>e.dialogue||Mt.findDialogue(Mt.currentDialogueId));ys(()=>{C(t)?.onEnter&&Mt.runActions(C(t).onEnter)});function r(g){if(g.actions&&Mt.runActions(g.actions),g.miniGame){console.log("Запуск мини-игры:",g.miniGame.id),Mt.goToDialogue(g.miniGame.onWinDialogueId);return}g.nextDialogueId&&Mt.goToDialogue(g.nextDialogueId)}function o(g){return g.visibleIf&&g.visibleIf.hasItem?Mt.hasItem(g.visibleIf.hasItem):!0}var l=Fn(),c=Xt(l);{var f=g=>{var y=gh(),k=V(y);{var E=K=>{var j=uh(),M=V(j);{var oe=ce=>{var Q=Fn(),he=Xt(Q);Pa(he,()=>C(t).backgroundImage,De=>{$a(De,{get fileName(){return C(t).backgroundImage}})}),ae(ce,Q)},le=ce=>{var Q=lh();et(()=>Ra(Q,"src",`${Es}/storage/v1/object/public/${ks}/${C(t).backgroundImage}`)),ae(ce,Q)};Qe(M,ce=>{C(t).backgroundImage.endsWith(".riv")?ce(oe):ce(le,!1)})}ae(K,j)};Qe(k,K=>{C(t).backgroundImage&&K(E)})}var _=Z(k,2);{var I=K=>{var j=hh(),M=V(j);{var oe=ce=>{var Q=Fn(),he=Xt(Q);Pa(he,()=>C(t).characterImage,De=>{$a(De,{get fileName(){return C(t).characterImage}})}),ae(ce,Q)},le=ce=>{var Q=ch();et(()=>Ra(Q,"src",`${Es}/storage/v1/object/public/${ks}/${C(t).characterImage}`)),ae(ce,Q)};Qe(M,ce=>{C(t).characterImage.endsWith(".riv")?ce(oe):ce(le,!1)})}ae(K,j)};Qe(_,K=>{C(t).characterImage&&K(I)})}var L=Z(_,2),$=V(L),z=V($),U=Z($,2);{var N=K=>{var j=vh();xt(j,21,()=>C(t).options,M=>M.text,(M,oe)=>{var le=Fn(),ce=Xt(le);{var Q=he=>{var De=fh();De.__click=[dh,r,oe];var Ke=V(De);et(()=>nt(Ke,C(oe).text)),ae(he,De)};Qe(ce,he=>{o(C(oe))&&he(Q)})}ae(M,le)}),ae(K,j)},G=K=>{var j=Fn(),M=Xt(j);{var oe=le=>{var ce=ph(),Q=V(ce);Q.__click=[ah,t],ae(le,ce)};Qe(M,le=>{C(t).nextDialogueId&&le(oe)},!0)}ae(K,j)};Qe(U,K=>{C(t).options&&C(t).options.length>0?K(N):K(G,!1)})}et(()=>nt(z,C(t).text)),ae(g,y)},p=g=>{var y=_h(),k=V(y);et(()=>nt(k,`Диалог не найден (ID: ${Mt.currentDialogueId??""})`)),ae(g,y)};Qe(c,g=>{C(t)?g(f):g(p,!1)})}ae(n,l),Mi()}Vl(["click"]);var mh=be('<div class="loading svelte-fgmugb"><p>🔄 Загрузка истории...</p></div>'),yh=be('<div class="error svelte-fgmugb"> </div>'),wh=be('<div class="dialogues-container svelte-fgmugb"><!></div>'),bh=be('<div class="app svelte-fgmugb"><!></div>');function kh(n,e){xi(e,!1);let t=`${Es}/storage/v1/object/public/${ks}/${sh}`;Uo(async()=>{console.log("Загружаем историю из:",t),await Mt.loadStory(t)}),Jc();var r=bh(),o=V(r);{var l=f=>{var p=mh();ae(f,p)},c=f=>{var p=Fn(),g=Xt(p);{var y=E=>{var _=yh(),I=V(_);et(()=>nt(I,`⚠️ ${Mt.error??""}`)),ae(E,_)},k=E=>{var _=wh(),I=V(_);{var L=$=>{Kl($,{})};Qe(I,$=>{Mt.storyData&&$(L)})}ae(E,_)};Qe(g,E=>{Mt.error?E(y):E(k,!1)},!0)}ae(f,p)};Qe(o,f=>{Mt.isLoading?f(l):f(c,!1)})}ae(n,r),Mi()}const Eh="modulepreload",Ah=function(n,e){return new URL(n,e).href},Fa={},$i=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(k=>Promise.resolve(k).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};const c=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=g(t.map(y=>{if(y=Ah(y,r),y in Fa)return;Fa[y]=!0;const k=y.endsWith(".css"),E=k?'[rel="stylesheet"]':"";if(!!r)for(let L=c.length-1;L>=0;L--){const $=c[L];if($.href===y&&(!k||$.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${E}`))return;const I=document.createElement("link");if(I.rel=k?"stylesheet":Eh,k||(I.as="script"),I.crossOrigin="",I.href=y,p&&I.setAttribute("nonce",p),document.head.appendChild(I),k)return new Promise((L,$)=>{I.addEventListener("load",L),I.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return o.then(c=>{for(const f of c||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})},Sh=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>ai);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class qo extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Ch extends qo{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Da extends qo{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ua extends qo{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ho;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(ho||(ho={}));var Th=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};class Ih{constructor(e,{headers:t={},customFetch:r,region:o=ho.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=Sh(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Th(this,void 0,void 0,function*(){try{const{headers:o,method:l,body:c}=t;let f={},{region:p}=t;p||(p=this.region);const g=new URL(`${this.url}/${e}`);p&&p!=="any"&&(f["x-region"]=p,g.searchParams.set("forceFunctionRegion",p));let y;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=c):typeof c=="string"?(f["Content-Type"]="text/plain",y=c):typeof FormData<"u"&&c instanceof FormData?y=c:(f["Content-Type"]="application/json",y=JSON.stringify(c)));const k=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:y}).catch(L=>{throw new Ch(L)}),E=k.headers.get("x-relay-error");if(E&&E==="true")throw new Da(k);if(!k.ok)throw new Ua(k);let _=((r=k.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),I;return _==="application/json"?I=yield k.json():_==="application/octet-stream"?I=yield k.blob():_==="text/event-stream"?I=k:_==="multipart/form-data"?I=yield k.formData():I=yield k.text(),{data:I,error:null,response:k}}catch(o){return{data:null,error:o,response:o instanceof Ua||o instanceof Da?o.context:void 0}}})}}var dt={},Dr={},Ur={},qr={},Nr={},Br={},Ph=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ni=Ph();const Rh=ni.fetch,Yl=ni.fetch.bind(ni),Jl=ni.Headers,jh=ni.Request,Oh=ni.Response,ai=Object.freeze(Object.defineProperty({__proto__:null,Headers:Jl,Request:jh,Response:Oh,default:Yl,fetch:Rh},Symbol.toStringTag,{value:"Module"})),xh=th(ai);var os={},qa;function Xl(){if(qa)return os;qa=1,Object.defineProperty(os,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return os.default=n,os}var Na;function Ql(){if(Na)return Br;Na=1;var n=Br&&Br.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Br,"__esModule",{value:!0});const e=n(xh),t=n(Xl());class r{constructor(l){var c,f;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(f=l.isMaybeSingle)!==null&&f!==void 0?f:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let p=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var y,k,E,_;let I=null,L=null,$=null,z=g.status,U=g.statusText;if(g.ok){if(this.method!=="HEAD"){const j=await g.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?L=j:L=JSON.parse(j))}const G=(k=this.headers.get("Prefer"))===null||k===void 0?void 0:k.match(/count=(exact|planned|estimated)/),K=(E=g.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&K&&K.length>1&&($=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(L)&&(L.length>1?(I={code:"PGRST116",details:`Results contain ${L.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},L=null,$=null,z=406,U="Not Acceptable"):L.length===1?L=L[0]:L=null)}else{const G=await g.text();try{I=JSON.parse(G),Array.isArray(I)&&g.status===404&&(L=[],I=null,z=200,U="OK")}catch{g.status===404&&G===""?(z=204,U="No Content"):I={message:G}}if(I&&this.isMaybeSingle&&(!((_=I?.details)===null||_===void 0)&&_.includes("0 rows"))&&(I=null,z=200,U="OK"),I&&this.shouldThrowOnError)throw new t.default(I)}return{error:I,data:L,count:$,status:z,statusText:U}});return this.shouldThrowOnError||(p=p.catch(g=>{var y,k,E;return{error:{message:`${(y=g?.name)!==null&&y!==void 0?y:"FetchError"}: ${g?.message}`,details:`${(k=g?.stack)!==null&&k!==void 0?k:""}`,hint:"",code:`${(E=g?.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),p.then(l,c)}returns(){return this}overrideTypes(){return this}}return Br.default=r,Br}var Ba;function Zl(){if(Ba)return Nr;Ba=1;var n=Nr&&Nr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Nr,"__esModule",{value:!0});const e=n(Ql());class t extends e.default{select(o){let l=!1;const c=(o??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:l=!0,nullsFirst:c,foreignTable:f,referencedTable:p=f}={}){const g=p?`${p}.order`:"order",y=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${y?`${y},`:""}${o}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${o}`),this}range(o,l,{foreignTable:c,referencedTable:f=c}={}){const p=typeof f>"u"?"offset":`${f}.offset`,g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(p,`${o}`),this.url.searchParams.set(g,`${l-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:l=!1,settings:c=!1,buffers:f=!1,wal:p=!1,format:g="text"}={}){var y;const k=[o?"analyze":null,l?"verbose":null,c?"settings":null,f?"buffers":null,p?"wal":null].filter(Boolean).join("|"),E=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${E}"; options=${k};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return Nr.default=t,Nr}var Wa;function No(){if(Wa)return qr;Wa=1;var n=qr&&qr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(qr,"__esModule",{value:!0});const e=n(Zl());class t extends e.default{eq(o,l){return this.url.searchParams.append(o,`eq.${l}`),this}neq(o,l){return this.url.searchParams.append(o,`neq.${l}`),this}gt(o,l){return this.url.searchParams.append(o,`gt.${l}`),this}gte(o,l){return this.url.searchParams.append(o,`gte.${l}`),this}lt(o,l){return this.url.searchParams.append(o,`lt.${l}`),this}lte(o,l){return this.url.searchParams.append(o,`lte.${l}`),this}like(o,l){return this.url.searchParams.append(o,`like.${l}`),this}likeAllOf(o,l){return this.url.searchParams.append(o,`like(all).{${l.join(",")}}`),this}likeAnyOf(o,l){return this.url.searchParams.append(o,`like(any).{${l.join(",")}}`),this}ilike(o,l){return this.url.searchParams.append(o,`ilike.${l}`),this}ilikeAllOf(o,l){return this.url.searchParams.append(o,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(o,l){return this.url.searchParams.append(o,`ilike(any).{${l.join(",")}}`),this}is(o,l){return this.url.searchParams.append(o,`is.${l}`),this}in(o,l){const c=Array.from(new Set(l)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(o,`in.(${c})`),this}contains(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cs.{${l.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(l)}`),this}containedBy(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cd.{${l.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(l)}`),this}rangeGt(o,l){return this.url.searchParams.append(o,`sr.${l}`),this}rangeGte(o,l){return this.url.searchParams.append(o,`nxl.${l}`),this}rangeLt(o,l){return this.url.searchParams.append(o,`sl.${l}`),this}rangeLte(o,l){return this.url.searchParams.append(o,`nxr.${l}`),this}rangeAdjacent(o,l){return this.url.searchParams.append(o,`adj.${l}`),this}overlaps(o,l){return typeof l=="string"?this.url.searchParams.append(o,`ov.${l}`):this.url.searchParams.append(o,`ov.{${l.join(",")}}`),this}textSearch(o,l,{config:c,type:f}={}){let p="";f==="plain"?p="pl":f==="phrase"?p="ph":f==="websearch"&&(p="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(o,`${p}fts${g}.${l}`),this}match(o){return Object.entries(o).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(o,l,c){return this.url.searchParams.append(o,`not.${l}.${c}`),this}or(o,{foreignTable:l,referencedTable:c=l}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${o})`),this}filter(o,l,c){return this.url.searchParams.append(o,`${l}.${c}`),this}}return qr.default=t,qr}var Va;function eu(){if(Va)return Ur;Va=1;var n=Ur&&Ur.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ur,"__esModule",{value:!0});const e=n(No());class t{constructor(o,{headers:l={},schema:c,fetch:f}){this.url=o,this.headers=new Headers(l),this.schema=c,this.fetch=f}select(o,{head:l=!1,count:c}={}){const f=l?"HEAD":"GET";let p=!1;const g=(o??"*").split("").map(y=>/\s/.test(y)&&!p?"":(y==='"'&&(p=!p),y)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:l,defaultToNull:c=!0}={}){var f;const p="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const g=o.reduce((y,k)=>y.concat(Object.keys(k)),[]);if(g.length>0){const y=[...new Set(g)].map(k=>`"${k}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(o,{onConflict:l,ignoreDuplicates:c=!1,count:f,defaultToNull:p=!0}={}){var g;const y="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),f&&this.headers.append("Prefer",`count=${f}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const k=o.reduce((E,_)=>E.concat(Object.keys(_)),[]);if(k.length>0){const E=[...new Set(k)].map(_=>`"${_}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(o,{count:l}={}){var c;const f="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:o}={}){var l;const c="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Ur.default=t,Ur}var Ha;function Mh(){if(Ha)return Dr;Ha=1;var n=Dr&&Dr.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Dr,"__esModule",{value:!0});const e=n(eu()),t=n(No());class r{constructor(l,{headers:c={},schema:f,fetch:p}={}){this.url=l,this.headers=new Headers(c),this.schemaName=f,this.fetch=p}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:f=!1,get:p=!1,count:g}={}){var y;let k;const E=new URL(`${this.url}/rpc/${l}`);let _;f||p?(k=f?"HEAD":"GET",Object.entries(c).filter(([L,$])=>$!==void 0).map(([L,$])=>[L,Array.isArray($)?`{${$.join(",")}}`:`${$}`]).forEach(([L,$])=>{E.searchParams.append(L,$)})):(k="POST",_=c);const I=new Headers(this.headers);return g&&I.set("Prefer",`count=${g}`),new t.default({method:k,url:E,headers:I,schema:this.schemaName,body:_,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Dr.default=r,Dr}var za;function Lh(){if(za)return dt;za=1;var n=dt&&dt.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(dt,"__esModule",{value:!0}),dt.PostgrestError=dt.PostgrestBuilder=dt.PostgrestTransformBuilder=dt.PostgrestFilterBuilder=dt.PostgrestQueryBuilder=dt.PostgrestClient=void 0;const e=n(Mh());dt.PostgrestClient=e.default;const t=n(eu());dt.PostgrestQueryBuilder=t.default;const r=n(No());dt.PostgrestFilterBuilder=r.default;const o=n(Zl());dt.PostgrestTransformBuilder=o.default;const l=n(Ql());dt.PostgrestBuilder=l.default;const c=n(Xl());return dt.PostgrestError=c.default,dt.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default},dt}var $h=Lh();const Fh=eh($h),{PostgrestClient:Dh,PostgrestQueryBuilder:pv,PostgrestFilterBuilder:gv,PostgrestTransformBuilder:_v,PostgrestBuilder:mv,PostgrestError:yv}=Fh;class Uh{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const qh="2.15.1",Nh=`realtime-js/${qh}`,Bh="1.0.0",fo=1e4,Wh=1e3,Vh=100;var Ei;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ei||(Ei={}));var at;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(at||(at={}));var dn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(dn||(dn={}));var vo;(function(n){n.websocket="websocket"})(vo||(vo={}));var vr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(vr||(vr={}));class Hh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const f=r.decode(e.slice(c,c+o));c=c+o;const p=r.decode(e.slice(c,c+l));c=c+l;const g=JSON.parse(r.decode(e.slice(c,e.byteLength)));return{ref:null,topic:f,event:p,payload:g}}}class tu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var We;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(We||(We={}));const Ga=(n,e,t={})=>{var r;const o=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((l,c)=>(l[c]=zh(c,n,e,o),l),{})},zh=(n,e,t,r)=>{const o=e.find(f=>f.name===n),l=o?.type,c=t[n];return l&&!r.includes(l)?nu(l,c):po(c)},nu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Jh(e,t)}switch(n){case We.bool:return Gh(e);case We.float4:case We.float8:case We.int2:case We.int4:case We.int8:case We.numeric:case We.oid:return Kh(e);case We.json:case We.jsonb:return Yh(e);case We.timestamp:return Xh(e);case We.abstime:case We.date:case We.daterange:case We.int4range:case We.int8range:case We.money:case We.reltime:case We.text:case We.time:case We.timestamptz:case We.timetz:case We.tsrange:case We.tstzrange:return po(e);default:return po(e)}},po=n=>n,Gh=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Kh=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Yh=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Jh=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(f=>nu(e,f))}return n},Xh=n=>typeof n=="string"?n.replace(" ","T"):n,ru=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Qs{constructor(e,t,r={},o=fo){this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ka;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ka||(Ka={}));class Ai{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ai.syncState(this.state,o,l,c),this.pendingDiffs.forEach(p=>{this.state=Ai.syncDiff(this.state,p,l,c)}),this.pendingDiffs=[],f()}),this.channel._on(r.diff,{},o=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Ai.syncDiff(this.state,o,l,c),f())}),this.onJoin((o,l,c)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:c})}),this.onLeave((o,l,c)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const l=this.cloneDeep(e),c=this.transformState(t),f={},p={};return this.map(l,(g,y)=>{c[g]||(p[g]=y)}),this.map(c,(g,y)=>{const k=l[g];if(k){const E=y.map($=>$.presence_ref),_=k.map($=>$.presence_ref),I=y.filter($=>_.indexOf($.presence_ref)<0),L=k.filter($=>E.indexOf($.presence_ref)<0);I.length>0&&(f[g]=I),L.length>0&&(p[g]=L)}else f[g]=y}),this.syncDiff(l,{joins:f,leaves:p},r,o)}static syncDiff(e,t,r,o){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(l,(f,p)=>{var g;const y=(g=e[f])!==null&&g!==void 0?g:[];if(e[f]=this.cloneDeep(p),y.length>0){const k=e[f].map(_=>_.presence_ref),E=y.filter(_=>k.indexOf(_.presence_ref)<0);e[f].unshift(...E)}r(f,y,p)}),this.map(c,(f,p)=>{let g=e[f];if(!g)return;const y=p.map(k=>k.presence_ref);g=g.filter(k=>y.indexOf(k.presence_ref)<0),e[f]=g,o(f,g,p),g.length===0&&delete e[f]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return"metas"in o?t[r]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[r]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ya;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Ya||(Ya={}));var Si;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Si||(Si={}));var $n;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})($n||($n={}));class Bo{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=at.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Qs(this,dn.join,this.params,this.timeout),this.rejoinTimer=new tu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=at.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=at.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this._on(dn.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Ai(this),this.broadcastEndpointURL=ru(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==at.closed){const{config:{broadcast:l,presence:c,private:f}}=this.params,p=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(E=>E.filter))!==null&&o!==void 0?o:[],g=!!this.bindings[Si.PRESENCE]&&this.bindings[Si.PRESENCE].length>0,y={},k={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:p,private:f};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(E=>e?.($n.CHANNEL_ERROR,E)),this._onClose(()=>e?.($n.CLOSED)),this.updateJoinPayload(Object.assign({config:k},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:E})=>{var _;if(this.socket.setAuth(),E===void 0){e?.($n.SUBSCRIBED);return}else{const I=this.bindings.postgres_changes,L=(_=I?.length)!==null&&_!==void 0?_:0,$=[];for(let z=0;z<L;z++){const U=I[z],{filter:{event:N,schema:G,table:K,filter:j}}=U,M=E&&E[z];if(M&&M.event===N&&M.schema===G&&M.table===K&&M.filter===j)$.push(Object.assign(Object.assign({},U),{id:M.id}));else{this.unsubscribe(),this.state=at.errored,e?.($n.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=$,e&&e($n.SUBSCRIBED);return}}).receive("error",E=>{this.state=at.errored,e?.($n.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{e?.($n.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===at.joined&&e===Si.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=g.body)===null||o===void 0?void 0:o.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,f,p;const g=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((p=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||p===void 0)&&p.ack)&&l("ok"),g.receive("ok",()=>l("ok")),g.receive("error",()=>l("error")),g.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=at.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(dn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Qs(this,dn.leave,{},e),r.receive("ok",()=>{t(),o("ok")}).receive("timeout",()=>{t(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=at.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const o=new AbortController,l=setTimeout(()=>o.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(l),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Qs(this,e,t,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Vh){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,l;const c=e.toLocaleLowerCase(),{close:f,error:p,leave:g,join:y}=dn;if(r&&[f,p,g,y].indexOf(c)>=0&&r!==this._joinRef())return;let E=this._onMessage(c,t,r);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(_=>{var I,L,$;return((I=_.filter)===null||I===void 0?void 0:I.event)==="*"||(($=(L=_.filter)===null||L===void 0?void 0:L.event)===null||$===void 0?void 0:$.toLocaleLowerCase())===c}).map(_=>_.callback(E,r)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var I,L,$,z,U,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const G=_.id,K=(I=_.filter)===null||I===void 0?void 0:I.event;return G&&((L=t.ids)===null||L===void 0?void 0:L.includes(G))&&(K==="*"||K?.toLocaleLowerCase()===(($=t.data)===null||$===void 0?void 0:$.type.toLocaleLowerCase()))}else{const G=(U=(z=_?.filter)===null||z===void 0?void 0:z.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return G==="*"||G===((N=t?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof E=="object"&&"ids"in E){const I=E.data,{schema:L,table:$,commit_timestamp:z,type:U,errors:N}=I;E=Object.assign(Object.assign({},{schema:L,table:$,commit_timestamp:z,eventType:U,new:{},old:{},errors:N}),this._getPayloadRecords(I))}_.callback(E,r)})}_isClosed(){return this.state===at.closed}_isJoined(){return this.state===at.joined}_isJoining(){return this.state===at.joining}_isLeaving(){return this.state===at.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const o=e.toLocaleLowerCase(),l={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&Bo.isEqual(o.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(dn.close,{},e)}_onError(e){this._on(dn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=at.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ga(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ga(e.columns,e.old_record)),t}}const Ja=()=>{},as={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Qh=[1e3,2e3,5e3,1e4],Zh=1e4,ed=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class td{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=fo,this.transport=null,this.heartbeatIntervalMs=as.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ja,this.ref=0,this.reconnectTimer=null,this.logger=Ja,this.conn=null,this.sendBuffer=[],this.serializer=new Hh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let l;return o?l=o:typeof fetch>"u"?l=(...c)=>$i(async()=>{const{default:f}=await Promise.resolve().then(()=>ai);return{default:f}},void 0,import.meta.url).then(({default:f})=>f(...c)).catch(f=>{throw new Error(`Failed to load @supabase/node-fetch: ${f.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${vo.websocket}`,this.httpEndpoint=ru(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Uh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Bh}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ei.connecting:return vr.Connecting;case Ei.open:return vr.Open;case Ei.closing:return vr.Closing;default:return vr.Closed}}isConnected(){return this.connectionState()===vr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(l=>l.topic===r);if(o)return o;{const l=new Bo(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:r,payload:o,ref:l}=e,c=()=>{this.encode(e,f=>{var p;(p=this.conn)===null||p===void 0||p.send(f)})};this.log("push",`${t} ${r} (${l})`,o),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Wh,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},as.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:l,ref:c}=t,f=c?`(${c})`:"",p=l.status||"";this.log("receive",`${p} ${r} ${o} ${f}`.trim(),l),this.channels.filter(g=>g._isMember(r)).forEach(g=>g._trigger(o,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(dn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${r}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([ed],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const o={access_token:t,version:Nh};t&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(dn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new tu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},as.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,o,l,c,f,p,g;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:fo,this.heartbeatIntervalMs=(o=e?.heartbeatIntervalMs)!==null&&o!==void 0?o:as.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(y=>Qh[y-1]||Zh),this.encode=(p=e?.encode)!==null&&p!==void 0?p:((y,k)=>k(JSON.stringify(y))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Wo extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function lt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class nd extends Wo{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class go extends Wo{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var rd=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};const iu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>ai);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},id=()=>rd(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $i(()=>Promise.resolve().then(()=>ai),void 0,import.meta.url)).Response:Response}),_o=n=>{if(Array.isArray(n))return n.map(t=>_o(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const o=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[o]=_o(r)}),e},sd=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var kr=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};const Zs=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),od=(n,e,t)=>kr(void 0,void 0,void 0,function*(){const r=yield id();n instanceof r&&!t?.noResolveJson?n.json().then(o=>{const l=n.status||500,c=o?.statusCode||l+"";e(new nd(Zs(o),l,c))}).catch(o=>{e(new go(Zs(o),o))}):e(new go(Zs(n),n))}),ad=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"||!r?o:(sd(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(r)):o.body=r,e?.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),t))};function Fi(n,e,t,r,o,l){return kr(this,void 0,void 0,function*(){return new Promise((c,f)=>{n(t,ad(e,r,o,l)).then(p=>{if(!p.ok)throw p;return r?.noResolveJson?p:p.json()}).then(p=>c(p)).catch(p=>od(p,f,r))})})}function As(n,e,t,r){return kr(this,void 0,void 0,function*(){return Fi(n,"GET",e,t,r)})}function bn(n,e,t,r,o){return kr(this,void 0,void 0,function*(){return Fi(n,"POST",e,r,o,t)})}function mo(n,e,t,r,o){return kr(this,void 0,void 0,function*(){return Fi(n,"PUT",e,r,o,t)})}function ld(n,e,t,r){return kr(this,void 0,void 0,function*(){return Fi(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function su(n,e,t,r,o){return kr(this,void 0,void 0,function*(){return Fi(n,"DELETE",e,r,o,t)})}var St=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};const ud={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Xa={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cd{constructor(e,t={},r,o){this.url=e,this.headers=t,this.bucketId=r,this.fetch=iu(o)}uploadOrUpdate(e,t,r,o){return St(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Xa),o);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const p=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),p&&l.append("metadata",this.encodeMetadata(p)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),p&&l.append("metadata",this.encodeMetadata(p))):(l=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,p&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(p)))),o?.headers&&(f=Object.assign(Object.assign({},f),o.headers));const g=this._removeEmptyFolders(t),y=this._getFinalPath(g),k=yield(e=="PUT"?mo:bn)(this.fetch,`${this.url}/object/${y}`,l,Object.assign({headers:f},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:k.Id,fullPath:k.Key},error:null}}catch(l){if(lt(l))return{data:null,error:l};throw l}})}upload(e,t,r){return St(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return St(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let p;const g=Object.assign({upsert:Xa.upsert},o),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&r instanceof Blob?(p=new FormData,p.append("cacheControl",g.cacheControl),p.append("",r)):typeof FormData<"u"&&r instanceof FormData?(p=r,p.append("cacheControl",g.cacheControl)):(p=r,y["cache-control"]=`max-age=${g.cacheControl}`,y["content-type"]=g.contentType);const k=yield mo(this.fetch,f.toString(),p,{headers:y});return{data:{path:l,fullPath:k.Key},error:null}}catch(p){if(lt(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(e,t){return St(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);t?.upsert&&(o["x-upsert"]="true");const l=yield bn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),c=new URL(this.url+l.url),f=c.searchParams.get("token");if(!f)throw new Wo("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:f},error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}update(e,t,r){return St(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return St(this,void 0,void 0,function*(){try{return{data:yield bn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}copy(e,t,r){return St(this,void 0,void 0,function*(){try{return{data:{path:(yield bn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return St(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),l=yield bn(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return St(this,void 0,void 0,function*(){try{const o=yield bn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}download(e,t){return St(this,void 0,void 0,function*(){const o=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const f=this._getFinalPath(e);return{data:yield(yield As(this.fetch,`${this.url}/${o}/${f}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(lt(f))return{data:null,error:f};throw f}})}info(e){return St(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield As(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:_o(r),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}exists(e){return St(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield ld(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(lt(r)&&r instanceof go){const o=r.originalError;if([400,404].includes(o?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&o.push(l);const f=typeof t?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(t?.transform||{});p!==""&&o.push(p);let g=o.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${r}${g}`)}}}remove(e){return St(this,void 0,void 0,function*(){try{return{data:yield su(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}list(e,t,r){return St(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},ud),t),{prefix:e||""});return{data:yield bn(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}listV2(e,t){return St(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield bn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const hd="2.11.0",dd={"X-Client-Info":`storage-js/${hd}`};var Wr=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};class fd{constructor(e,t={},r,o){const l=new URL(e);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},dd),t),this.fetch=iu(r)}listBuckets(){return Wr(this,void 0,void 0,function*(){try{return{data:yield As(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(lt(e))return{data:null,error:e};throw e}})}getBucket(e){return Wr(this,void 0,void 0,function*(){try{return{data:yield As(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Wr(this,void 0,void 0,function*(){try{return{data:yield bn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Wr(this,void 0,void 0,function*(){try{return{data:yield mo(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Wr(this,void 0,void 0,function*(){try{return{data:yield bn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Wr(this,void 0,void 0,function*(){try{return{data:yield su(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}}class vd extends fd{constructor(e,t={},r,o){super(e,t,r,o)}from(e){return new cd(this.url,this.headers,e,this.fetch)}}const pd="2.56.0";let wi="";typeof Deno<"u"?wi="deno":typeof document<"u"?wi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?wi="react-native":wi="node";const gd={"X-Client-Info":`supabase-js-${wi}/${pd}`},_d={headers:gd},md={schema:"public"},yd={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wd={};var bd=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};const kd=n=>{let e;return n?e=n:typeof fetch>"u"?e=Yl:e=fetch,(...t)=>e(...t)},Ed=()=>typeof Headers>"u"?Jl:Headers,Ad=(n,e,t)=>{const r=kd(t),o=Ed();return(l,c)=>bd(void 0,void 0,void 0,function*(){var f;const p=(f=yield e())!==null&&f!==void 0?f:n;let g=new o(c?.headers);return g.has("apikey")||g.set("apikey",n),g.has("Authorization")||g.set("Authorization",`Bearer ${p}`),r(l,Object.assign(Object.assign({},c),{headers:g}))})};var Sd=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};function Cd(n){return n.endsWith("/")?n:n+"/"}function Td(n,e){var t,r;const{db:o,auth:l,realtime:c,global:f}=n,{db:p,auth:g,realtime:y,global:k}=e,E={db:Object.assign(Object.assign({},p),o),auth:Object.assign(Object.assign({},g),l),realtime:Object.assign(Object.assign({},y),c),storage:{},global:Object.assign(Object.assign(Object.assign({},k),f),{headers:Object.assign(Object.assign({},(t=k?.headers)!==null&&t!==void 0?t:{}),(r=f?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Sd(this,void 0,void 0,function*(){return""})};return n.accessToken?E.accessToken=n.accessToken:delete E.accessToken,E}const ou="2.71.1",Yr=30*1e3,yo=3,eo=yo*Yr,Id="http://localhost:9999",Pd="supabase.auth.token",Rd={"X-Client-Info":`gotrue-js/${ou}`},wo="X-Supabase-Api-Version",au={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},jd=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Od=600*1e3;class Vo extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function pe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class xd extends Vo{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Md(n){return pe(n)&&n.name==="AuthApiError"}class lu extends Vo{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Zn extends Vo{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class zn extends Zn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ld(n){return pe(n)&&n.name==="AuthSessionMissingError"}class ls extends Zn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class us extends Zn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class cs extends Zn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function $d(n){return pe(n)&&n.name==="AuthImplicitGrantRedirectError"}class Qa extends Zn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bo extends Zn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function to(n){return pe(n)&&n.name==="AuthRetryableFetchError"}class Za extends Zn{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class ko extends Zn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ss="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),el=` 	
\r=`.split(""),Fd=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<el.length;e+=1)n[el[e].charCodeAt(0)]=-2;for(let e=0;e<Ss.length;e+=1)n[Ss[e].charCodeAt(0)]=e;return n})();function tl(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ss[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ss[r]),e.queuedBits-=6}}function uu(n,e,t){const r=Fd[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function nl(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=c=>{qd(c,r,t)};for(let c=0;c<n.length;c+=1)uu(n.charCodeAt(c),o,l);return e.join("")}function Dd(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Ud(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|o)+65536,t+=1}Dd(r,e)}}function qd(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Nd(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<n.length;o+=1)uu(n.charCodeAt(o),t,r);return new Uint8Array(e)}function Bd(n){const e=[];return Ud(n,t=>e.push(t)),new Uint8Array(e)}function Wd(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};return n.forEach(o=>tl(o,t,r)),tl(null,t,r),e.join("")}function Vd(n){return Math.round(Date.now()/1e3)+n}function Hd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const hn=()=>typeof window<"u"&&typeof document<"u",cr={tested:!1,writable:!1},cu=()=>{if(!hn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(cr.tested)return cr.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),cr.tested=!0,cr.writable=!0}catch{cr.tested=!0,cr.writable=!1}return cr.writable};function zd(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,l)=>{e[l]=o})}catch{}return t.searchParams.forEach((r,o)=>{e[o]=r}),e}const hu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>ai);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Gd=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Jr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},hr=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Hn=async(n,e)=>{await n.removeItem(e)};class $s{constructor(){this.promise=new $s.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}$s.promiseConstructor=Promise;function no(n){const e=n.split(".");if(e.length!==3)throw new ko("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!jd.test(e[r]))throw new ko("JWT not in base64url format");return{header:JSON.parse(nl(e[0])),payload:JSON.parse(nl(e[1])),signature:Nd(e[2]),raw:{header:e[0],payload:e[1]}}}async function Kd(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Yd(n,e){return new Promise((r,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){r(c);return}}catch(c){if(!e(l,c)){o(c);return}}})()})}function Jd(n){return("0"+n.toString(16)).substr(-2)}function Xd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let o="";for(let l=0;l<56;l++)o+=t.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,Jd).join("")}async function Qd(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function Zd(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Qd(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Vr(n,e,t=!1){const r=Xd();let o=r;t&&(o+="/PASSWORD_RECOVERY"),await Jr(n,`${e}-code-verifier`,o);const l=await Zd(r);return[l,r===l?"plain":"s256"]}const ef=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function tf(n){const e=n.headers.get(wo);if(!e||!e.match(ef))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function nf(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function rf(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hr(n){if(!sf.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ro(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function rl(n){return JSON.parse(JSON.stringify(n))}var of=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};const dr=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),af=[502,503,504];async function il(n){var e;if(!Gd(n))throw new bo(dr(n),0);if(af.includes(n.status))throw new bo(dr(n),n.status);let t;try{t=await n.json()}catch(l){throw new lu(dr(l),l)}let r;const o=tf(n);if(o&&o.getTime()>=au["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Za(dr(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new zn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Za(dr(t),n.status,t.weak_password.reasons);throw new xd(dr(t),n.status||500,r)}const lf=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),t))};async function Ae(n,e,t,r){var o;const l=Object.assign({},r?.headers);l[wo]||(l[wo]=au["2024-01-01"].name),r?.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(o=r?.query)!==null&&o!==void 0?o:{};r?.redirectTo&&(c.redirect_to=r.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",p=await uf(n,e,t+f,{headers:l,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(p):{data:Object.assign({},p),error:null}}async function uf(n,e,t,r,o,l){const c=lf(e,r,o,l);let f;try{f=await n(t,Object.assign({},c))}catch(p){throw console.error(p),new bo(dr(p),0)}if(f.ok||await il(f),r?.noResolveJson)return f;try{return await f.json()}catch(p){await il(p)}}function Ln(n){var e;let t=null;ff(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Vd(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function sl(n){const e=Ln(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Gn(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function cf(n){return{data:n,error:null}}function hf(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:l}=n,c=of(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:l},p=Object.assign({},c);return{data:{properties:f,user:p},error:null}}function df(n){return n}function ff(n){return n.access_token&&n.refresh_token&&n.expires_in}const io=["global","local","others"];var vf=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};class pf{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=hu(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=io[0]){if(io.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${io.join(", ")}`);try{return await Ae(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Ae(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Gn})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=vf(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=r?.newEmail,delete o.newEmail),await Ae(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:hf,redirectTo:t?.redirectTo})}catch(t){if(pe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ae(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Gn})}catch(t){if(pe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,l,c,f,p;try{const g={nextPage:null,lastPage:0,total:0},y=await Ae(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:df});if(y.error)throw y.error;const k=await y.json(),E=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(p=(f=y.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&p!==void 0?p:[];return _.length>0&&(_.forEach(I=>{const L=parseInt(I.split(";")[0].split("=")[1].substring(0,1)),$=JSON.parse(I.split(";")[1].split("=")[1]);g[`${$}Page`]=L}),g.total=parseInt(E)),{data:Object.assign(Object.assign({},k),g),error:null}}catch(g){if(pe(g))return{data:{users:[]},error:g};throw g}}async getUserById(e){Hr(e);try{return await Ae(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Gn})}catch(t){if(pe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Hr(e);try{return await Ae(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Gn})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Hr(e);try{return await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Gn})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Hr(e.userId);try{const{data:t,error:r}=await Ae(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:r}}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Hr(e.userId),Hr(e.id);try{return{data:await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(pe(t))return{data:null,error:t};throw t}}}function ol(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function gf(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const zr={debug:!!(globalThis&&cu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class du extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class _f extends du{}async function mf(n,e,t){zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),zr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,o.name);try{return await t()}finally{zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,o.name)}}else{if(e===0)throw zr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new _f(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(zr.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}gf();const yf={url:Id,storageKey:Pd,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Rd,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function al(n,e,t){return await t()}const Gr={};class Ri{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ri.nextInstanceID,Ri.nextInstanceID+=1,this.instanceID>0&&hn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},yf),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new pf({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=hu(o.fetch),this.lock=o.lock||al,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:hn()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=mf:this.lock=al,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:cu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ol(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=ol(this.memoryStorage)),hn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Gr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Gr[this.storageKey]=Object.assign(Object.assign({},Gr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Gr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Gr[this.storageKey]=Object.assign(Object.assign({},Gr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ou}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=zd(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),hn()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:l}=await this._getSessionFromURL(t,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),$d(l)){const p=(e=l.details)===null||e===void 0?void 0:e.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:f}=o;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return pe(t)?{error:t}:{error:new lu("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Ln}),{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const p=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:g,session:p},error:null}}catch(l){if(pe(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(e){var t,r,o;try{let l;if("email"in e){const{email:y,password:k,options:E}=e;let _=null,I=null;this.flowType==="pkce"&&([_,I]=await Vr(this.storage,this.storageKey)),l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E?.emailRedirectTo,body:{email:y,password:k,data:(t=E?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E?.captchaToken},code_challenge:_,code_challenge_method:I},xform:Ln})}else if("phone"in e){const{phone:y,password:k,options:E}=e;l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:k,data:(r=E?.data)!==null&&r!==void 0?r:{},channel:(o=E?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:E?.captchaToken}},xform:Ln})}else throw new us("You must provide either an email or phone number and a password");const{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const p=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:g,session:p},error:null}}catch(l){if(pe(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:f}=e;t=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:sl})}else if("phone"in e){const{phone:l,password:c,options:f}=e;t=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:sl})}else throw new us("You must provide either an email or phone number and a password");const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ls}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,o,l,c,f,p,g,y,k,E,_;let I,L;if("message"in e)I=e.message,L=e.signature;else{const{chain:$,wallet:z,statement:U,options:N}=e;let G;if(hn())if(typeof z=="object")G=z;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))G=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof z!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=z}const K=new URL((t=N?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in G&&G.signIn){const j=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),U?{statement:U}:null));let M;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")M=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)M=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in M&&"signature"in M&&(typeof M.signedMessage=="string"||M.signedMessage instanceof Uint8Array)&&M.signature instanceof Uint8Array)I=typeof M.signedMessage=="string"?M.signedMessage:new TextDecoder().decode(M.signedMessage),L=M.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");I=[`${K.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...U?["",U,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(o=(r=N?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=N?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((f=N?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((p=N?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((g=N?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((k=(y=N?.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||k===void 0)&&k.length?["Resources",...N.signInWithSolana.resources.map(M=>`- ${M}`)]:[]].join(`
`);const j=await G.signMessage(new TextEncoder().encode(I),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");L=j}}try{const{data:$,error:z}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:I,signature:Wd(L)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Ln});if(z)throw z;return!$||!$.session||!$.user?{data:{user:null,session:null},error:new ls}:($.session&&(await this._saveSession($.session),await this._notifyAllSubscribers("SIGNED_IN",$.session)),{data:Object.assign({},$),error:z})}catch($){if(pe($))return{data:{user:null,session:null},error:$};throw $}}async _exchangeCodeForSession(e){const t=await hr(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(t??"").split("/");try{const{data:l,error:c}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ln});if(await Hn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new ls}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:c})}catch(l){if(pe(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:l,nonce:c}=e,f=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ln}),{data:p,error:g}=f;return g?{data:{user:null,session:null},error:g}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new ls}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:p,error:g})}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,l,c;try{if("email"in e){const{email:f,options:p}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await Vr(this.storage,this.storageKey));const{error:k}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=p?.data)!==null&&t!==void 0?t:{},create_user:(r=p?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:g,code_challenge_method:y},redirectTo:p?.emailRedirectTo});return{data:{user:null,session:null},error:k}}if("phone"in e){const{phone:f,options:p}=e,{data:g,error:y}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(o=p?.data)!==null&&o!==void 0?o:{},create_user:(l=p?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(c=p?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:y}}throw new us("You must provide either an email or phone number.")}catch(f){if(pe(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(e){var t,r;try{let o,l;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:f}=await Ae(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:Ln});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const p=c.session,g=c.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),{data:{user:g,session:p},error:null}}catch(o){if(pe(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Vr(this.storage,this.storageKey)),await Ae(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:cf})}catch(l){if(pe(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new zn;const{error:o}=await Ae(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(pe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:l}=e,{error:c}=await Ae(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:r,type:o,options:l}=e,{data:c,error:f}=await Ae(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:f}}throw new us("You must provide either an email or phone number and a type")}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await hr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<eo:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await hr(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=ro()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(p,g,y)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(p,g,y))})}return{data:{session:e},error:null}}const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Gn}):await this._useSession(async t=>{var r,o,l;const{data:c,error:f}=t;if(f)throw f;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new zn}:await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:Gn})})}catch(t){if(pe(t))return Ld(t)&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:o,error:l}=r;if(l)throw l;if(!o.session)throw new zn;const c=o.session;let f=null,p=null;this.flowType==="pkce"&&e.email!=null&&([f,p]=await Vr(this.storage,this.storageKey));const{data:g,error:y}=await Ae(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:p}),jwt:c.access_token,xform:Gn});if(y)throw y;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(pe(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new zn;const t=Date.now()/1e3;let r=t,o=!0,l=null;const{payload:c}=no(e.access_token);if(c.exp&&(r=c.exp,o=r<=t),o){const{session:f,error:p}=await this._callRefreshToken(e.refresh_token);if(p)return{data:{user:null,session:null},error:p};if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:p}=await this._getUser(e.access_token);if(p)throw p;l={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(pe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:f}=t;if(f)throw f;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new zn;const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(pe(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!hn())throw new cs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new cs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Qa("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new cs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Qa("No code detected.");const{data:U,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:U.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:l,refresh_token:c,expires_in:f,expires_at:p,token_type:g}=e;if(!l||!f||!c||!g)throw new cs("No session defined in URL");const y=Math.round(Date.now()/1e3),k=parseInt(f);let E=y+k;p&&(E=parseInt(p));const _=E-y;_*1e3<=Yr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${k}s`);const I=E-k;y-I>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",I,E,y):y-I<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",I,E,y);const{data:L,error:$}=await this._getUser(l);if($)throw $;const z={provider_token:r,provider_refresh_token:o,access_token:l,expires_in:k,expires_at:E,refresh_token:c,token_type:g,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:z,redirectType:e.type},error:null}}catch(r){if(pe(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await hr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:o,error:l}=t;if(l)return{error:l};const c=(r=o.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:f}=await this.admin.signOut(c,e);if(f&&!(Md(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return e!=="others"&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Hd(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:l},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Vr(this.storage,this.storageKey,!0));try{return await Ae(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(pe(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(pe(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async l=>{var c,f,p,g,y;const{data:k,error:E}=l;if(E)throw E;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(p=e.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Ae(this.fetch,"GET",_,{headers:this.headers,jwt:(y=(g=k.session)===null||g===void 0?void 0:g.access_token)!==null&&y!==void 0?y:void 0})});if(o)throw o;return hn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(pe(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:l,error:c}=t;if(c)throw c;return await Ae(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Yd(async o=>(o>0&&await Kd(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await Ae(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ln})),(o,l)=>{const c=200*Math.pow(2,o);return l&&to(l)&&Date.now()+c-r<Yr})}catch(r){if(this._debug(t,"error",r),pe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),hn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await hr(this.storage,this.storageKey);if(o&&this.userStorage){let c=await hr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:o.user},await Jr(this.userStorage,this.storageKey+"-user",c)),o.user=(e=c?.user)!==null&&e!==void 0?e:ro()}else if(o&&!o.user&&!o.user){const c=await hr(this.storage,this.storageKey+"-user");c&&c?.user?(o.user=c.user,await Hn(this.storage,this.storageKey+"-user"),await Jr(this.storage,this.storageKey,o)):o.user=ro()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const l=((t=o.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<eo;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${eo}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:c}=await this._callRefreshToken(o.refresh_token);c&&(console.error(c),to(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:f}=await this._getUser(o.access_token);!f&&c?.user?(o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new zn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new $s;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new zn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={session:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(o,"error",l),pe(l)){const c={session:null,error:l};return to(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,t)}catch(p){l.push(p)}});if(await Promise.all(c),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Jr(this.userStorage,this.storageKey+"-user",{user:t.user});const o=Object.assign({},t);delete o.user;const l=rl(o);await Jr(this.storage,this.storageKey,l)}else{const o=rl(t);await Jr(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Hn(this.storage,this.storageKey),await Hn(this.storage,this.storageKey+"-code-verifier"),await Hn(this.storage,this.storageKey+"-user"),this.userStorage&&await Hn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&hn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Yr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/Yr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Yr}ms, refresh threshold is ${yo} ticks`),o<=yo&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof du)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!hn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await Vr(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});o.push(f.toString())}if(r?.queryParams){const l=new URLSearchParams(r.queryParams);o.push(l.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:l}=t;return l?{data:null,error:l}:await Ae(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:l,error:c}=t;if(c)return{data:null,error:c};const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:p,error:g}=await Ae(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(r=l?.session)===null||r===void 0?void 0:r.access_token});return g?{data:null,error:g}:(e.factorType==="totp"&&(!((o=p?.totp)===null||o===void 0)&&o.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),{data:p,error:null})})}catch(t){if(pe(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:f}=await Ae(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})})}catch(t){if(pe(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:l}=t;return l?{data:null,error:l}:await Ae(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(pe(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],o=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:o,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:l}=e;if(l)return{data:null,error:l};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=no(o.access_token);let f=null;c.aal&&(f=c.aal);let p=f;((r=(t=o.user.factors)===null||t===void 0?void 0:t.filter(k=>k.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(p="aal2");const y=c.amr||[];return{data:{currentLevel:f,nextLevel:p,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(f=>f.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(f=>f.kid===e),r&&this.jwks_cached_at+Od>o)return r;const{data:l,error:c}=await Ae(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,r=l.keys.find(f=>f.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:_,error:I}=await this.getSession();if(I||!_.session)return{data:null,error:I};r=_.session.access_token}const{header:o,payload:l,signature:c,raw:{header:f,payload:p}}=no(r);t?.allowExpired||nf(l.exp);const g=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:_}=await this.getUser(r);if(_)throw _;return{data:{claims:l,header:o,signature:c},error:null}}const y=rf(o.alg),k=await crypto.subtle.importKey("jwk",g,y,!0,["verify"]);if(!await crypto.subtle.verify(y,k,c,Bd(`${f}.${p}`)))throw new ko("Invalid JWT signature");return{data:{claims:l,header:o,signature:c},error:null}}catch(r){if(pe(r))return{data:null,error:r};throw r}}}Ri.nextInstanceID=0;const wf=Ri;class bf extends wf{constructor(e){super(e)}}var kf=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(y){try{g(r.next(y))}catch(k){c(k)}}function p(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(f,p)}g((r=r.apply(n,e||[])).next())})};class Ef{constructor(e,t,r){var o,l,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=Cd(e),p=new URL(f);this.realtimeUrl=new URL("realtime/v1",p),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",p),this.storageUrl=new URL("storage/v1",p),this.functionsUrl=new URL("functions/v1",p);const g=`sb-${p.hostname.split(".")[0]}-auth-token`,y={db:md,realtime:wd,auth:Object.assign(Object.assign({},yd),{storageKey:g}),global:_d},k=Td(r??{},y);this.storageKey=(o=k.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(l=k.global.headers)!==null&&l!==void 0?l:{},k.accessToken?(this.accessToken=k.accessToken,this.auth=new Proxy({},{get:(E,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=k.auth)!==null&&c!==void 0?c:{},this.headers,k.global.fetch),this.fetch=Ad(t,this._getAccessToken.bind(this),k.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},k.realtime)),this.rest=new Dh(new URL("rest/v1",p).href,{headers:this.headers,schema:k.db.schema,fetch:this.fetch}),this.storage=new vd(this.storageUrl.href,this.headers,this.fetch,r?.storage),k.accessToken||this._listenForAuthEvents()}get functions(){return new Ih(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return kf(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,storageKey:l,flowType:c,lock:f,debug:p},g,y){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bf({url:this.authUrl.href,headers:Object.assign(Object.assign({},k),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,flowType:c,lock:f,debug:p,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new td(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Af=(n,e,t)=>new Ef(n,e,t);function Sf(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Sf()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Cf="https://vycjpmuyscfygstjjied.supabase.co",Tf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",pr="dracula",gr=Af(Cf,Tf,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}});async function If(n,e,t,r){const o=prompt("Введите имя файла истории:","new_story.json");if(!o)return;const l={meta:{version:"3.1",title:"New Story"},chapters:[{id:"ch1",title:"Глава 1"}],dialogues:[{id:"start",chapterId:"ch1",text:"Начало...",options:[]}]},c=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),{error:f}=await gr.storage.from(pr).upload(o,c);f?fe(e,{type:"error",text:"Ошибка создания: "+f.message},!0):(await t(),await r(o))}async function Pf(n,e,t,r){if(!C(e))return;fe(t,{type:"loading",text:"Сохранение..."},!0);const o=new Blob([JSON.stringify(C(e),null,2)],{type:"application/json"}),{error:l}=await gr.storage.from(pr).upload(C(r),o,{upsert:!0});fe(t,{type:l?"error":"success",text:l?"Ошибка сохранения":"Сохранено!"},!0)}async function Rf(n,e,t){const r=n.target;if(!r.files||r.files.length===0)return;const o=r.files[0];fe(e,{type:"loading",text:"Загрузка файла..."},!0);const{error:l}=await gr.storage.from(pr).upload(o.name,o,{upsert:!0});l?fe(e,{type:"error",text:"Ошибка загрузки"},!0):(fe(e,{type:"success",text:"Файл загружен"},!0),await t())}function jf(n,e,t){if(!C(e)||!C(e).chapters)return;const r="ch_"+Date.now();C(e).chapters.push({id:r,title:"Новая глава"}),fe(t,r)}function Of(n,e,t,r){if(!C(e)||!C(t))return;const o="d_"+Date.now();C(e).dialogues.push({id:o,chapterId:C(t),text:"Новый текст...",options:[]}),fe(r,o)}var xf=(n,e)=>e(n.target.value),Mf=be("<option> </option>"),Lf=(n,e,t)=>fe(e,C(t).id,!0),$f=be("<div> </div>"),Ff=(n,e,t)=>fe(e,C(t).id,!0),Df=be('<div><span class="id-badge svelte-1qcalqk"> </span> <span class="preview-text svelte-1qcalqk"> </span></div>'),Uf=be("<div> </div>"),qf=be("<option> </option>"),Nf=be("<option> </option>"),Bf=be("<option> </option>"),Wf=be("<option> </option>"),Vf=(n,e,t)=>e(C(t)),Hf=be("<option> </option>"),zf=be("<option> </option>"),Gf=be("<option> </option>"),Kf=be('<div class="form-group full-width svelte-1qcalqk"><label class="svelte-1qcalqk">Предмет</label> <select class="input select svelte-1qcalqk"><option>-- Выберите предмет --</option><!></select></div>'),Yf=be('<div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Стата</label> <input type="text" class="input svelte-1qcalqk" placeholder="knowledge"/></div> <div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Значение ></label> <input type="number" class="input svelte-1qcalqk"/></div>',1),Jf=be('<div class="form-group full-width svelte-1qcalqk"><label class="svelte-1qcalqk">Имя флага</label> <input type="text" class="input svelte-1qcalqk" placeholder="metDracula"/></div>'),Xf=be('<div class="option-details svelte-1qcalqk"><div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Текст кнопки</label><input type="text" class="input svelte-1qcalqk"/></div> <div class="form-row svelte-1qcalqk"><div class="form-group full-width svelte-1qcalqk"><label class="svelte-1qcalqk">Переход</label> <select class="input select svelte-1qcalqk"><option>-- Конец ветки --</option><!></select></div></div> <div class="options-settings-grid svelte-1qcalqk"><div class="setting-col svelte-1qcalqk"><label class="checkbox-row svelte-1qcalqk"><input type="checkbox"/> Включено (Enable)</label> <p class="setting-desc svelte-1qcalqk">Если выключено, кнопка серая и не кликабельна.</p></div> <div class="setting-col svelte-1qcalqk"><label class="checkbox-row svelte-1qcalqk"><input type="checkbox"/> Видимо (Visible)</label> <p class="setting-desc svelte-1qcalqk">Если скрыто, кнопки нет в списке.</p></div></div> <div class="trigger-section svelte-1qcalqk"><div class="form-row svelte-1qcalqk"><div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Условие видимости</label> <select class="input select svelte-1qcalqk"></select></div> <!> <!> <!></div></div></div>'),Qf=be('<div><div class="option-header svelte-1qcalqk"><span class="status-icons svelte-1qcalqk"><!></span> <span> </span> <button class="btn-icon danger svelte-1qcalqk">×</button></div> <!></div>'),Zf=be("<option> </option>"),ev=(n,e,t)=>e(C(t).nextDialogueId),tv=be('<div class="link-row svelte-1qcalqk"><span class="link-type svelte-1qcalqk">Auto:</span> <span class="link-id svelte-1qcalqk"> </span> <button class="btn-link svelte-1qcalqk">Перейти →</button></div>'),nv=(n,e,t)=>e(C(t).nextDialogueId),rv=be('<div class="link-row svelte-1qcalqk"><span class="link-type svelte-1qcalqk">Opt:</span> <span class="link-id svelte-1qcalqk"> </span> <button class="btn-link svelte-1qcalqk">Перейти →</button></div>'),iv=(n,e,t)=>e(C(t).id),sv=be('<div class="dialogue-form svelte-1qcalqk"><div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">ID диалога</label><input type="text" class="input svelte-1qcalqk"/></div> <div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Текст</label><textarea class="textarea svelte-1qcalqk" rows="3"></textarea></div> <div class="media-section svelte-1qcalqk"><h4 class="svelte-1qcalqk">Медиа ресурсы</h4> <div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Фон</label> <div class="input-group svelte-1qcalqk"><select class="input select svelte-1qcalqk"><option>-- Нет --</option><!><!></select> <label class="btn-file svelte-1qcalqk">Загрузить <input type="file" accept="image/*,.riv" hidden/></label></div></div> <div class="form-group svelte-1qcalqk"><label class="svelte-1qcalqk">Персонаж</label> <div class="input-group svelte-1qcalqk"><select class="input select svelte-1qcalqk"><option>-- Нет --</option><!><!></select></div></div></div> <div class="options-section svelte-1qcalqk"><div class="section-header svelte-1qcalqk"><h4 class="svelte-1qcalqk">Варианты ответов</h4><button class="btn small svelte-1qcalqk">+ Добавить</button></div> <!></div> <div class="links-section svelte-1qcalqk"><h4 class="svelte-1qcalqk">Авто-переход</h4> <select class="input select svelte-1qcalqk"><option>-- Нет --</option><!></select></div> <div class="infographic-section svelte-1qcalqk"><h4 class="svelte-1qcalqk">Связи и переходы</h4> <div class="info-block svelte-1qcalqk"><div class="info-title svelte-1qcalqk">👉 Куда ведет:</div> <!> <!></div></div> <div class="form-actions svelte-1qcalqk"><button class="btn danger svelte-1qcalqk">Удалить сцену</button></div></div>'),ov=be('<div class="empty-state svelte-1qcalqk">Выберите сцену</div>'),av=(n,e)=>fe(e,null),lv=be('<div class="empty-preview svelte-1qcalqk">Выберите сцену</div>'),uv=be('<div class="editor-container svelte-1qcalqk"><header class="toolbar svelte-1qcalqk"><div class="logo svelte-1qcalqk"><h2 class="svelte-1qcalqk">Story Editor v3.1</h2></div> <div class="stories-control svelte-1qcalqk"><select class="story-select svelte-1qcalqk"></select> <button class="btn primary small svelte-1qcalqk">+ Новая</button> <button class="btn success small svelte-1qcalqk">💾 Сохранить</button> <button class="btn small svelte-1qcalqk">📋 Копия</button></div></header> <div class="main-workspace svelte-1qcalqk"><aside class="sidebar svelte-1qcalqk"><div class="sidebar-section svelte-1qcalqk"><div class="section-header svelte-1qcalqk"><h3>Главы</h3><button class="btn-icon svelte-1qcalqk">+</button></div> <div class="chapter-list svelte-1qcalqk"></div></div> <div class="sidebar-section flex-1 svelte-1qcalqk"><div class="section-header svelte-1qcalqk"><h3> </h3><button class="btn-icon svelte-1qcalqk">+</button></div> <div class="dialogue-list svelte-1qcalqk"></div></div> <div class="status-box svelte-1qcalqk"><!></div></aside> <main class="editor-area svelte-1qcalqk"><!></main> <aside class="preview-panel svelte-1qcalqk"><div class="preview-header svelte-1qcalqk"><h3 class="svelte-1qcalqk">Предпросмотр</h3> <button class="btn-link small svelte-1qcalqk">Сбросить редакт. опций</button></div> <div class="preview-wrapper svelte-1qcalqk"><!></div></aside></div></div>');function cv(n,e){xi(e,!0);let t=Ze(En({meta:{version:"3.1",title:"Untitled"},chapters:[],dialogues:[]})),r=Ze(null),o=Ze(null),l=Ze(null),c=Ze(En([])),f=Ze(En({type:"",text:""})),p=Ze(En([])),g=Ze("dracula_story.json");Uo(async()=>{await y(),await E(C(g)),await _()});async function y(){const{data:J,error:re}=await gr.storage.from(pr).list("",{search:".json"});!re&&J&&fe(p,J.map(v=>v.name).filter(v=>v!==".emptyFolderPlaceholder"),!0)}async function k(){if(!C(t))return;const J=C(g).replace(".json",""),re=new Date().getTime();let v=`${J}_copy_${re}.json`.trim();const a=prompt("Введите имя для копии:",v);if(!a)return;v=a.trim(),v.endsWith(".json")||(v+=".json"),fe(f,{type:"loading",text:"Создание копии..."},!0);const h=new Blob([JSON.stringify(C(t),null,2)],{type:"application/json"}),{error:w}=await gr.storage.from(pr).upload(v,h,{upsert:!0});w?fe(f,{type:"error",text:`Ошибка копии: ${w.message}`},!0):(await y(),fe(f,{type:"success",text:"Копия сохранена!"},!0))}async function E(J){fe(f,{type:"loading",text:"Загрузка..."},!0),fe(g,J,!0);try{const{data:re,error:v}=await gr.storage.from(pr).download(J);if(v)throw v;let a=JSON.parse(await re.text());a.dialogues&&a.dialogues.forEach(h=>{h.options&&h.options.forEach(w=>{typeof w.enabled>"u"&&(w.enabled=!0),typeof w.visible>"u"&&(w.visible=!0),w.visibleIf&&!w.visibilityCondition&&(w.visibilityCondition={type:"has_item",itemId:w.visibleIf.hasItem})})}),a.chapters||(a.chapters=[{id:"main",title:"Основная история"}],a.dialogues&&a.dialogues.forEach(h=>{h.chapterId||(h.chapterId="main")})),fe(t,a,!0),C(t).chapters&&C(t).chapters.length>0&&fe(r,C(t).chapters[0].id,!0),C(t).dialogues&&C(t).dialogues.length>0&&fe(o,C(t).dialogues[0].id,!0),fe(f,{type:"success",text:"Загружено!"},!0)}catch(re){console.error(re),fe(f,{type:"error",text:"Ошибка загрузки: "+re.message},!0)}}async function _(){const{data:J}=await gr.storage.from(pr).list();J&&fe(c,J.filter(re=>re.name!==".emptyFolderPlaceholder"&&!re.name.endsWith(".json")),!0)}function I(J){J.visibilityCondition||(J.visibilityCondition={type:"always"})}function L(J){J.options||(J.options=[]);const re={text:"Новый вариант",enabled:!0,visible:!0,visibilityCondition:{type:"always"}};J.options.push(re),fe(l,J.options.length-1),I(re)}function $(J,re){if(C(l)===J)fe(l,null);else{fe(l,J,!0);const v=re.options[J];I(v)}}function z(J){confirm("Удалить диалог "+J+"?")&&C(t)&&(C(t).dialogues=C(t).dialogues.filter(re=>re.id!==J),C(t).dialogues.forEach(re=>{re.nextDialogueId===J&&(re.nextDialogueId=""),re.options&&re.options.forEach(v=>{v.nextDialogueId===J&&(v.nextDialogueId="")})}),C(o)===J&&fe(o,null))}let U=Kr(()=>C(t)?.dialogues.find(J=>J.id===C(o))),N=Kr(()=>C(t)?C(t).dialogues.filter(J=>J.chapterId===C(r)):[]),G=Kr(()=>C(c).filter(J=>J.name.match(/\.(png|jpg|jpeg|webp|gif)$/i))),K=Kr(()=>C(c).filter(J=>J.name.endsWith(".riv"))),j=Kr(()=>C(t)?.items||[]);function M(J){const re=C(t)?.dialogues.find(v=>v.id===J);re&&(fe(r,re.chapterId,!0),fe(o,J,!0))}const oe=["always","has_item","stat_greater","flag_true"];var le=uv(),ce=V(le),Q=Z(V(ce),2),he=V(Q);he.__change=[xf,E],xt(he,21,()=>C(p),cn,(J,re)=>{var v=Mf(),a=V(v),h={};et(()=>{nt(a,C(re)),h!==(h=C(re))&&(v.value=(v.__value=C(re))??"")}),ae(J,v)});var De=Z(he,2);De.__click=[If,f,y,E];var Ke=Z(De,2);Ke.__click=[Pf,t,f,g];var Ve=Z(Ke,2);Ve.__click=k;var wt=Z(ce,2),ke=V(wt),en=V(ke),tt=V(en),He=Z(V(tt));He.__click=[jf,t,r];var ot=Z(tt,2);xt(ot,21,()=>C(t)?.chapters||[],J=>J.id,(J,re)=>{var v=$f();v.__click=[Lf,r,re];var a=V(v);et(()=>{ss(v,1,`chapter-item ${C(r)===C(re).id?"active":""}`,"svelte-1qcalqk"),nt(a,C(re).title)}),ae(J,v)});var Tt=Z(en,2),Ee=V(Tt),Te=V(Ee),$t=V(Te),Me=Z(Te);Me.__click=[Of,t,r,o];var bt=Z(Ee,2);xt(bt,21,()=>C(N),J=>J.id,(J,re)=>{var v=Df();v.__click=[Ff,o,re];var a=V(v),h=V(a),w=Z(a,2),T=V(w);et(O=>{ss(v,1,`dialogue-item ${C(o)===C(re).id?"active":""}`,"svelte-1qcalqk"),nt(h,C(re).id),nt(T,`${O??""}...`)},[()=>C(re).text.substring(0,25)]),ae(J,v)});var Je=Z(Tt,2),tn=V(Je);{var vn=J=>{var re=Uf(),v=V(re);et(()=>{ss(re,1,`alert ${C(f).type??""}`,"svelte-1qcalqk"),nt(v,C(f).text)}),ae(J,re)};Qe(tn,J=>{C(f).text&&J(vn)})}var zt=Z(ke,2),Cn=V(zt);{var _t=J=>{var re=sv(),v=V(re),a=Z(V(v)),h=Z(v,2),w=Z(V(h)),T=Z(h,2),O=Z(V(T),2),F=Z(V(O),2),ie=V(F),de=V(ie);de.value=de.__value="";var ne=Z(de);xt(ne,17,()=>C(G),cn,($e,se)=>{var ye=qf(),it=V(ye),qe={};et(()=>{nt(it,C(se).name),qe!==(qe=C(se).name)&&(ye.value=(ye.__value=C(se).name)??"")}),ae($e,ye)});var me=Z(ne);xt(me,17,()=>C(K),cn,($e,se)=>{var ye=Nf(),it=V(ye),qe={};et(()=>{nt(it,`${C(se).name??""} (Rive)`),qe!==(qe=C(se).name)&&(ye.value=(ye.__value=C(se).name)??"")}),ae($e,ye)});var je=Z(ie,2),rt=Z(V(je));rt.__change=[Rf,f,_];var Be=Z(O,2),Dt=Z(V(Be),2),Et=V(Dt),ut=V(Et);ut.value=ut.__value="";var vt=Z(ut);xt(vt,17,()=>C(G),cn,($e,se)=>{var ye=Bf(),it=V(ye),qe={};et(()=>{nt(it,C(se).name),qe!==(qe=C(se).name)&&(ye.value=(ye.__value=C(se).name)??"")}),ae($e,ye)});var It=Z(vt);xt(It,17,()=>C(K),cn,($e,se)=>{var ye=Wf(),it=V(ye),qe={};et(()=>{nt(it,`${C(se).name??""} (Rive)`),qe!==(qe=C(se).name)&&(ye.value=(ye.__value=C(se).name)??"")}),ae($e,ye)});var rn=Z(T,2),sn=V(rn),Gt=Z(V(sn));Gt.__click=[Vf,L,U];var ue=Z(sn,2);xt(ue,17,()=>C(U).options||[],cn,($e,se,ye)=>{var it=Qf(),qe=V(it);qe.__click=()=>$(ye,C(U));var on=V(qe),Tr=V(on);{var qt=Pt=>{var In=Ks("👁️‍🗨️");ae(Pt,In)},Ir=Pt=>{var In=Fn(),Pn=Xt(In);{var jr=an=>{var Kt=Ks("🔒");ae(an,Kt)},tr=an=>{var Kt=Ks("✅");ae(an,Kt)};Qe(Pn,an=>{C(se).enabled?an(tr,!1):an(jr)},!0)}ae(Pt,In)};Qe(Tr,Pt=>{C(se).visible?Pt(Ir,!1):Pt(qt)})}var Pr=Z(on,2),hi=V(Pr),qi=Z(Pr,2);qi.__click=()=>C(U).options.splice(ye,1);var Nt=Z(qe,2);{var Rr=Pt=>{var In=Xf(),Pn=V(In),jr=Z(V(Pn)),tr=Z(Pn,2),an=V(tr),Kt=Z(V(an),2),nr=V(Kt);nr.value=nr.__value="";var Rn=Z(nr);xt(Rn,17,()=>C(t).dialogues,cn,(Ue,Xe)=>{var Ne=Hf(),At=V(Ne),pt={};et(gn=>{nt(At,`${C(Xe).id??""}: ${gn??""}...`),pt!==(pt=C(Xe).id)&&(Ne.value=(Ne.__value=C(Xe).id)??"")},[()=>C(Xe).text.substring(0,30)]),ae(Ue,Ne)});var Bn=Z(tr,2),rr=V(Bn),ir=V(rr),ln=V(ir),Ni=Z(rr,2),Or=V(Ni),Bi=V(Or),Rt=Z(Bn,2),Wn=V(Rt),ve=V(Wn),jt=Z(V(ve),2);xt(jt,21,()=>oe,cn,(Ue,Xe)=>{var Ne=zf(),At=V(Ne),pt={};et(()=>{nt(At,C(Xe)),pt!==(pt=C(Xe))&&(Ne.value=(Ne.__value=C(Xe))??"")}),ae(Ue,Ne)});var Ot=Z(ve,2);{var Wi=Ue=>{var Xe=Kf(),Ne=Z(V(Xe),2),At=V(Ne);At.value=At.__value="";var pt=Z(At);xt(pt,17,()=>C(j),cn,(gn,Bt)=>{var jn=Gf(),fi=V(jn),vi={};et(()=>{nt(fi,C(Bt).name),vi!==(vi=C(Bt).id)&&(jn.value=(jn.__value=C(Bt).id)??"")}),ae(gn,jn)}),ur(Ne,()=>C(se).visibilityCondition.itemId,gn=>C(se).visibilityCondition.itemId=gn),ae(Ue,Xe)};Qe(Ot,Ue=>{C(se).visibilityCondition.type==="has_item"&&Ue(Wi)})}var di=Z(Ot,2);{var Vi=Ue=>{var Xe=Yf(),Ne=Xt(Xe),At=Z(V(Ne),2),pt=Z(Ne,2),gn=Z(V(pt),2);Fr(At,()=>C(se).visibilityCondition.statName,Bt=>C(se).visibilityCondition.statName=Bt),Fr(gn,()=>C(se).visibilityCondition.statValue,Bt=>C(se).visibilityCondition.statValue=Bt),ae(Ue,Xe)};Qe(di,Ue=>{C(se).visibilityCondition.type==="stat_greater"&&Ue(Vi)})}var Ye=Z(di,2);{var sr=Ue=>{var Xe=Jf(),Ne=Z(V(Xe),2);Fr(Ne,()=>C(se).visibilityCondition.flagName,At=>C(se).visibilityCondition.flagName=At),ae(Ue,Xe)};Qe(Ye,Ue=>{C(se).visibilityCondition.type==="flag_true"&&Ue(sr)})}Fr(jr,()=>C(se).text,Ue=>C(se).text=Ue),ur(Kt,()=>C(se).nextDialogueId,Ue=>C(se).nextDialogueId=Ue),Oa(ln,()=>C(se).enabled,Ue=>C(se).enabled=Ue),Oa(Bi,()=>C(se).visible,Ue=>C(se).visible=Ue),ur(jt,()=>C(se).visibilityCondition.type,Ue=>C(se).visibilityCondition.type=Ue),ae(Pt,In)};Qe(Nt,Pt=>{C(l)===ye&&Pt(Rr)})}et(()=>{ss(it,1,`option-card ${C(l)===ye?"editing":""}`,"svelte-1qcalqk"),nt(hi,`#${ye+1} ${C(se).text??""}`)}),ae($e,it)});var Se=Z(rn,2),Ut=Z(V(Se),2),Sr=V(Ut);Sr.value=Sr.__value="";var Cr=Z(Sr);xt(Cr,17,()=>C(t).dialogues,cn,($e,se)=>{var ye=Zf(),it=V(ye),qe={};et(on=>{nt(it,`${C(se).id??""}: ${on??""}...`),qe!==(qe=C(se).id)&&(ye.value=(ye.__value=C(se).id)??"")},[()=>C(se).text.substring(0,30)]),ae($e,ye)});var Di=Z(Se,2),er=Z(V(Di),2),ui=Z(V(er),2);{var ee=$e=>{var se=tv(),ye=Z(V(se),2),it=V(ye),qe=Z(ye,2);qe.__click=[ev,M,U],et(()=>nt(it,C(U).nextDialogueId)),ae($e,se)};Qe(ui,$e=>{C(U).nextDialogueId&&$e(ee)})}var ci=Z(ui,2);xt(ci,17,()=>C(U).options||[],cn,($e,se)=>{var ye=Fn(),it=Xt(ye);{var qe=on=>{var Tr=rv(),qt=Z(V(Tr),2),Ir=V(qt),Pr=Z(qt,2);Pr.__click=[nv,M,se],et(()=>nt(Ir,C(se).nextDialogueId)),ae(on,Tr)};Qe(it,on=>{C(se).nextDialogueId&&on(qe)})}ae($e,ye)});var Tn=Z(Di,2),Ui=V(Tn);Ui.__click=[iv,z,U],Fr(a,()=>C(U).id,$e=>C(U).id=$e),Fr(w,()=>C(U).text,$e=>C(U).text=$e),ur(ie,()=>C(U).backgroundImage,$e=>C(U).backgroundImage=$e),ur(Et,()=>C(U).characterImage,$e=>C(U).characterImage=$e),ur(Ut,()=>C(U).nextDialogueId,$e=>C(U).nextDialogueId=$e),ae(J,re)},Ft=J=>{var re=ov();ae(J,re)};Qe(Cn,J=>{C(U)?J(_t):J(Ft,!1)})}var pn=Z(zt,2),Nn=V(pn),nn=Z(V(Nn),2);nn.__click=[av,l];var Er=Z(Nn,2),kt=V(Er);{var li=J=>{Kl(J,{get dialogue(){return C(U)},index:0})},Ar=J=>{var re=lv();ae(J,re)};Qe(kt,J=>{C(U)?J(li):J(Ar,!1)})}et(()=>{nt($t,`Сцены (${C(N).length??""})`),Me.disabled=!C(r)}),ur(he,()=>C(g),J=>fe(g,J)),ae(n,le),Mi()}Vl(["change","click"]);var hv=be('<button style="position:fixed; top:10px; right:500px; z-index:9999;">Закрыть редактор</button> <!>',1),dv=be('<button style="position:fixed; bottom:10px; right:10px; z-index:9999;">Редактор</button> <!>',1);function fv(n){let e=Ze(!1);var t=Fn(),r=Xt(t);{var o=c=>{var f=hv(),p=Xt(f),g=Z(p,2);cv(g,{}),Ta("click",p,()=>fe(e,!1)),ae(c,f)},l=c=>{var f=dv(),p=Xt(f),g=Z(p,2);kh(g,{}),Ta("click",p,()=>fe(e,!0)),ae(c,f)};Qe(r,c=>{C(e)?c(o):c(l,!1)})}ae(n,t)}Dc(fv,{target:document.getElementById("app")});
