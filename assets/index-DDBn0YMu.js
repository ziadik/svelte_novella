(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();const bl=!1;var fs=Array.isArray,Xu=Array.prototype.indexOf,_a=Array.from,Zs=Object.defineProperty,ui=Object.getOwnPropertyDescriptor,El=Object.getOwnPropertyDescriptors,Qu=Object.prototype,Zu=Array.prototype,ma=Object.getPrototypeOf,Ro=Object.isExtensible;function ec(n){return n()}function es(n){for(var e=0;e<n.length;e++)n[e]()}function tc(){var n,e,t=new Promise((r,s)=>{n=r,e=s});return{promise:t,resolve:n,reject:e}}const Ut=2,ya=4,vs=8,zr=16,Pn=32,cr=64,Al=128,Kt=256,ts=512,At=1024,Yt=2048,Wn=4096,rn=8192,dr=16384,wa=32768,ba=65536,Oo=1<<17,nc=1<<18,mi=1<<19,kl=1<<20,ea=1<<21,Ea=1<<22,or=1<<23,Un=Symbol("$state"),rc=Symbol(""),Aa=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ic(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function sc(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ac(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function oc(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function lc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function uc(n){throw new Error("https://svelte.dev/e/effect_orphan")}function cc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function dc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function hc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function fc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const ps=1,gs=2,Sl=4,vc=8,pc=16,gc=1,_c=2,mt=Symbol(),mc="http://www.w3.org/1999/xhtml";function yc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let wc=!1;function Il(n){return n===this.v}function Cl(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function bc(n,e){return n!==e}function Tl(n){return!Cl(n,this.v)}let yi=!1,Ec=!1;function Ac(){yi=!0}let ut=null;function ns(n){ut=n}function sn(n,e=!1,t){ut={p:ut,c:null,e:null,s:n,x:null,l:yi&&!e?{s:null,u:null,$:[]}:null}}function an(n){var e=ut,t=e.e;if(t!==null){e.e=null;for(var r of t)Vl(r)}return ut=e.p,{}}function Gr(){return!yi||ut!==null&&ut.l===null}const kc=new WeakMap;function Sc(n){var e=Ue;if(e===null)return Ve.f|=or,n;if((e.f&wa)===0){if((e.f&Al)===0)throw!e.parent&&n instanceof Error&&Pl(n),n;e.b.error(n)}else ka(n,e)}function ka(n,e){for(;e!==null;){if((e.f&Al)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&Pl(n),n}function Pl(n){const e=kc.get(n);e&&(Zs(n,"message",{value:e.message}),Zs(n,"stack",{value:e.stack}))}let pi=[],ta=[];function xl(){var n=pi;pi=[],es(n)}function Ic(){var n=ta;ta=[],es(n)}function Sa(n){pi.length===0&&queueMicrotask(xl),pi.push(n)}function Cc(){pi.length>0&&xl(),ta.length>0&&Ic()}function Tc(){for(var n=Ue.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&ic(),n}function wi(n){var e=Ut|Yt,t=Ve!==null&&(Ve.f&Ut)!==0?Ve:null;return Ue===null||t!==null&&(t.f&Kt)!==0?e|=Kt:Ue.f|=mi,{ctx:ut,deps:null,effects:null,equals:Il,f:e,fn:n,reactions:null,rv:0,v:mt,wv:0,parent:t??Ue,ac:null}}function Pc(n,e){let t=Ue;t===null&&ac();var r=t.b,s=void 0,l=Wr(mt),c=null,h=!Ve;return qc(()=>{try{var v=n();c&&Promise.resolve(v).catch(()=>{})}catch(_){v=Promise.reject(_)}var g=()=>v;s=c?.then(g,g)??Promise.resolve(v),c=s;var m=et,E=r.pending;h&&(r.update_pending_count(1),E||m.increment());const A=(_,S=void 0)=>{c=null,E||m.activate(),S?S!==Aa&&(l.f|=or,Vr(l,S)):((l.f&or)!==0&&(l.f^=or),Vr(l,_)),h&&(r.update_pending_count(-1),E||m.decrement()),Ml()};if(s.then(A,_=>A(null,_||"unknown")),m)return()=>{queueMicrotask(()=>m.neuter())}}),new Promise(v=>{function g(m){function E(){m===s?v(l):g(s)}m.then(E,E)}g(s)})}function xc(n){const e=wi(n);return Jl(e),e}function Rl(n){const e=wi(n);return e.equals=Tl,e}function Ol(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Tn(e[t])}}function Rc(n){for(var e=n.parent;e!==null;){if((e.f&Ut)===0)return e;e=e.parent}return null}function Ia(n){var e,t=Ue;Bn(Rc(n));try{Ol(n),e=eu(n)}finally{Bn(t)}return e}function jl(n){var e=Ia(n);if(n.equals(e)||(n.v=e,n.wv=Ql()),!fr){var t=(Fn||(n.f&Kt)!==0)&&n.deps!==null?Wn:At;Ot(n,t)}}function Oc(n,e,t){const r=Gr()?wi:Rl;if(e.length===0){t(n.map(r));return}var s=et,l=Ue,c=jc(),h=Tc();Promise.all(e.map(v=>Pc(v))).then(v=>{s?.activate(),c();try{t([...n.map(r),...v])}catch(g){(l.f&dr)===0&&ka(g,l)}s?.deactivate(),Ml()}).catch(v=>{h.error(v)})}function jc(){var n=Ue,e=Ve,t=ut,r=et;return function(){Bn(n),gn(e),ns(t),r?.activate()}}function Ml(){Bn(null),gn(null),ns(null)}const Us=new Set;let et=null,Xi=null,jo=new Set,rs=[];function Ll(){const n=rs.shift();rs.length>0&&queueMicrotask(Ll),n()}let ur=[],_s=null,na=!1,Qi=!1;class Nr{current=new Map;#n=new Map;#t=new Set;#e=0;#r=null;#i=!1;#a=[];#l=[];#o=[];#s=[];#u=[];#d=[];#h=[];skipped_effects=new Set;process(e){ur=[],Xi=null;for(const s of e)this.#v(s);if(this.#a.length===0&&this.#e===0){this.#f();var t=this.#o,r=this.#s;this.#o=[],this.#s=[],this.#u=[],Xi=et,et=null,Mo(t),Mo(r),et===null?et=this:Us.delete(this),this.#r?.resolve()}else this.#c(this.#o),this.#c(this.#s),this.#c(this.#u);for(const s of this.#a)$r(s);for(const s of this.#l)$r(s);this.#a=[],this.#l=[]}#v(e){e.f^=At;for(var t=e.first;t!==null;){var r=t.f,s=(r&(Pn|cr))!==0,l=s&&(r&At)!==0,c=l||(r&rn)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(s)t.f^=At;else if((r&ya)!==0)this.#s.push(t);else if((r&At)===0)if((r&Ea)!==0){var h=t.b?.pending?this.#l:this.#a;h.push(t)}else bs(t)&&((t.f&zr)!==0&&this.#u.push(t),$r(t));var v=t.first;if(v!==null){t=v;continue}}var g=t.parent;for(t=t.next;t===null&&g!==null;)t=g.next,g=g.parent}}#c(e){for(const t of e)((t.f&Yt)!==0?this.#d:this.#h).push(t),Ot(t,At);e.length=0}capture(e,t){this.#n.has(e)||this.#n.set(e,t),this.current.set(e,e.v)}activate(){et=this}deactivate(){et=null,Xi=null;for(const e of jo)if(jo.delete(e),e(),et!==null)break}neuter(){this.#i=!0}flush(){ur.length>0?Dl():this.#f(),et===this&&(this.#e===0&&Us.delete(this),this.deactivate())}#f(){if(!this.#i)for(const e of this.#t)e();this.#t.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#d)Ot(e,Yt),Br(e);for(const e of this.#h)Ot(e,Wn),Br(e);this.#o=[],this.#s=[],this.flush()}else this.deactivate()}add_callback(e){this.#t.add(e)}settled(){return(this.#r??=tc()).promise}static ensure(){if(et===null){const e=et=new Nr;Us.add(et),Qi||Nr.enqueue(()=>{et===e&&e.flush()})}return et}static enqueue(e){rs.length===0&&queueMicrotask(Ll),rs.unshift(e)}}function Mc(n){var e=Qi;Qi=!0;try{for(var t;;){if(Cc(),ur.length===0&&(et?.flush(),ur.length===0))return _s=null,t;Dl()}}finally{Qi=e}}function Dl(){var n=Dr;na=!0;try{var e=0;for(Fo(!0);ur.length>0;){var t=Nr.ensure();if(e++>1e3){var r,s;Lc()}t.process(ur),Nn.clear()}}finally{na=!1,Fo(n),_s=null}}function Lc(){try{cc()}catch(n){ka(n,_s)}}let er=null;function Mo(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(dr|rn))===0&&bs(r)&&(er=[],$r(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Gl(r):r.fn=null),er?.length>0)){Nn.clear();for(const s of er)$r(s);er=[]}}er=null}}function Br(n){for(var e=_s=n;e.parent!==null;){e=e.parent;var t=e.f;if(na&&e===Ue&&(t&zr)!==0)return;if((t&(cr|Pn))!==0){if((t&At)===0)return;e.f^=At}}ur.push(e)}const Nn=new Map;function Wr(n,e){var t={f:0,v:n,reactions:null,equals:Il,rv:0,wv:0};return t}function xt(n,e){const t=Wr(n);return Jl(t),t}function Dc(n,e=!1,t=!0){const r=Wr(n);return e||(r.equals=Tl),yi&&t&&ut!==null&&ut.l!==null&&(ut.l.s??=[]).push(r),r}function Tt(n,e,t=!1){Ve!==null&&(!pn||(Ve.f&Oo)!==0)&&Gr()&&(Ve.f&(Ut|zr|Ea|Oo))!==0&&!Cn?.includes(n)&&fc();let r=t?rr(e):e;return Vr(n,r)}function Vr(n,e){if(!n.equals(e)){var t=n.v;fr?Nn.set(n,e):Nn.set(n,t),n.v=e;var r=Nr.ensure();r.capture(n,t),(n.f&Ut)!==0&&((n.f&Yt)!==0&&Ia(n),Ot(n,(n.f&Kt)===0?At:Wn)),n.wv=Ql(),$l(n,Yt),Gr()&&Ue!==null&&(Ue.f&At)!==0&&(Ue.f&(Pn|cr))===0&&(Ht===null?Kc([n]):Ht.push(n))}return e}function Ns(n){Tt(n,n.v+1)}function $l(n,e){var t=n.reactions;if(t!==null)for(var r=Gr(),s=t.length,l=0;l<s;l++){var c=t[l],h=c.f;if(!(!r&&c===Ue)){var v=(h&Yt)===0;v&&Ot(c,e),(h&Ut)!==0?$l(c,Wn):v&&((h&zr)!==0&&er!==null&&er.push(c),Br(c))}}}function rr(n){if(typeof n!="object"||n===null||Un in n)return n;const e=ma(n);if(e!==Qu&&e!==Zu)return n;var t=new Map,r=fs(n),s=xt(0),l=lr,c=h=>{if(lr===l)return h();var v=Ve,g=lr;gn(null),No(l);var m=h();return gn(v),No(g),m};return r&&t.set("length",xt(n.length)),new Proxy(n,{defineProperty(h,v,g){(!("value"in g)||g.configurable===!1||g.enumerable===!1||g.writable===!1)&&dc();var m=t.get(v);return m===void 0?m=c(()=>{var E=xt(g.value);return t.set(v,E),E}):Tt(m,g.value,!0),!0},deleteProperty(h,v){var g=t.get(v);if(g===void 0){if(v in h){const m=c(()=>xt(mt));t.set(v,m),Ns(s)}}else Tt(g,mt),Ns(s);return!0},get(h,v,g){if(v===Un)return n;var m=t.get(v),E=v in h;if(m===void 0&&(!E||ui(h,v)?.writable)&&(m=c(()=>{var _=rr(E?h[v]:mt),S=xt(_);return S}),t.set(v,m)),m!==void 0){var A=$(m);return A===mt?void 0:A}return Reflect.get(h,v,g)},getOwnPropertyDescriptor(h,v){var g=Reflect.getOwnPropertyDescriptor(h,v);if(g&&"value"in g){var m=t.get(v);m&&(g.value=$(m))}else if(g===void 0){var E=t.get(v),A=E?.v;if(E!==void 0&&A!==mt)return{enumerable:!0,configurable:!0,value:A,writable:!0}}return g},has(h,v){if(v===Un)return!0;var g=t.get(v),m=g!==void 0&&g.v!==mt||Reflect.has(h,v);if(g!==void 0||Ue!==null&&(!m||ui(h,v)?.writable)){g===void 0&&(g=c(()=>{var A=m?rr(h[v]):mt,_=xt(A);return _}),t.set(v,g));var E=$(g);if(E===mt)return!1}return m},set(h,v,g,m){var E=t.get(v),A=v in h;if(r&&v==="length")for(var _=g;_<E.v;_+=1){var S=t.get(_+"");S!==void 0?Tt(S,mt):_ in h&&(S=c(()=>xt(mt)),t.set(_+"",S))}if(E===void 0)(!A||ui(h,v)?.writable)&&(E=c(()=>xt(void 0)),Tt(E,rr(g)),t.set(v,E));else{A=E.v!==mt;var L=c(()=>rr(g));Tt(E,L)}var x=Reflect.getOwnPropertyDescriptor(h,v);if(x?.set&&x.set.call(m,g),!A){if(r&&typeof v=="string"){var D=t.get("length"),N=Number(v);Number.isInteger(N)&&N>=D.v&&Tt(D,N+1)}Ns(s)}return!0},ownKeys(h){$(s);var v=Reflect.ownKeys(h).filter(E=>{var A=t.get(E);return A===void 0||A.v!==mt});for(var[g,m]of t)m.v!==mt&&!(g in h)&&v.push(g);return v},setPrototypeOf(){hc()}})}function Lo(n){try{if(n!==null&&typeof n=="object"&&Un in n)return n[Un]}catch{}return n}function $c(n,e){return Object.is(Lo(n),Lo(e))}var Do,Fl,Ul,Nl;function Fc(){if(Do===void 0){Do=window,Fl=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Ul=ui(e,"firstChild").get,Nl=ui(e,"nextSibling").get,Ro(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Ro(t)&&(t.__t=void 0)}}function hr(n=""){return document.createTextNode(n)}function is(n){return Ul.call(n)}function ms(n){return Nl.call(n)}function F(n,e){return is(n)}function Gt(n,e){{var t=is(n);return t instanceof Comment&&t.data===""?ms(t):t}}function B(n,e=1,t=!1){let r=n;for(;e--;)r=ms(r);return r}function Uc(n){n.textContent=""}function Ca(){return!1}let $o=!1;function Nc(){$o||($o=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function ys(n){var e=Ve,t=Ue;gn(null),Bn(null);try{return n()}finally{gn(e),Bn(t)}}function Ta(n,e,t,r=t){n.addEventListener(e,()=>ys(t));const s=n.__on_r;s?n.__on_r=()=>{s(),r(!0)}:n.__on_r=()=>r(!0),Nc()}function Bl(n){Ue===null&&Ve===null&&uc(),Ve!==null&&(Ve.f&Kt)!==0&&Ue===null&&lc(),fr&&oc()}function Bc(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function _n(n,e,t,r=!0){var s=Ue;s!==null&&(s.f&rn)!==0&&(n|=rn);var l={ctx:ut,deps:null,nodes_start:null,nodes_end:null,f:n|Yt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{$r(l),l.f|=wa}catch(v){throw Tn(l),v}else e!==null&&Br(l);if(r){var c=l;if(t&&c.deps===null&&c.teardown===null&&c.nodes_start===null&&c.first===c.last&&(c.f&mi)===0&&(c=c.first),c!==null&&(c.parent=s,s!==null&&Bc(c,s),Ve!==null&&(Ve.f&Ut)!==0&&(n&cr)===0)){var h=Ve;(h.effects??=[]).push(c)}}return l}function Wl(n){const e=_n(vs,null,!1);return Ot(e,At),e.teardown=n,e}function ss(n){Bl();var e=Ue.f,t=!Ve&&(e&Pn)!==0&&(e&wa)===0;if(t){var r=ut;(r.e??=[]).push(n)}else return Vl(n)}function Vl(n){return _n(ya|kl,n,!1)}function Wc(n){return Bl(),_n(vs|kl,n,!0)}function Vc(n){Nr.ensure();const e=_n(cr|mi,n,!0);return(t={})=>new Promise(r=>{t.outro?ws(e,()=>{Tn(e),r(void 0)}):(Tn(e),r(void 0))})}function ql(n){return _n(ya,n,!1)}function qc(n){return _n(Ea|mi,n,!0)}function Pa(n,e=0){return _n(vs|e,n,!0)}function xe(n,e=[],t=[]){Oc(e,t,r=>{_n(vs,()=>n(...r.map($)),!0)})}function xa(n,e=0){var t=_n(zr|e,n,!0);return t}function qr(n,e=!0){return _n(Pn|mi,n,!0,e)}function Hl(n){var e=n.teardown;if(e!==null){const t=fr,r=Ve;Uo(!0),gn(null);try{e.call(null)}finally{Uo(t),gn(r)}}}function zl(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const s=t.ac;s!==null&&ys(()=>{s.abort(Aa)});var r=t.next;(t.f&cr)!==0?t.parent=null:Tn(t,e),t=r}}function Hc(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Pn)===0&&Tn(e),e=t}}function Tn(n,e=!0){var t=!1;(e||(n.f&nc)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(zc(n.nodes_start,n.nodes_end),t=!0),zl(n,e&&!t),as(n,0),Ot(n,dr);var r=n.transitions;if(r!==null)for(const l of r)l.stop();Hl(n);var s=n.parent;s!==null&&s.first!==null&&Gl(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function zc(n,e){for(;n!==null;){var t=n===e?null:ms(n);n.remove(),n=t}}function Gl(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function ws(n,e){var t=[];Ra(n,t,!0),Kl(t,()=>{Tn(n),e&&e()})}function Kl(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var s of n)s.out(r)}else e()}function Ra(n,e,t){if((n.f&rn)===0){if(n.f^=rn,n.transitions!==null)for(const c of n.transitions)(c.is_global||t)&&e.push(c);for(var r=n.first;r!==null;){var s=r.next,l=(r.f&ba)!==0||(r.f&Pn)!==0;Ra(r,e,l?t:!1),r=s}}}function Oa(n){Yl(n,!0)}function Yl(n,e){if((n.f&rn)!==0){n.f^=rn,(n.f&At)===0&&(Ot(n,Yt),Br(n));for(var t=n.first;t!==null;){var r=t.next,s=(t.f&ba)!==0||(t.f&Pn)!==0;Yl(t,s?e:!1),t=r}if(n.transitions!==null)for(const l of n.transitions)(l.is_global||e)&&l.in()}}let Or=null;function Gc(n){var e=Or;try{if(Or=new Set,Kr(n),e!==null)for(var t of Or)e.add(t);return Or}finally{Or=e}}function tn(n){for(var e of Gc(n))Vr(e,e.v)}let Dr=!1;function Fo(n){Dr=n}let fr=!1;function Uo(n){fr=n}let Ve=null,pn=!1;function gn(n){Ve=n}let Ue=null;function Bn(n){Ue=n}let Cn=null;function Jl(n){Ve!==null&&(Cn===null?Cn=[n]:Cn.push(n))}let Ct=null,Ft=0,Ht=null;function Kc(n){Ht=n}let Xl=1,gi=0,lr=gi;function No(n){lr=n}let Fn=!1;function Ql(){return++Xl}function bs(n){var e=n.f;if((e&Yt)!==0)return!0;if((e&Wn)!==0){var t=n.deps,r=(e&Kt)!==0;if(t!==null){var s,l,c=(e&ts)!==0,h=r&&Ue!==null&&!Fn,v=t.length;if((c||h)&&(Ue===null||(Ue.f&dr)===0)){var g=n,m=g.parent;for(s=0;s<v;s++)l=t[s],(c||!l?.reactions?.includes(g))&&(l.reactions??=[]).push(g);c&&(g.f^=ts),h&&m!==null&&(m.f&Kt)===0&&(g.f^=Kt)}for(s=0;s<v;s++)if(l=t[s],bs(l)&&jl(l),l.wv>n.wv)return!0}(!r||Ue!==null&&!Fn)&&Ot(n,At)}return!1}function Zl(n,e,t=!0){var r=n.reactions;if(r!==null&&!Cn?.includes(n))for(var s=0;s<r.length;s++){var l=r[s];(l.f&Ut)!==0?Zl(l,e,!1):e===l&&(t?Ot(l,Yt):(l.f&At)!==0&&Ot(l,Wn),Br(l))}}function eu(n){var e=Ct,t=Ft,r=Ht,s=Ve,l=Fn,c=Cn,h=ut,v=pn,g=lr,m=n.f;Ct=null,Ft=0,Ht=null,Fn=(m&Kt)!==0&&(pn||!Dr||Ve===null),Ve=(m&(Pn|cr))===0?n:null,Cn=null,ns(n.ctx),pn=!1,lr=++gi,n.ac!==null&&(ys(()=>{n.ac.abort(Aa)}),n.ac=null);try{n.f|=ea;var E=n.fn,A=E(),_=n.deps;if(Ct!==null){var S;if(as(n,Ft),_!==null&&Ft>0)for(_.length=Ft+Ct.length,S=0;S<Ct.length;S++)_[Ft+S]=Ct[S];else n.deps=_=Ct;if(!Fn||(m&Ut)!==0&&n.reactions!==null)for(S=Ft;S<_.length;S++)(_[S].reactions??=[]).push(n)}else _!==null&&Ft<_.length&&(as(n,Ft),_.length=Ft);if(Gr()&&Ht!==null&&!pn&&_!==null&&(n.f&(Ut|Wn|Yt))===0)for(S=0;S<Ht.length;S++)Zl(Ht[S],n);return s!==null&&s!==n&&(gi++,Ht!==null&&(r===null?r=Ht:r.push(...Ht))),(n.f&or)!==0&&(n.f^=or),A}catch(L){return Sc(L)}finally{n.f^=ea,Ct=e,Ft=t,Ht=r,Ve=s,Fn=l,Cn=c,ns(h),pn=v,lr=g}}function Yc(n,e){let t=e.reactions;if(t!==null){var r=Xu.call(t,n);if(r!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[r]=t[s],t.pop())}}t===null&&(e.f&Ut)!==0&&(Ct===null||!Ct.includes(e))&&(Ot(e,Wn),(e.f&(Kt|ts))===0&&(e.f^=ts),Ol(e),as(e,0))}function as(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Yc(n,t[r])}function $r(n){var e=n.f;if((e&dr)===0){Ot(n,At);var t=Ue,r=Dr;Ue=n,Dr=!0;try{(e&zr)!==0?Hc(n):zl(n),Hl(n);var s=eu(n);n.teardown=typeof s=="function"?s:null,n.wv=Xl;var l;bl&&Ec&&(n.f&Yt)!==0&&n.deps}finally{Dr=r,Ue=t}}}async function Jc(){await Promise.resolve(),Mc()}function $(n){var e=n.f,t=(e&Ut)!==0;if(Or?.add(n),Ve!==null&&!pn){var r=Ue!==null&&(Ue.f&dr)!==0;if(!r&&!Cn?.includes(n)){var s=Ve.deps;if((Ve.f&ea)!==0)n.rv<gi&&(n.rv=gi,Ct===null&&s!==null&&s[Ft]===n?Ft++:Ct===null?Ct=[n]:(!Fn||!Ct.includes(n))&&Ct.push(n));else{(Ve.deps??=[]).push(n);var l=n.reactions;l===null?n.reactions=[Ve]:l.includes(Ve)||l.push(Ve)}}}else if(t&&n.deps===null&&n.effects===null){var c=n,h=c.parent;h!==null&&(h.f&Kt)===0&&(c.f^=Kt)}if(fr){if(Nn.has(n))return Nn.get(n);if(t){c=n;var v=c.v;return((c.f&At)===0&&c.reactions!==null||tu(c))&&(v=Ia(c)),Nn.set(c,v),v}}else t&&(c=n,bs(c)&&jl(c));if((n.f&or)!==0)throw n.v;return n.v}function tu(n){if(n.v===mt)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Nn.has(e)||(e.f&Ut)!==0&&tu(e))return!0;return!1}function Kr(n){var e=pn;try{return pn=!0,n()}finally{pn=e}}const Xc=-7169;function Ot(n,e){n.f=n.f&Xc|e}function Qc(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Un in n)ra(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Un in t&&ra(t)}}}function ra(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{ra(n[r],e)}catch{}const t=ma(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=El(t);for(let s in r){const l=r[s].get;if(l)try{l.call(n)}catch{}}}}}const Zc=["touchstart","touchmove"];function ed(n){return Zc.includes(n)}const nu=new Set,ia=new Set;function td(n,e,t,r={}){function s(l){if(r.capture||oi.call(e,l),!l.cancelBubble)return ys(()=>t?.call(this,l))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Sa(()=>{e.addEventListener(n,s,r)}):e.addEventListener(n,s,r),s}function tr(n,e,t,r,s){var l={capture:r,passive:s},c=td(n,e,t,l);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Wl(()=>{e.removeEventListener(n,c,l)})}function vr(n){for(var e=0;e<n.length;e++)nu.add(n[e]);for(var t of ia)t(n)}let Bo=null;function oi(n){var e=this,t=e.ownerDocument,r=n.type,s=n.composedPath?.()||[],l=s[0]||n.target;Bo=n;var c=0,h=Bo===n&&n.__root;if(h){var v=s.indexOf(h);if(v!==-1&&(e===document||e===window)){n.__root=e;return}var g=s.indexOf(e);if(g===-1)return;v<=g&&(c=v)}if(l=s[c]||n.target,l!==e){Zs(n,"currentTarget",{configurable:!0,get(){return l||t}});var m=Ve,E=Ue;gn(null),Bn(null);try{for(var A,_=[];l!==null;){var S=l.assignedSlot||l.parentNode||l.host||null;try{var L=l["__"+r];if(L!=null&&(!l.disabled||n.target===l))if(fs(L)){var[x,...D]=L;x.apply(l,[n,...D])}else L.call(l,n)}catch(N){A?_.push(N):A=N}if(n.cancelBubble||S===e||S===null)break;l=S}if(A){for(let N of _)queueMicrotask(()=>{throw N});throw A}}finally{n.__root=e,delete n.currentTarget,gn(m),Bn(E)}}}function nd(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function os(n,e){var t=Ue;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function ce(n,e){var t=(e&gc)!==0,r=(e&_c)!==0,s,l=!n.startsWith("<!>");return()=>{s===void 0&&(s=nd(l?n:"<!>"+n),t||(s=is(s)));var c=r||Fl?document.importNode(s,!0):s.cloneNode(!0);if(t){var h=is(c),v=c.lastChild;os(h,v)}else os(c,c);return c}}function Bs(n=""){{var e=hr(n+"");return os(e,e),e}}function Sn(){var n=document.createDocumentFragment(),e=document.createComment(""),t=hr();return n.append(e,t),os(e,t),n}function ne(n,e){n!==null&&n.before(e)}function He(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function rd(n,e){return id(n,e)}const br=new Map;function id(n,{target:e,anchor:t,props:r={},events:s,context:l,intro:c=!0}){Fc();var h=new Set,v=E=>{for(var A=0;A<E.length;A++){var _=E[A];if(!h.has(_)){h.add(_);var S=ed(_);e.addEventListener(_,oi,{passive:S});var L=br.get(_);L===void 0?(document.addEventListener(_,oi,{passive:S}),br.set(_,1)):br.set(_,L+1)}}};v(_a(nu)),ia.add(v);var g=void 0,m=Vc(()=>{var E=t??e.appendChild(hr());return qr(()=>{if(l){sn({});var A=ut;A.c=l}s&&(r.$$events=s),g=n(E,r)||{},l&&an()}),()=>{for(var A of h){e.removeEventListener(A,oi);var _=br.get(A);--_===0?(document.removeEventListener(A,oi),br.delete(A)):br.set(A,_)}ia.delete(v),E!==t&&E.parentNode?.removeChild(E)}});return sd.set(g,m),g}let sd=new WeakMap;function Ge(n,e,t=!1){var r=n,s=null,l=null,c=mt,h=t?ba:0,v=!1;const g=(_,S=!0)=>{v=!0,A(S,_)};var m=null;function E(){m!==null&&(m.lastChild.remove(),r.before(m),m=null);var _=c?s:l,S=c?l:s;_&&Oa(_),S&&ws(S,()=>{c?l=null:s=null})}const A=(_,S)=>{if(c!==(c=_)){var L=Ca(),x=r;if(L&&(m=document.createDocumentFragment(),m.append(x=hr())),c?s??=S&&qr(()=>S(x)):l??=S&&qr(()=>S(x)),L){var D=et,N=c?s:l,U=c?l:s;N&&D.skipped_effects.delete(N),U&&D.skipped_effects.add(U),D.add_callback(E)}else E()}};xa(()=>{v=!1,e(g),v||A(null,null)},h)}function Wo(n,e,t){var r=n,s=mt,l,c,h=null,v=Gr()?bc:Cl;function g(){l&&ws(l),h!==null&&(h.lastChild.remove(),r.before(h),h=null),l=c}xa(()=>{if(v(s,s=e())){var m=r,E=Ca();E&&(h=document.createDocumentFragment(),h.append(m=hr())),c=qr(()=>t(m)),E?et.add_callback(g):g()}})}function zt(n,e){return e}function ad(n,e,t){for(var r=n.items,s=[],l=e.length,c=0;c<l;c++)Ra(e[c].e,s,!0);var h=l>0&&s.length===0&&t!==null;if(h){var v=t.parentNode;Uc(v),v.append(t),r.clear(),fn(n,e[0].prev,e[l-1].next)}Kl(s,()=>{for(var g=0;g<l;g++){var m=e[g];h||(r.delete(m.k),fn(n,m.prev,m.next)),Tn(m.e,!h)}})}function Et(n,e,t,r,s,l=null){var c=n,h={flags:e,items:new Map,first:null},v=(e&Sl)!==0;if(v){var g=n;c=g.appendChild(hr())}var m=null,E=!1,A=new Map,_=Rl(()=>{var D=t();return fs(D)?D:D==null?[]:_a(D)}),S,L;function x(){od(L,S,h,A,c,s,e,r,t),l!==null&&(S.length===0?m?Oa(m):m=qr(()=>l(c)):m!==null&&ws(m,()=>{m=null}))}xa(()=>{L??=Ue,S=$(_);var D=S.length;if(!(E&&D===0)){E=D===0;var N,U,H,G;if(Ca()){var R=new Set,M=et;for(U=0;U<D;U+=1){H=S[U],G=r(H,U);var ie=h.items.get(G)??A.get(G);ie?(e&(ps|gs))!==0&&ru(ie,H,U,e):(N=iu(null,h,null,null,H,G,U,s,e,t,!0),A.set(G,N)),R.add(G)}for(const[Y,le]of h.items)R.has(Y)||M.skipped_effects.add(le.e);M.add_callback(x)}else x();$(_)}})}function od(n,e,t,r,s,l,c,h,v){var g=(c&vc)!==0,m=(c&(ps|gs))!==0,E=e.length,A=t.items,_=t.first,S=_,L,x=null,D,N=[],U=[],H,G,R,M;if(g)for(M=0;M<E;M+=1)H=e[M],G=h(H,M),R=A.get(G),R!==void 0&&(R.a?.measure(),(D??=new Set).add(R));for(M=0;M<E;M+=1){if(H=e[M],G=h(H,M),R=A.get(G),R===void 0){var ie=r.get(G);if(ie!==void 0){r.delete(G),A.set(G,ie);var Y=x?x.next:S;fn(t,x,ie),fn(t,ie,Y),Ws(ie,Y,s),x=ie}else{var le=S?S.e.nodes_start:s;x=iu(le,t,x,x===null?t.first:x.next,H,G,M,l,c,v)}A.set(G,x),N=[],U=[],S=x.next;continue}if(m&&ru(R,H,M,c),(R.e.f&rn)!==0&&(Oa(R.e),g&&(R.a?.unfix(),(D??=new Set).delete(R))),R!==S){if(L!==void 0&&L.has(R)){if(N.length<U.length){var J=U[0],ee;x=J.prev;var ve=N[0],qe=N[N.length-1];for(ee=0;ee<N.length;ee+=1)Ws(N[ee],J,s);for(ee=0;ee<U.length;ee+=1)L.delete(U[ee]);fn(t,ve.prev,qe.next),fn(t,x,ve),fn(t,qe,J),S=J,x=qe,M-=1,N=[],U=[]}else L.delete(R),Ws(R,S,s),fn(t,R.prev,R.next),fn(t,R,x===null?t.first:x.next),fn(t,x,R),x=R;continue}for(N=[],U=[];S!==null&&S.k!==G;)(S.e.f&rn)===0&&(L??=new Set).add(S),U.push(S),S=S.next;if(S===null)continue;R=S}N.push(R),x=R,S=R.next}if(S!==null||L!==void 0){for(var se=L===void 0?[]:_a(L);S!==null;)(S.e.f&rn)===0&&se.push(S),S=S.next;var Te=se.length;if(Te>0){var oe=(c&Sl)!==0&&E===0?s:null;if(g){for(M=0;M<Te;M+=1)se[M].a?.measure();for(M=0;M<Te;M+=1)se[M].a?.fix()}ad(t,se,oe)}}g&&Sa(()=>{if(D!==void 0)for(R of D)R.a?.apply()}),n.first=t.first&&t.first.e,n.last=x&&x.e;for(var Je of r.values())Tn(Je.e);r.clear()}function ru(n,e,t,r){(r&ps)!==0&&Vr(n.v,e),(r&gs)!==0?Vr(n.i,t):n.i=t}function iu(n,e,t,r,s,l,c,h,v,g,m){var E=(v&ps)!==0,A=(v&pc)===0,_=E?A?Dc(s,!1,!1):Wr(s):s,S=(v&gs)===0?c:Wr(c),L={i:S,v:_,k:l,a:null,e:null,prev:t,next:r};try{if(n===null){var x=document.createDocumentFragment();x.append(n=hr())}return L.e=qr(()=>h(n,_,S,g),wc),L.e.prev=t&&t.e,L.e.next=r&&r.e,t===null?m||(e.first=L):(t.next=L,t.e.next=L.e),r!==null&&(r.prev=L,r.e.prev=L.e),L}finally{}}function Ws(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,s=e?e.e.nodes_start:t,l=n.e.nodes_start;l!==null&&l!==r;){var c=ms(l);s.before(l),l=c}}function fn(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const Vo=[...` 	
\r\fÂ \v\uFEFF`];function ld(n,e,t){var r=n==null?"":""+n;if(e&&(r=r?r+" "+e:e),t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var l=s.length,c=0;(c=r.indexOf(s,c))>=0;){var h=c+l;(c===0||Vo.includes(r[c-1]))&&(h===r.length||Vo.includes(r[h]))?r=(c===0?"":r.substring(0,c))+r.substring(h+1):c=h}}return r===""?null:r}function Fr(n,e,t,r,s,l){var c=n.__className;if(c!==t||c===void 0){var h=ld(t,r,l);h==null?n.removeAttribute("class"):n.className=h,n.__className=t}else if(l&&s!==l)for(var v in l){var g=!!l[v];(s==null||g!==!!s[v])&&n.classList.toggle(v,g)}return l}function ls(n,e,t=!1){if(n.multiple){if(e==null)return;if(!fs(e))return yc();for(var r of n.options)r.selected=e.includes(ci(r));return}for(r of n.options){var s=ci(r);if($c(s,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function sa(n){var e=new MutationObserver(()=>{ls(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Wl(()=>{e.disconnect()})}function Ur(n,e,t=e){var r=!0;Ta(n,"change",s=>{var l=s?"[selected]":":checked",c;if(n.multiple)c=[].map.call(n.querySelectorAll(l),ci);else{var h=n.querySelector(l)??n.querySelector("option:not([disabled])");c=h&&ci(h)}t(c)}),ql(()=>{var s=e();if(ls(n,s,r),r&&s===void 0){var l=n.querySelector(":checked");l!==null&&(s=ci(l),t(s))}n.__value=s,r=!1}),sa(n)}function ci(n){return"__value"in n?n.__value:n.value}const ud=Symbol("is custom element"),cd=Symbol("is html");function Vs(n,e){var t=su(n);t.value===(t.value=e??void 0)||n.value===e&&(e!==0||n.nodeName!=="PROGRESS")||(n.value=e??"")}function Lr(n,e,t,r){var s=su(n);s[e]!==(s[e]=t)&&(e==="loading"&&(n[rc]=t),t==null?n.removeAttribute(e):typeof t!="string"&&dd(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function su(n){return n.__attributes??={[ud]:n.nodeName.includes("-"),[cd]:n.namespaceURI===mc}}var qo=new Map;function dd(n){var e=n.getAttribute("is")||n.nodeName,t=qo.get(e);if(t)return t;qo.set(e,t=[]);for(var r,s=n,l=Element.prototype;l!==s;){r=El(s);for(var c in r)r[c].set&&t.push(c);s=ma(s)}return t}function ir(n,e,t=e){var r=new WeakSet;Ta(n,"input",async s=>{var l=s?n.defaultValue:n.value;if(l=qs(n)?Hs(l):l,t(l),et!==null&&r.add(et),await Jc(),l!==(l=e())){var c=n.selectionStart,h=n.selectionEnd;n.value=l??"",h!==null&&(n.selectionStart=c,n.selectionEnd=Math.min(h,n.value.length))}}),Kr(e)==null&&n.value&&(t(qs(n)?Hs(n.value):n.value),et!==null&&r.add(et)),Pa(()=>{var s=e();if(n===document.activeElement){var l=Xi??et;if(r.has(l))return}qs(n)&&s===Hs(n.value)||n.type==="date"&&!s&&!n.value||s!==n.value&&(n.value=s??"")})}function Ho(n,e,t=e){Ta(n,"change",r=>{var s=r?n.defaultChecked:n.checked;t(s)}),Kr(e)==null&&t(n.checked),Pa(()=>{var r=e();n.checked=!!r})}function qs(n){var e=n.type;return e==="number"||e==="range"}function Hs(n){return n===""?null:+n}function zo(n,e){return n===e||n?.[Un]===e}function hd(n={},e,t,r){return ql(()=>{var s,l;return Pa(()=>{s=l,l=[],Kr(()=>{n!==t(...l)&&(e(n,...l),s&&zo(t(...s),n)&&e(null,...s))})}),()=>{Sa(()=>{l&&zo(t(...l),n)&&e(null,...l)})}}),n}function pr(n=!1){const e=ut,t=e.l.u;if(!t)return;let r=()=>Qc(e.s);if(n){let s=0,l={};const c=wi(()=>{let h=!1;const v=e.s;for(const g in v)v[g]!==l[g]&&(l[g]=v[g],h=!0);return h&&s++,s});r=()=>$(c)}t.b.length&&Wc(()=>{Go(e,r),es(t.b)}),ss(()=>{const s=Kr(()=>t.m.map(ec));return()=>{for(const l of s)typeof l=="function"&&l()}}),t.a.length&&ss(()=>{Go(e,r),es(t.a)})}function Go(n,e){if(n.l.s)for(const t of n.l.s)$(t);e()}function bi(n){var e=Wr(0);return function(){return arguments.length===1?(Tt(e,$(e)+1),arguments[0]):($(e),n())}}function fd(n,e,t,r){var s=r,l=!0,c=()=>(l&&(l=!1,s=r),s);n[e];var h;h=()=>{var E=n[e];return E===void 0?c():(l=!0,E)};var v=!1,g=wi(()=>(v=!1,h())),m=Ue;return(function(E,A){if(arguments.length>0){const _=A?$(g):E;return Tt(g,_),v=!0,s!==void 0&&(s=_),E}return fr&&v||(m.f&dr)!==0?g.v:$(g)})}function ja(n){ut===null&&sc(),yi&&ut.l!==null?vd(ut).m.push(n):ss(()=>{const e=Kr(n);if(typeof e=="function")return e})}function vd(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const pd="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(pd);Ac();const gd="modulepreload",_d=function(n,e){return new URL(n,e).href},Ko={},Ei=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let g=function(m){return Promise.all(m.map(E=>Promise.resolve(E).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};const c=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),v=h?.nonce||h?.getAttribute("nonce");s=g(t.map(m=>{if(m=_d(m,r),m in Ko)return;Ko[m]=!0;const E=m.endsWith(".css"),A=E?'[rel="stylesheet"]':"";if(!!r)for(let L=c.length-1;L>=0;L--){const x=c[L];if(x.href===m&&(!E||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${A}`))return;const S=document.createElement("link");if(S.rel=E?"stylesheet":gd,E||(S.as="script"),S.crossOrigin="",S.href=m,v&&S.setAttribute("nonce",v),document.head.appendChild(S),E)return new Promise((L,x)=>{S.addEventListener("load",L),S.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return s.then(c=>{for(const h of c||[])h.status==="rejected"&&l(h.reason);return e().catch(l)})},md=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ei(async()=>{const{default:r}=await Promise.resolve().then(()=>Yr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Ma extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class yd extends Ma{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yo extends Ma{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Jo extends Ma{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var aa;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(aa||(aa={}));var wd=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};class bd{constructor(e,{headers:t={},customFetch:r,region:s=aa.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=md(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return wd(this,void 0,void 0,function*(){try{const{headers:s,method:l,body:c}=t;let h={},{region:v}=t;v||(v=this.region);const g=new URL(`${this.url}/${e}`);v&&v!=="any"&&(h["x-region"]=v,g.searchParams.set("forceFunctionRegion",v));let m;c&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)));const E=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),s),body:m}).catch(L=>{throw new yd(L)}),A=E.headers.get("x-relay-error");if(A&&A==="true")throw new Yo(E);if(!E.ok)throw new Jo(E);let _=((r=E.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),S;return _==="application/json"?S=yield E.json():_==="application/octet-stream"?S=yield E.blob():_==="text/event-stream"?S=E:_==="multipart/form-data"?S=yield E.formData():S=yield E.text(),{data:S,error:null,response:E}}catch(s){return{data:null,error:s,response:s instanceof Jo||s instanceof Yo?s.context:void 0}}})}}function Ed(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ad(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var _t={},Er={},Ar={},kr={},Sr={},Ir={},kd=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Hr=kd();const Sd=Hr.fetch,au=Hr.fetch.bind(Hr),ou=Hr.Headers,Id=Hr.Request,Cd=Hr.Response,Yr=Object.freeze(Object.defineProperty({__proto__:null,Headers:ou,Request:Id,Response:Cd,default:au,fetch:Sd},Symbol.toStringTag,{value:"Module"})),Td=Ad(Yr);var zi={},Xo;function lu(){if(Xo)return zi;Xo=1,Object.defineProperty(zi,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return zi.default=n,zi}var Qo;function uu(){if(Qo)return Ir;Qo=1;var n=Ir&&Ir.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ir,"__esModule",{value:!0});const e=n(Td),t=n(lu());class r{constructor(l){var c,h;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(h=l.isMaybeSingle)!==null&&h!==void 0?h:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let v=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var m,E,A,_;let S=null,L=null,x=null,D=g.status,N=g.statusText;if(g.ok){if(this.method!=="HEAD"){const R=await g.text();R===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?L=R:L=JSON.parse(R))}const H=(E=this.headers.get("Prefer"))===null||E===void 0?void 0:E.match(/count=(exact|planned|estimated)/),G=(A=g.headers.get("content-range"))===null||A===void 0?void 0:A.split("/");H&&G&&G.length>1&&(x=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(L)&&(L.length>1?(S={code:"PGRST116",details:`Results contain ${L.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},L=null,x=null,D=406,N="Not Acceptable"):L.length===1?L=L[0]:L=null)}else{const H=await g.text();try{S=JSON.parse(H),Array.isArray(S)&&g.status===404&&(L=[],S=null,D=200,N="OK")}catch{g.status===404&&H===""?(D=204,N="No Content"):S={message:H}}if(S&&this.isMaybeSingle&&(!((_=S?.details)===null||_===void 0)&&_.includes("0 rows"))&&(S=null,D=200,N="OK"),S&&this.shouldThrowOnError)throw new t.default(S)}return{error:S,data:L,count:x,status:D,statusText:N}});return this.shouldThrowOnError||(v=v.catch(g=>{var m,E,A;return{error:{message:`${(m=g?.name)!==null&&m!==void 0?m:"FetchError"}: ${g?.message}`,details:`${(E=g?.stack)!==null&&E!==void 0?E:""}`,hint:"",code:`${(A=g?.code)!==null&&A!==void 0?A:""}`},data:null,count:null,status:0,statusText:""}})),v.then(l,c)}returns(){return this}overrideTypes(){return this}}return Ir.default=r,Ir}var Zo;function cu(){if(Zo)return Sr;Zo=1;var n=Sr&&Sr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Sr,"__esModule",{value:!0});const e=n(uu());class t extends e.default{select(s){let l=!1;const c=(s??"*").split("").map(h=>/\s/.test(h)&&!l?"":(h==='"'&&(l=!l),h)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:l=!0,nullsFirst:c,foreignTable:h,referencedTable:v=h}={}){const g=v?`${v}.order`:"order",m=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${m?`${m},`:""}${s}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:l,referencedTable:c=l}={}){const h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(h,`${s}`),this}range(s,l,{foreignTable:c,referencedTable:h=c}={}){const v=typeof h>"u"?"offset":`${h}.offset`,g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(v,`${s}`),this.url.searchParams.set(g,`${l-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:l=!1,settings:c=!1,buffers:h=!1,wal:v=!1,format:g="text"}={}){var m;const E=[s?"analyze":null,l?"verbose":null,c?"settings":null,h?"buffers":null,v?"wal":null].filter(Boolean).join("|"),A=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${A}"; options=${E};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Sr.default=t,Sr}var el;function La(){if(el)return kr;el=1;var n=kr&&kr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(kr,"__esModule",{value:!0});const e=n(cu());class t extends e.default{eq(s,l){return this.url.searchParams.append(s,`eq.${l}`),this}neq(s,l){return this.url.searchParams.append(s,`neq.${l}`),this}gt(s,l){return this.url.searchParams.append(s,`gt.${l}`),this}gte(s,l){return this.url.searchParams.append(s,`gte.${l}`),this}lt(s,l){return this.url.searchParams.append(s,`lt.${l}`),this}lte(s,l){return this.url.searchParams.append(s,`lte.${l}`),this}like(s,l){return this.url.searchParams.append(s,`like.${l}`),this}likeAllOf(s,l){return this.url.searchParams.append(s,`like(all).{${l.join(",")}}`),this}likeAnyOf(s,l){return this.url.searchParams.append(s,`like(any).{${l.join(",")}}`),this}ilike(s,l){return this.url.searchParams.append(s,`ilike.${l}`),this}ilikeAllOf(s,l){return this.url.searchParams.append(s,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(s,l){return this.url.searchParams.append(s,`ilike(any).{${l.join(",")}}`),this}is(s,l){return this.url.searchParams.append(s,`is.${l}`),this}in(s,l){const c=Array.from(new Set(l)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(s,`in.(${c})`),this}contains(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cs.{${l.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(l)}`),this}containedBy(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cd.{${l.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(l)}`),this}rangeGt(s,l){return this.url.searchParams.append(s,`sr.${l}`),this}rangeGte(s,l){return this.url.searchParams.append(s,`nxl.${l}`),this}rangeLt(s,l){return this.url.searchParams.append(s,`sl.${l}`),this}rangeLte(s,l){return this.url.searchParams.append(s,`nxr.${l}`),this}rangeAdjacent(s,l){return this.url.searchParams.append(s,`adj.${l}`),this}overlaps(s,l){return typeof l=="string"?this.url.searchParams.append(s,`ov.${l}`):this.url.searchParams.append(s,`ov.{${l.join(",")}}`),this}textSearch(s,l,{config:c,type:h}={}){let v="";h==="plain"?v="pl":h==="phrase"?v="ph":h==="websearch"&&(v="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(s,`${v}fts${g}.${l}`),this}match(s){return Object.entries(s).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(s,l,c){return this.url.searchParams.append(s,`not.${l}.${c}`),this}or(s,{foreignTable:l,referencedTable:c=l}={}){const h=c?`${c}.or`:"or";return this.url.searchParams.append(h,`(${s})`),this}filter(s,l,c){return this.url.searchParams.append(s,`${l}.${c}`),this}}return kr.default=t,kr}var tl;function du(){if(tl)return Ar;tl=1;var n=Ar&&Ar.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ar,"__esModule",{value:!0});const e=n(La());class t{constructor(s,{headers:l={},schema:c,fetch:h}){this.url=s,this.headers=new Headers(l),this.schema=c,this.fetch=h}select(s,{head:l=!1,count:c}={}){const h=l?"HEAD":"GET";let v=!1;const g=(s??"*").split("").map(m=>/\s/.test(m)&&!v?"":(m==='"'&&(v=!v),m)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:l,defaultToNull:c=!0}={}){var h;const v="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const g=s.reduce((m,E)=>m.concat(Object.keys(E)),[]);if(g.length>0){const m=[...new Set(g)].map(E=>`"${E}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(s,{onConflict:l,ignoreDuplicates:c=!1,count:h,defaultToNull:v=!0}={}){var g;const m="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),h&&this.headers.append("Prefer",`count=${h}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const E=s.reduce((A,_)=>A.concat(Object.keys(_)),[]);if(E.length>0){const A=[...new Set(E)].map(_=>`"${_}"`);this.url.searchParams.set("columns",A.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(s,{count:l}={}){var c;const h="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:s}={}){var l;const c="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Ar.default=t,Ar}var nl;function Pd(){if(nl)return Er;nl=1;var n=Er&&Er.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Er,"__esModule",{value:!0});const e=n(du()),t=n(La());class r{constructor(l,{headers:c={},schema:h,fetch:v}={}){this.url=l,this.headers=new Headers(c),this.schemaName=h,this.fetch=v}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:h=!1,get:v=!1,count:g}={}){var m;let E;const A=new URL(`${this.url}/rpc/${l}`);let _;h||v?(E=h?"HEAD":"GET",Object.entries(c).filter(([L,x])=>x!==void 0).map(([L,x])=>[L,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([L,x])=>{A.searchParams.append(L,x)})):(E="POST",_=c);const S=new Headers(this.headers);return g&&S.set("Prefer",`count=${g}`),new t.default({method:E,url:A,headers:S,schema:this.schemaName,body:_,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return Er.default=r,Er}var rl;function xd(){if(rl)return _t;rl=1;var n=_t&&_t.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(_t,"__esModule",{value:!0}),_t.PostgrestError=_t.PostgrestBuilder=_t.PostgrestTransformBuilder=_t.PostgrestFilterBuilder=_t.PostgrestQueryBuilder=_t.PostgrestClient=void 0;const e=n(Pd());_t.PostgrestClient=e.default;const t=n(du());_t.PostgrestQueryBuilder=t.default;const r=n(La());_t.PostgrestFilterBuilder=r.default;const s=n(cu());_t.PostgrestTransformBuilder=s.default;const l=n(uu());_t.PostgrestBuilder=l.default;const c=n(lu());return _t.PostgrestError=c.default,_t.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:l.default,PostgrestError:c.default},_t}var Rd=xd();const Od=Ed(Rd),{PostgrestClient:jd,PostgrestQueryBuilder:Hv,PostgrestFilterBuilder:zv,PostgrestTransformBuilder:Gv,PostgrestBuilder:Kv,PostgrestError:Yv}=Od;class Md{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Ld="2.15.1",Dd=`realtime-js/${Ld}`,$d="1.0.0",oa=1e4,Fd=1e3,Ud=100;var di;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(di||(di={}));var ct;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(ct||(ct={}));var nn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(nn||(nn={}));var la;(function(n){n.websocket="websocket"})(la||(la={}));var nr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(nr||(nr={}));class Nd{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const h=r.decode(e.slice(c,c+s));c=c+s;const v=r.decode(e.slice(c,c+l));c=c+l;const g=JSON.parse(r.decode(e.slice(c,e.byteLength)));return{ref:null,topic:h,event:v,payload:g}}}class hu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Xe;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Xe||(Xe={}));const il=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((l,c)=>(l[c]=Bd(c,n,e,s),l),{})},Bd=(n,e,t,r)=>{const s=e.find(h=>h.name===n),l=s?.type,c=t[n];return l&&!r.includes(l)?fu(l,c):ua(c)},fu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Hd(e,t)}switch(n){case Xe.bool:return Wd(e);case Xe.float4:case Xe.float8:case Xe.int2:case Xe.int4:case Xe.int8:case Xe.numeric:case Xe.oid:return Vd(e);case Xe.json:case Xe.jsonb:return qd(e);case Xe.timestamp:return zd(e);case Xe.abstime:case Xe.date:case Xe.daterange:case Xe.int4range:case Xe.int8range:case Xe.money:case Xe.reltime:case Xe.text:case Xe.time:case Xe.timestamptz:case Xe.timetz:case Xe.tsrange:case Xe.tstzrange:return ua(e);default:return ua(e)}},ua=n=>n,Wd=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Vd=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},qd=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Hd=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(h=>fu(e,h))}return n},zd=n=>typeof n=="string"?n.replace(" ","T"):n,vu=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class zs{constructor(e,t,r={},s=oa){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var sl;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(sl||(sl={}));class hi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:l,onLeave:c,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hi.syncState(this.state,s,l,c),this.pendingDiffs.forEach(v=>{this.state=hi.syncDiff(this.state,v,l,c)}),this.pendingDiffs=[],h()}),this.channel._on(r.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=hi.syncDiff(this.state,s,l,c),h())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const l=this.cloneDeep(e),c=this.transformState(t),h={},v={};return this.map(l,(g,m)=>{c[g]||(v[g]=m)}),this.map(c,(g,m)=>{const E=l[g];if(E){const A=m.map(x=>x.presence_ref),_=E.map(x=>x.presence_ref),S=m.filter(x=>_.indexOf(x.presence_ref)<0),L=E.filter(x=>A.indexOf(x.presence_ref)<0);S.length>0&&(h[g]=S),L.length>0&&(v[g]=L)}else h[g]=m}),this.syncDiff(l,{joins:h,leaves:v},r,s)}static syncDiff(e,t,r,s){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(l,(h,v)=>{var g;const m=(g=e[h])!==null&&g!==void 0?g:[];if(e[h]=this.cloneDeep(v),m.length>0){const E=e[h].map(_=>_.presence_ref),A=m.filter(_=>E.indexOf(_.presence_ref)<0);e[h].unshift(...A)}r(h,m,v)}),this.map(c,(h,v)=>{let g=e[h];if(!g)return;const m=v.map(E=>E.presence_ref);g=g.filter(E=>m.indexOf(E.presence_ref)<0),e[h]=g,s(h,g,v),g.length===0&&delete e[h]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var al;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(al||(al={}));var fi;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(fi||(fi={}));var kn;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(kn||(kn={}));class Da{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=ct.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new zs(this,nn.join,this.params,this.timeout),this.rejoinTimer=new hu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ct.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ct.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ct.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ct.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ct.errored,this.rejoinTimer.scheduleTimeout())}),this._on(nn.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new hi(this),this.broadcastEndpointURL=vu(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ct.closed){const{config:{broadcast:l,presence:c,private:h}}=this.params,v=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(A=>A.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[fi.PRESENCE]&&this.bindings[fi.PRESENCE].length>0,m={},E={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:v,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(A=>e?.(kn.CHANNEL_ERROR,A)),this._onClose(()=>e?.(kn.CLOSED)),this.updateJoinPayload(Object.assign({config:E},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:A})=>{var _;if(this.socket.setAuth(),A===void 0){e?.(kn.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,L=(_=S?.length)!==null&&_!==void 0?_:0,x=[];for(let D=0;D<L;D++){const N=S[D],{filter:{event:U,schema:H,table:G,filter:R}}=N,M=A&&A[D];if(M&&M.event===U&&M.schema===H&&M.table===G&&M.filter===R)x.push(Object.assign(Object.assign({},N),{id:M.id}));else{this.unsubscribe(),this.state=ct.errored,e?.(kn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(kn.SUBSCRIBED);return}}).receive("error",A=>{this.state=ct.errored,e?.(kn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(A).join(", ")||"error")))}).receive("timeout",()=>{e?.(kn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===ct.joined&&e===fi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=g.body)===null||s===void 0?void 0:s.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,h,v;const g=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(h=(c=this.params)===null||c===void 0?void 0:c.config)===null||h===void 0?void 0:h.broadcast)===null||v===void 0)&&v.ack)&&l("ok"),g.receive("ok",()=>l("ok")),g.receive("error",()=>l("error")),g.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ct.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(nn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new zs(this,nn.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ct.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,l=setTimeout(()=>s.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(l),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new zs(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Ud){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,l;const c=e.toLocaleLowerCase(),{close:h,error:v,leave:g,join:m}=nn;if(r&&[h,v,g,m].indexOf(c)>=0&&r!==this._joinRef())return;let A=this._onMessage(c,t,r);if(t&&!A)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var S,L,x;return((S=_.filter)===null||S===void 0?void 0:S.event)==="*"||((x=(L=_.filter)===null||L===void 0?void 0:L.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===c}).map(_=>_.callback(A,r)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var S,L,x,D,N,U;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const H=_.id,G=(S=_.filter)===null||S===void 0?void 0:S.event;return H&&((L=t.ids)===null||L===void 0?void 0:L.includes(H))&&(G==="*"||G?.toLocaleLowerCase()===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const H=(N=(D=_?.filter)===null||D===void 0?void 0:D.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return H==="*"||H===((U=t?.event)===null||U===void 0?void 0:U.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof A=="object"&&"ids"in A){const S=A.data,{schema:L,table:x,commit_timestamp:D,type:N,errors:U}=S;A=Object.assign(Object.assign({},{schema:L,table:x,commit_timestamp:D,eventType:N,new:{},old:{},errors:U}),this._getPayloadRecords(S))}_.callback(A,r)})}_isClosed(){return this.state===ct.closed}_isJoined(){return this.state===ct.joined}_isJoining(){return this.state===ct.joining}_isLeaving(){return this.state===ct.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),l={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&Da.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(nn.close,{},e)}_onError(e){this._on(nn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ct.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=il(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=il(e.columns,e.old_record)),t}}const ol=()=>{},Gi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Gd=[1e3,2e3,5e3,1e4],Kd=1e4,Yd=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Jd{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=oa,this.transport=null,this.heartbeatIntervalMs=Gi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ol,this.ref=0,this.reconnectTimer=null,this.logger=ol,this.conn=null,this.sendBuffer=[],this.serializer=new Nd,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let l;return s?l=s:typeof fetch>"u"?l=(...c)=>Ei(async()=>{const{default:h}=await Promise.resolve().then(()=>Yr);return{default:h}},void 0,import.meta.url).then(({default:h})=>h(...c)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${la.websocket}`,this.httpEndpoint=vu(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Md.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$d}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case di.connecting:return nr.Connecting;case di.open:return nr.Open;case di.closing:return nr.Closing;default:return nr.Closed}}isConnected(){return this.connectionState()===nr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(l=>l.topic===r);if(s)return s;{const l=new Da(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:r,payload:s,ref:l}=e,c=()=>{this.encode(e,h=>{var v;(v=this.conn)===null||v===void 0||v.send(h)})};this.log("push",`${t} ${r} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Fd,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Gi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:l,ref:c}=t,h=c?`(${c})`:"",v=l.status||"";this.log("receive",`${v} ${r} ${s} ${h}`.trim(),l),this.channels.filter(g=>g._isMember(r)).forEach(g=>g._trigger(s,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(nn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Yd],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:Dd};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(nn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new hu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Gi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,l,c,h,v,g;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:oa,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Gi.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(m=>Gd[m-1]||Kd),this.encode=(v=e?.encode)!==null&&v!==void 0?v:((m,E)=>E(JSON.stringify(m))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class $a extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function dt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Xd extends $a{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ca extends $a{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Qd=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};const pu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ei(async()=>{const{default:r}=await Promise.resolve().then(()=>Yr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Zd=()=>Qd(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ei(()=>Promise.resolve().then(()=>Yr),void 0,import.meta.url)).Response:Response}),da=n=>{if(Array.isArray(n))return n.map(t=>da(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[s]=da(r)}),e},eh=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var gr=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};const Gs=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),th=(n,e,t)=>gr(void 0,void 0,void 0,function*(){const r=yield Zd();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const l=n.status||500,c=s?.statusCode||l+"";e(new Xd(Gs(s),l,c))}).catch(s=>{e(new ca(Gs(s),s))}):e(new ca(Gs(n),n))}),nh=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(eh(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Ai(n,e,t,r,s,l){return gr(this,void 0,void 0,function*(){return new Promise((c,h)=>{n(t,nh(e,r,s,l)).then(v=>{if(!v.ok)throw v;return r?.noResolveJson?v:v.json()}).then(v=>c(v)).catch(v=>th(v,h,r))})})}function us(n,e,t,r){return gr(this,void 0,void 0,function*(){return Ai(n,"GET",e,t,r)})}function vn(n,e,t,r,s){return gr(this,void 0,void 0,function*(){return Ai(n,"POST",e,r,s,t)})}function ha(n,e,t,r,s){return gr(this,void 0,void 0,function*(){return Ai(n,"PUT",e,r,s,t)})}function rh(n,e,t,r){return gr(this,void 0,void 0,function*(){return Ai(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function gu(n,e,t,r,s){return gr(this,void 0,void 0,function*(){return Ai(n,"DELETE",e,r,s,t)})}var It=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};const ih={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ll={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class sh{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=pu(s)}uploadOrUpdate(e,t,r,s){return It(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},ll),s);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const v=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),v&&l.append("metadata",this.encodeMetadata(v)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),v&&l.append("metadata",this.encodeMetadata(v))):(l=r,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType,v&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),s?.headers&&(h=Object.assign(Object.assign({},h),s.headers));const g=this._removeEmptyFolders(t),m=this._getFinalPath(g),E=yield(e=="PUT"?ha:vn)(this.fetch,`${this.url}/object/${m}`,l,Object.assign({headers:h},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:E.Id,fullPath:E.Key},error:null}}catch(l){if(dt(l))return{data:null,error:l};throw l}})}upload(e,t,r){return It(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return It(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),h=new URL(this.url+`/object/upload/sign/${c}`);h.searchParams.set("token",t);try{let v;const g=Object.assign({upsert:ll.upsert},s),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&r instanceof Blob?(v=new FormData,v.append("cacheControl",g.cacheControl),v.append("",r)):typeof FormData<"u"&&r instanceof FormData?(v=r,v.append("cacheControl",g.cacheControl)):(v=r,m["cache-control"]=`max-age=${g.cacheControl}`,m["content-type"]=g.contentType);const E=yield ha(this.fetch,h.toString(),v,{headers:m});return{data:{path:l,fullPath:E.Key},error:null}}catch(v){if(dt(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return It(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const l=yield vn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),c=new URL(this.url+l.url),h=c.searchParams.get("token");if(!h)throw new $a("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:h},error:null}}catch(r){if(dt(r))return{data:null,error:r};throw r}})}update(e,t,r){return It(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return It(this,void 0,void 0,function*(){try{return{data:yield vn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(dt(s))return{data:null,error:s};throw s}})}copy(e,t,r){return It(this,void 0,void 0,function*(){try{return{data:{path:(yield vn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(dt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return It(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),l=yield vn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(dt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return It(this,void 0,void 0,function*(){try{const s=yield vn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(dt(s))return{data:null,error:s};throw s}})}download(e,t){return It(this,void 0,void 0,function*(){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const h=this._getFinalPath(e);return{data:yield(yield us(this.fetch,`${this.url}/${s}/${h}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(dt(h))return{data:null,error:h};throw h}})}info(e){return It(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield us(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:da(r),error:null}}catch(r){if(dt(r))return{data:null,error:r};throw r}})}exists(e){return It(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield rh(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(dt(r)&&r instanceof ca){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&s.push(l);const h=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&s.push(v);let g=s.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${r}${g}`)}}}remove(e){return It(this,void 0,void 0,function*(){try{return{data:yield gu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(dt(t))return{data:null,error:t};throw t}})}list(e,t,r){return It(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ih),t),{prefix:e||""});return{data:yield vn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(dt(s))return{data:null,error:s};throw s}})}listV2(e,t){return It(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield vn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(dt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ah="2.11.0",oh={"X-Client-Info":`storage-js/${ah}`};var Cr=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};class lh{constructor(e,t={},r,s){const l=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},oh),t),this.fetch=pu(r)}listBuckets(){return Cr(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(dt(e))return{data:null,error:e};throw e}})}getBucket(e){return Cr(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(dt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Cr(this,void 0,void 0,function*(){try{return{data:yield vn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(dt(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Cr(this,void 0,void 0,function*(){try{return{data:yield ha(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(dt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Cr(this,void 0,void 0,function*(){try{return{data:yield vn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(dt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Cr(this,void 0,void 0,function*(){try{return{data:yield gu(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(dt(t))return{data:null,error:t};throw t}})}}class uh extends lh{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new sh(this.url,this.headers,e,this.fetch)}}const ch="2.56.0";let li="";typeof Deno<"u"?li="deno":typeof document<"u"?li="web":typeof navigator<"u"&&navigator.product==="ReactNative"?li="react-native":li="node";const dh={"X-Client-Info":`supabase-js-${li}/${ch}`},hh={headers:dh},fh={schema:"public"},vh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ph={};var gh=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};const _h=n=>{let e;return n?e=n:typeof fetch>"u"?e=au:e=fetch,(...t)=>e(...t)},mh=()=>typeof Headers>"u"?ou:Headers,yh=(n,e,t)=>{const r=_h(t),s=mh();return(l,c)=>gh(void 0,void 0,void 0,function*(){var h;const v=(h=yield e())!==null&&h!==void 0?h:n;let g=new s(c?.headers);return g.has("apikey")||g.set("apikey",n),g.has("Authorization")||g.set("Authorization",`Bearer ${v}`),r(l,Object.assign(Object.assign({},c),{headers:g}))})};var wh=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};function bh(n){return n.endsWith("/")?n:n+"/"}function Eh(n,e){var t,r;const{db:s,auth:l,realtime:c,global:h}=n,{db:v,auth:g,realtime:m,global:E}=e,A={db:Object.assign(Object.assign({},v),s),auth:Object.assign(Object.assign({},g),l),realtime:Object.assign(Object.assign({},m),c),storage:{},global:Object.assign(Object.assign(Object.assign({},E),h),{headers:Object.assign(Object.assign({},(t=E?.headers)!==null&&t!==void 0?t:{}),(r=h?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>wh(this,void 0,void 0,function*(){return""})};return n.accessToken?A.accessToken=n.accessToken:delete A.accessToken,A}const _u="2.71.1",jr=30*1e3,fa=3,Ks=fa*jr,Ah="http://localhost:9999",kh="supabase.auth.token",Sh={"X-Client-Info":`gotrue-js/${_u}`},va="X-Supabase-Api-Version",mu={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ih=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ch=600*1e3;class Fa extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function we(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Th extends Fa{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function Ph(n){return we(n)&&n.name==="AuthApiError"}class yu extends Fa{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Vn extends Fa{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class Dn extends Vn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function xh(n){return we(n)&&n.name==="AuthSessionMissingError"}class Ki extends Vn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Yi extends Vn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ji extends Vn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Rh(n){return we(n)&&n.name==="AuthImplicitGrantRedirectError"}class ul extends Vn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pa extends Vn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ys(n){return we(n)&&n.name==="AuthRetryableFetchError"}class cl extends Vn{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class ga extends Vn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dl=` 	
\r=`.split(""),Oh=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<dl.length;e+=1)n[dl[e].charCodeAt(0)]=-2;for(let e=0;e<cs.length;e+=1)n[cs[e].charCodeAt(0)]=e;return n})();function hl(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(cs[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(cs[r]),e.queuedBits-=6}}function wu(n,e,t){const r=Oh[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function fl(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{Lh(c,r,t)};for(let c=0;c<n.length;c+=1)wu(n.charCodeAt(c),s,l);return e.join("")}function jh(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Mh(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}jh(r,e)}}function Lh(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Dh(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)wu(n.charCodeAt(s),t,r);return new Uint8Array(e)}function $h(n){const e=[];return Mh(n,t=>e.push(t)),new Uint8Array(e)}function Fh(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>hl(s,t,r)),hl(null,t,r),e.join("")}function Uh(n){return Math.round(Date.now()/1e3)+n}function Nh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const en=()=>typeof window<"u"&&typeof document<"u",Xn={tested:!1,writable:!1},bu=()=>{if(!en())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xn.tested)return Xn.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Xn.tested=!0,Xn.writable=!0}catch{Xn.tested=!0,Xn.writable=!1}return Xn.writable};function Bh(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,l)=>{e[l]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const Eu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ei(async()=>{const{default:r}=await Promise.resolve().then(()=>Yr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Wh=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Mr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Qn=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Mn=async(n,e)=>{await n.removeItem(e)};class Es{constructor(){this.promise=new Es.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Es.promiseConstructor=Promise;function Js(n){const e=n.split(".");if(e.length!==3)throw new ga("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Ih.test(e[r]))throw new ga("JWT not in base64url format");return{header:JSON.parse(fl(e[0])),payload:JSON.parse(fl(e[1])),signature:Dh(e[2]),raw:{header:e[0],payload:e[1]}}}async function Vh(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function qh(n,e){return new Promise((r,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){r(c);return}}catch(c){if(!e(l,c)){s(c);return}}})()})}function Hh(n){return("0"+n.toString(16)).substr(-2)}function zh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let l=0;l<56;l++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Hh).join("")}async function Gh(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function Kh(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Gh(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Tr(n,e,t=!1){const r=zh();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await Mr(n,`${e}-code-verifier`,s);const l=await Kh(r);return[l,r===l?"plain":"s256"]}const Yh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Jh(n){const e=n.headers.get(va);if(!e||!e.match(Yh))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Xh(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Qh(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Zh=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pr(n){if(!Zh.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Xs(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function vl(n){return JSON.parse(JSON.stringify(n))}var ef=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Zn=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),tf=[502,503,504];async function pl(n){var e;if(!Wh(n))throw new pa(Zn(n),0);if(tf.includes(n.status))throw new pa(Zn(n),n.status);let t;try{t=await n.json()}catch(l){throw new yu(Zn(l),l)}let r;const s=Jh(n);if(s&&s.getTime()>=mu["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new cl(Zn(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Dn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new cl(Zn(t),n.status,t.weak_password.reasons);throw new Th(Zn(t),n.status||500,r)}const nf=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function Me(n,e,t,r){var s;const l=Object.assign({},r?.headers);l[va]||(l[va]=mu["2024-01-01"].name),r?.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(c.redirect_to=r.redirectTo);const h=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",v=await rf(n,e,t+h,{headers:l,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(v):{data:Object.assign({},v),error:null}}async function rf(n,e,t,r,s,l){const c=nf(e,r,s,l);let h;try{h=await n(t,Object.assign({},c))}catch(v){throw console.error(v),new pa(Zn(v),0)}if(h.ok||await pl(h),r?.noResolveJson)return h;try{return await h.json()}catch(v){await pl(v)}}function An(n){var e;let t=null;lf(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Uh(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function gl(n){const e=An(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function $n(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function sf(n){return{data:n,error:null}}function af(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:l}=n,c=ef(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:l},v=Object.assign({},c);return{data:{properties:h,user:v},error:null}}function of(n){return n}function lf(n){return n.access_token&&n.refresh_token&&n.expires_in}const Qs=["global","local","others"];var uf=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class cf{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=Eu(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Qs[0]){if(Qs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Qs.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:$n})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=uf(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:af,redirectTo:t?.redirectTo})}catch(t){if(we(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$n})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,l,c,h,v;try{const g={nextPage:null,lastPage:0,total:0},m=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:of});if(m.error)throw m.error;const E=await m.json(),A=(c=m.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(v=(h=m.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&v!==void 0?v:[];return _.length>0&&(_.forEach(S=>{const L=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(S.split(";")[1].split("=")[1]);g[`${x}Page`]=L}),g.total=parseInt(A)),{data:Object.assign(Object.assign({},E),g),error:null}}catch(g){if(we(g))return{data:{users:[]},error:g};throw g}}async getUserById(e){Pr(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$n})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Pr(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:$n})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Pr(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:$n})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Pr(e.userId);try{const{data:t,error:r}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Pr(e.userId),Pr(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}}function _l(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function df(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const xr={debug:!!(globalThis&&bu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Au extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class hf extends Au{}async function ff(n,e,t){xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),xr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw xr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new hf(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(xr.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}df();const vf={url:Ah,storageKey:kh,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Sh,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ml(n,e,t){return await t()}const Rr={};class _i{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_i.nextInstanceID,_i.nextInstanceID+=1,this.instanceID>0&&en()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},vf),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new cf({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Eu(s.fetch),this.lock=s.lock||ml,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:en()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=ff:this.lock=ml,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:bu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=_l(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=_l(this.memoryStorage)),en()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Rr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Rr[this.storageKey]=Object.assign(Object.assign({},Rr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Rr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Rr[this.storageKey]=Object.assign(Object.assign({},Rr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${_u}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Bh(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),en()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:l}=await this._getSessionFromURL(t,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Rh(l)){const v=(e=l.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:h}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",h),await this._saveSession(c),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return we(t)?{error:t}:{error:new yu("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const l=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:An}),{data:c,error:h}=l;if(h||!c)return{data:{user:null,session:null},error:h};const v=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(l){if(we(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(e){var t,r,s;try{let l;if("email"in e){const{email:m,password:E,options:A}=e;let _=null,S=null;this.flowType==="pkce"&&([_,S]=await Tr(this.storage,this.storageKey)),l=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:A?.emailRedirectTo,body:{email:m,password:E,data:(t=A?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:A?.captchaToken},code_challenge:_,code_challenge_method:S},xform:An})}else if("phone"in e){const{phone:m,password:E,options:A}=e;l=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:E,data:(r=A?.data)!==null&&r!==void 0?r:{},channel:(s=A?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:A?.captchaToken}},xform:An})}else throw new Yi("You must provide either an email or phone number and a password");const{data:c,error:h}=l;if(h||!c)return{data:{user:null,session:null},error:h};const v=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(l){if(we(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:h}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:gl})}else if("phone"in e){const{phone:l,password:c,options:h}=e;t=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:gl})}else throw new Yi("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ki}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,s,l,c,h,v,g,m,E,A,_;let S,L;if("message"in e)S=e.message,L=e.signature;else{const{chain:x,wallet:D,statement:N,options:U}=e;let H;if(en())if(typeof D=="object")H=D;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))H=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!U?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");H=D}const G=new URL((t=U?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in H&&H.signIn){const R=await H.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},U?.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),N?{statement:N}:null));let M;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")M=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)M=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in M&&"signature"in M&&(typeof M.signedMessage=="string"||M.signedMessage instanceof Uint8Array)&&M.signature instanceof Uint8Array)S=typeof M.signedMessage=="string"?M.signedMessage:new TextDecoder().decode(M.signedMessage),L=M.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in H)||typeof H.signMessage!="function"||!("publicKey"in H)||typeof H!="object"||!H.publicKey||!("toBase58"in H.publicKey)||typeof H.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${G.host} wants you to sign in with your Solana account:`,H.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(s=(r=U?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=U?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${U.signInWithSolana.notBefore}`]:[],...!((c=U?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${U.signInWithSolana.expirationTime}`]:[],...!((h=U?.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${U.signInWithSolana.chainId}`]:[],...!((v=U?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${U.signInWithSolana.nonce}`]:[],...!((g=U?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${U.signInWithSolana.requestId}`]:[],...!((E=(m=U?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||E===void 0)&&E.length?["Resources",...U.signInWithSolana.resources.map(M=>`- ${M}`)]:[]].join(`
`);const R=await H.signMessage(new TextEncoder().encode(S),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");L=R}}try{const{data:x,error:D}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Fh(L)},!((A=e.options)===null||A===void 0)&&A.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:An});if(D)throw D;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Ki}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:D})}catch(x){if(we(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const t=await Qn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:l,error:c}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:An});if(await Mn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Ki}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(we(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:l,nonce:c}=e,h=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:An}),{data:v,error:g}=h;return g?{data:{user:null,session:null},error:g}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new Ki}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:g})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,l,c;try{if("email"in e){const{email:h,options:v}=e;let g=null,m=null;this.flowType==="pkce"&&([g,m]=await Tr(this.storage,this.storageKey));const{error:E}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(r=v?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:g,code_challenge_method:m},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:E}}if("phone"in e){const{phone:h,options:v}=e,{data:g,error:m}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(s=v?.data)!==null&&s!==void 0?s:{},create_user:(l=v?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(c=v?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:m}}throw new Yi("You must provide either an email or phone number.")}catch(h){if(we(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var t,r;try{let s,l;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:h}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:An});if(h)throw h;if(!c)throw new Error("An error occurred on token verification.");const v=c.session,g=c.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(s){if(we(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Tr(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:sf})}catch(l){if(we(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Dn;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(we(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:l}=e,{error:c}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:r,type:s,options:l}=e,{data:c,error:h}=await Me(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:h}}throw new Yi("You must provide either an email or phone number and a type")}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Qn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Ks:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await Qn(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=Xs()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(v,g,m)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,g,m))})}return{data:{session:e},error:null}}const{session:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$n}):await this._useSession(async t=>{var r,s,l;const{data:c,error:h}=t;if(h)throw h;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dn}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:$n})})}catch(t){if(we(t))return xh(t)&&(await this._removeSession(),await Mn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:l}=r;if(l)throw l;if(!s.session)throw new Dn;const c=s.session;let h=null,v=null;this.flowType==="pkce"&&e.email!=null&&([h,v]=await Tr(this.storage,this.storageKey));const{data:g,error:m}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:v}),jwt:c.access_token,xform:$n});if(m)throw m;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Dn;const t=Date.now()/1e3;let r=t,s=!0,l=null;const{payload:c}=Js(e.access_token);if(c.exp&&(r=c.exp,s=r<=t),s){const{session:h,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!h)return{data:{user:null,session:null},error:null};l=h}else{const{data:h,error:v}=await this._getUser(e.access_token);if(v)throw v;l={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(we(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:h}=t;if(h)throw h;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new Dn;const{session:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!en())throw new Ji("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ji(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ul("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ji("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ul("No code detected.");const{data:N,error:U}=await this._exchangeCodeForSession(e.code);if(U)throw U;const H=new URL(window.location.href);return H.searchParams.delete("code"),window.history.replaceState(window.history.state,"",H.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:h,expires_at:v,token_type:g}=e;if(!l||!h||!c||!g)throw new Ji("No session defined in URL");const m=Math.round(Date.now()/1e3),E=parseInt(h);let A=m+E;v&&(A=parseInt(v));const _=A-m;_*1e3<=jr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${E}s`);const S=A-E;m-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,A,m):m-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,A,m);const{data:L,error:x}=await this._getUser(l);if(x)throw x;const D={provider_token:r,provider_refresh_token:s,access_token:l,expires_in:E,expires_at:A,refresh_token:c,token_type:g,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:D,redirectType:e.type},error:null}}catch(r){if(we(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Qn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:l}=t;if(l)return{error:l};const c=(r=s.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:h}=await this.admin.signOut(c,e);if(h&&!(Ph(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await Mn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Nh(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:l},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Tr(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(we(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:s}=await this._useSession(async l=>{var c,h,v,g,m;const{data:E,error:A}=l;if(A)throw A;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",_,{headers:this.headers,jwt:(m=(g=E.session)===null||g===void 0?void 0:g.access_token)!==null&&m!==void 0?m:void 0})});if(s)throw s;return en()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(we(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:l,error:c}=t;if(c)throw c;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await qh(async s=>(s>0&&await Vh(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:An})),(s,l)=>{const c=200*Math.pow(2,s);return l&&Ys(l)&&Date.now()+c-r<jr})}catch(r){if(this._debug(t,"error",r),we(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),en()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Qn(this.storage,this.storageKey);if(s&&this.userStorage){let c=await Qn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await Mr(this.userStorage,this.storageKey+"-user",c)),s.user=(e=c?.user)!==null&&e!==void 0?e:Xs()}else if(s&&!s.user&&!s.user){const c=await Qn(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await Mn(this.storage,this.storageKey+"-user"),await Mr(this.storage,this.storageKey,s)):s.user=Xs()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const l=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ks;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${Ks}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),Ys(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:h}=await this._getUser(s.access_token);!h&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Dn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Es;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Dn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const h={session:l.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(l){if(this._debug(s,"error",l),we(l)){const c={session:null,error:l};return Ys(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,t)}catch(v){l.push(v)}});if(await Promise.all(c),l.length>0){for(let h=0;h<l.length;h+=1)console.error(l[h]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Mr(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const l=vl(s);await Mr(this.storage,this.storageKey,l)}else{const s=vl(t);await Mr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Mn(this.storage,this.storageKey),await Mn(this.storage,this.storageKey+"-code-verifier"),await Mn(this.storage,this.storageKey+"-user"),this.userStorage&&await Mn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&en()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),jr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/jr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${jr}ms, refresh threshold is ${fa} ticks`),s<=fa&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Au)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!en()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await Tr(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(h.toString())}if(r?.queryParams){const l=new URLSearchParams(r.queryParams);s.push(l.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:l}=t;return l?{data:null,error:l}:await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:l,error:c}=t;if(c)return{data:null,error:c};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:v,error:g}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(r=l?.session)===null||r===void 0?void 0:r.access_token});return g?{data:null,error:g}:(e.factorType==="totp"&&(!((s=v?.totp)===null||s===void 0)&&s.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:h}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:h})})}catch(t){if(we(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:l}=t;return l?{data:null,error:l}:await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(we(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],s=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:s,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:l}=e;if(l)return{data:null,error:l};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Js(s.access_token);let h=null;c.aal&&(h=c.aal);let v=h;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(E=>E.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(v="aal2");const m=c.amr||[];return{data:{currentLevel:h,nextLevel:v,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(h=>h.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(h=>h.kid===e),r&&this.jwks_cached_at+Ch>s)return r;const{data:l,error:c}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,r=l.keys.find(h=>h.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:_,error:S}=await this.getSession();if(S||!_.session)return{data:null,error:S};r=_.session.access_token}const{header:s,payload:l,signature:c,raw:{header:h,payload:v}}=Js(r);t?.allowExpired||Xh(l.exp);const g=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:_}=await this.getUser(r);if(_)throw _;return{data:{claims:l,header:s,signature:c},error:null}}const m=Qh(s.alg),E=await crypto.subtle.importKey("jwk",g,m,!0,["verify"]);if(!await crypto.subtle.verify(m,E,c,$h(`${h}.${v}`)))throw new ga("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}}_i.nextInstanceID=0;const pf=_i;class gf extends pf{constructor(e){super(e)}}var _f=function(n,e,t,r){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(r.next(m))}catch(E){c(E)}}function v(m){try{g(r.throw(m))}catch(E){c(E)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((r=r.apply(n,e||[])).next())})};class mf{constructor(e,t,r){var s,l,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=bh(e),v=new URL(h);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const g=`sb-${v.hostname.split(".")[0]}-auth-token`,m={db:fh,realtime:ph,auth:Object.assign(Object.assign({},vh),{storageKey:g}),global:hh},E=Eh(r??{},m);this.storageKey=(s=E.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(l=E.global.headers)!==null&&l!==void 0?l:{},E.accessToken?(this.accessToken=E.accessToken,this.auth=new Proxy({},{get:(A,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=E.auth)!==null&&c!==void 0?c:{},this.headers,E.global.fetch),this.fetch=yh(t,this._getAccessToken.bind(this),E.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},E.realtime)),this.rest=new jd(new URL("rest/v1",v).href,{headers:this.headers,schema:E.db.schema,fetch:this.fetch}),this.storage=new uh(this.storageUrl.href,this.headers,this.fetch,r?.storage),E.accessToken||this._listenForAuthEvents()}get functions(){return new bd(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return _f(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:l,flowType:c,lock:h,debug:v},g,m){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new gf({url:this.authUrl.href,headers:Object.assign(Object.assign({},E),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:c,lock:h,debug:v,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Jd(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const yf=(n,e,t)=>new mf(n,e,t);function wf(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}wf()&&console.warn("â ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const bf="https://vycjpmuyscfygstjjied.supabase.co",Ef="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",sr="dracula",ar=yf(bf,Ef,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}}),Af=rr({showEditor:!1,showItems:!1,editingOptionIndex:null,editingItemIndex:null,selectedChapterId:null,selectedDialogueId:null,data:{dialogues:[],chapters:[]},storedFiles:[],storiesList:[],currentFileName:"dracula_story_v3.json",statusMessage:{type:"",text:""},get currentDialogue(){return this.data?.dialogues.find(n=>n.id===this.selectedDialogueId)},get currentChapter(){return this.data?.chapters?.find(n=>n.id===this.selectedChapterId)},get currentEditingOption(){return this.currentDialogue&&this.editingOptionIndex!==null?this.currentDialogue.options?.[this.editingOptionIndex]:null},get chapterDialogues(){return this.data?.dialogues.filter(n=>n.chapterId===this.selectedChapterId)||[]},get imageResources(){return this.storedFiles.filter(n=>n.name.match(/\.(png|jpg|jpeg|webp|gif)$/i))},get rivResources(){return this.storedFiles.filter(n=>n.name.endsWith(".riv"))},get availableItems(){return this.data?.items||[]},get backlinks(){return!this.data||!this.selectedDialogueId?[]:this.data.dialogues.filter(n=>n.nextDialogueId===this.selectedDialogueId?!0:n.options?n.options.some(e=>e.nextDialogueId===this.selectedDialogueId):!1)}}),fe=Af,Pt={toggleEditor(){fe.showEditor=!fe.showEditor},toggleItemsPanel(){fe.showItems=!fe.showItems},setStatus(n,e){fe.statusMessage={type:n,text:e}},clearStatus(){fe.statusMessage={type:"",text:""}}};function kf(n){return n.dialogues&&n.dialogues.forEach(e=>{e.options&&e.options.forEach(t=>{typeof t.enabled>"u"&&(t.enabled=!0),typeof t.visible>"u"&&(t.visible=!0),t.visibleIf&&!t.visibilityCondition&&(t.visibleIf.hasItem&&(t.visibilityCondition={type:"has_item",itemId:t.visibleIf.hasItem}),delete t.visibleIf),t.visibilityCondition||(t.visibilityCondition={type:"always"})})}),n.chapters||(n.chapters=[{id:"main",title:"ÐÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸ÑÑÐ¾ÑÐ¸Ñ"}],n.dialogues&&n.dialogues.forEach(e=>{e.chapterId||(e.chapterId="main")})),n.items||(n.items=[]),n.meta||(n.meta={version:"3.1",title:n.title||"Untitled"}),n.miniGames&&Array.isArray(n.miniGames)&&(n.miniGames=n.miniGames.map(e=>e.id&&!e.onWinDialogueId?{...e,onWinDialogueId:e.winTarget||"",onLoseDialogueId:e.loseTarget||""}:e)),n}function Sf(){return{text:"ÐÐ¾Ð²ÑÐ¹ Ð²Ð°ÑÐ¸Ð°Ð½Ñ",enabled:!0,visible:!0,visibilityCondition:{type:"always"}}}const In={async createNewStory(){const n=prompt("ÐÐ²ÐµÐ´Ð¸ÑÐµ Ð¸Ð¼Ñ ÑÐ°Ð¹Ð»Ð° Ð¸ÑÑÐ¾ÑÐ¸Ð¸:","new_story.json");if(!n)return;const e={meta:{version:"3.1",title:"New Story"},chapters:[{id:"ch1",title:"ÐÐ»Ð°Ð²Ð° 1"}],dialogues:[{id:"start",chapterId:"ch1",text:"ÐÐ°ÑÐ°Ð»Ð¾...",options:[]}]},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),{error:r}=await ar.storage.from(sr).upload(n,t);r?Pt.setStatus("error","ÐÑÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ: "+r.message):(await resourceActions.loadStoriesList(),await this.loadStory(n))},async loadStory(n){Pt.setStatus("loading","ÐÐ°Ð³ÑÑÐ·ÐºÐ°..."),fe.currentFileName=n;try{const{data:e,error:t}=await ar.storage.from(sr).download(n);if(t)throw t;let r=JSON.parse(await e.text());r=kf(r),fe.data=r,fe.data.chapters&&fe.data.chapters.length>0&&(fe.selectedChapterId=fe.data.chapters[0].id),fe.data.dialogues&&fe.data.dialogues.length>0&&(fe.selectedDialogueId=fe.data.dialogues[0].id),Pt.setStatus("success","ÐÐ°Ð³ÑÑÐ¶ÐµÐ½Ð¾!")}catch(e){console.error(e),Pt.setStatus("error","ÐÑÐ¸Ð±ÐºÐ° Ð·Ð°Ð³ÑÑÐ·ÐºÐ¸: "+e.message)}},async saveCurrentStory(){if(!fe.data)return;Pt.setStatus("loading","Ð¡Ð¾ÑÑÐ°Ð½ÐµÐ½Ð¸Ðµ...");const n=new Blob([JSON.stringify(fe.data,null,2)],{type:"application/json"}),{error:e}=await ar.storage.from(sr).upload(fe.currentFileName,n,{upsert:!0});Pt.setStatus(e?"error":"success",e?"ÐÑÐ¸Ð±ÐºÐ° ÑÐ¾ÑÑÐ°Ð½ÐµÐ½Ð¸Ñ":"Ð¡Ð¾ÑÑÐ°Ð½ÐµÐ½Ð¾!")},async saveStoryCopy(){if(!fe.data)return;const n=fe.currentFileName.replace(".json",""),e=new Date().getTime();let t=`${n}_copy_${e}.json`.trim();const r=prompt("ÐÐ²ÐµÐ´Ð¸ÑÐµ Ð¸Ð¼Ñ Ð´Ð»Ñ ÐºÐ¾Ð¿Ð¸Ð¸:",t);if(!r)return;t=r.trim(),t.endsWith(".json")||(t+=".json"),Pt.setStatus("loading","Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¿Ð¸Ð¸...");const s=new Blob([JSON.stringify(fe.data,null,2)],{type:"application/json"}),{error:l}=await ar.storage.from(sr).upload(t,s,{upsert:!0});l?Pt.setStatus("error",`ÐÑÐ¸Ð±ÐºÐ° ÐºÐ¾Ð¿Ð¸Ð¸: ${l.message}`):(await resourceActions.loadStoriesList(),Pt.setStatus("success","ÐÐ¾Ð¿Ð¸Ñ ÑÐ¾ÑÑÐ°Ð½ÐµÐ½Ð°!"))},addChapter(){if(!fe.data||!fe.data.chapters)return;const n="ch_"+Date.now();fe.data.chapters.push({id:n,title:"ÐÐ¾Ð²Ð°Ñ Ð³Ð»Ð°Ð²Ð°"}),fe.selectedChapterId=n},addDialogue(){if(!fe.data||!fe.selectedChapterId)return;const n="d_"+Date.now();fe.data.dialogues.push({id:n,chapterId:fe.selectedChapterId,text:"ÐÐ¾Ð²ÑÐ¹ ÑÐµÐºÑÑ...",options:[]}),fe.selectedDialogueId=n},deleteDialogue(n){confirm("Ð£Ð´Ð°Ð»Ð¸ÑÑ Ð´Ð¸Ð°Ð»Ð¾Ð³ "+n+"?")&&fe.data&&(fe.data.dialogues=fe.data.dialogues.filter(e=>e.id!==n),fe.data.dialogues.forEach(e=>{e.nextDialogueId===n&&(e.nextDialogueId=""),e.options&&e.options.forEach(t=>{t.nextDialogueId===n&&(t.nextDialogueId="")})}),fe.selectedDialogueId===n&&(fe.selectedDialogueId=null))},jumpTo(n){const e=fe.data?.dialogues.find(t=>t.id===n);e&&(fe.selectedChapterId=e.chapterId,fe.selectedDialogueId=n)},getLinkType(n,e){return n.nextDialogueId===e?"Auto":"Option"}},vi={async loadStoriesList(){const{data:n,error:e}=await ar.storage.from(sr).list("",{search:".json"});!e&&n&&(fe.storiesList=n.map(t=>t.name).filter(t=>t!==".emptyFolderPlaceholder"))},async loadStoredResources(){const{data:n}=await ar.storage.from(sr).list();n&&(fe.storedFiles=n.filter(e=>e.name!==".emptyFolderPlaceholder"&&!e.name.endsWith(".json")))},async uploadNewFile(n){const e=n.target;if(!e.files||e.files.length===0)return;const t=e.files[0];Pt.setStatus("loading","ÐÐ°Ð³ÑÑÐ·ÐºÐ° ÑÐ°Ð¹Ð»Ð°...");const{error:r}=await ar.storage.from(sr).upload(t.name,t,{upsert:!0});r?Pt.setStatus("error","ÐÑÐ¸Ð±ÐºÐ° Ð·Ð°Ð³ÑÑÐ·ÐºÐ¸"):(Pt.setStatus("success","Ð¤Ð°Ð¹Ð» Ð·Ð°Ð³ÑÑÐ¶ÐµÐ½"),await this.loadStoredResources())}};var Dt=bi(()=>fe),If=ce("<div> </div>"),Cf=ce('<div><span class="id-badge svelte-chskml"> </span> <span class="preview-text svelte-chskml"> </span></div>'),Tf=ce("<div> </div>"),Pf=ce('<aside class="sidebar svelte-chskml"><div class="sidebar-section svelte-chskml"><div class="section-header"><h3>ÐÐ»Ð°Ð²Ñ</h3> <button class="btn-icon">+</button></div> <div class="chapter-list svelte-chskml"></div></div> <div class="sidebar-section flex-1 svelte-chskml"><div class="section-header"><h3> </h3> <button class="btn-icon">+</button></div> <div class="dialogue-list svelte-chskml"></div></div> <div class="status-box svelte-chskml"><!></div></aside>');function xf(n,e){sn(e,!1),pr();var t=Pf(),r=F(t),s=F(r),l=B(F(s),2);l.__click=function(...x){In.addChapter?.apply(this,x)};var c=B(s,2);Et(c,5,()=>Dt().data?.chapters||[],x=>x.id,(x,D)=>{var N=If();let U;N.__click=()=>Dt(Dt().selectedChapterId=$(D).id);var H=F(N);xe(G=>{U=Fr(N,1,"chapter-item svelte-chskml",null,U,G),He(H,$(D).title)},[()=>({active:Dt().selectedChapterId===$(D).id})]),ne(x,N)});var h=B(r,2),v=F(h),g=F(v),m=F(g),E=B(g,2);E.__click=function(...x){In.addDialogue?.apply(this,x)};var A=B(v,2);Et(A,5,()=>Dt().chapterDialogues,x=>x.id,(x,D)=>{var N=Cf();let U;N.__click=()=>Dt(Dt().selectedDialogueId=$(D).id);var H=F(N),G=F(H),R=B(H,2),M=F(R);xe((ie,Y)=>{U=Fr(N,1,"dialogue-item svelte-chskml",null,U,ie),He(G,$(D).id),He(M,`${Y??""}...`)},[()=>({active:Dt().selectedDialogueId===$(D).id}),()=>$(D).text.substring(0,25)]),ne(x,N)});var _=B(h,2),S=F(_);{var L=x=>{var D=Tf(),N=F(D);xe(()=>{Fr(D,1,`alert ${Dt().statusMessage.type??""}`,"svelte-chskml"),He(N,Dt().statusMessage.text)}),ne(x,D)};Ge(S,x=>{Dt().statusMessage.text&&x(L)})}xe(()=>{He(m,`Ð¡ÑÐµÐ½Ñ (${Dt().chapterDialogues.length??""})`),E.disabled=!Dt().selectedChapterId}),ne(n,t),an()}vr(["click"]);var Rf=ce("<option> </option>"),Of=ce("<option> </option>"),jf=ce("<option> </option>"),Mf=ce('<div class="form-group full-width svelte-1br6fha"><label>ÐÑÐµÐ´Ð¼ÐµÑ</label> <select class="input select"><option>-- ÐÑÐ±ÐµÑÐ¸ÑÐµ Ð¿ÑÐµÐ´Ð¼ÐµÑ --</option><!></select></div>'),Lf=ce('<div class="form-group svelte-1br6fha"><label>Ð¡ÑÐ°ÑÐ°</label> <input type="text" class="input" placeholder="knowledge"/></div> <div class="form-group svelte-1br6fha"><label>ÐÐ½Ð°ÑÐµÐ½Ð¸Ðµ ></label> <input type="number" class="input"/></div>',1),Df=ce('<div class="form-group full-width svelte-1br6fha"><label>ÐÐ¼Ñ ÑÐ»Ð°Ð³Ð°</label> <input type="text" class="input" placeholder="metDracula"/></div>'),$f=ce('<div class="option-details svelte-1br6fha"><div class="form-group"><label>Ð¢ÐµÐºÑÑ ÐºÐ½Ð¾Ð¿ÐºÐ¸</label> <input type="text" class="input"/></div> <div class="form-group"><label>ÐÐµÑÐµÑÐ¾Ð´</label> <select class="input select"><option>-- ÐÐ¾Ð½ÐµÑ Ð²ÐµÑÐºÐ¸ --</option><!></select></div> <div class="options-settings-grid svelte-1br6fha"><div class="setting-col svelte-1br6fha"><label class="checkbox-row svelte-1br6fha"><input type="checkbox"/> ÐÐºÐ»ÑÑÐµÐ½Ð¾ (Enable)</label> <p class="setting-desc svelte-1br6fha">ÐÑÐ»Ð¸ Ð²ÑÐºÐ»ÑÑÐµÐ½Ð¾, ÐºÐ½Ð¾Ð¿ÐºÐ° ÑÐµÑÐ°Ñ Ð¸ Ð½Ðµ ÐºÐ»Ð¸ÐºÐ°Ð±ÐµÐ»ÑÐ½Ð°.</p></div> <div class="setting-col svelte-1br6fha"><label class="checkbox-row svelte-1br6fha"><input type="checkbox"/> ÐÐ¸Ð´Ð¸Ð¼Ð¾ (Visible)</label> <p class="setting-desc svelte-1br6fha">ÐÑÐ»Ð¸ ÑÐºÑÑÑÐ¾, ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð½ÐµÑ Ð² ÑÐ¿Ð¸ÑÐºÐµ.</p></div></div> <div class="trigger-section svelte-1br6fha"><h5 class="svelte-1br6fha">Ð£ÑÐ»Ð¾Ð²Ð¸Ðµ Ð²Ð¸Ð´Ð¸Ð¼Ð¾ÑÑÐ¸</h5> <div class="form-row svelte-1br6fha"><div class="form-group svelte-1br6fha"><label>Ð¢Ð¸Ð¿ ÑÑÐ»Ð¾Ð²Ð¸Ñ</label> <select class="input select"></select></div> <!> <!> <!></div></div></div>');function Ff(n,e){sn(e,!0);const t=fd(e,"option");function r(){t().visibilityCondition||(t().visibilityCondition={type:"always"})}function s(){return r(),t().visibilityCondition}function l(se){r(),t().visibilityCondition={...t().visibilityCondition,...se}}var c=$f(),h=F(c),v=B(F(h),2),g=B(h,2),m=B(F(g),2),E=F(m);E.value=E.__value="";var A=B(E);Et(A,17,()=>e.dialogues,zt,(se,Te)=>{var oe=Rf(),Je=F(oe),Ne={};xe(Re=>{He(Je,`${$(Te).id??""}: ${Re??""}...`),Ne!==(Ne=$(Te).id)&&(oe.value=(oe.__value=$(Te).id)??"")},[()=>$(Te).text.substring(0,30)]),ne(se,oe)});var _=B(g,2),S=F(_),L=F(S),x=F(L),D=B(S,2),N=F(D),U=F(N),H=B(_,2),G=B(F(H),2),R=F(G),M=B(F(R),2);Et(M,21,()=>e.conditionTypes,zt,(se,Te)=>{var oe=Of(),Je=F(oe),Ne={};xe(()=>{He(Je,$(Te)),Ne!==(Ne=$(Te))&&(oe.value=(oe.__value=$(Te))??"")}),ne(se,oe)});var ie;sa(M);var Y=B(R,2);{var le=se=>{var Te=Mf(),oe=B(F(Te),2),Je=F(oe);Je.value=Je.__value="";var Ne=B(Je);Et(Ne,17,()=>e.availableItems,zt,(Oe,st)=>{var ye=jf(),Pe=F(ye),be={};xe(()=>{He(Pe,$(st).name),be!==(be=$(st).id)&&(ye.value=(ye.__value=$(st).id)??"")}),ne(Oe,ye)});var Re;sa(oe),xe(Oe=>{Re!==(Re=Oe)&&(oe.value=(oe.__value=Oe)??"",ls(oe,Oe))},[()=>s().itemId||""]),tr("change",oe,Oe=>l({itemId:Oe.target.value})),ne(se,Te)};Ge(Y,se=>{s().type==="has_item"&&se(le)})}var J=B(Y,2);{var ee=se=>{var Te=Lf(),oe=Gt(Te),Je=B(F(oe),2),Ne=B(oe,2),Re=B(F(Ne),2);xe((Oe,st)=>{Vs(Je,Oe),Vs(Re,st)},[()=>s().statName||"",()=>s().statValue||""]),tr("input",Je,Oe=>l({statName:Oe.target.value})),tr("input",Re,Oe=>l({statValue:parseInt(Oe.target.value)||0})),ne(se,Te)};Ge(J,se=>{s().type==="stat_greater"&&se(ee)})}var ve=B(J,2);{var qe=se=>{var Te=Df(),oe=B(F(Te),2);xe(Je=>Vs(oe,Je),[()=>s().flagName||""]),tr("input",oe,Je=>l({flagName:Je.target.value})),ne(se,Te)};Ge(ve,se=>{s().type==="flag_true"&&se(qe)})}xe(se=>{ie!==(ie=se)&&(M.value=(M.__value=se)??"",ls(M,se))},[()=>s().type]),ir(v,()=>t().text,se=>t().text=se),Ur(m,()=>t().nextDialogueId,se=>t().nextDialogueId=se),Ho(x,()=>t().enabled,se=>t().enabled=se),Ho(U,()=>t().visible,se=>t().visible=se),tr("change",M,se=>{const Te=se.target.value;l({type:Te})}),ne(n,c),an()}var _e=bi(()=>fe),Uf=ce("<option> </option>"),Nf=ce("<option> </option>"),Bf=ce("<option> </option>"),Wf=ce("<option> </option>"),Vf=ce('<div><div class="option-header svelte-1x64pwp"><span class="status-icons svelte-1x64pwp"><!></span> <span> </span> <button class="btn-icon danger">Ã</button></div> <!></div>'),qf=ce("<option> </option>"),Hf=ce('<div class="dialogue-form svelte-1x64pwp"><div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">ID Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°</label> <input type="text" class="input svelte-1x64pwp"/></div> <div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">Ð¢ÐµÐºÑÑ</label> <textarea class="textarea svelte-1x64pwp" rows="3"></textarea></div> <div class="media-section svelte-1x64pwp"><h4 class="svelte-1x64pwp">ÐÐµÐ´Ð¸Ð° ÑÐµÑÑÑÑÑ</h4> <div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">Ð¤Ð¾Ð½</label> <div class="input-group svelte-1x64pwp"><select class="input select svelte-1x64pwp"><option>-- ÐÐµÑ --</option><!><!></select> <label class="btn-file svelte-1x64pwp">ÐÐ°Ð³ÑÑÐ·Ð¸ÑÑ <input type="file" accept="image/*,.riv" hidden/></label></div></div> <div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">ÐÐµÑÑÐ¾Ð½Ð°Ð¶</label> <div class="input-group svelte-1x64pwp"><select class="input select svelte-1x64pwp"><option>-- ÐÐµÑ --</option><!><!></select></div></div></div> <div class="options-section svelte-1x64pwp"><div class="section-header svelte-1x64pwp"><h4 class="svelte-1x64pwp">ÐÐ°ÑÐ¸Ð°Ð½ÑÑ Ð¾ÑÐ²ÐµÑÐ¾Ð²</h4> <button class="btn small">+ ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ</button></div> <!></div> <div class="links-section svelte-1x64pwp"><h4 class="svelte-1x64pwp">ÐÐ²ÑÐ¾-Ð¿ÐµÑÐµÑÐ¾Ð´</h4> <select class="input select svelte-1x64pwp"><option>-- ÐÐµÑ --</option><!></select></div> <div class="form-actions svelte-1x64pwp"><button class="btn danger">Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÐµÐ½Ñ</button></div></div>'),zf=ce('<div class="empty-state">ÐÑÐ±ÐµÑÐ¸ÑÐµ ÑÑÐµÐ½Ñ</div>');function Gf(n,e){sn(e,!1);const t=["always","has_item","stat_greater","flag_true"];function r(m){m.options||(m.options=[]);const E=Sf();m.options.push(E),_e(_e().editingOptionIndex=m.options.length-1)}function s(m){if(_e().editingOptionIndex===m)_e(_e().editingOptionIndex=null);else{_e(_e().editingOptionIndex=m);const E=_e().currentDialogue?.options?.[m];E&&!E.visibilityCondition&&(E.visibilityCondition={type:"always"})}}function l(m,E){confirm("Ð£Ð´Ð°Ð»Ð¸ÑÑ Ð²Ð°ÑÐ¸Ð°Ð½Ñ Ð¾ÑÐ²ÐµÑÐ°?")&&(m.options?.splice(E,1),_e().editingOptionIndex===E?_e(_e().editingOptionIndex=null):_e().editingOptionIndex&&_e().editingOptionIndex>E&&_e(_e().editingOptionIndex--))}pr();var c=Sn(),h=Gt(c);{var v=m=>{var E=Hf(),A=F(E),_=B(F(A),2),S=B(A,2),L=B(F(S),2),x=B(S,2),D=B(F(x),2),N=B(F(D),2),U=F(N);xe(()=>{_e(),tn(()=>{})});var H=F(U);H.value=H.__value="";var G=B(H);Et(G,1,()=>_e().imageResources,zt,(be,ue)=>{var pe=Uf(),je=F(pe),Ye={};xe(()=>{He(je,$(ue).name),Ye!==(Ye=$(ue).name)&&(pe.value=(pe.__value=$(ue).name)??"")}),ne(be,pe)});var R=B(G);Et(R,1,()=>_e().rivResources,zt,(be,ue)=>{var pe=Nf(),je=F(pe),Ye={};xe(()=>{He(je,`${$(ue).name??""} (Rive)`),Ye!==(Ye=$(ue).name)&&(pe.value=(pe.__value=$(ue).name)??"")}),ne(be,pe)});var M=B(U,2),ie=B(F(M));ie.__change=function(...be){vi.uploadNewFile?.apply(this,be)};var Y=B(D,2),le=B(F(Y),2),J=F(le);xe(()=>{_e(),tn(()=>{})});var ee=F(J);ee.value=ee.__value="";var ve=B(ee);Et(ve,1,()=>_e().imageResources,zt,(be,ue)=>{var pe=Bf(),je=F(pe),Ye={};xe(()=>{He(je,$(ue).name),Ye!==(Ye=$(ue).name)&&(pe.value=(pe.__value=$(ue).name)??"")}),ne(be,pe)});var qe=B(ve);Et(qe,1,()=>_e().rivResources,zt,(be,ue)=>{var pe=Wf(),je=F(pe),Ye={};xe(()=>{He(je,`${$(ue).name??""} (Rive)`),Ye!==(Ye=$(ue).name)&&(pe.value=(pe.__value=$(ue).name)??"")}),ne(be,pe)});var se=B(x,2),Te=F(se),oe=B(F(Te),2);oe.__click=()=>r(_e().currentDialogue);var Je=B(Te,2);Et(Je,1,()=>_e().currentDialogue.options||[],zt,(be,ue,pe)=>{var je=Vf();let Ye;var yt=F(je);yt.__click=()=>s(pe);var kt=F(yt),Nt=F(kt);{var ht=vt=>{var Bt=Bs("ðï¸âð¨ï¸");ne(vt,Bt)},St=vt=>{var Bt=Sn(),qn=Gt(Bt);{var Mt=o=>{var d=Bs("ð");ne(o,d)},p=o=>{var d=Bs("â");ne(o,d)};Ge(qn,o=>{$(ue).enabled?o(p,!1):o(Mt)},!0)}ne(vt,Bt)};Ge(Nt,vt=>{$(ue).visible?vt(St,!1):vt(ht)})}var jt=B(kt,2),ot=F(jt),tt=B(jt,2);tt.__click=()=>l(_e().currentDialogue,pe);var on=B(yt,2);{var ft=vt=>{Ff(vt,{get option(){return $(ue)},index:pe,get dialogues(){return _e().data.dialogues},get availableItems(){return _e().availableItems},get conditionTypes(){return t}})};Ge(on,vt=>{_e().editingOptionIndex===pe&&vt(ft)})}xe(vt=>{Ye=Fr(je,1,"option-card svelte-1x64pwp",null,Ye,vt),He(ot,`#${pe+1} ${$(ue).text??""}`)},[()=>({editing:_e().editingOptionIndex===pe})]),ne(be,je)});var Ne=B(se,2),Re=B(F(Ne),2);xe(()=>{_e(),tn(()=>{})});var Oe=F(Re);Oe.value=Oe.__value="";var st=B(Oe);Et(st,1,()=>_e().data.dialogues,zt,(be,ue)=>{var pe=qf(),je=F(pe),Ye={};xe(yt=>{He(je,`${$(ue).id??""}: ${yt??""}...`),Ye!==(Ye=$(ue).id)&&(pe.value=(pe.__value=$(ue).id)??"")},[()=>$(ue).text.substring(0,30)]),ne(be,pe)});var ye=B(Ne,2),Pe=F(ye);Pe.__click=()=>In.deleteDialogue(_e().currentDialogue.id),ir(_,()=>_e().currentDialogue.id,be=>_e(_e().currentDialogue.id=be)),ir(L,()=>_e().currentDialogue.text,be=>_e(_e().currentDialogue.text=be)),Ur(U,()=>_e().currentDialogue.backgroundImage,be=>_e(_e().currentDialogue.backgroundImage=be)),Ur(J,()=>_e().currentDialogue.characterImage,be=>_e(_e().currentDialogue.characterImage=be)),Ur(Re,()=>_e().currentDialogue.nextDialogueId,be=>_e(_e().currentDialogue.nextDialogueId=be)),ne(m,E)},g=m=>{var E=zf();ne(m,E)};Ge(h,m=>{_e().currentDialogue?m(v):m(g,!1)})}ne(n,c),an()}vr(["change","click"]);var Ie=bi(()=>fe),Kf=ce('<img class="icon-preview svelte-lxnltn"/>'),Yf=ce('<div class="icon-placeholder svelte-lxnltn">ð¦</div>'),Jf=ce("<option> </option>"),Xf=ce('<div class="icon-preview-small svelte-lxnltn"><img alt="Preview" class="preview-image svelte-lxnltn"/> <span class="preview-name svelte-lxnltn"> </span></div>'),Qf=ce("<option> </option>"),Zf=ce('<div class="item-edit-form svelte-lxnltn"><div class="edit-grid svelte-lxnltn"><div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">ID Ð¿ÑÐµÐ´Ð¼ÐµÑÐ°</label> <input type="text" class="input svelte-lxnltn" placeholder="item_unique_id"/></div> <div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ</label> <input type="text" class="input svelte-lxnltn" placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿ÑÐµÐ´Ð¼ÐµÑÐ°"/></div> <div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">ÐÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ</label> <textarea class="textarea svelte-lxnltn" rows="2" placeholder="ÐÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿ÑÐµÐ´Ð¼ÐµÑÐ°..."></textarea></div> <div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">ÐÐºÐ¾Ð½ÐºÐ°</label> <div class="input-group svelte-lxnltn"><input type="text" class="input svelte-lxnltn" placeholder="icon.png"/> <select class="input select svelte-lxnltn"><option>-- ÐÑÐ±ÑÐ°ÑÑ Ð¸Ð· Ð·Ð°Ð³ÑÑÐ¶ÐµÐ½Ð½ÑÑ --</option><!></select> <label class="btn-file svelte-lxnltn">ÐÐ°Ð³ÑÑÐ·Ð¸ÑÑ <input type="file" accept="image/*" hidden/></label></div> <!></div> <div class="form-group svelte-lxnltn"><label class="svelte-lxnltn">Ð¢Ð¸Ð¿</label> <select class="item-type-select svelte-lxnltn"></select></div></div></div>'),ev=ce('<div><div class="item-info svelte-lxnltn"><div class="item-header svelte-lxnltn"><div class="item-icon svelte-lxnltn"><!></div> <div class="item-details svelte-lxnltn"><div class="item-name svelte-lxnltn"> </div> <div class="item-meta svelte-lxnltn"><span class="item-id svelte-lxnltn"> </span> <span> </span></div></div></div> <div class="item-description svelte-lxnltn"> <em>ÐÐµÑ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ</em></div></div> <div class="item-actions svelte-lxnltn"><button class="btn-icon svelte-lxnltn" title="ÐÑÐ±Ð»Ð¸ÑÐ¾Ð²Ð°ÑÑ">â</button> <button class="btn-icon svelte-lxnltn" title="Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ">âï¸</button> <button class="btn-icon danger svelte-lxnltn" title="Ð£Ð´Ð°Ð»Ð¸ÑÑ">Ã</button></div> <!></div>'),tv=ce('<div class="items-list svelte-lxnltn"></div>'),nv=ce('<div class="empty-items svelte-lxnltn"><div class="empty-icon svelte-lxnltn">ð¦</div> <div class="empty-text svelte-lxnltn">ÐÐµÑ Ð¿ÑÐµÐ´Ð¼ÐµÑÐ¾Ð²</div> <div class="empty-subtext svelte-lxnltn">ÐÐ¾Ð±Ð°Ð²ÑÑÐµ Ð¿ÑÐµÐ´Ð¼ÐµÑÑ Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² ÑÑÐ»Ð¾Ð²Ð¸ÑÑ</div></div>'),rv=ce('<div class="items-container svelte-lxnltn"><!> <button class="btn primary full-width svelte-lxnltn">+ ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ Ð¿ÑÐµÐ´Ð¼ÐµÑ</button></div>'),iv=ce('<div class="items-manager svelte-lxnltn"><div class="section-header svelte-lxnltn"><h4 class="svelte-lxnltn"><span class="icon svelte-lxnltn">ð¦</span> </h4> <span class="toggle-icon svelte-lxnltn"> </span></div> <!></div>');function sv(n,e){sn(e,!1);const t=[{value:"tool",label:"ÐÐ½ÑÑÑÑÐ¼ÐµÐ½Ñ"},{value:"key",label:"ÐÐ»ÑÑ"},{value:"consumable",label:"Ð Ð°ÑÑÐ¾Ð´ÑÐµÐ¼ÑÐ¹"},{value:"quest",label:"ÐÐ²ÐµÑÑÐ¾Ð²ÑÐ¹"},{value:"misc",label:"Ð Ð°Ð·Ð½Ð¾Ðµ"}];function r(){if(!Ie().data)return;Ie().data.items||Ie(Ie().data.items=[]);const x={id:`item_${Date.now()}`,name:"ÐÐ¾Ð²ÑÐ¹ Ð¿ÑÐµÐ´Ð¼ÐµÑ",description:"ÐÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿ÑÐµÐ´Ð¼ÐµÑÐ°",icon:"icon_default.png",type:"misc"};Ie().data.items.push(x),Ie(Ie().editingItemIndex=Ie().data.items.length-1)}function s(x){Ie().editingItemIndex===x?Ie(Ie().editingItemIndex=null):Ie(Ie().editingItemIndex=x)}function l(x){confirm("Ð£Ð´Ð°Ð»Ð¸ÑÑ Ð¿ÑÐµÐ´Ð¼ÐµÑ?")&&Ie().data?.items&&(Ie().data.items.splice(x,1),Ie(Ie().editingItemIndex=null))}function c(x){if(!Ie().data?.items)return;const D=Ie().data.items[x],N={...D,id:`${D.id}_copy_${Date.now()}`,name:`${D.name} (ÐºÐ¾Ð¿Ð¸Ñ)`};Ie().data.items.splice(x+1,0,N),Ie(Ie().editingItemIndex=x+1)}function h(x){return t.find(D=>D.value===x)?.label||x}pr();var v=iv(),g=F(v);g.__click=()=>Ie(Ie().showItems=!Ie().showItems);var m=F(g),E=B(F(m)),A=B(m,2),_=F(A),S=B(g,2);{var L=x=>{var D=rv(),N=F(D);{var U=R=>{var M=tv();Et(M,7,()=>Ie().data.items,ie=>ie.id,(ie,Y,le)=>{var J=ev();let ee;var ve=F(J);ve.__click=()=>s($(le));var qe=F(ve),se=F(qe),Te=F(se);{var oe=ot=>{var tt=Kf();xe(()=>{Lr(tt,"src",`https://vycjpmuyscfygstjjied.supabase.co/${bucketName}/${$(Y).icon}`),Lr(tt,"alt",$(Y).name)}),ne(ot,tt)},Je=ot=>{var tt=Yf();ne(ot,tt)};Ge(Te,ot=>{$(Y).icon?ot(oe):ot(Je,!1)})}var Ne=B(se,2),Re=F(Ne),Oe=F(Re),st=B(Re,2),ye=F(st),Pe=F(ye),be=B(ye,2);let ue;var pe=F(be),je=B(qe,2),Ye=F(je),yt=B(ve,2),kt=F(yt);kt.__click=()=>c($(le));var Nt=B(kt,2);Nt.__click=()=>s($(le));var ht=B(Nt,2);ht.__click=()=>l($(le));var St=B(yt,2);{var jt=ot=>{var tt=Zf(),on=F(tt),ft=F(on),vt=B(F(ft),2),Bt=B(ft,2),qn=B(F(Bt),2),Mt=B(Bt,2),p=B(F(Mt),2),o=B(Mt,2),d=B(F(o),2),w=F(d),C=B(w,2);C.__change=he=>($(Y).icon=he.target.value,tn(()=>Ie()));var O=F(C);O.value=O.__value="";var W=B(O);Et(W,1,()=>Ie().storedFiles.filter(he=>he.name.match(/\.(png|jpg|jpeg|webp|gif|svg)$/i)),zt,(he,nt)=>{var Qe=Jf(),lt=F(Qe),rt={};xe(()=>{He(lt,$(nt).name),rt!==(rt=$(nt).name)&&(Qe.value=(Qe.__value=$(nt).name)??"")}),ne(he,Qe)});var de=B(C,2),me=B(F(de));me.__change=function(...he){vi.uploadNewFile?.apply(this,he)};var ae=B(d,2);{var Se=he=>{var nt=Xf(),Qe=F(nt),lt=B(Qe,2),rt=F(lt);xe(()=>{Lr(Qe,"src",`https://vycjpmuyscfygstjjied.supabase.co/${bucketName}/${$(Y).icon}`),He(rt,$(Y).icon)}),ne(he,nt)};Ge(ae,he=>{$(Y).icon&&he(Se)})}var Be=B(o,2),at=B(F(Be),2);xe(()=>{$(Y),tn(()=>{})}),Et(at,5,()=>t,zt,(he,nt)=>{var Qe=Qf(),lt=F(Qe),rt={};xe(()=>{He(lt,$(nt).label),rt!==(rt=$(nt).value)&&(Qe.value=(Qe.__value=$(nt).value)??"")}),ne(he,Qe)}),ir(vt,()=>$(Y).id,he=>($(Y).id=he,tn(()=>Ie()))),ir(qn,()=>$(Y).name,he=>($(Y).name=he,tn(()=>Ie()))),ir(p,()=>$(Y).description,he=>($(Y).description=he,tn(()=>Ie()))),ir(w,()=>$(Y).icon,he=>($(Y).icon=he,tn(()=>Ie()))),Ur(at,()=>$(Y).type,he=>($(Y).type=he,tn(()=>Ie()))),ne(ot,tt)};Ge(St,ot=>{Ie().editingItemIndex===$(le)&&ot(jt)})}xe((ot,tt,on)=>{ee=Fr(J,1,"item-row svelte-lxnltn",null,ee,ot),He(Oe,$(Y).name),He(Pe,$(Y).id),ue=Fr(be,1,"item-type-badge svelte-lxnltn",null,ue,tt),He(pe,on),He(Ye,`${$(Y).description??""} || `)},[()=>({editing:Ie().editingItemIndex===$(le)}),()=>({tool:$(Y).type==="tool",key:$(Y).type==="key",consumable:$(Y).type==="consumable",quest:$(Y).type==="quest",misc:$(Y).type==="misc"}),()=>h($(Y).type)]),ne(ie,J)}),ne(R,M)},H=R=>{var M=nv();ne(R,M)};Ge(N,R=>{Ie().data?.items?.length?R(U):R(H,!1)})}var G=B(N,2);G.__click=r,ne(x,D)};Ge(S,x=>{Ie().showItems&&x(L)})}xe(()=>{Lr(g,"title",Ie().showItems?"Ð¡ÐºÑÑÑÑ Ð¿ÑÐµÐ´Ð¼ÐµÑÑ":"ÐÐ¾ÐºÐ°Ð·Ð°ÑÑ Ð¿ÑÐµÐ´Ð¼ÐµÑÑ"),He(E,` ÐÑÐµÐ´Ð¼ÐµÑÑ (${(Ie().data?.items?.length||0)??""})`),He(_,Ie().showItems?"â¼":"â¶")}),ne(n,v),an()}vr(["click","change"]);vr(["click"]);class av{#n=xt(rr({inventory:[],stats:{knowledge:0,courage:0,charisma:0}}));get player(){return $(this.#n)}set player(e){Tt(this.#n,e,!0)}#t=xt(null);get storyData(){return $(this.#t)}set storyData(e){Tt(this.#t,e,!0)}#e=xt("0");get currentDialogueId(){return $(this.#e)}set currentDialogueId(e){Tt(this.#e,e,!0)}#r=xt(!0);get isLoading(){return $(this.#r)}set isLoading(e){Tt(this.#r,e,!0)}#i=xt("");get error(){return $(this.#i)}set error(e){Tt(this.#i,e,!0)}async loadStory(e){this.isLoading=!0;try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.storyData=await t.json(),this.currentDialogueId=this.storyData.dialogues[0]?.id||"0"}catch(t){this.error="ÐÑÐ¸Ð±ÐºÐ° Ð·Ð°Ð³ÑÑÐ·ÐºÐ¸: "+t.message,console.error(t)}finally{this.isLoading=!1}}findDialogue(e){return this.storyData?.dialogues.find(t=>t.id===e)}getItem(e){return this.storyData?.items.find(t=>t.id===e)}hasItem(e){return this.player.inventory.includes(e)}addItem(e){this.player.inventory.includes(e)||(this.player.inventory=[...this.player.inventory,e])}runActions(e){e&&e.forEach(t=>{t.type==="add_item"&&t.id&&this.addItem(t.id),t.type==="stat_change"&&t.stat&&t.value!==void 0&&(this.player.stats[t.stat]+=t.value)})}goToDialogue(e){this.currentDialogueId=e}}const Rt=new av;var Zi={exports:{}},ov=Zi.exports,yl;function lv(){return yl||(yl=1,(function(n,e){(function(r,s){n.exports=s()})(ov,()=>(()=>{var t=[,((c,h,v)=>{v.r(h),v.d(h,{default:()=>m});var g=(()=>{var E=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(A={}){var _=A,S,L;_.ready=new Promise((i,a)=>{S=i,L=a});function x(){function i(k){const P=f;u=a=0,f=new Map,P.forEach(j=>{try{j(k)}catch(T){console.error(T)}}),this.pb(),y&&y.Tb()}let a=0,u=0,f=new Map,y=null,b=null;this.requestAnimationFrame=function(k){a||(a=requestAnimationFrame(i.bind(this)));const P=++u;return f.set(P,k),P},this.cancelAnimationFrame=function(k){f.delete(k),a&&f.size==0&&(cancelAnimationFrame(a),a=0)},this.Rb=function(k){b&&(document.body.remove(b),b=null),k||(b=document.createElement("div"),b.style.backgroundColor="black",b.style.position="fixed",b.style.right=0,b.style.top=0,b.style.color="white",b.style.padding="4px",b.innerHTML="RIVE FPS",k=function(P){b.innerHTML="RIVE FPS "+P.toFixed(1)},document.body.appendChild(b)),y=new function(){let P=0,j=0;this.Tb=function(){var T=performance.now();j?(++P,T-=j,1e3<T&&(k(1e3*P/T),P=j=0)):(j=T,P=0)}}},this.Ob=function(){b&&(document.body.remove(b),b=null),y=null},this.pb=function(){}}function D(i){console.assert(!0);const a=new Map;let u=-1/0;this.push=function(f){return f=f+((1<<i)-1)>>i,a.has(f)&&clearTimeout(a.get(f)),a.set(f,setTimeout(function(){a.delete(f),a.length==0?u=-1/0:f==u&&(u=Math.max(...a.keys()),console.assert(u<f))},1e3)),u=Math.max(f,u),u<<i}}const N=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){N&&N();let i=_.decodeAudio;_.decodeAudio=function(y,b){y=i(y),b(y)};let a=_.decodeFont;_.decodeFont=function(y,b){y=a(y),b(y)};const u=_.FileAssetLoader;_.ptrToAsset=y=>{let b=_.ptrToFileAsset(y);return b.isImage?_.ptrToImageAsset(y):b.isFont?_.ptrToFontAsset(y):b.isAudio?_.ptrToAudioAsset(y):b},_.CustomFileAssetLoader=u.extend("CustomFileAssetLoader",{__construct:function({loadContents:y}){this.__parent.__construct.call(this),this.Gb=y},loadContents:function(y,b){return y=_.ptrToAsset(y),this.Gb(y,b)}}),_.CDNFileAssetLoader=u.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(y){let b=_.ptrToAsset(y);return y=b.cdnUuid,y===""?!1:((function(k,P){var j=new XMLHttpRequest;j.responseType="arraybuffer",j.onreadystatechange=function(){j.readyState==4&&j.status==200&&P(j)},j.open("GET",k,!0),j.send(null)})(b.cdnBaseUrl+"/"+y,k=>{b.decode(new Uint8Array(k.response))}),!0)}}),_.FallbackFileAssetLoader=u.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(y){this.lb.push(y)},loadContents:function(y,b){for(let k of this.lb)if(k.loadContents(y,b))return!0;return!1}});let f=_.computeAlignment;_.computeAlignment=function(y,b,k,P,j=1){return f.call(this,y,b,k,P,j)}};const U="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),H=new function(){function i(){if(!a){let Ae=function(Ce,Q,Ze){if(Q=q.createShader(Q),q.shaderSource(Q,Ze),q.compileShader(Q),Ze=q.getShaderInfoLog(Q),0<(Ze||"").length)throw Ze;q.attachShader(Ce,Q)};var I=document.createElement("canvas"),z={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let q;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(q=I.getContext("webgl",z),u=1,!q)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(q=I.getContext("webgl2",z))u=2;else if(q=I.getContext("webgl",z))u=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(q=new Proxy(q,{get(Ce,Q){if(Ce.isContextLost()){if(j||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",Q),j=!0),typeof Ce[Q]=="function")return function(){}}else return typeof Ce[Q]=="function"?function(...Ze){return Ce[Q].apply(Ce,Ze)}:Ce[Q]},set(Ce,Q,Ze){if(Ce.isContextLost())j||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+Q),j=!0);else return Ce[Q]=Ze,!0}}),f=Math.min(q.getParameter(q.MAX_RENDERBUFFER_SIZE),q.getParameter(q.MAX_TEXTURE_SIZE)),I=q.createProgram(),Ae(I,q.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),Ae(I,q.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),q.bindAttribLocation(I,0,"vertex"),q.bindAttribLocation(I,1,"uv"),q.linkProgram(I),z=q.getProgramInfoLog(I),0<(z||"").trim().length)throw z;y=q.getUniformLocation(I,"mat"),b=q.getUniformLocation(I,"translate"),q.useProgram(I),q.bindBuffer(q.ARRAY_BUFFER,q.createBuffer()),q.enableVertexAttribArray(0),q.enableVertexAttribArray(1),q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,q.createBuffer()),q.uniform1i(q.getUniformLocation(I,"image"),0),q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),a=q}return!0}let a=null,u=0,f=0,y=null,b=null,k=0,P=0,j=!1;i(),this.hc=function(){return i(),f},this.Mb=function(I){a.deleteTexture&&a.deleteTexture(I)},this.Lb=function(I){if(!i())return null;const z=a.createTexture();return z?(a.bindTexture(a.TEXTURE_2D,z),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,I),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),u==2?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR),a.generateMipmap(a.TEXTURE_2D)):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),z):null};const T=new D(8),K=new D(8),X=new D(10),te=new D(10);this.Qb=function(I,z,q,Ae,Ce){if(i()){var Q=T.push(I),Ze=K.push(z);if(a.canvas){(a.canvas.width!=Q||a.canvas.height!=Ze)&&(a.canvas.width=Q,a.canvas.height=Ze),a.viewport(0,Ze-z,I,z),a.disable(a.SCISSOR_TEST),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.enable(a.SCISSOR_TEST),q.sort(($e,hn)=>hn.xb-$e.xb),Q=X.push(Ae),k!=Q&&(a.bufferData(a.ARRAY_BUFFER,8*Q,a.DYNAMIC_DRAW),k=Q),Q=0;for(var wt of q)a.bufferSubData(a.ARRAY_BUFFER,Q,wt.Ua),Q+=4*wt.Ua.length;console.assert(Q==4*Ae);for(var dn of q)a.bufferSubData(a.ARRAY_BUFFER,Q,dn.Db),Q+=4*dn.Db.length;console.assert(Q==8*Ae),Q=te.push(Ce),P!=Q&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,2*Q,a.DYNAMIC_DRAW),P=Q),wt=0;for(var Kn of q)a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,wt,Kn.indices),wt+=2*Kn.indices.length;console.assert(wt==2*Ce),Kn=0,dn=!0,Q=wt=0;for(const $e of q){$e.image.Ka!=Kn&&(a.bindTexture(a.TEXTURE_2D,$e.image.Ja||null),Kn=$e.image.Ka),$e.mc?(a.scissor($e.Za,Ze-$e.$a-$e.kb,$e.Ac,$e.kb),dn=!0):dn&&(a.scissor(0,Ze-z,I,z),dn=!1),q=2/I;const hn=-2/z;a.uniform4f(y,$e.ha[0]*q*$e.Ba,$e.ha[1]*hn*$e.Ca,$e.ha[2]*q*$e.Ba,$e.ha[3]*hn*$e.Ca),a.uniform2f(b,$e.ha[4]*q*$e.Ba+q*($e.Za-$e.ic*$e.Ba)-1,$e.ha[5]*hn*$e.Ca+hn*($e.$a-$e.jc*$e.Ca)+1),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,Q),a.vertexAttribPointer(1,2,a.FLOAT,!1,0,Q+4*Ae),a.drawElements(a.TRIANGLES,$e.indices.length,a.UNSIGNED_SHORT,wt),Q+=4*$e.Ua.length,wt+=2*$e.indices.length}console.assert(Q==4*Ae),console.assert(wt==2*Ce)}}},this.canvas=function(){return i()&&a.canvas}},G=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){function i(V){switch(V){case T.srcOver:return"source-over";case T.screen:return"screen";case T.overlay:return"overlay";case T.darken:return"darken";case T.lighten:return"lighten";case T.colorDodge:return"color-dodge";case T.colorBurn:return"color-burn";case T.hardLight:return"hard-light";case T.softLight:return"soft-light";case T.difference:return"difference";case T.exclusion:return"exclusion";case T.multiply:return"multiply";case T.hue:return"hue";case T.saturation:return"saturation";case T.color:return"color";case T.luminosity:return"luminosity"}}function a(V){return"rgba("+((16711680&V)>>>16)+","+((65280&V)>>>8)+","+((255&V)>>>0)+","+((4278190080&V)>>>24)/255+")"}function u(){0<Ze.length&&(H.Qb(Q.drawWidth(),Q.drawHeight(),Ze,wt,dn),Ze=[],dn=wt=0,Q.reset(512,512));for(const V of Ce){for(const Z of V.H)Z();V.H=[]}Ce.clear()}G&&G();var f=_.RenderPaintStyle;const y=_.RenderPath,b=_.RenderPaint,k=_.Renderer,P=_.StrokeCap,j=_.StrokeJoin,T=_.BlendMode,K=f.fill,X=f.stroke,te=_.FillRule.evenOdd;let I=1;var z=_.RenderImage.extend("CanvasRenderImage",{__construct:function({la:V,xa:Z}={}){this.__parent.__construct.call(this),this.Ka=I,I=I+1&2147483647||1,this.la=V,this.xa=Z},__destruct:function(){this.Ja&&(H.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(V){var Z=this;Z.xa&&Z.xa(Z);var Le=new Image;Z.Xa=URL.createObjectURL(new Blob([V],{type:"image/png"})),Le.onload=function(){Z.Fb=Le,Z.Ja=H.Lb(Le),Z.size(Le.width,Le.height),Z.la&&Z.la(Z)},Le.src=Z.Xa}}),q=y.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(V,Z,Le,Fe,ke,De,ze){var Ke=this.T,Zt=Ke.addPath;V=V.T;const pt=new DOMMatrix;pt.a=Z,pt.b=Le,pt.c=Fe,pt.d=ke,pt.e=De,pt.f=ze,Zt.call(Ke,V,pt)},fillRule:function(V){this.Wa=V},moveTo:function(V,Z){this.T.moveTo(V,Z)},lineTo:function(V,Z){this.T.lineTo(V,Z)},cubicTo:function(V,Z,Le,Fe,ke,De){this.T.bezierCurveTo(V,Z,Le,Fe,ke,De)},close:function(){this.T.closePath()}}),Ae=b.extend("CanvasRenderPaint",{color:function(V){this.Ya=a(V)},thickness:function(V){this.Ib=V},join:function(V){switch(V){case j.miter:this.Ia="miter";break;case j.round:this.Ia="round";break;case j.bevel:this.Ia="bevel"}},cap:function(V){switch(V){case P.butt:this.Ha="butt";break;case P.round:this.Ha="round";break;case P.square:this.Ha="square"}},style:function(V){this.Hb=V},blendMode:function(V){this.Eb=i(V)},clearGradient:function(){this.ja=null},linearGradient:function(V,Z,Le,Fe){this.ja={zb:V,Ab:Z,cb:Le,eb:Fe,Ra:[]}},radialGradient:function(V,Z,Le,Fe){this.ja={zb:V,Ab:Z,cb:Le,eb:Fe,Ra:[],ec:!0}},addStop:function(V,Z){this.ja.Ra.push({color:V,stop:Z})},completeGradient:function(){},draw:function(V,Z,Le){let Fe=this.Hb;var ke=this.Ya,De=this.ja;if(V.globalCompositeOperation=this.Eb,De!=null){ke=De.zb;var ze=De.Ab;const Zt=De.cb;var Ke=De.eb;const pt=De.Ra;De.ec?(De=Zt-ke,Ke-=ze,ke=V.createRadialGradient(ke,ze,0,ke,ze,Math.sqrt(De*De+Ke*Ke))):ke=V.createLinearGradient(ke,ze,Zt,Ke);for(let qt=0,gt=pt.length;qt<gt;qt++)ze=pt[qt],ke.addColorStop(ze.stop,a(ze.color));this.Ya=ke,this.ja=null}switch(Fe){case X:V.strokeStyle=ke,V.lineWidth=this.Ib,V.lineCap=this.Ha,V.lineJoin=this.Ia,V.stroke(Z);break;case K:V.fillStyle=ke,V.fill(Z,Le)}}});const Ce=new Set;let Q=null,Ze=[],wt=0,dn=0;var Kn=_.CanvasRenderer=k.extend("Renderer",{__construct:function(V){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=V.getContext("2d"),this.Va=V,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const V=this.S.length-6;if(6>V)throw"restore() called without matching save().";this.S.splice(V),this.H.push(this.C.restore.bind(this.C))},transform:function(V,Z,Le,Fe,ke,De){const ze=this.S,Ke=ze.length-6;ze.splice(Ke,6,ze[Ke]*V+ze[Ke+2]*Z,ze[Ke+1]*V+ze[Ke+3]*Z,ze[Ke]*Le+ze[Ke+2]*Fe,ze[Ke+1]*Le+ze[Ke+3]*Fe,ze[Ke]*ke+ze[Ke+2]*De+ze[Ke+4],ze[Ke+1]*ke+ze[Ke+3]*De+ze[Ke+5]),this.H.push(this.C.transform.bind(this.C,V,Z,Le,Fe,ke,De))},rotate:function(V){const Z=Math.sin(V);V=Math.cos(V),this.transform(V,Z,-Z,V,0,0)},_drawPath:function(V,Z){this.H.push(Z.draw.bind(Z,this.C,V.T,V.Wa===te?"evenodd":"nonzero"))},_drawRiveImage:function(V,Z,Le,Fe){var ke=V.Fb;if(ke){var De=this.C,ze=i(Le);this.H.push(function(){De.globalCompositeOperation=ze,De.globalAlpha=Fe,De.drawImage(ke,0,0),De.globalAlpha=1})}},_getMatrix:function(V){const Z=this.S,Le=Z.length-6;for(let Fe=0;6>Fe;++Fe)V[Fe]=Z[Le+Fe]},_drawImageMesh:function(V,Z,Le,Fe,ke,De,ze,Ke,Zt,pt,qt){Z=this.C.canvas.width;var gt=this.C.canvas.height;const Io=pt-Ke,Co=qt-Zt;Ke=Math.max(Ke,0),Zt=Math.max(Zt,0),pt=Math.min(pt,Z),qt=Math.min(qt,gt);const si=pt-Ke,ai=qt-Zt;if(console.assert(si<=Math.min(Io,Z)),console.assert(ai<=Math.min(Co,gt)),!(0>=si||0>=ai)){pt=si<Io||ai<Co,Z=qt=1;var Yn=Math.ceil(si*qt),Jn=Math.ceil(ai*Z);gt=H.hc(),Yn>gt&&(qt*=gt/Yn,Yn=gt),Jn>gt&&(Z*=gt/Jn,Jn=gt),Q||(Q=new _.DynamicRectanizer(gt),Q.reset(512,512)),gt=Q.addRect(Yn,Jn),0>gt&&(u(),Ce.add(this),gt=Q.addRect(Yn,Jn),console.assert(0<=gt));var To=gt&65535,Po=gt>>16;Ze.push({ha:this.S.slice(this.S.length-6),image:V,Za:To,$a:Po,ic:Ke,jc:Zt,Ac:Yn,kb:Jn,Ba:qt,Ca:Z,Ua:new Float32Array(ke),Db:new Float32Array(De),indices:new Uint16Array(ze),mc:pt,xb:V.Ka<<1|(pt?1:0)}),wt+=ke.length,dn+=ze.length;var wr=this.C,Ju=i(Le);this.H.push(function(){wr.save(),wr.resetTransform(),wr.globalCompositeOperation=Ju,wr.globalAlpha=Fe;const xo=H.canvas();xo&&wr.drawImage(xo,To,Po,Yn,Jn,Ke,Zt,si,ai),wr.restore()})}},_clipPath:function(V){this.H.push(this.C.clip.bind(this.C,V.T,V.Wa===te?"evenodd":"nonzero"))},clear:function(){Ce.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(V,Z){this.transform(1,0,0,1,V,Z)}});_.makeRenderer=function(V){const Z=new Kn(V),Le=Z.C;return new Proxy(Z,{get(Fe,ke){if(typeof Fe[ke]=="function")return function(...De){return Fe[ke].apply(Fe,De)};if(typeof Le[ke]=="function"){if(-1<U.indexOf(ke))throw Error("RiveException: Method call to '"+ke+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(...De){Z.H.push(Le[ke].bind(Le,...De))}}return Fe[ke]},set(Fe,ke,De){if(ke in Le)return Z.H.push(()=>{Le[ke]=De}),!0}})},_.decodeImage=function(V,Z){new z({la:Z}).decode(V)},_.renderFactory={makeRenderPaint:function(){return new Ae},makeRenderPath:function(){return new q},makeRenderImage:function(){let V=hn;return new z({xa:()=>{V.total++},la:()=>{if(V.loaded++,V.loaded===V.total){const Z=V.ready;Z&&(Z(),V.ready=null)}}})}};let $e=_.load,hn=null;_.load=function(V,Z,Le=!0){const Fe=new _.FallbackFileAssetLoader;return Z!==void 0&&Fe.addLoader(Z),Le&&(Z=new _.CDNFileAssetLoader,Fe.addLoader(Z)),new Promise(function(ke){let De=null;hn={total:0,loaded:0,ready:function(){ke(De)}},De=$e(V,Fe),hn.total==0&&ke(De)})};let Yu=_.RendererWrapper.prototype.align;_.RendererWrapper.prototype.align=function(V,Z,Le,Fe,ke=1){Yu.call(this,V,Z,Le,Fe,ke)},f=new x,_.requestAnimationFrame=f.requestAnimationFrame.bind(f),_.cancelAnimationFrame=f.cancelAnimationFrame.bind(f),_.enableFPSCounter=f.Rb.bind(f),_.disableFPSCounter=f.Ob,f.pb=u,_.resolveAnimationFrame=u,_.cleanup=function(){Q&&Q.delete()}};var R=Object.assign({},_),M="./this.program",ie=typeof window=="object",Y=typeof importScripts=="function",le="",J,ee;(ie||Y)&&(Y?le=self.location.href:typeof document<"u"&&document.currentScript&&(le=document.currentScript.src),E&&(le=E),le.indexOf("blob:")!==0?le=le.substr(0,le.replace(/[?#].*/,"").lastIndexOf("/")+1):le="",Y&&(ee=i=>{var a=new XMLHttpRequest;return a.open("GET",i,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),J=(i,a,u)=>{var f=new XMLHttpRequest;f.open("GET",i,!0),f.responseType="arraybuffer",f.onload=()=>{f.status==200||f.status==0&&f.response?a(f.response):u()},f.onerror=u,f.send(null)});var ve=_.print||console.log.bind(console),qe=_.printErr||console.error.bind(console);Object.assign(_,R),R=null,_.thisProgram&&(M=_.thisProgram);var se;_.wasmBinary&&(se=_.wasmBinary),_.noExitRuntime,typeof WebAssembly!="object"&&jt("no native wasm support detected");var Te,oe,Je=!1,Ne,Re,Oe,st,ye,Pe,be,ue;function pe(){var i=Te.buffer;_.HEAP8=Ne=new Int8Array(i),_.HEAP16=Oe=new Int16Array(i),_.HEAP32=ye=new Int32Array(i),_.HEAPU8=Re=new Uint8Array(i),_.HEAPU16=st=new Uint16Array(i),_.HEAPU32=Pe=new Uint32Array(i),_.HEAPF32=be=new Float32Array(i),_.HEAPF64=ue=new Float64Array(i)}var je,Ye=[],yt=[],kt=[];function Nt(){var i=_.preRun.shift();Ye.unshift(i)}var ht=0,St=null;function jt(i){throw _.onAbort&&_.onAbort(i),i="Aborted("+i+")",qe(i),Je=!0,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),L(i),i}function ot(i){return i.startsWith("data:application/octet-stream;base64,")}var tt;if(tt="canvas_advanced.wasm",!ot(tt)){var on=tt;tt=_.locateFile?_.locateFile(on,le):le+on}function ft(i){if(i==tt&&se)return new Uint8Array(se);if(ee)return ee(i);throw"both async and sync fetching of the wasm failed"}function vt(i){if(!se&&(ie||Y)){if(typeof fetch=="function"&&!i.startsWith("file://"))return fetch(i,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at '"+i+"'";return a.arrayBuffer()}).catch(()=>ft(i));if(J)return new Promise((a,u)=>{J(i,f=>a(new Uint8Array(f)),u)})}return Promise.resolve().then(()=>ft(i))}function Bt(i,a,u){return vt(i).then(f=>WebAssembly.instantiate(f,a)).then(f=>f).then(u,f=>{qe("failed to asynchronously prepare wasm: "+f),jt(f)})}function qn(i,a){var u=tt;return se||typeof WebAssembly.instantiateStreaming!="function"||ot(u)||u.startsWith("file://")||typeof fetch!="function"?Bt(u,i,a):fetch(u,{credentials:"same-origin"}).then(f=>WebAssembly.instantiateStreaming(f,i).then(a,function(y){return qe("wasm streaming compile failed: "+y),qe("falling back to ArrayBuffer instantiation"),Bt(u,i,a)}))}var Mt,p,o={460492:(i,a,u,f,y)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=i,window.h.I.capture=a,window.h.I.La=u,window.h.ga={},window.h.ga.stopped=f,window.h.ga.yb=y;let b=window.h;b.D=[],b.yc=function(k){for(var P=0;P<b.D.length;++P)if(b.D[P]==null)return b.D[P]=k,P;return b.D.push(k),b.D.length-1},b.Cb=function(k){for(b.D[k]=null;0<b.D.length&&b.D[b.D.length-1]==null;)b.D.pop()},b.Sc=function(k){for(var P=0;P<b.D.length;++P)if(b.D[P]==k)return b.Cb(P)},b.ra=function(k){return b.D[k]},b.Ta=["touchend","click"],b.unlock=function(){for(var k=0;k<b.D.length;++k){var P=b.D[k];P!=null&&P.J!=null&&P.state===b.ga.yb&&P.J.resume().then(()=>{bo(P.qb)},j=>{console.error("Failed to resume audiocontext",j)})}b.Ta.map(function(j){document.removeEventListener(j,b.unlock,!0)})},b.Ta.map(function(k){document.addEventListener(k,b.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(i){document.removeEventListener(i,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var i=new(window.AudioContext||window.webkitAudioContext),a=i.sampleRate;return i.close(),a}catch{return 0}},463249:(i,a,u,f,y,b)=>{if(typeof window.h>"u")return-1;var k={},P={};return i==window.h.I.ya&&u!=0&&(P.sampleRate=u),k.J=new(window.AudioContext||window.webkitAudioContext)(P),k.J.suspend(),k.state=window.h.ga.stopped,u=0,i!=window.h.I.ya&&(u=a),k.Z=k.J.createScriptProcessor(f,u,a),k.Z.onaudioprocess=function(j){if((k.sa==null||k.sa.length==0)&&(k.sa=new Float32Array(be.buffer,y,f*a)),i==window.h.I.capture||i==window.h.I.La){for(var T=0;T<a;T+=1)for(var K=j.inputBuffer.getChannelData(T),X=k.sa,te=0;te<f;te+=1)X[te*a+T]=K[te];Eo(b,f,y)}if(i==window.h.I.ya||i==window.h.I.La)for(Ao(b,f,y),T=0;T<j.outputBuffer.numberOfChannels;++T)for(K=j.outputBuffer.getChannelData(T),X=k.sa,te=0;te<f;te+=1)K[te]=X[te*a+T];else for(T=0;T<j.outputBuffer.numberOfChannels;++T)j.outputBuffer.getChannelData(T).fill(0)},i!=window.h.I.capture&&i!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(j){k.Da=k.J.createMediaStreamSource(j),k.Da.connect(k.Z),k.Z.connect(k.J.destination)}).catch(function(j){console.log("Failed to get user media: "+j)}),i==window.h.I.ya&&k.Z.connect(k.J.destination),k.qb=b,window.h.yc(k)},466126:i=>window.h.ra(i).J.sampleRate,466199:i=>{i=window.h.ra(i),i.Z!==void 0&&(i.Z.onaudioprocess=function(){},i.Z.disconnect(),i.Z=void 0),i.Da!==void 0&&(i.Da.disconnect(),i.Da=void 0),i.J.close(),i.J=void 0,i.qb=void 0},466599:i=>{window.h.Cb(i)},466649:i=>{i=window.h.ra(i),i.J.resume(),i.state=window.h.ga.yb},466788:i=>{i=window.h.ra(i),i.J.suspend(),i.state=window.h.ga.stopped}},d=i=>{for(;0<i.length;)i.shift()(_)},w=(i,a)=>{for(var u=0,f=i.length-1;0<=f;f--){var y=i[f];y==="."?i.splice(f,1):y===".."?(i.splice(f,1),u++):u&&(i.splice(f,1),u--)}if(a)for(;u;u--)i.unshift("..");return i},C=i=>{var a=i.charAt(0)==="/",u=i.substr(-1)==="/";return(i=w(i.split("/").filter(f=>!!f),!a).join("/"))||a||(i="."),i&&u&&(i+="/"),(a?"/":"")+i},O=i=>{var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(i).slice(1);return i=a[0],a=a[1],!i&&!a?".":(a&&(a=a.substr(0,a.length-1)),i+a)},W=i=>{if(i==="/")return"/";i=C(i),i=i.replace(/\/$/,"");var a=i.lastIndexOf("/");return a===-1?i:i.substr(a+1)},de=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return i=>crypto.getRandomValues(i);jt("initRandomDevice")},me=i=>(me=de())(i);function ae(){for(var i="",a=!1,u=arguments.length-1;-1<=u&&!a;u--){if(a=0<=u?arguments[u]:"/",typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";i=a+"/"+i,a=a.charAt(0)==="/"}return i=w(i.split("/").filter(f=>!!f),!a).join("/"),(a?"/":"")+i||"."}var Se=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Be=(i,a,u)=>{var f=a+u;for(u=a;i[u]&&!(u>=f);)++u;if(16<u-a&&i.buffer&&Se)return Se.decode(i.subarray(a,u));for(f="";a<u;){var y=i[a++];if(y&128){var b=i[a++]&63;if((y&224)==192)f+=String.fromCharCode((y&31)<<6|b);else{var k=i[a++]&63;y=(y&240)==224?(y&15)<<12|b<<6|k:(y&7)<<18|b<<12|k<<6|i[a++]&63,65536>y?f+=String.fromCharCode(y):(y-=65536,f+=String.fromCharCode(55296|y>>10,56320|y&1023))}}else f+=String.fromCharCode(y)}return f},at=[],he=i=>{for(var a=0,u=0;u<i.length;++u){var f=i.charCodeAt(u);127>=f?a++:2047>=f?a+=2:55296<=f&&57343>=f?(a+=4,++u):a+=3}return a},nt=(i,a,u,f)=>{if(!(0<f))return 0;var y=u;f=u+f-1;for(var b=0;b<i.length;++b){var k=i.charCodeAt(b);if(55296<=k&&57343>=k){var P=i.charCodeAt(++b);k=65536+((k&1023)<<10)|P&1023}if(127>=k){if(u>=f)break;a[u++]=k}else{if(2047>=k){if(u+1>=f)break;a[u++]=192|k>>6}else{if(65535>=k){if(u+2>=f)break;a[u++]=224|k>>12}else{if(u+3>=f)break;a[u++]=240|k>>18,a[u++]=128|k>>12&63}a[u++]=128|k>>6&63}a[u++]=128|k&63}}return a[u]=0,u-y};function Qe(i,a){var u=Array(he(i)+1);return i=nt(i,u,0,u.length),a&&(u.length=i),u}var lt=[];function rt(i,a){lt[i]={input:[],F:[],V:a},ks(i,Wt)}var Wt={open:function(i){var a=lt[i.node.za];if(!a)throw new re(43);i.s=a,i.seekable=!1},close:function(i){i.s.V.qa(i.s)},qa:function(i){i.s.V.qa(i.s)},read:function(i,a,u,f){if(!i.s||!i.s.V.jb)throw new re(60);for(var y=0,b=0;b<f;b++){try{var k=i.s.V.jb(i.s)}catch{throw new re(29)}if(k===void 0&&y===0)throw new re(6);if(k==null)break;y++,a[u+b]=k}return y&&(i.node.timestamp=Date.now()),y},write:function(i,a,u,f){if(!i.s||!i.s.V.Oa)throw new re(60);try{for(var y=0;y<f;y++)i.s.V.Oa(i.s,a[u+y])}catch{throw new re(29)}return f&&(i.node.timestamp=Date.now()),y}},xn={jb:function(){e:{if(!at.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i){i=null;break e}at=Qe(i,!0)}i=at.shift()}return i},Oa:function(i,a){a===null||a===10?(ve(Be(i.F,0)),i.F=[]):a!=0&&i.F.push(a)},qa:function(i){i.F&&0<i.F.length&&(ve(Be(i.F,0)),i.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},Rn={Oa:function(i,a){a===null||a===10?(qe(Be(i.F,0)),i.F=[]):a!=0&&i.F.push(a)},qa:function(i){i.F&&0<i.F.length&&(qe(Be(i.F,0)),i.F=[])}};function ln(i,a){var u=i.j?i.j.length:0;u>=a||(a=Math.max(a,u*(1048576>u?2:1.125)>>>0),u!=0&&(a=Math.max(a,256)),u=i.j,i.j=new Uint8Array(a),0<i.v&&i.j.set(u.subarray(0,i.v),0))}var ge={O:null,U(){return ge.createNode(null,"/",16895,0)},createNode(i,a,u,f){if((u&61440)===24576||(u&61440)===4096)throw new re(63);return ge.O||(ge.O={dir:{node:{Y:ge.l.Y,P:ge.l.P,ka:ge.l.ka,va:ge.l.va,vb:ge.l.vb,Bb:ge.l.Bb,wb:ge.l.wb,tb:ge.l.tb,Ea:ge.l.Ea},stream:{ba:ge.m.ba}},file:{node:{Y:ge.l.Y,P:ge.l.P},stream:{ba:ge.m.ba,read:ge.m.read,write:ge.m.write,pa:ge.m.pa,mb:ge.m.mb,ob:ge.m.ob}},link:{node:{Y:ge.l.Y,P:ge.l.P,ma:ge.l.ma},stream:{}},ab:{node:{Y:ge.l.Y,P:ge.l.P},stream:Cu}}),u=Va(i,a,u,f),(u.mode&61440)===16384?(u.l=ge.O.dir.node,u.m=ge.O.dir.stream,u.j={}):(u.mode&61440)===32768?(u.l=ge.O.file.node,u.m=ge.O.file.stream,u.v=0,u.j=null):(u.mode&61440)===40960?(u.l=ge.O.link.node,u.m=ge.O.link.stream):(u.mode&61440)===8192&&(u.l=ge.O.ab.node,u.m=ge.O.ab.stream),u.timestamp=Date.now(),i&&(i.j[a]=u,i.timestamp=u.timestamp),u},Kc(i){return i.j?i.j.subarray?i.j.subarray(0,i.v):new Uint8Array(i.j):new Uint8Array(0)},l:{Y(i){var a={};return a.Jc=(i.mode&61440)===8192?i.id:1,a.Mc=i.id,a.mode=i.mode,a.Oc=1,a.uid=0,a.Lc=0,a.za=i.za,(i.mode&61440)===16384?a.size=4096:(i.mode&61440)===32768?a.size=i.v:(i.mode&61440)===40960?a.size=i.link.length:a.size=0,a.Bc=new Date(i.timestamp),a.Nc=new Date(i.timestamp),a.Ic=new Date(i.timestamp),a.Jb=4096,a.Cc=Math.ceil(a.size/a.Jb),a},P(i,a){if(a.mode!==void 0&&(i.mode=a.mode),a.timestamp!==void 0&&(i.timestamp=a.timestamp),a.size!==void 0&&(a=a.size,i.v!=a))if(a==0)i.j=null,i.v=0;else{var u=i.j;i.j=new Uint8Array(a),u&&i.j.set(u.subarray(0,Math.min(a,i.v))),i.v=a}},ka(){throw As[44]},va(i,a,u,f){return ge.createNode(i,a,u,f)},vb(i,a,u){if((i.mode&61440)===16384){try{var f=Si(a,u)}catch{}if(f)for(var y in f.j)throw new re(55)}delete i.parent.j[i.name],i.parent.timestamp=Date.now(),i.name=u,a.j[u]=i,a.timestamp=i.parent.timestamp,i.parent=a},Bb(i,a){delete i.j[a],i.timestamp=Date.now()},wb(i,a){var u=Si(i,a),f;for(f in u.j)throw new re(55);delete i.j[a],i.timestamp=Date.now()},tb(i){var a=[".",".."],u;for(u in i.j)i.j.hasOwnProperty(u)&&a.push(u);return a},Ea(i,a,u){return i=ge.createNode(i,a,41471,0),i.link=u,i},ma(i){if((i.mode&61440)!==40960)throw new re(28);return i.link}},m:{read(i,a,u,f,y){var b=i.node.j;if(y>=i.node.v)return 0;if(i=Math.min(i.node.v-y,f),8<i&&b.subarray)a.set(b.subarray(y,y+i),u);else for(f=0;f<i;f++)a[u+f]=b[y+f];return i},write(i,a,u,f,y,b){if(a.buffer===Ne.buffer&&(b=!1),!f)return 0;if(i=i.node,i.timestamp=Date.now(),a.subarray&&(!i.j||i.j.subarray)){if(b)return i.j=a.subarray(u,u+f),i.v=f;if(i.v===0&&y===0)return i.j=a.slice(u,u+f),i.v=f;if(y+f<=i.v)return i.j.set(a.subarray(u,u+f),y),f}if(ln(i,y+f),i.j.subarray&&a.subarray)i.j.set(a.subarray(u,u+f),y);else for(b=0;b<f;b++)i.j[y+b]=a[u+b];return i.v=Math.max(i.v,y+f),f},ba(i,a,u){if(u===1?a+=i.position:u===2&&(i.node.mode&61440)===32768&&(a+=i.node.v),0>a)throw new re(28);return a},pa(i,a,u){ln(i.node,a+u),i.node.v=Math.max(i.node.v,a+u)},mb(i,a,u,f,y){if((i.node.mode&61440)!==32768)throw new re(43);if(i=i.node.j,y&2||i.buffer!==Ne.buffer){if((0<u||u+a<i.length)&&(i.subarray?i=i.subarray(u,u+a):i=Array.prototype.slice.call(i,u,u+a)),u=!0,jt(),a=void 0,!a)throw new re(48);Ne.set(i,a)}else u=!1,a=i.byteOffset;return{o:a,M:u}},ob(i,a,u,f){return ge.m.write(i,a,0,f,u,!1),0}}};function We(i,a){var u=0;return i&&(u|=365),a&&(u|=146),u}var un=null,Ua={},ki=[],Su=1,Jr=null,Na=!0,re=null,As={},Hn=(i,a={})=>{if(i=ae(i),!i)return{path:"",node:null};if(a=Object.assign({hb:!0,Qa:0},a),8<a.Qa)throw new re(32);i=i.split("/").filter(k=>!!k);for(var u=un,f="/",y=0;y<i.length;y++){var b=y===i.length-1;if(b&&a.parent)break;if(u=Si(u,i[y]),f=C(f+"/"+i[y]),u.wa&&(!b||b&&a.hb)&&(u=u.wa.root),!b||a.gb){for(b=0;(u.mode&61440)===40960;)if(u=Tu(f),f=ae(O(f),u),u=Hn(f,{Qa:a.Qa+1}).node,40<b++)throw new re(32)}}return{path:f,node:u}},Ba=i=>{for(var a;;){if(i===i.parent)return i=i.U.nb,a?i[i.length-1]!=="/"?`${i}/${a}`:i+a:i;a=a?`${i.name}/${a}`:i.name,i=i.parent}},Wa=(i,a)=>{for(var u=0,f=0;f<a.length;f++)u=(u<<5)-u+a.charCodeAt(f)|0;return(i+u>>>0)%Jr.length},Si=(i,a)=>{var u;if(u=(u=Ii(i,"x"))?u:i.l.ka?0:2)throw new re(u,i);for(u=Jr[Wa(i.id,a)];u;u=u.lc){var f=u.name;if(u.parent.id===i.id&&f===a)return u}return i.l.ka(i,a)},Va=(i,a,u,f)=>(i=new _o(i,a,u,f),a=Wa(i.parent.id,i.name),i.lc=Jr[a],Jr[a]=i),qa=i=>{var a=["r","w","rw"][i&3];return i&512&&(a+="w"),a},Ii=(i,a)=>{if(Na)return 0;if(!a.includes("r")||i.mode&292){if(a.includes("w")&&!(i.mode&146)||a.includes("x")&&!(i.mode&73))return 2}else return 2;return 0},Ha=(i,a)=>{try{return Si(i,a),20}catch{}return Ii(i,"wx")},Iu=()=>{for(var i=0;4096>=i;i++)if(!ki[i])return i;throw new re(33)},On=i=>{if(i=ki[i],!i)throw new re(8);return i},za=(i,a=-1)=>(Qr||(Qr=function(){this.h={}},Qr.prototype={},Object.defineProperties(Qr.prototype,{object:{get(){return this.node},set(u){this.node=u}},flags:{get(){return this.h.flags},set(u){this.h.flags=u}},position:{get(){return this.h.position},set(u){this.h.position=u}}})),i=Object.assign(new Qr,i),a==-1&&(a=Iu()),i.X=a,ki[a]=i),Cu={open:i=>{i.m=Ua[i.node.za].m,i.m.open&&i.m.open(i)},ba:()=>{throw new re(70)}},ks=(i,a)=>{Ua[i]={m:a}},Ga=(i,a)=>{var u=a==="/",f=!a;if(u&&un)throw new re(10);if(!u&&!f){var y=Hn(a,{hb:!1});if(a=y.path,y=y.node,y.wa)throw new re(10);if((y.mode&61440)!==16384)throw new re(54)}a={type:i,Qc:{},nb:a,kc:[]},i=i.U(a),i.U=a,a.root=i,u?un=i:y&&(y.wa=a,y.U&&y.U.kc.push(a))},Jt=(i,a,u)=>{var f=Hn(i,{parent:!0}).node;if(i=W(i),!i||i==="."||i==="..")throw new re(28);var y=Ha(f,i);if(y)throw new re(y);if(!f.l.va)throw new re(63);return f.l.va(f,i,a,u)},Ci=(i,a,u)=>{typeof u>"u"&&(u=a,a=438),Jt(i,a|8192,u)},Ss=(i,a)=>{if(!ae(i))throw new re(44);var u=Hn(a,{parent:!0}).node;if(!u)throw new re(44);a=W(a);var f=Ha(u,a);if(f)throw new re(f);if(!u.l.Ea)throw new re(63);u.l.Ea(u,a,i)},Tu=i=>{if(i=Hn(i).node,!i)throw new re(44);if(!i.l.ma)throw new re(28);return ae(Ba(i.parent),i.l.ma(i))},Ti=(i,a,u)=>{if(i==="")throw new re(44);if(typeof a=="string"){var f={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[a];if(typeof f>"u")throw Error(`Unknown file open mode: ${a}`);a=f}if(u=a&64?(typeof u>"u"?438:u)&4095|32768:0,typeof i=="object")var y=i;else{i=C(i);try{y=Hn(i,{gb:!(a&131072)}).node}catch{}}if(f=!1,a&64)if(y){if(a&128)throw new re(20)}else y=Jt(i,u,0),f=!0;if(!y)throw new re(44);if((y.mode&61440)===8192&&(a&=-513),a&65536&&(y.mode&61440)!==16384)throw new re(54);if(!f&&(u=y?(y.mode&61440)===40960?32:(y.mode&61440)===16384&&(qa(a)!=="r"||a&512)?31:Ii(y,qa(a)):44))throw new re(u);if(a&512&&!f){if(u=y,u=typeof u=="string"?Hn(u,{gb:!0}).node:u,!u.l.P)throw new re(63);if((u.mode&61440)===16384)throw new re(31);if((u.mode&61440)!==32768)throw new re(28);if(f=Ii(u,"w"))throw new re(f);u.l.P(u,{size:0,timestamp:Date.now()})}return a&=-131713,y=za({node:y,path:Ba(y),flags:a,seekable:!0,position:0,m:y.m,zc:[],error:!1}),y.m.open&&y.m.open(y),!_.logReadFiles||a&1||(Pi||(Pi={}),i in Pi||(Pi[i]=1)),y},Ka=(i,a,u)=>{if(i.X===null)throw new re(8);if(!i.seekable||!i.m.ba)throw new re(70);if(u!=0&&u!=1&&u!=2)throw new re(28);i.position=i.m.ba(i,a,u),i.zc=[]},Ya=()=>{re||(re=function(i,a){this.name="ErrnoError",this.node=a,this.pc=function(u){this.aa=u},this.pc(i),this.message="FS error"},re.prototype=Error(),re.prototype.constructor=re,[44].forEach(i=>{As[i]=new re(i),As[i].stack="<generic error, no stack>"}))},Ja,Xr=(i,a,u)=>{i=C("/dev/"+i);var f=We(!!a,!!u);Is||(Is=64);var y=Is++<<8|0;ks(y,{open:b=>{b.seekable=!1},close:()=>{u&&u.buffer&&u.buffer.length&&u(10)},read:(b,k,P,j)=>{for(var T=0,K=0;K<j;K++){try{var X=a()}catch{throw new re(29)}if(X===void 0&&T===0)throw new re(6);if(X==null)break;T++,k[P+K]=X}return T&&(b.node.timestamp=Date.now()),T},write:(b,k,P,j)=>{for(var T=0;T<j;T++)try{u(k[P+T])}catch{throw new re(29)}return j&&(b.node.timestamp=Date.now()),T}}),Ci(i,f,y)},Is,zn={},Qr,Pi,Zr=void 0;function mn(){return Zr+=4,ye[Zr-4>>2]}function Xa(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var a=i.charCodeAt(0);return 48<=a&&57>=a?`_${i}`:i}function xi(i,a){return i=Xa(i),{[i]:function(){return a.apply(this,arguments)}}[i]}function Qa(){this.M=[void 0],this.ib=[]}var Vt=new Qa,_r=void 0;function Ee(i){throw new _r(i)}var Xt=i=>(i||Ee("Cannot use deleted val. handle = "+i),Vt.get(i).value),Qt=i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return Vt.pa({ub:1,value:i})}};function Za(i){var a=Error,u=xi(i,function(f){this.name=i,this.message=f,f=Error(f).stack,f!==void 0&&(this.stack=this.toString()+`
`+f.replace(/^Error(:[^\n]*)?\n/,""))});return u.prototype=Object.create(a.prototype),u.prototype.constructor=u,u.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},u}var eo=void 0,to=void 0;function it(i){for(var a="";Re[i];)a+=to[Re[i++]];return a}var ei=[];function Cs(){for(;ei.length;){var i=ei.pop();i.g.fa=!1,i.delete()}}var ti=void 0,yn={};function Ts(i,a){for(a===void 0&&Ee("ptr should not be undefined");i.A;)a=i.na(a),i=i.A;return a}var Gn={};function no(i){i=ko(i);var a=it(i);return En(i),a}function ni(i,a){var u=Gn[i];return u===void 0&&Ee(a+" has unknown type "+no(i)),u}function Ri(){}var Ps=!1;function ro(i){--i.count.value,i.count.value===0&&(i.G?i.L.W(i.G):i.u.i.W(i.o))}function io(i,a,u){return a===u?i:u.A===void 0?null:(i=io(i,a,u.A),i===null?null:u.Pb(i))}var so={};function Pu(i,a){return a=Ts(i,a),yn[a]}var ao=void 0;function Oi(i){throw new ao(i)}function ji(i,a){return a.u&&a.o||Oi("makeClassHandle requires ptr and ptrType"),!!a.L!=!!a.G&&Oi("Both smartPtrType and smartPtr must be specified"),a.count={value:1},mr(Object.create(i,{g:{value:a}}))}function mr(i){return typeof FinalizationRegistry>"u"?(mr=a=>a,i):(Ps=new FinalizationRegistry(a=>{ro(a.g)}),mr=a=>{var u=a.g;return u.G&&Ps.register(a,{g:u},a),a},Ri=a=>{Ps.unregister(a)},mr(i))}var Mi={};function ri(i){for(;i.length;){var a=i.pop();i.pop()(a)}}function ii(i){return this.fromWireType(ye[i>>2])}var yr={},Li={};function Lt(i,a,u){function f(P){P=u(P),P.length!==i.length&&Oi("Mismatched type converter count");for(var j=0;j<i.length;++j)cn(i[j],P[j])}i.forEach(function(P){Li[P]=a});var y=Array(a.length),b=[],k=0;a.forEach((P,j)=>{Gn.hasOwnProperty(P)?y[j]=Gn[P]:(b.push(P),yr.hasOwnProperty(P)||(yr[P]=[]),yr[P].push(()=>{y[j]=Gn[P],++k,k===b.length&&f(y)}))}),b.length===0&&f(y)}function Di(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${i}`)}}function xu(i,a,u={}){var f=a.name;if(i||Ee(`type "${f}" must have a positive integer typeid pointer`),Gn.hasOwnProperty(i)){if(u.$b)return;Ee(`Cannot register type '${f}' twice`)}Gn[i]=a,delete Li[i],yr.hasOwnProperty(i)&&(a=yr[i],delete yr[i],a.forEach(y=>y()))}function cn(i,a,u={}){if(!("argPackAdvance"in a))throw new TypeError("registerType registeredInstance requires argPackAdvance");xu(i,a,u)}function xs(i){Ee(i.g.u.i.name+" instance already deleted")}function jn(){}function Rs(i,a,u){if(i[a].B===void 0){var f=i[a];i[a]=function(){return i[a].B.hasOwnProperty(arguments.length)||Ee(`Function '${u}' called with an invalid number of arguments (${arguments.length}) - expects one of (${i[a].B})!`),i[a].B[arguments.length].apply(this,arguments)},i[a].B=[],i[a].B[f.ea]=f}}function Os(i,a,u){_.hasOwnProperty(i)?((u===void 0||_[i].B!==void 0&&_[i].B[u]!==void 0)&&Ee(`Cannot register public name '${i}' twice`),Rs(_,i,i),_.hasOwnProperty(u)&&Ee(`Cannot register multiple overloads of a function with the same number of arguments (${u})!`),_[i].B[u]=a):(_[i]=a,u!==void 0&&(_[i].Pc=u))}function Ru(i,a,u,f,y,b,k,P){this.name=i,this.constructor=a,this.N=u,this.W=f,this.A=y,this.Ub=b,this.na=k,this.Pb=P,this.rb=[]}function $i(i,a,u){for(;a!==u;)a.na||Ee(`Expected null or instance of ${u.name}, got an instance of ${a.name}`),i=a.na(i),a=a.A;return i}function Ou(i,a){return a===null?(this.Na&&Ee(`null is not a valid ${this.name}`),0):(a.g||Ee(`Cannot pass "${Ms(a)}" as a ${this.name}`),a.g.o||Ee(`Cannot pass deleted object as a pointer of type ${this.name}`),$i(a.g.o,a.g.u.i,this.i))}function ju(i,a){if(a===null){if(this.Na&&Ee(`null is not a valid ${this.name}`),this.ua){var u=this.Pa();return i!==null&&i.push(this.W,u),u}return 0}if(a.g||Ee(`Cannot pass "${Ms(a)}" as a ${this.name}`),a.g.o||Ee(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&a.g.u.ta&&Ee(`Cannot convert argument of type ${a.g.L?a.g.L.name:a.g.u.name} to parameter type ${this.name}`),u=$i(a.g.o,a.g.u.i,this.i),this.ua)switch(a.g.G===void 0&&Ee("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:a.g.L===this?u=a.g.G:Ee(`Cannot convert argument of type ${a.g.L?a.g.L.name:a.g.u.name} to parameter type ${this.name}`);break;case 1:u=a.g.G;break;case 2:if(a.g.L===this)u=a.g.G;else{var f=a.clone();u=this.oc(u,Qt(function(){f.delete()})),i!==null&&i.push(this.W,u)}break;default:Ee("Unsupporting sharing policy")}return u}function Mu(i,a){return a===null?(this.Na&&Ee(`null is not a valid ${this.name}`),0):(a.g||Ee(`Cannot pass "${Ms(a)}" as a ${this.name}`),a.g.o||Ee(`Cannot pass deleted object as a pointer of type ${this.name}`),a.g.u.ta&&Ee(`Cannot convert argument of type ${a.g.u.name} to parameter type ${this.name}`),$i(a.g.o,a.g.u.i,this.i))}function wn(i,a,u,f){this.name=i,this.i=a,this.Na=u,this.ta=f,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,a.A!==void 0?this.toWireType=ju:(this.toWireType=f?Ou:Mu,this.K=null)}function oo(i,a,u){_.hasOwnProperty(i)||Oi("Replacing nonexistant public symbol"),_[i].B!==void 0&&u!==void 0?_[i].B[u]=a:(_[i]=a,_[i].ea=u)}var Fi=[],lo=i=>{var a=Fi[i];return a||(i>=Fi.length&&(Fi.length=i+1),Fi[i]=a=je.get(i)),a},Lu=(i,a)=>{var u=[];return function(){if(u.length=0,Object.assign(u,arguments),i.includes("j")){var f=_["dynCall_"+i];f=u&&u.length?f.apply(null,[a].concat(u)):f.call(null,a)}else f=lo(a).apply(null,u);return f}};function bt(i,a){i=it(i);var u=i.includes("j")?Lu(i,a):lo(a);return typeof u!="function"&&Ee(`unknown function pointer with signature ${i}: ${a}`),u}var uo=void 0;function bn(i,a){function u(b){y[b]||Gn[b]||(Li[b]?Li[b].forEach(u):(f.push(b),y[b]=!0))}var f=[],y={};throw a.forEach(u),new uo(`${i}: `+f.map(no).join([", "]))}function Ui(i,a,u,f,y){var b=a.length;2>b&&Ee("argTypes array size mismatch! Must at least get return value and 'this' types!");var k=a[1]!==null&&u!==null,P=!1;for(u=1;u<a.length;++u)if(a[u]!==null&&a[u].K===void 0){P=!0;break}var j=a[0].name!=="void",T=b-2,K=Array(T),X=[],te=[];return function(){if(arguments.length!==T&&Ee(`function ${i} called with ${arguments.length} arguments, expected ${T} args!`),te.length=0,X.length=k?2:1,X[0]=y,k){var I=a[1].toWireType(te,this);X[1]=I}for(var z=0;z<T;++z)K[z]=a[z+2].toWireType(te,arguments[z]),X.push(K[z]);if(z=f.apply(null,X),P)ri(te);else for(var q=k?1:2;q<a.length;q++){var Ae=q===1?I:K[q-2];a[q].K!==null&&a[q].K(Ae)}return I=j?a[0].fromWireType(z):void 0,I}}function Ni(i,a){for(var u=[],f=0;f<i;f++)u.push(Pe[a+4*f>>2]);return u}function co(i,a,u){return i instanceof Object||Ee(`${u} with invalid "this": ${i}`),i instanceof a.i.constructor||Ee(`${u} incompatible with "this" of type ${i.constructor.name}`),i.g.o||Ee(`cannot call emscripten binding method ${u} on deleted object`),$i(i.g.o,i.g.u.i,a.i)}function js(i){i>=Vt.h&&--Vt.get(i).ub===0&&Vt.Zb(i)}function Du(i,a,u){switch(a){case 0:return function(f){return this.fromWireType((u?Ne:Re)[f])};case 1:return function(f){return this.fromWireType((u?Oe:st)[f>>1])};case 2:return function(f){return this.fromWireType((u?ye:Pe)[f>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Ms(i){if(i===null)return"null";var a=typeof i;return a==="object"||a==="array"||a==="function"?i.toString():""+i}function $u(i,a){switch(a){case 2:return function(u){return this.fromWireType(be[u>>2])};case 3:return function(u){return this.fromWireType(ue[u>>3])};default:throw new TypeError("Unknown float type: "+i)}}function Fu(i,a,u){switch(a){case 0:return u?function(f){return Ne[f]}:function(f){return Re[f]};case 1:return u?function(f){return Oe[f>>1]}:function(f){return st[f>>1]};case 2:return u?function(f){return ye[f>>2]}:function(f){return Pe[f>>2]};default:throw new TypeError("Unknown integer type: "+i)}}var ho=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Uu=(i,a)=>{for(var u=i>>1,f=u+a/2;!(u>=f)&&st[u];)++u;if(u<<=1,32<u-i&&ho)return ho.decode(Re.subarray(i,u));for(u="",f=0;!(f>=a/2);++f){var y=Oe[i+2*f>>1];if(y==0)break;u+=String.fromCharCode(y)}return u},Nu=(i,a,u)=>{if(u===void 0&&(u=2147483647),2>u)return 0;u-=2;var f=a;u=u<2*i.length?u/2:i.length;for(var y=0;y<u;++y)Oe[a>>1]=i.charCodeAt(y),a+=2;return Oe[a>>1]=0,a-f},Bu=i=>2*i.length,Wu=(i,a)=>{for(var u=0,f="";!(u>=a/4);){var y=ye[i+4*u>>2];if(y==0)break;++u,65536<=y?(y-=65536,f+=String.fromCharCode(55296|y>>10,56320|y&1023)):f+=String.fromCharCode(y)}return f},Vu=(i,a,u)=>{if(u===void 0&&(u=2147483647),4>u)return 0;var f=a;u=f+u-4;for(var y=0;y<i.length;++y){var b=i.charCodeAt(y);if(55296<=b&&57343>=b){var k=i.charCodeAt(++y);b=65536+((b&1023)<<10)|k&1023}if(ye[a>>2]=b,a+=4,a+4>u)break}return ye[a>>2]=0,a-f},qu=i=>{for(var a=0,u=0;u<i.length;++u){var f=i.charCodeAt(u);55296<=f&&57343>=f&&++u,a+=4}return a},Hu={};function Bi(i){var a=Hu[i];return a===void 0?it(i):a}var Wi=[];function zu(i){var a=Wi.length;return Wi.push(i),a}function Gu(i,a){for(var u=Array(i),f=0;f<i;++f)u[f]=ni(Pe[a+4*f>>2],"parameter "+f);return u}var fo=[],Ls=[],Ds={},vo=()=>{if(!$s){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:M||"./this.program"},a;for(a in Ds)Ds[a]===void 0?delete i[a]:i[a]=Ds[a];var u=[];for(a in i)u.push(`${a}=${i[a]}`);$s=u}return $s},$s,Vi=i=>i%4===0&&(i%100!==0||i%400===0),po=[31,29,31,30,31,30,31,31,30,31,30,31],go=[31,28,31,30,31,30,31,31,30,31,30,31],Ku=(i,a,u,f)=>{function y(I,z,q){for(I=typeof I=="number"?I.toString():I||"";I.length<z;)I=q[0]+I;return I}function b(I,z){return y(I,z,"0")}function k(I,z){function q(Ce){return 0>Ce?-1:0<Ce?1:0}var Ae;return(Ae=q(I.getFullYear()-z.getFullYear()))===0&&(Ae=q(I.getMonth()-z.getMonth()))===0&&(Ae=q(I.getDate()-z.getDate())),Ae}function P(I){switch(I.getDay()){case 0:return new Date(I.getFullYear()-1,11,29);case 1:return I;case 2:return new Date(I.getFullYear(),0,3);case 3:return new Date(I.getFullYear(),0,2);case 4:return new Date(I.getFullYear(),0,1);case 5:return new Date(I.getFullYear()-1,11,31);case 6:return new Date(I.getFullYear()-1,11,30)}}function j(I){var z=I.ca;for(I=new Date(new Date(I.da+1900,0,1).getTime());0<z;){var q=I.getMonth(),Ae=(Vi(I.getFullYear())?po:go)[q];if(z>Ae-I.getDate())z-=Ae-I.getDate()+1,I.setDate(1),11>q?I.setMonth(q+1):(I.setMonth(0),I.setFullYear(I.getFullYear()+1));else{I.setDate(I.getDate()+z);break}}return q=new Date(I.getFullYear()+1,0,4),z=P(new Date(I.getFullYear(),0,4)),q=P(q),0>=k(z,I)?0>=k(q,I)?I.getFullYear()+1:I.getFullYear():I.getFullYear()-1}var T=ye[f+40>>2];f={wc:ye[f>>2],vc:ye[f+4>>2],Fa:ye[f+8>>2],Sa:ye[f+12>>2],Ga:ye[f+16>>2],da:ye[f+20>>2],R:ye[f+24>>2],ca:ye[f+28>>2],Rc:ye[f+32>>2],uc:ye[f+36>>2],xc:T&&T?Be(Re,T):""},u=u?Be(Re,u):"",T={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var K in T)u=u.replace(new RegExp(K,"g"),T[K]);var X="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),te="January February March April May June July August September October November December".split(" ");T={"%a":I=>X[I.R].substring(0,3),"%A":I=>X[I.R],"%b":I=>te[I.Ga].substring(0,3),"%B":I=>te[I.Ga],"%C":I=>b((I.da+1900)/100|0,2),"%d":I=>b(I.Sa,2),"%e":I=>y(I.Sa,2," "),"%g":I=>j(I).toString().substring(2),"%G":I=>j(I),"%H":I=>b(I.Fa,2),"%I":I=>(I=I.Fa,I==0?I=12:12<I&&(I-=12),b(I,2)),"%j":I=>{for(var z=0,q=0;q<=I.Ga-1;z+=(Vi(I.da+1900)?po:go)[q++]);return b(I.Sa+z,3)},"%m":I=>b(I.Ga+1,2),"%M":I=>b(I.vc,2),"%n":()=>`
`,"%p":I=>0<=I.Fa&&12>I.Fa?"AM":"PM","%S":I=>b(I.wc,2),"%t":()=>"	","%u":I=>I.R||7,"%U":I=>b(Math.floor((I.ca+7-I.R)/7),2),"%V":I=>{var z=Math.floor((I.ca+7-(I.R+6)%7)/7);if(2>=(I.R+371-I.ca-2)%7&&z++,z)z==53&&(q=(I.R+371-I.ca)%7,q==4||q==3&&Vi(I.da)||(z=1));else{z=52;var q=(I.R+7-I.ca-1)%7;(q==4||q==5&&Vi(I.da%400-1))&&z++}return b(z,2)},"%w":I=>I.R,"%W":I=>b(Math.floor((I.ca+7-(I.R+6)%7)/7),2),"%y":I=>(I.da+1900).toString().substring(2),"%Y":I=>I.da+1900,"%z":I=>{I=I.uc;var z=0<=I;return I=Math.abs(I)/60,(z?"+":"-")+("0000"+(I/60*100+I%60)).slice(-4)},"%Z":I=>I.xc,"%%":()=>"%"},u=u.replace(/%%/g,"\0\0");for(K in T)u.includes(K)&&(u=u.replace(new RegExp(K,"g"),T[K](f)));return u=u.replace(/\0\0/g,"%"),K=Qe(u,!1),K.length>a?0:(Ne.set(K,i),K.length-1)};function _o(i,a,u,f){i||(i=this),this.parent=i,this.U=i.U,this.wa=null,this.id=Su++,this.name=a,this.mode=u,this.l={},this.m={},this.za=f}Object.defineProperties(_o.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(i){i?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(i){i?this.mode|=146:this.mode&=-147}}}),Ya(),Jr=Array(4096),Ga(ge,"/"),Jt("/tmp",16895,0),Jt("/home",16895,0),Jt("/home/web_user",16895,0),(()=>{Jt("/dev",16895,0),ks(259,{read:()=>0,write:(f,y,b,k)=>k}),Ci("/dev/null",259),rt(1280,xn),rt(1536,Rn),Ci("/dev/tty",1280),Ci("/dev/tty1",1536);var i=new Uint8Array(1024),a=0,u=()=>(a===0&&(a=me(i).byteLength),i[--a]);Xr("random",u),Xr("urandom",u),Jt("/dev/shm",16895,0),Jt("/dev/shm/tmp",16895,0)})(),(()=>{Jt("/proc",16895,0);var i=Jt("/proc/self",16895,0);Jt("/proc/self/fd",16895,0),Ga({U:()=>{var a=Va(i,"fd",16895,73);return a.l={ka:(u,f)=>{var y=On(+f);return u={parent:null,U:{nb:"fake"},l:{ma:()=>y.path}},u.parent=u}},a}},"/proc/self/fd")})(),Object.assign(Qa.prototype,{get(i){return this.M[i]},has(i){return this.M[i]!==void 0},pa(i){var a=this.ib.pop()||this.M.length;return this.M[a]=i,a},Zb(i){this.M[i]=void 0,this.ib.push(i)}}),_r=_.BindingError=class extends Error{constructor(i){super(i),this.name="BindingError"}},Vt.M.push({value:void 0},{value:null},{value:!0},{value:!1}),Vt.h=Vt.M.length,_.count_emval_handles=function(){for(var i=0,a=Vt.h;a<Vt.M.length;++a)Vt.M[a]!==void 0&&++i;return i},eo=_.PureVirtualError=Za("PureVirtualError");for(var mo=Array(256),qi=0;256>qi;++qi)mo[qi]=String.fromCharCode(qi);to=mo,_.getInheritedInstanceCount=function(){return Object.keys(yn).length},_.getLiveInheritedInstances=function(){var i=[],a;for(a in yn)yn.hasOwnProperty(a)&&i.push(yn[a]);return i},_.flushPendingDeletes=Cs,_.setDelayFunction=function(i){ti=i,ei.length&&ti&&ti(Cs)},ao=_.InternalError=class extends Error{constructor(i){super(i),this.name="InternalError"}},jn.prototype.isAliasOf=function(i){if(!(this instanceof jn&&i instanceof jn))return!1;var a=this.g.u.i,u=this.g.o,f=i.g.u.i;for(i=i.g.o;a.A;)u=a.na(u),a=a.A;for(;f.A;)i=f.na(i),f=f.A;return a===f&&u===i},jn.prototype.clone=function(){if(this.g.o||xs(this),this.g.ia)return this.g.count.value+=1,this;var i=mr,a=Object,u=a.create,f=Object.getPrototypeOf(this),y=this.g;return i=i(u.call(a,f,{g:{value:{count:y.count,fa:y.fa,ia:y.ia,o:y.o,u:y.u,G:y.G,L:y.L}}})),i.g.count.value+=1,i.g.fa=!1,i},jn.prototype.delete=function(){this.g.o||xs(this),this.g.fa&&!this.g.ia&&Ee("Object already scheduled for deletion"),Ri(this),ro(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},jn.prototype.isDeleted=function(){return!this.g.o},jn.prototype.deleteLater=function(){return this.g.o||xs(this),this.g.fa&&!this.g.ia&&Ee("Object already scheduled for deletion"),ei.push(this),ei.length===1&&ti&&ti(Cs),this.g.fa=!0,this},wn.prototype.Vb=function(i){return this.sb&&(i=this.sb(i)),i},wn.prototype.bb=function(i){this.W&&this.W(i)},wn.prototype.argPackAdvance=8,wn.prototype.readValueFromPointer=ii,wn.prototype.deleteObject=function(i){i!==null&&i.delete()},wn.prototype.fromWireType=function(i){function a(){return this.ua?ji(this.i.N,{u:this.nc,o:u,L:this,G:i}):ji(this.i.N,{u:this,o:i})}var u=this.Vb(i);if(!u)return this.bb(i),null;var f=Pu(this.i,u);if(f!==void 0)return f.g.count.value===0?(f.g.o=u,f.g.G=i,f.clone()):(f=f.clone(),this.bb(i),f);if(f=this.i.Ub(u),f=so[f],!f)return a.call(this);f=this.ta?f.Kb:f.pointerType;var y=io(u,this.i,f.i);return y===null?a.call(this):this.ua?ji(f.i.N,{u:f,o:y,L:this,G:i}):ji(f.i.N,{u:f,o:y})},uo=_.UnboundTypeError=Za("UnboundTypeError");var yo={__syscall_fcntl64:function(i,a,u){Zr=u;try{var f=On(i);switch(a){case 0:var y=mn();return 0>y?-28:za(f,y).X;case 1:case 2:return 0;case 3:return f.flags;case 4:return y=mn(),f.flags|=y,0;case 5:return y=mn(),Oe[y+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return ye[wo()>>2]=28,-1;default:return-28}}catch(b){if(typeof zn>"u"||b.name!=="ErrnoError")throw b;return-b.aa}},__syscall_ioctl:function(i,a,u){Zr=u;try{var f=On(i);switch(a){case 21509:return f.s?0:-59;case 21505:if(!f.s)return-59;if(f.s.V.bc){a=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var y=mn();ye[y>>2]=25856,ye[y+4>>2]=5,ye[y+8>>2]=191,ye[y+12>>2]=35387;for(var b=0;32>b;b++)Ne[y+b+17>>0]=a[b]||0}return 0;case 21510:case 21511:case 21512:return f.s?0:-59;case 21506:case 21507:case 21508:if(!f.s)return-59;if(f.s.V.cc)for(y=mn(),a=[],b=0;32>b;b++)a.push(Ne[y+b+17>>0]);return 0;case 21519:return f.s?(y=mn(),ye[y>>2]=0):-59;case 21520:return f.s?-28:-59;case 21531:if(y=mn(),!f.m.ac)throw new re(59);return f.m.ac(f,a,y);case 21523:return f.s?(f.s.V.dc&&(b=[24,80],y=mn(),Oe[y>>1]=b[0],Oe[y+2>>1]=b[1]),0):-59;case 21524:return f.s?0:-59;case 21515:return f.s?0:-59;default:return-28}}catch(k){if(typeof zn>"u"||k.name!=="ErrnoError")throw k;return-k.aa}},__syscall_openat:function(i,a,u,f){Zr=f;try{a=a?Be(Re,a):"";var y=a;if(y.charAt(0)==="/")a=y;else{var b=i===-100?"/":On(i).path;if(y.length==0)throw new re(44);a=C(b+"/"+y)}var k=f?mn():0;return Ti(a,u,k).X}catch(P){if(typeof zn>"u"||P.name!=="ErrnoError")throw P;return-P.aa}},_embind_create_inheriting_constructor:function(i,a,u){i=it(i),a=ni(a,"wrapper"),u=Xt(u);var f=[].slice,y=a.i,b=y.N,k=y.A.N,P=y.A.constructor;i=xi(i,function(){y.A.rb.forEach((function(T){if(this[T]===k[T])throw new eo(`Pure virtual function ${T} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:b}),this.__construct.apply(this,f.call(arguments))}),b.__construct=function(){this===b&&Ee("Pass correct 'this' to __construct");var T=P.implement.apply(void 0,[this].concat(f.call(arguments)));Ri(T);var K=T.g;T.notifyOnDestruction(),K.ia=!0,Object.defineProperties(this,{g:{value:K}}),mr(this),T=K.o,T=Ts(y,T),yn.hasOwnProperty(T)?Ee(`Tried to register registered instance: ${T}`):yn[T]=this},b.__destruct=function(){this===b&&Ee("Pass correct 'this' to __destruct"),Ri(this);var T=this.g.o;T=Ts(y,T),yn.hasOwnProperty(T)?delete yn[T]:Ee(`Tried to unregister unregistered instance: ${T}`)},i.prototype=Object.create(b);for(var j in u)i.prototype[j]=u[j];return Qt(i)},_embind_finalize_value_object:function(i){var a=Mi[i];delete Mi[i];var u=a.Pa,f=a.W,y=a.fb,b=y.map(k=>k.Yb).concat(y.map(k=>k.rc));Lt([i],b,k=>{var P={};return y.forEach((j,T)=>{var K=k[T],X=j.Wb,te=j.Xb,I=k[T+y.length],z=j.qc,q=j.sc;P[j.Sb]={read:Ae=>K.fromWireType(X(te,Ae)),write:(Ae,Ce)=>{var Q=[];z(q,Ae,I.toWireType(Q,Ce)),ri(Q)}}}),[{name:a.name,fromWireType:function(j){var T={},K;for(K in P)T[K]=P[K].read(j);return f(j),T},toWireType:function(j,T){for(var K in P)if(!(K in T))throw new TypeError(`Missing field: "${K}"`);var X=u();for(K in P)P[K].write(X,T[K]);return j!==null&&j.push(f,X),X},argPackAdvance:8,readValueFromPointer:ii,K:f}]})},_embind_register_bigint:function(){},_embind_register_bool:function(i,a,u,f,y){var b=Di(u);a=it(a),cn(i,{name:a,fromWireType:function(k){return!!k},toWireType:function(k,P){return P?f:y},argPackAdvance:8,readValueFromPointer:function(k){if(u===1)var P=Ne;else if(u===2)P=Oe;else if(u===4)P=ye;else throw new TypeError("Unknown boolean type size: "+a);return this.fromWireType(P[k>>b])},K:null})},_embind_register_class:function(i,a,u,f,y,b,k,P,j,T,K,X,te){K=it(K),b=bt(y,b),P&&(P=bt(k,P)),T&&(T=bt(j,T)),te=bt(X,te);var I=Xa(K);Os(I,function(){bn(`Cannot construct ${K} due to unbound types`,[f])}),Lt([i,a,u],f?[f]:[],function(z){if(z=z[0],f)var q=z.i,Ae=q.N;else Ae=jn.prototype;z=xi(I,function(){if(Object.getPrototypeOf(this)!==Ce)throw new _r("Use 'new' to construct "+K);if(Q.$===void 0)throw new _r(K+" has no accessible constructor");var wt=Q.$[arguments.length];if(wt===void 0)throw new _r(`Tried to invoke ctor of ${K} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(Q.$).toString()}) parameters instead!`);return wt.apply(this,arguments)});var Ce=Object.create(Ae,{constructor:{value:z}});z.prototype=Ce;var Q=new Ru(K,z,Ce,te,q,b,P,T);Q.A&&(Q.A.oa===void 0&&(Q.A.oa=[]),Q.A.oa.push(Q)),q=new wn(K,Q,!0,!1),Ae=new wn(K+"*",Q,!1,!1);var Ze=new wn(K+" const*",Q,!1,!0);return so[i]={pointerType:Ae,Kb:Ze},oo(I,z),[q,Ae,Ze]})},_embind_register_class_class_function:function(i,a,u,f,y,b,k){var P=Ni(u,f);a=it(a),b=bt(y,b),Lt([],[i],function(j){function T(){bn(`Cannot call ${K} due to unbound types`,P)}j=j[0];var K=`${j.name}.${a}`;a.startsWith("@@")&&(a=Symbol[a.substring(2)]);var X=j.i.constructor;return X[a]===void 0?(T.ea=u-1,X[a]=T):(Rs(X,a,K),X[a].B[u-1]=T),Lt([],P,function(te){if(te=Ui(K,[te[0],null].concat(te.slice(1)),null,b,k),X[a].B===void 0?(te.ea=u-1,X[a]=te):X[a].B[u-1]=te,j.i.oa)for(const I of j.i.oa)I.constructor.hasOwnProperty(a)||(I.constructor[a]=te);return[]}),[]})},_embind_register_class_class_property:function(i,a,u,f,y,b,k,P){a=it(a),b=bt(y,b),Lt([],[i],function(j){j=j[0];var T=`${j.name}.${a}`,K={get(){bn(`Cannot access ${T} due to unbound types`,[u])},enumerable:!0,configurable:!0};return K.set=P?()=>{bn(`Cannot access ${T} due to unbound types`,[u])}:()=>{Ee(`${T} is a read-only property`)},Object.defineProperty(j.i.constructor,a,K),Lt([],[u],function(X){X=X[0];var te={get(){return X.fromWireType(b(f))},enumerable:!0};return P&&(P=bt(k,P),te.set=I=>{var z=[];P(f,X.toWireType(z,I)),ri(z)}),Object.defineProperty(j.i.constructor,a,te),[]}),[]})},_embind_register_class_constructor:function(i,a,u,f,y,b){var k=Ni(a,u);y=bt(f,y),Lt([],[i],function(P){P=P[0];var j=`constructor ${P.name}`;if(P.i.$===void 0&&(P.i.$=[]),P.i.$[a-1]!==void 0)throw new _r(`Cannot register multiple constructors with identical number of parameters (${a-1}) for class '${P.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return P.i.$[a-1]=()=>{bn(`Cannot construct ${P.name} due to unbound types`,k)},Lt([],k,function(T){return T.splice(1,0,null),P.i.$[a-1]=Ui(j,T,null,y,b),[]}),[]})},_embind_register_class_function:function(i,a,u,f,y,b,k,P){var j=Ni(u,f);a=it(a),b=bt(y,b),Lt([],[i],function(T){function K(){bn(`Cannot call ${X} due to unbound types`,j)}T=T[0];var X=`${T.name}.${a}`;a.startsWith("@@")&&(a=Symbol[a.substring(2)]),P&&T.i.rb.push(a);var te=T.i.N,I=te[a];return I===void 0||I.B===void 0&&I.className!==T.name&&I.ea===u-2?(K.ea=u-2,K.className=T.name,te[a]=K):(Rs(te,a,X),te[a].B[u-2]=K),Lt([],j,function(z){return z=Ui(X,z,T,b,k),te[a].B===void 0?(z.ea=u-2,te[a]=z):te[a].B[u-2]=z,[]}),[]})},_embind_register_class_property:function(i,a,u,f,y,b,k,P,j,T){a=it(a),y=bt(f,y),Lt([],[i],function(K){K=K[0];var X=`${K.name}.${a}`,te={get(){bn(`Cannot access ${X} due to unbound types`,[u,k])},enumerable:!0,configurable:!0};return te.set=j?()=>{bn(`Cannot access ${X} due to unbound types`,[u,k])}:()=>{Ee(X+" is a read-only property")},Object.defineProperty(K.i.N,a,te),Lt([],j?[u,k]:[u],function(I){var z=I[0],q={get(){var Ce=co(this,K,X+" getter");return z.fromWireType(y(b,Ce))},enumerable:!0};if(j){j=bt(P,j);var Ae=I[1];q.set=function(Ce){var Q=co(this,K,X+" setter"),Ze=[];j(T,Q,Ae.toWireType(Ze,Ce)),ri(Ze)}}return Object.defineProperty(K.i.N,a,q),[]}),[]})},_embind_register_emval:function(i,a){a=it(a),cn(i,{name:a,fromWireType:function(u){var f=Xt(u);return js(u),f},toWireType:function(u,f){return Qt(f)},argPackAdvance:8,readValueFromPointer:ii,K:null})},_embind_register_enum:function(i,a,u,f){function y(){}u=Di(u),a=it(a),y.values={},cn(i,{name:a,constructor:y,fromWireType:function(b){return this.constructor.values[b]},toWireType:function(b,k){return k.value},argPackAdvance:8,readValueFromPointer:Du(a,u,f),K:null}),Os(a,y)},_embind_register_enum_value:function(i,a,u){var f=ni(i,"enum");a=it(a),i=f.constructor,f=Object.create(f.constructor.prototype,{value:{value:u},constructor:{value:xi(`${f.name}_${a}`,function(){})}}),i.values[u]=f,i[a]=f},_embind_register_float:function(i,a,u){u=Di(u),a=it(a),cn(i,{name:a,fromWireType:function(f){return f},toWireType:function(f,y){return y},argPackAdvance:8,readValueFromPointer:$u(a,u),K:null})},_embind_register_function:function(i,a,u,f,y,b){var k=Ni(a,u);i=it(i),y=bt(f,y),Os(i,function(){bn(`Cannot call ${i} due to unbound types`,k)},a-1),Lt([],k,function(P){return oo(i,Ui(i,[P[0],null].concat(P.slice(1)),null,y,b),a-1),[]})},_embind_register_integer:function(i,a,u,f,y){a=it(a),y===-1&&(y=4294967295),y=Di(u);var b=P=>P;if(f===0){var k=32-8*u;b=P=>P<<k>>>k}u=a.includes("unsigned")?function(P,j){return j>>>0}:function(P,j){return j},cn(i,{name:a,fromWireType:b,toWireType:u,argPackAdvance:8,readValueFromPointer:Fu(a,y,f!==0),K:null})},_embind_register_memory_view:function(i,a,u){function f(b){b>>=2;var k=Pe;return new y(k.buffer,k[b+1],k[b])}var y=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][a];u=it(u),cn(i,{name:u,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{$b:!0})},_embind_register_std_string:function(i,a){a=it(a);var u=a==="std::string";cn(i,{name:a,fromWireType:function(f){var y=Pe[f>>2],b=f+4;if(u)for(var k=b,P=0;P<=y;++P){var j=b+P;if(P==y||Re[j]==0){if(k=k?Be(Re,k,j-k):"",T===void 0)var T=k;else T+="\0",T+=k;k=j+1}}else{for(T=Array(y),P=0;P<y;++P)T[P]=String.fromCharCode(Re[b+P]);T=T.join("")}return En(f),T},toWireType:function(f,y){y instanceof ArrayBuffer&&(y=new Uint8Array(y));var b=typeof y=="string";b||y instanceof Uint8Array||y instanceof Uint8ClampedArray||y instanceof Int8Array||Ee("Cannot pass non-string to std::string");var k=u&&b?he(y):y.length,P=Fs(4+k+1),j=P+4;if(Pe[P>>2]=k,u&&b)nt(y,Re,j,k+1);else if(b)for(b=0;b<k;++b){var T=y.charCodeAt(b);255<T&&(En(j),Ee("String has UTF-16 code units that do not fit in 8 bits")),Re[j+b]=T}else for(b=0;b<k;++b)Re[j+b]=y[b];return f!==null&&f.push(En,P),P},argPackAdvance:8,readValueFromPointer:ii,K:function(f){En(f)}})},_embind_register_std_wstring:function(i,a,u){if(u=it(u),a===2)var f=Uu,y=Nu,b=Bu,k=()=>st,P=1;else a===4&&(f=Wu,y=Vu,b=qu,k=()=>Pe,P=2);cn(i,{name:u,fromWireType:function(j){for(var T=Pe[j>>2],K=k(),X,te=j+4,I=0;I<=T;++I){var z=j+4+I*a;(I==T||K[z>>P]==0)&&(te=f(te,z-te),X===void 0?X=te:(X+="\0",X+=te),te=z+a)}return En(j),X},toWireType:function(j,T){typeof T!="string"&&Ee(`Cannot pass non-string to C++ string type ${u}`);var K=b(T),X=Fs(4+K+a);return Pe[X>>2]=K>>P,y(T,X+4,K+a),j!==null&&j.push(En,X),X},argPackAdvance:8,readValueFromPointer:ii,K:function(j){En(j)}})},_embind_register_value_object:function(i,a,u,f,y,b){Mi[i]={name:it(a),Pa:bt(u,f),W:bt(y,b),fb:[]}},_embind_register_value_object_field:function(i,a,u,f,y,b,k,P,j,T){Mi[i].fb.push({Sb:it(a),Yb:u,Wb:bt(f,y),Xb:b,rc:k,qc:bt(P,j),sc:T})},_embind_register_void:function(i,a){a=it(a),cn(i,{fc:!0,name:a,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(i,a,u){i=Xt(i),a=ni(a,"emval::as");var f=[],y=Qt(f);return Pe[u>>2]=y,a.toWireType(f,i)},_emval_call_method:function(i,a,u,f,y){i=Wi[i],a=Xt(a),u=Bi(u);var b=[];return Pe[f>>2]=Qt(b),i(a,u,b,y)},_emval_call_void_method:function(i,a,u,f){i=Wi[i],a=Xt(a),u=Bi(u),i(a,u,null,f)},_emval_decref:js,_emval_get_method_caller:function(i,a){var u=Gu(i,a),f=u[0];a=f.name+"_$"+u.slice(1).map(function(k){return k.name}).join("_")+"$";var y=fo[a];if(y!==void 0)return y;var b=Array(i-1);return y=zu((k,P,j,T)=>{for(var K=0,X=0;X<i-1;++X)b[X]=u[X+1].readValueFromPointer(T+K),K+=u[X+1].argPackAdvance;for(k=k[P].apply(k,b),X=0;X<i-1;++X)u[X+1].Nb&&u[X+1].Nb(b[X]);if(!f.fc)return f.toWireType(j,k)}),fo[a]=y},_emval_get_module_property:function(i){return i=Bi(i),Qt(_[i])},_emval_get_property:function(i,a){return i=Xt(i),a=Xt(a),Qt(i[a])},_emval_incref:function(i){4<i&&(Vt.get(i).ub+=1)},_emval_new_array:function(){return Qt([])},_emval_new_cstring:function(i){return Qt(Bi(i))},_emval_new_object:function(){return Qt({})},_emval_run_destructors:function(i){var a=Xt(i);ri(a),js(i)},_emval_set_property:function(i,a,u){i=Xt(i),a=Xt(a),u=Xt(u),i[a]=u},_emval_take_value:function(i,a){return i=ni(i,"_emval_take_value"),i=i.readValueFromPointer(a),Qt(i)},abort:()=>{jt("")},emscripten_asm_const_int:(i,a,u)=>{Ls.length=0;var f;for(u>>=2;f=Re[a++];)u+=f!=105&u,Ls.push(f==105?ye[u]:ue[u++>>1]),++u;return o[i].apply(null,Ls)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(i,a,u)=>Re.copyWithin(i,a,a+u),emscripten_resize_heap:i=>{var a=Re.length;if(i>>>=0,2147483648<i)return!1;for(var u=1;4>=u;u*=2){var f=a*(1+.2/u);f=Math.min(f,i+100663296);var y=Math;f=Math.max(i,f);e:{y=y.min.call(y,2147483648,f+(65536-f%65536)%65536)-Te.buffer.byteLength+65535>>>16;try{Te.grow(y),pe();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},environ_get:(i,a)=>{var u=0;return vo().forEach(function(f,y){var b=a+u;for(y=Pe[i+4*y>>2]=b,b=0;b<f.length;++b)Ne[y++>>0]=f.charCodeAt(b);Ne[y>>0]=0,u+=f.length+1}),0},environ_sizes_get:(i,a)=>{var u=vo();Pe[i>>2]=u.length;var f=0;return u.forEach(function(y){f+=y.length+1}),Pe[a>>2]=f,0},fd_close:function(i){try{var a=On(i);if(a.X===null)throw new re(8);a.Ma&&(a.Ma=null);try{a.m.close&&a.m.close(a)}catch(u){throw u}finally{ki[a.X]=null}return a.X=null,0}catch(u){if(typeof zn>"u"||u.name!=="ErrnoError")throw u;return u.aa}},fd_read:function(i,a,u,f){try{e:{var y=On(i);i=a;for(var b,k=a=0;k<u;k++){var P=Pe[i>>2],j=Pe[i+4>>2];i+=8;var T=y,K=P,X=j,te=b,I=Ne;if(0>X||0>te)throw new re(28);if(T.X===null)throw new re(8);if((T.flags&2097155)===1)throw new re(8);if((T.node.mode&61440)===16384)throw new re(31);if(!T.m.read)throw new re(28);var z=typeof te<"u";if(!z)te=T.position;else if(!T.seekable)throw new re(70);var q=T.m.read(T,I,K,X,te);z||(T.position+=q);var Ae=q;if(0>Ae){var Ce=-1;break e}if(a+=Ae,Ae<j)break;typeof b<"u"&&(b+=Ae)}Ce=a}return Pe[f>>2]=Ce,0}catch(Q){if(typeof zn>"u"||Q.name!=="ErrnoError")throw Q;return Q.aa}},fd_seek:function(i,a,u,f,y){a=u+2097152>>>0<4194305-!!a?(a>>>0)+4294967296*u:NaN;try{if(isNaN(a))return 61;var b=On(i);return Ka(b,a,f),p=[b.position>>>0,(Mt=b.position,1<=+Math.abs(Mt)?0<Mt?+Math.floor(Mt/4294967296)>>>0:~~+Math.ceil((Mt-+(~~Mt>>>0))/4294967296)>>>0:0)],ye[y>>2]=p[0],ye[y+4>>2]=p[1],b.Ma&&a===0&&f===0&&(b.Ma=null),0}catch(k){if(typeof zn>"u"||k.name!=="ErrnoError")throw k;return k.aa}},fd_write:function(i,a,u,f){try{e:{var y=On(i);i=a;for(var b,k=a=0;k<u;k++){var P=Pe[i>>2],j=Pe[i+4>>2];i+=8;var T=y,K=P,X=j,te=b,I=Ne;if(0>X||0>te)throw new re(28);if(T.X===null)throw new re(8);if((T.flags&2097155)===0)throw new re(8);if((T.node.mode&61440)===16384)throw new re(31);if(!T.m.write)throw new re(28);T.seekable&&T.flags&1024&&Ka(T,0,2);var z=typeof te<"u";if(!z)te=T.position;else if(!T.seekable)throw new re(70);var q=T.m.write(T,I,K,X,te,void 0);z||(T.position+=q);var Ae=q;if(0>Ae){var Ce=-1;break e}a+=Ae,typeof b<"u"&&(b+=Ae)}Ce=a}return Pe[f>>2]=Ce,0}catch(Q){if(typeof zn>"u"||Q.name!=="ErrnoError")throw Q;return Q.aa}},strftime_l:(i,a,u,f)=>Ku(i,a,u,f)};(function(){function i(u){if(oe=u=u.exports,Te=oe.memory,pe(),je=oe.__indirect_function_table,yt.unshift(oe.__wasm_call_ctors),ht--,_.monitorRunDependencies&&_.monitorRunDependencies(ht),ht==0&&St){var f=St;St=null,f()}return u}var a={env:yo,wasi_snapshot_preview1:yo};if(ht++,_.monitorRunDependencies&&_.monitorRunDependencies(ht),_.instantiateWasm)try{return _.instantiateWasm(a,i)}catch(u){qe("Module.instantiateWasm callback failed with error: "+u),L(u)}return qn(a,function(u){i(u.instance)}).catch(L),{}})();var En=i=>(En=oe.free)(i),Fs=i=>(Fs=oe.malloc)(i),wo=()=>(wo=oe.__errno_location)(),bo=_._ma_device__on_notification_unlocked=i=>(bo=_._ma_device__on_notification_unlocked=oe.ma_device__on_notification_unlocked)(i);_._ma_malloc_emscripten=(i,a)=>(_._ma_malloc_emscripten=oe.ma_malloc_emscripten)(i,a),_._ma_free_emscripten=(i,a)=>(_._ma_free_emscripten=oe.ma_free_emscripten)(i,a);var Eo=_._ma_device_process_pcm_frames_capture__webaudio=(i,a,u)=>(Eo=_._ma_device_process_pcm_frames_capture__webaudio=oe.ma_device_process_pcm_frames_capture__webaudio)(i,a,u),Ao=_._ma_device_process_pcm_frames_playback__webaudio=(i,a,u)=>(Ao=_._ma_device_process_pcm_frames_playback__webaudio=oe.ma_device_process_pcm_frames_playback__webaudio)(i,a,u),ko=i=>(ko=oe.__getTypeName)(i);_.__embind_initialize_bindings=()=>(_.__embind_initialize_bindings=oe._embind_initialize_bindings)(),_.dynCall_iiji=(i,a,u,f,y)=>(_.dynCall_iiji=oe.dynCall_iiji)(i,a,u,f,y),_.dynCall_jiji=(i,a,u,f,y)=>(_.dynCall_jiji=oe.dynCall_jiji)(i,a,u,f,y),_.dynCall_iiiji=(i,a,u,f,y,b)=>(_.dynCall_iiiji=oe.dynCall_iiiji)(i,a,u,f,y,b),_.dynCall_iij=(i,a,u,f)=>(_.dynCall_iij=oe.dynCall_iij)(i,a,u,f),_.dynCall_jii=(i,a,u)=>(_.dynCall_jii=oe.dynCall_jii)(i,a,u),_.dynCall_viijii=(i,a,u,f,y,b,k)=>(_.dynCall_viijii=oe.dynCall_viijii)(i,a,u,f,y,b,k),_.dynCall_iiiiij=(i,a,u,f,y,b,k)=>(_.dynCall_iiiiij=oe.dynCall_iiiiij)(i,a,u,f,y,b,k),_.dynCall_iiiiijj=(i,a,u,f,y,b,k,P,j)=>(_.dynCall_iiiiijj=oe.dynCall_iiiiijj)(i,a,u,f,y,b,k,P,j),_.dynCall_iiiiiijj=(i,a,u,f,y,b,k,P,j,T)=>(_.dynCall_iiiiiijj=oe.dynCall_iiiiiijj)(i,a,u,f,y,b,k,P,j,T);var Hi;St=function i(){Hi||So(),Hi||(St=i)};function So(){function i(){if(!Hi&&(Hi=!0,_.calledRun=!0,!Je)){if(_.noFSInit||Ja||(Ja=!0,Ya(),_.stdin=_.stdin,_.stdout=_.stdout,_.stderr=_.stderr,_.stdin?Xr("stdin",_.stdin):Ss("/dev/tty","/dev/stdin"),_.stdout?Xr("stdout",null,_.stdout):Ss("/dev/tty","/dev/stdout"),_.stderr?Xr("stderr",null,_.stderr):Ss("/dev/tty1","/dev/stderr"),Ti("/dev/stdin",0),Ti("/dev/stdout",1),Ti("/dev/stderr",1)),Na=!1,d(yt),S(_),_.onRuntimeInitialized&&_.onRuntimeInitialized(),_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;){var a=_.postRun.shift();kt.unshift(a)}d(kt)}}if(!(0<ht)){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)Nt();d(Ye),0<ht||(_.setStatus?(_.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_.setStatus("")},1),i()},1)):i())}}if(_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);0<_.preInit.length;)_.preInit.pop()();return So(),A.ready})})();const m=g}),(c=>{c.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((c,h,v)=>{v.r(h),v.d(h,{Animation:()=>g.Animation});var g=v(4)}),((c,h,v)=>{v.r(h),v.d(h,{Animation:()=>g});var g=(function(){function m(E,A,_,S){this.animation=E,this.artboard=A,this.playing=S,this.loopCount=0,this.scrubTo=null,this.instance=new _.LinearAnimationInstance(E,A)}return Object.defineProperty(m.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"time",{get:function(){return this.instance.time},set:function(E){this.instance.time=E},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),m.prototype.advance=function(E){this.scrubTo===null?this.instance.advance(E):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},m.prototype.apply=function(E){this.instance.apply(E)},m.prototype.cleanup=function(){this.instance.delete()},m})()}),((c,h,v)=>{v.r(h),v.d(h,{AudioAssetWrapper:()=>E.AudioAssetWrapper,AudioWrapper:()=>E.AudioWrapper,BLANK_URL:()=>m.BLANK_URL,CustomFileAssetLoaderWrapper:()=>E.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>E.FileAssetWrapper,Finalizable:()=>E.Finalizable,FontAssetWrapper:()=>E.FontAssetWrapper,FontWrapper:()=>E.FontWrapper,ImageAssetWrapper:()=>E.ImageAssetWrapper,ImageWrapper:()=>E.ImageWrapper,finalizationRegistry:()=>E.finalizationRegistry,registerTouchInteractions:()=>g.registerTouchInteractions,sanitizeUrl:()=>m.sanitizeUrl});var g=v(6),m=v(7),E=v(8)}),((c,h,v)=>{v.r(h),v.d(h,{registerTouchInteractions:()=>E});var g=void 0,m=function(A,_){var S,L;return["touchstart","touchmove"].indexOf(A.type)>-1&&(!((S=A.touches)===null||S===void 0)&&S.length)?(_||A.preventDefault(),{clientX:A.touches[0].clientX,clientY:A.touches[0].clientY}):A.type==="touchend"&&(!((L=A.changedTouches)===null||L===void 0)&&L.length)?{clientX:A.changedTouches[0].clientX,clientY:A.changedTouches[0].clientY}:{clientX:A.clientX,clientY:A.clientY}},E=function(A){var _=A.canvas,S=A.artboard,L=A.stateMachines,x=L===void 0?[]:L,D=A.renderer,N=A.rive,U=A.fit,H=A.alignment,G=A.isTouchScrollEnabled,R=G===void 0?!1:G,M=A.layoutScaleFactor,ie=M===void 0?1:M;if(!_||!x.length||!D||!N||!S||typeof window>"u")return null;var Y=null,le=!1,J=function(ve){if(le&&ve instanceof MouseEvent){ve.type=="mouseup"&&(le=!1);return}le=R&&ve.type==="touchend"&&Y==="touchstart",Y=ve.type;var qe=ve.currentTarget.getBoundingClientRect(),se=m(ve,R),Te=se.clientX,oe=se.clientY;if(!(!Te&&!oe)){var Je=Te-qe.left,Ne=oe-qe.top,Re=N.computeAlignment(U,H,{minX:0,minY:0,maxX:qe.width,maxY:qe.height},S.bounds,ie),Oe=new N.Mat2D;Re.invert(Oe);var st=new N.Vec2D(Je,Ne),ye=N.mapXY(Oe,st),Pe=ye.x(),be=ye.y();switch(ye.delete(),Oe.delete(),st.delete(),Re.delete(),ve.type){case"mouseout":for(var ue=0,pe=x;ue<pe.length;ue++){var je=pe[ue];je.pointerMove(Pe,be)}break;case"touchmove":case"mouseover":case"mousemove":{for(var Ye=0,yt=x;Ye<yt.length;Ye++){var je=yt[Ye];je.pointerMove(Pe,be)}break}case"touchstart":case"mousedown":{for(var kt=0,Nt=x;kt<Nt.length;kt++){var je=Nt[kt];je.pointerDown(Pe,be)}break}case"touchend":case"mouseup":{for(var ht=0,St=x;ht<St.length;ht++){var je=St[ht];je.pointerUp(Pe,be)}break}}}},ee=J.bind(g);return _.addEventListener("mouseover",ee),_.addEventListener("mouseout",ee),_.addEventListener("mousemove",ee),_.addEventListener("mousedown",ee),_.addEventListener("mouseup",ee),_.addEventListener("touchmove",ee,{passive:R}),_.addEventListener("touchstart",ee,{passive:R}),_.addEventListener("touchend",ee),function(){_.removeEventListener("mouseover",ee),_.removeEventListener("mouseout",ee),_.removeEventListener("mousemove",ee),_.removeEventListener("mousedown",ee),_.removeEventListener("mouseup",ee),_.removeEventListener("touchmove",ee),_.removeEventListener("touchstart",ee),_.removeEventListener("touchend",ee)}}}),((c,h,v)=>{v.r(h),v.d(h,{BLANK_URL:()=>L,sanitizeUrl:()=>N});var g=/^([^\w]*)(javascript|data|vbscript)/im,m=/&#(\w+)(^\w|;)?/g,E=/&(newline|tab);/gi,A=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,_=/^.+(:|&colon;)/gim,S=[".","/"],L="about:blank";function x(U){return S.indexOf(U[0])>-1}function D(U){var H=U.replace(A,"");return H.replace(m,function(G,R){return String.fromCharCode(R)})}function N(U){if(!U)return L;var H=D(U).replace(E,"").replace(A,"").trim();if(!H)return L;if(x(H))return H;var G=H.match(_);if(!G)return H;var R=G[0];return g.test(R)?L:H}}),((c,h,v)=>{v.r(h),v.d(h,{AudioAssetWrapper:()=>D,AudioWrapper:()=>A,CustomFileAssetLoaderWrapper:()=>S,FileAssetWrapper:()=>L,Finalizable:()=>m,FontAssetWrapper:()=>N,FontWrapper:()=>_,ImageAssetWrapper:()=>x,ImageWrapper:()=>E,finalizationRegistry:()=>G});var g=(function(){var R=function(M,ie){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,le){Y.__proto__=le}||function(Y,le){for(var J in le)Object.prototype.hasOwnProperty.call(le,J)&&(Y[J]=le[J])},R(M,ie)};return function(M,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Class extends value "+String(ie)+" is not a constructor or null");R(M,ie);function Y(){this.constructor=M}M.prototype=ie===null?Object.create(ie):(Y.prototype=ie.prototype,new Y)}})(),m=(function(){function R(){this.selfUnref=!1}return R})(),E=(function(R){g(M,R);function M(ie){var Y=R.call(this)||this;return Y._nativeImage=ie,Y}return Object.defineProperty(M.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),M.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},M})(m),A=(function(R){g(M,R);function M(ie){var Y=R.call(this)||this;return Y._nativeAudio=ie,Y}return Object.defineProperty(M.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),M.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},M})(m),_=(function(R){g(M,R);function M(ie){var Y=R.call(this)||this;return Y._nativeFont=ie,Y}return Object.defineProperty(M.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),M.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},M})(m),S=(function(){function R(M,ie){this._assetLoaderCallback=ie,this.assetLoader=new M.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return R.prototype.loadContents=function(M,ie){var Y;return M.isImage?Y=new x(M):M.isAudio?Y=new D(M):M.isFont&&(Y=new N(M)),this._assetLoaderCallback(Y,ie)},R})(),L=(function(){function R(M){this._nativeFileAsset=M}return R.prototype.decode=function(M){this._nativeFileAsset.decode(M)},Object.defineProperty(R.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),R})(),x=(function(R){g(M,R);function M(){return R!==null&&R.apply(this,arguments)||this}return M.prototype.setRenderImage=function(ie){this._nativeFileAsset.setRenderImage(ie.nativeImage)},M})(L),D=(function(R){g(M,R);function M(){return R!==null&&R.apply(this,arguments)||this}return M.prototype.setAudioSource=function(ie){this._nativeFileAsset.setAudioSource(ie.nativeAudio)},M})(L),N=(function(R){g(M,R);function M(){return R!==null&&R.apply(this,arguments)||this}return M.prototype.setFont=function(ie){this._nativeFileAsset.setFont(ie.nativeFont)},M})(L),U=(function(){function R(M){}return R.prototype.register=function(M){M.selfUnref=!0},R.prototype.unregister=function(M){},R})(),H=typeof FinalizationRegistry<"u"?FinalizationRegistry:U,G=new H(function(R){R.unref()})})],r={};function s(c){var h=r[c];if(h!==void 0)return h.exports;var v=r[c]={exports:{}};return t[c](v,v.exports,s),v.exports}s.d=(c,h)=>{for(var v in h)s.o(h,v)&&!s.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:h[v]})},s.o=(c,h)=>Object.prototype.hasOwnProperty.call(c,h),s.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var l={};return(()=>{s.r(l),s.d(l,{Alignment:()=>N,DataEnum:()=>be,EventType:()=>J,Fit:()=>D,Layout:()=>U,LoopType:()=>ee,Rive:()=>ye,RiveEventType:()=>M,RiveFile:()=>st,RuntimeLoader:()=>H,StateMachineInput:()=>R,StateMachineInputType:()=>G,Testing:()=>vt,ViewModel:()=>Pe,ViewModelInstance:()=>pe,ViewModelInstanceArtboard:()=>tt,ViewModelInstanceAssetImage:()=>ot,ViewModelInstanceBoolean:()=>kt,ViewModelInstanceColor:()=>jt,ViewModelInstanceEnum:()=>ht,ViewModelInstanceList:()=>St,ViewModelInstanceNumber:()=>yt,ViewModelInstanceString:()=>Ye,ViewModelInstanceTrigger:()=>Nt,ViewModelInstanceValue:()=>je,decodeAudio:()=>Bt,decodeFont:()=>Mt,decodeImage:()=>qn});var c=s(1),h=s(2),v=s(3),g=s(5),m=(function(){var p=function(o,d){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,C){w.__proto__=C}||function(w,C){for(var O in C)Object.prototype.hasOwnProperty.call(C,O)&&(w[O]=C[O])},p(o,d)};return function(o,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");p(o,d);function w(){this.constructor=o}o.prototype=d===null?Object.create(d):(w.prototype=d.prototype,new w)}})(),E=function(){return E=Object.assign||function(p){for(var o,d=1,w=arguments.length;d<w;d++){o=arguments[d];for(var C in o)Object.prototype.hasOwnProperty.call(o,C)&&(p[C]=o[C])}return p},E.apply(this,arguments)},A=function(p,o,d,w){function C(O){return O instanceof d?O:new d(function(W){W(O)})}return new(d||(d=Promise))(function(O,W){function de(Se){try{ae(w.next(Se))}catch(Be){W(Be)}}function me(Se){try{ae(w.throw(Se))}catch(Be){W(Be)}}function ae(Se){Se.done?O(Se.value):C(Se.value).then(de,me)}ae((w=w.apply(p,o||[])).next())})},_=function(p,o){var d={label:0,sent:function(){if(O[0]&1)throw O[1];return O[1]},trys:[],ops:[]},w,C,O,W=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return W.next=de(0),W.throw=de(1),W.return=de(2),typeof Symbol=="function"&&(W[Symbol.iterator]=function(){return this}),W;function de(ae){return function(Se){return me([ae,Se])}}function me(ae){if(w)throw new TypeError("Generator is already executing.");for(;W&&(W=0,ae[0]&&(d=0)),d;)try{if(w=1,C&&(O=ae[0]&2?C.return:ae[0]?C.throw||((O=C.return)&&O.call(C),0):C.next)&&!(O=O.call(C,ae[1])).done)return O;switch(C=0,O&&(ae=[ae[0]&2,O.value]),ae[0]){case 0:case 1:O=ae;break;case 4:return d.label++,{value:ae[1],done:!1};case 5:d.label++,C=ae[1],ae=[0];continue;case 7:ae=d.ops.pop(),d.trys.pop();continue;default:if(O=d.trys,!(O=O.length>0&&O[O.length-1])&&(ae[0]===6||ae[0]===2)){d=0;continue}if(ae[0]===3&&(!O||ae[1]>O[0]&&ae[1]<O[3])){d.label=ae[1];break}if(ae[0]===6&&d.label<O[1]){d.label=O[1],O=ae;break}if(O&&d.label<O[2]){d.label=O[2],d.ops.push(ae);break}O[2]&&d.ops.pop(),d.trys.pop();continue}ae=o.call(p,d)}catch(Se){ae=[6,Se],C=0}finally{w=O=0}if(ae[0]&5)throw ae[1];return{value:ae[0]?ae[1]:void 0,done:!0}}},S=function(p,o,d){if(d||arguments.length===2)for(var w=0,C=o.length,O;w<C;w++)(O||!(w in o))&&(O||(O=Array.prototype.slice.call(o,0,w)),O[w]=o[w]);return p.concat(O||Array.prototype.slice.call(o))},L=(function(p){m(o,p);function o(){var d=p!==null&&p.apply(this,arguments)||this;return d.isHandledError=!0,d}return o})(Error),x=function(p){return p&&p.isHandledError?p.message:"Problem loading file; may be corrupt!"},D;(function(p){p.Cover="cover",p.Contain="contain",p.Fill="fill",p.FitWidth="fitWidth",p.FitHeight="fitHeight",p.None="none",p.ScaleDown="scaleDown",p.Layout="layout"})(D||(D={}));var N;(function(p){p.Center="center",p.TopLeft="topLeft",p.TopCenter="topCenter",p.TopRight="topRight",p.CenterLeft="centerLeft",p.CenterRight="centerRight",p.BottomLeft="bottomLeft",p.BottomCenter="bottomCenter",p.BottomRight="bottomRight"})(N||(N={}));var U=(function(){function p(o){var d,w,C,O,W,de,me;this.fit=(d=o?.fit)!==null&&d!==void 0?d:D.Contain,this.alignment=(w=o?.alignment)!==null&&w!==void 0?w:N.Center,this.layoutScaleFactor=(C=o?.layoutScaleFactor)!==null&&C!==void 0?C:1,this.minX=(O=o?.minX)!==null&&O!==void 0?O:0,this.minY=(W=o?.minY)!==null&&W!==void 0?W:0,this.maxX=(de=o?.maxX)!==null&&de!==void 0?de:0,this.maxY=(me=o?.maxY)!==null&&me!==void 0?me:0}return p.new=function(o){var d=o.fit,w=o.alignment,C=o.minX,O=o.minY,W=o.maxX,de=o.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new p({fit:d,alignment:w,minX:C,minY:O,maxX:W,maxY:de})},p.prototype.copyWith=function(o){var d=o.fit,w=o.alignment,C=o.layoutScaleFactor,O=o.minX,W=o.minY,de=o.maxX,me=o.maxY;return new p({fit:d??this.fit,alignment:w??this.alignment,layoutScaleFactor:C??this.layoutScaleFactor,minX:O??this.minX,minY:W??this.minY,maxX:de??this.maxX,maxY:me??this.maxY})},p.prototype.runtimeFit=function(o){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var d;return this.fit===D.Cover?d=o.Fit.cover:this.fit===D.Contain?d=o.Fit.contain:this.fit===D.Fill?d=o.Fit.fill:this.fit===D.FitWidth?d=o.Fit.fitWidth:this.fit===D.FitHeight?d=o.Fit.fitHeight:this.fit===D.ScaleDown?d=o.Fit.scaleDown:this.fit===D.Layout?d=o.Fit.layout:d=o.Fit.none,this.cachedRuntimeFit=d,d},p.prototype.runtimeAlignment=function(o){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var d;return this.alignment===N.TopLeft?d=o.Alignment.topLeft:this.alignment===N.TopCenter?d=o.Alignment.topCenter:this.alignment===N.TopRight?d=o.Alignment.topRight:this.alignment===N.CenterLeft?d=o.Alignment.centerLeft:this.alignment===N.CenterRight?d=o.Alignment.centerRight:this.alignment===N.BottomLeft?d=o.Alignment.bottomLeft:this.alignment===N.BottomCenter?d=o.Alignment.bottomCenter:this.alignment===N.BottomRight?d=o.Alignment.bottomRight:d=o.Alignment.center,this.cachedRuntimeAlignment=d,d},p})(),H=(function(){function p(){}return p.loadRuntime=function(){c.default({locateFile:function(){return p.wasmURL}}).then(function(o){var d;for(p.runtime=o;p.callBackQueue.length>0;)(d=p.callBackQueue.shift())===null||d===void 0||d(p.runtime)}).catch(function(o){var d={message:o?.message||"Unknown error",type:o?.name||"Error",wasmError:o instanceof WebAssembly.CompileError||o instanceof WebAssembly.RuntimeError,originalError:o};console.debug("Rive WASM load error details:",d);var w="https://cdn.jsdelivr.net/npm/".concat(h.name,"@").concat(h.version,"/rive_fallback.wasm");if(p.wasmURL.toLowerCase()!==w)console.warn("Failed to load WASM from ".concat(p.wasmURL," (").concat(d.message,"), trying jsdelivr as a backup")),p.setWasmUrl(w),p.loadRuntime();else{var C=["Could not load Rive WASM file from ".concat(p.wasmURL," or ").concat(w,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(d.type),"- Message: ".concat(d.message),"- WebAssembly-specific error: ".concat(d.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(C)}})},p.getInstance=function(o){p.isLoading||(p.isLoading=!0,p.loadRuntime()),p.runtime?o(p.runtime):p.callBackQueue.push(o)},p.awaitInstance=function(){return new Promise(function(o){return p.getInstance(function(d){return o(d)})})},p.setWasmUrl=function(o){p.wasmURL=o},p.getWasmUrl=function(){return p.wasmURL},p.isLoading=!1,p.callBackQueue=[],p.wasmURL="https://unpkg.com/".concat(h.name,"@").concat(h.version,"/rive.wasm"),p})(),G;(function(p){p[p.Number=56]="Number",p[p.Trigger=58]="Trigger",p[p.Boolean=59]="Boolean"})(G||(G={}));var R=(function(){function p(o,d){this.type=o,this.runtimeInput=d}return Object.defineProperty(p.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(o){this.runtimeInput.value=o},enumerable:!1,configurable:!0}),p.prototype.fire=function(){this.type===G.Trigger&&this.runtimeInput.fire()},p.prototype.delete=function(){this.runtimeInput=null},p})(),M;(function(p){p[p.General=128]="General",p[p.OpenUrl=131]="OpenUrl"})(M||(M={}));var ie=(function(){function p(o){this.nativeArtboard=o}return p})(),Y=(function(){function p(o,d,w,C){this.stateMachine=o,this.playing=w,this.artboard=C,this.inputs=[],this.instance=new d.StateMachineInstance(o,C),this.initInputs(d)}return Object.defineProperty(p.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statesChanged",{get:function(){for(var o=[],d=0;d<this.instance.stateChangedCount();d++)o.push(this.instance.stateChangedNameByIndex(d));return o},enumerable:!1,configurable:!0}),p.prototype.advance=function(o){this.instance.advance(o)},p.prototype.advanceAndApply=function(o){this.instance.advanceAndApply(o)},p.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},p.prototype.reportedEventAt=function(o){return this.instance.reportedEventAt(o)},p.prototype.initInputs=function(o){for(var d=0;d<this.instance.inputCount();d++){var w=this.instance.input(d);this.inputs.push(this.mapRuntimeInput(w,o))}},p.prototype.mapRuntimeInput=function(o,d){if(o.type===d.SMIInput.bool)return new R(G.Boolean,o.asBool());if(o.type===d.SMIInput.number)return new R(G.Number,o.asNumber());if(o.type===d.SMIInput.trigger)return new R(G.Trigger,o.asTrigger())},p.prototype.cleanup=function(){this.inputs.forEach(function(o){o.delete()}),this.inputs.length=0,this.instance.delete()},p.prototype.bindViewModelInstance=function(o){o.runtimeInstance!=null&&this.instance.bindViewModelInstance(o.runtimeInstance)},p})(),le=(function(){function p(o,d,w,C,O){C===void 0&&(C=[]),O===void 0&&(O=[]),this.runtime=o,this.artboard=d,this.eventManager=w,this.animations=C,this.stateMachines=O}return p.prototype.add=function(o,d,w){if(w===void 0&&(w=!0),o=ft(o),o.length===0)this.animations.forEach(function(he){return he.playing=d}),this.stateMachines.forEach(function(he){return he.playing=d});else for(var C=this.animations.map(function(he){return he.name}),O=this.stateMachines.map(function(he){return he.name}),W=0;W<o.length;W++){var de=C.indexOf(o[W]),me=O.indexOf(o[W]);if(de>=0||me>=0)de>=0?this.animations[de].playing=d:this.stateMachines[me].playing=d;else{var ae=this.artboard.animationByName(o[W]);if(ae){var Se=new v.Animation(ae,this.artboard,this.runtime,d);Se.advance(0),Se.apply(1),this.animations.push(Se)}else{var Be=this.artboard.stateMachineByName(o[W]);if(Be){var at=new Y(Be,this.runtime,d,this.artboard);this.stateMachines.push(at)}}}}return w&&(d?this.eventManager.fire({type:J.Play,data:this.playing}):this.eventManager.fire({type:J.Pause,data:this.paused})),d?this.playing:this.paused},p.prototype.initLinearAnimations=function(o,d){for(var w=this.animations.map(function(me){return me.name}),C=0;C<o.length;C++){var O=w.indexOf(o[C]);if(O>=0)this.animations[O].playing=d;else{var W=this.artboard.animationByName(o[C]);if(W){var de=new v.Animation(W,this.artboard,this.runtime,d);de.advance(0),de.apply(1),this.animations.push(de)}else console.error("Animation with name ".concat(o[C]," not found."))}}},p.prototype.initStateMachines=function(o,d){for(var w=this.stateMachines.map(function(me){return me.name}),C=0;C<o.length;C++){var O=w.indexOf(o[C]);if(O>=0)this.stateMachines[O].playing=d;else{var W=this.artboard.stateMachineByName(o[C]);if(W){var de=new Y(W,this.runtime,d,this.artboard);this.stateMachines.push(de),d||de.advanceAndApply(0)}else console.warn("State Machine with name ".concat(o[C]," not found.")),this.initLinearAnimations([o[C]],d)}}},p.prototype.play=function(o){return this.add(o,!0)},p.prototype.pause=function(o){return this.add(o,!1)},p.prototype.scrub=function(o,d){var w=this.animations.filter(function(C){return o.includes(C.name)});return w.forEach(function(C){return C.scrubTo=d}),w.map(function(C){return C.name})},Object.defineProperty(p.prototype,"playing",{get:function(){return this.animations.filter(function(o){return o.playing}).map(function(o){return o.name}).concat(this.stateMachines.filter(function(o){return o.playing}).map(function(o){return o.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"paused",{get:function(){return this.animations.filter(function(o){return!o.playing}).map(function(o){return o.name}).concat(this.stateMachines.filter(function(o){return!o.playing}).map(function(o){return o.name}))},enumerable:!1,configurable:!0}),p.prototype.stop=function(o){var d=this;o=ft(o);var w=[];if(o.length===0)w=this.animations.map(function(W){return W.name}).concat(this.stateMachines.map(function(W){return W.name})),this.animations.forEach(function(W){return W.cleanup()}),this.stateMachines.forEach(function(W){return W.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var C=this.animations.filter(function(W){return o.includes(W.name)});C.forEach(function(W){W.cleanup(),d.animations.splice(d.animations.indexOf(W),1)});var O=this.stateMachines.filter(function(W){return o.includes(W.name)});O.forEach(function(W){W.cleanup(),d.stateMachines.splice(d.stateMachines.indexOf(W),1)}),w=C.map(function(W){return W.name}).concat(O.map(function(W){return W.name}))}return this.eventManager.fire({type:J.Stop,data:w}),w},Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(o,d){return o||d.playing},!1)||this.stateMachines.reduce(function(o,d){return o||d.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),p.prototype.atLeastOne=function(o,d){d===void 0&&(d=!0);var w;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([w=this.artboard.animationByIndex(0).name],o,d):this.artboard.stateMachineCount()>0&&this.add([w=this.artboard.stateMachineByIndex(0).name],o,d)),w},p.prototype.handleLooping=function(){for(var o=0,d=this.animations.filter(function(C){return C.playing});o<d.length;o++){var w=d[o];w.loopValue===0&&w.loopCount?(w.loopCount=0,this.stop(w.name)):w.loopValue===1&&w.loopCount?(this.eventManager.fire({type:J.Loop,data:{animation:w.name,type:ee.Loop}}),w.loopCount=0):w.loopValue===2&&w.loopCount>1&&(this.eventManager.fire({type:J.Loop,data:{animation:w.name,type:ee.PingPong}}),w.loopCount=0)}},p.prototype.handleStateChanges=function(){for(var o=[],d=0,w=this.stateMachines.filter(function(O){return O.playing});d<w.length;d++){var C=w[d];o.push.apply(o,C.statesChanged)}o.length>0&&this.eventManager.fire({type:J.StateChange,data:o})},p.prototype.handleAdvancing=function(o){this.eventManager.fire({type:J.Advance,data:o})},p})(),J;(function(p){p.Load="load",p.LoadError="loaderror",p.Play="play",p.Pause="pause",p.Stop="stop",p.Loop="loop",p.Draw="draw",p.Advance="advance",p.StateChange="statechange",p.RiveEvent="riveevent",p.AudioStatusChange="audiostatuschange"})(J||(J={}));var ee;(function(p){p.OneShot="oneshot",p.Loop="loop",p.PingPong="pingpong"})(ee||(ee={}));var ve=(function(){function p(o){o===void 0&&(o=[]),this.listeners=o}return p.prototype.getListeners=function(o){return this.listeners.filter(function(d){return d.type===o})},p.prototype.add=function(o){this.listeners.includes(o)||this.listeners.push(o)},p.prototype.remove=function(o){for(var d=0;d<this.listeners.length;d++){var w=this.listeners[d];if(w.type===o.type&&w.callback===o.callback){this.listeners.splice(d,1);break}}},p.prototype.removeAll=function(o){var d=this;o?this.listeners.filter(function(w){return w.type===o}).forEach(function(w){return d.remove(w)}):this.listeners.splice(0,this.listeners.length)},p.prototype.fire=function(o){var d=this.getListeners(o.type);d.forEach(function(w){return w.callback(o)})},p})(),qe=(function(){function p(o){this.eventManager=o,this.queue=[]}return p.prototype.add=function(o){this.queue.push(o)},p.prototype.process=function(){for(;this.queue.length>0;){var o=this.queue.shift();o?.action&&o.action(),o?.event&&this.eventManager.fire(o.event)}},p})(),se;(function(p){p[p.AVAILABLE=0]="AVAILABLE",p[p.UNAVAILABLE=1]="UNAVAILABLE"})(se||(se={}));var Te=(function(p){m(o,p);function o(){var d=p!==null&&p.apply(this,arguments)||this;return d._started=!1,d._enabled=!1,d._status=se.UNAVAILABLE,d}return o.prototype.delay=function(d){return A(this,void 0,void 0,function(){return _(this,function(w){return[2,new Promise(function(C){return setTimeout(C,d)})]})})},o.prototype.timeout=function(){return A(this,void 0,void 0,function(){return _(this,function(d){return[2,new Promise(function(w,C){return setTimeout(C,50)})]})})},o.prototype.reportToListeners=function(){this.fire({type:J.AudioStatusChange}),this.removeAll()},o.prototype.enableAudio=function(){return A(this,void 0,void 0,function(){return _(this,function(d){return this._enabled||(this._enabled=!0,this._status=se.AVAILABLE,this.reportToListeners()),[2]})})},o.prototype.testAudio=function(){return A(this,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:if(!(this._status===se.UNAVAILABLE&&this._audioContext!==null))return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return d.sent(),this.enableAudio(),[3,4];case 3:return d.sent(),[3,4];case 4:return[2]}})})},o.prototype._establishAudio=function(){return A(this,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),d.label=2;case 2:return this._status!==se.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return d.sent(),[4,this.delay(1e3)];case 4:return d.sent(),[3,2];case 5:return[2]}})})},o.prototype.listenForUserAction=function(){var d=this,w=function(){return A(d,void 0,void 0,function(){return _(this,function(C){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",w,{once:!0})},o.prototype.establishAudio=function(){return A(this,void 0,void 0,function(){return _(this,function(d){return this._establishAudio(),[2]})})},Object.defineProperty(o.prototype,"systemVolume",{get:function(){return this._status===se.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),o})(ve),oe=new Te,Je=(function(){function p(){}return p.prototype.observe=function(){},p.prototype.unobserve=function(){},p.prototype.disconnect=function(){},p})(),Ne=globalThis.ResizeObserver||Je,Re=(function(){function p(){var o=this;this._elementsMap=new Map,this._onObservedEntry=function(d){var w=o._elementsMap.get(d.target);w!==null?w.onResize(d.target.clientWidth==0||d.target.clientHeight==0):o._resizeObserver.unobserve(d.target)},this._onObserved=function(d){d.forEach(o._onObservedEntry)},this._resizeObserver=new Ne(this._onObserved)}return p.prototype.add=function(o,d){var w={onResize:d,element:o};return this._elementsMap.set(o,w),this._resizeObserver.observe(o),w},p.prototype.remove=function(o){this._resizeObserver.unobserve(o.element),this._elementsMap.delete(o.element)},p})(),Oe=new Re,st=(function(){function p(o){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=o.src,this.buffer=o.buffer,o.assetLoader&&(this.assetLoader=o.assetLoader),this.enableRiveAssetCDN=typeof o.enableRiveAssetCDN=="boolean"?o.enableRiveAssetCDN:!0,this.eventManager=new ve,o.onLoad&&this.on(J.Load,o.onLoad),o.onLoadError&&this.on(J.LoadError,o.onLoadError)}return p.prototype.initData=function(){return A(this,void 0,void 0,function(){var o,d,w,C,O;return _(this,function(W){switch(W.label){case 0:return this.src?(o=this,[4,on(this.src)]):[3,2];case 1:o.buffer=W.sent(),W.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(w=new g.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),d=w.assetLoader),C=this,[4,this.runtime.load(new Uint8Array(this.buffer),d,this.enableRiveAssetCDN)]);case 3:return C.file=W.sent(),this.destroyed?((O=this.file)===null||O===void 0||O.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:J.Load,data:this}):this.fireLoadError(p.fileLoadErrorMessage),[2])}})})},p.prototype.init=function(){return A(this,void 0,void 0,function(){var o,d;return _(this,function(w){switch(w.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(p.missingErrorMessage),[2];w.label=1;case 1:return w.trys.push([1,4,,5]),o=this,[4,H.awaitInstance()];case 2:return o.runtime=w.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return w.sent(),[3,5];case 4:return d=w.sent(),this.fireLoadError(d instanceof Error?d.message:p.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},p.prototype.fireLoadError=function(o){throw this.eventManager.fire({type:J.LoadError,data:o}),new Error(o)},p.prototype.on=function(o,d){this.eventManager.add({type:o,callback:d})},p.prototype.off=function(o,d){this.eventManager.remove({type:o,callback:d})},p.prototype.cleanup=function(){var o;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(o=this.file)===null||o===void 0||o.delete(),this.file=null,this.destroyed=!0)},p.prototype.removeAllRiveEventListeners=function(o){this.eventManager.removeAll(o)},p.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},p.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},p.prototype.getArtboard=function(o){var d=this.file.artboardByName(o);return d!=null?new ie(d):null},p.missingErrorMessage="Rive source file or data buffer required",p.fileLoadErrorMessage="The file failed to load",p})(),ye=(function(){function p(o){var d=this,w;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(C){var O=d._hasZeroSize!==C;d._hasZeroSize=C,C?(!d._layout.maxX||!d._layout.maxY)&&d.resizeToCanvas():O&&d.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=o.canvas,o.canvas.constructor===HTMLCanvasElement&&(this._observed=Oe.add(this.canvas,this.onCanvasResize)),this.src=o.src,this.buffer=o.buffer,this.riveFile=o.riveFile,this.layout=(w=o.layout)!==null&&w!==void 0?w:new U,this.shouldDisableRiveListeners=!!o.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!o.isTouchScrollEnabled,this.automaticallyHandleEvents=!!o.automaticallyHandleEvents,this.enableRiveAssetCDN=o.enableRiveAssetCDN===void 0?!0:o.enableRiveAssetCDN,this.eventManager=new ve,o.onLoad&&this.on(J.Load,o.onLoad),o.onLoadError&&this.on(J.LoadError,o.onLoadError),o.onPlay&&this.on(J.Play,o.onPlay),o.onPause&&this.on(J.Pause,o.onPause),o.onStop&&this.on(J.Stop,o.onStop),o.onLoop&&this.on(J.Loop,o.onLoop),o.onStateChange&&this.on(J.StateChange,o.onStateChange),o.onAdvance&&this.on(J.Advance,o.onAdvance),o.onload&&!o.onLoad&&this.on(J.Load,o.onload),o.onloaderror&&!o.onLoadError&&this.on(J.LoadError,o.onloaderror),o.onplay&&!o.onPlay&&this.on(J.Play,o.onplay),o.onpause&&!o.onPause&&this.on(J.Pause,o.onpause),o.onstop&&!o.onStop&&this.on(J.Stop,o.onstop),o.onloop&&!o.onLoop&&this.on(J.Loop,o.onloop),o.onstatechange&&!o.onStateChange&&this.on(J.StateChange,o.onstatechange),o.assetLoader&&(this.assetLoader=o.assetLoader),this.taskQueue=new qe(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:o.autoplay,autoBind:o.autoBind,animations:o.animations,stateMachines:o.stateMachines,artboard:o.artboard,useOffscreenRenderer:o.useOffscreenRenderer})}return Object.defineProperty(p.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),p.new=function(o){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new p(o)},p.prototype.onSystemAudioChanged=function(){this.volume=this._volume},p.prototype.init=function(o){var d=this,w=o.src,C=o.buffer,O=o.riveFile,W=o.animations,de=o.stateMachines,me=o.artboard,ae=o.autoplay,Se=ae===void 0?!1:ae,Be=o.useOffscreenRenderer,at=Be===void 0?!1:Be,he=o.autoBind,nt=he===void 0?!1:he;if(!this.destroyed){if(this.src=w,this.buffer=C,this.riveFile=O,!this.src&&!this.buffer&&!this.riveFile)throw new L(p.missingErrorMessage);var Qe=ft(W),lt=ft(de);this.loaded=!1,this.readyForPlaying=!1,H.awaitInstance().then(function(rt){d.destroyed||(d.runtime=rt,d.removeRiveListeners(),d.deleteRiveRenderer(),d.renderer=d.runtime.makeRenderer(d.canvas,at),d.canvas.width||d.canvas.height||d.resizeDrawingSurfaceToCanvas(),d.initData(me,Qe,lt,Se,nt).then(function(Wt){if(Wt)return d.setupRiveListeners()}).catch(function(Wt){console.error(Wt)}))}).catch(function(rt){console.error(rt)})}},p.prototype.setupRiveListeners=function(o){var d=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var w=(this.animator.stateMachines||[]).filter(function(O){return O.playing&&d.runtime.hasListeners(O.instance)}).map(function(O){return O.instance}),C=this.isTouchScrollEnabled;o&&"isTouchScrollEnabled"in o&&(C=o.isTouchScrollEnabled),this.eventCleanup=(0,g.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:w,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:C,layoutScaleFactor:this._layout.layoutScaleFactor})}},p.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},p.prototype.initializeAudio=function(){var o=this,d;oe.status==se.UNAVAILABLE&&!((d=this.artboard)===null||d===void 0)&&d.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:J.AudioStatusChange,callback:function(){return o.onSystemAudioChanged()}},oe.add(this._audioEventListener),oe.establishAudio())},p.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},p.prototype.initData=function(o,d,w,C,O){return A(this,void 0,void 0,function(){var W,de,me,ae;return _(this,function(Se){switch(Se.label){case 0:return Se.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(W=new st({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=W,[4,W.init()]);case 1:if(Se.sent(),this.destroyed)return W.destroyIfUnused(),[2,!1];Se.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(o,d,w,C,O),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:J.Load,data:(ae=this.src)!==null&&ae!==void 0?ae:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return de=Se.sent(),me=x(de),console.warn(me),this.eventManager.fire({type:J.LoadError,data:me}),[2,Promise.reject(me)];case 4:return[2]}})})},p.prototype.initArtboard=function(o,d,w,C,O){if(this.file){var W=o?this.file.artboardByName(o):this.file.defaultArtboard();if(!W){var de="Invalid artboard name or no default artboard";console.warn(de),this.eventManager.fire({type:J.LoadError,data:de});return}if(this.artboard=W,W.volume=this._volume*oe.systemVolume,this.artboard.animationCount()<1){var de="Artboard has no animations";throw this.eventManager.fire({type:J.LoadError,data:de}),de}this.animator=new le(this.runtime,this.artboard,this.eventManager);var me;if(d.length>0||w.length>0?(me=d.concat(w),this.animator.initLinearAnimations(d,C),this.animator.initStateMachines(w,C)):me=[this.animator.atLeastOne(C,!1)],this.taskQueue.add({event:{type:C?J.Play:J.Pause,data:me}}),O){var ae=this.file.defaultArtboardViewModel(W);if(ae!==null){var Se=ae.defaultInstance();if(Se!==null){var Be=new pe(Se,null);this.bindViewModelInstance(Be)}}}}},p.prototype.drawFrame=function(){var o,d;!((o=document?.timeline)===null||o===void 0)&&o.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(d=this.runtime)===null||d===void 0||d.resolveAnimationFrame()):this.startRendering()},p.prototype.draw=function(o,d){var w;this.frameRequestId=null;var C=performance.now();this.lastRenderTime||(this.lastRenderTime=o),this.renderSecondTimer+=o-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,d?.());var O=(o-this.lastRenderTime)/1e3;this.lastRenderTime=o;for(var W=this.animator.animations.filter(function(un){return un.playing||un.needsScrub}).sort(function(un){return un.needsScrub?-1:1}),de=0,me=W;de<me.length;de++){var ae=me[de];ae.advance(O),ae.instance.didLoop&&(ae.loopCount+=1),ae.apply(1)}for(var Se=this.animator.stateMachines.filter(function(un){return un.playing}),Be=0,at=Se;Be<at.length;Be++){var he=at[Be],nt=he.reportedEventCount();if(nt)for(var Qe=0;Qe<nt;Qe++){var lt=he.reportedEventAt(Qe);if(lt)if(lt.type===M.OpenUrl){if(this.eventManager.fire({type:J.RiveEvent,data:lt}),this.automaticallyHandleEvents){var rt=document.createElement("a"),Wt=lt,xn=Wt.url,Rn=Wt.target,ln=(0,g.sanitizeUrl)(xn);xn&&rt.setAttribute("href",ln),Rn&&rt.setAttribute("target",Rn),ln&&ln!==g.BLANK_URL&&rt.click()}}else this.eventManager.fire({type:J.RiveEvent,data:lt})}he.advanceAndApply(O)}this.animator.stateMachines.length==0&&this.artboard.advance(O);var ge=this.renderer;ge.clear(),ge.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(ge),ge.restore(),ge.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(O),this.frameCount++;var We=performance.now();for(this.frameTimes.push(We),this.durations.push(We-C);this.frameTimes[0]<=We-1e3;)this.frameTimes.shift(),this.durations.shift();(w=this._viewModelInstance)===null||w===void 0||w.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},p.prototype.alignRenderer=function(){var o=this,d=o.renderer,w=o.runtime,C=o._layout,O=o.artboard;d.align(C.runtimeFit(w),C.runtimeAlignment(w),{minX:C.minX,minY:C.minY,maxX:C.maxX,maxY:C.maxY},O.bounds,this._devicePixelRatioUsed*C.layoutScaleFactor)},Object.defineProperty(p.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(o,d){return o+d},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),p.prototype.cleanup=function(){var o,d;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&Oe.remove(this._observed),this.removeRiveListeners(),this.file&&((o=this.riveFile)===null||o===void 0||o.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(oe.remove(this._audioEventListener),this._audioEventListener=null),(d=this._viewModelInstance)===null||d===void 0||d.cleanup(),this._viewModelInstance=null,this._dataEnums=null},p.prototype.deleteRiveRenderer=function(){var o;(o=this.renderer)===null||o===void 0||o.delete(),this.renderer=null},p.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},p.prototype.retrieveTextRun=function(o){var d;if(!o){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var w=this.artboard.textRun(o);if(!w){console.warn("Could not access a text run with name '".concat(o,"' in the '").concat((d=this.artboard)===null||d===void 0?void 0:d.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return w},p.prototype.getTextRunValue=function(o){var d=this.retrieveTextRun(o);return d?d.text:void 0},p.prototype.setTextRunValue=function(o,d){var w=this.retrieveTextRun(o);w&&(w.text=d)},p.prototype.play=function(o,d){var w=this;if(o=ft(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.play(o,d)}});return}this.animator.play(o),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},p.prototype.pause=function(o){var d=this;if(o=ft(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.pause(o)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(o)},p.prototype.scrub=function(o,d){var w=this;if(o=ft(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.scrub(o,d)}});return}this.animator.scrub(o,d||0),this.drawFrame()},p.prototype.stop=function(o){var d=this;if(o=ft(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.stop(o)}});return}this.animator&&this.animator.stop(o),this.eventCleanup&&this.eventCleanup()},p.prototype.reset=function(o){var d,w,C=o?.artboard,O=ft(o?.animations),W=ft(o?.stateMachines),de=(d=o?.autoplay)!==null&&d!==void 0?d:!1,me=(w=o?.autoBind)!==null&&w!==void 0?w:!1;this.cleanupInstances(),this.initArtboard(C,O,W,de,me),this.taskQueue.process()},p.prototype.load=function(o){this.file=null,this.stop(),this.init(o)},Object.defineProperty(p.prototype,"layout",{get:function(){return this._layout},set:function(o){this._layout=o,(!o.maxX||!o.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),p.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},p.prototype.resizeDrawingSurfaceToCanvas=function(o){if(this.canvas instanceof HTMLCanvasElement&&window){var d=this.canvas.getBoundingClientRect(),w=d.width,C=d.height,O=o||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=O,this.canvas.width=O*w,this.canvas.height=O*C,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===D.Layout){var W=this._layout.layoutScaleFactor;this.artboard.width=w/W,this.artboard.height=C/W}}},Object.defineProperty(p.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var o=[],d=0;d<this.artboard.animationCount();d++)o.push(this.artboard.animationByIndex(d).name);return o},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var o=[],d=0;d<this.artboard.stateMachineCount();d++)o.push(this.artboard.stateMachineByIndex(d).name);return o},enumerable:!1,configurable:!0}),p.prototype.stateMachineInputs=function(o){if(this.loaded){var d=this.animator.stateMachines.find(function(w){return w.name===o});return d?.inputs}},p.prototype.retrieveInputAtPath=function(o,d){if(!o){console.warn("No input name provided for path '".concat(d,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(o,"', at path: '").concat(d,"', but the Artboard is null"));return}var w=this.artboard.inputByPath(o,d);if(!w){console.warn("Could not access an input with name: '".concat(o,"', at path:'").concat(d,"'"));return}return w},p.prototype.setBooleanStateAtPath=function(o,d,w){var C=this.retrieveInputAtPath(o,w);C&&(C.type===G.Boolean?C.asBool().value=d:console.warn("Input with name: '".concat(o,"', at path:'").concat(w,"' is not a boolean")))},p.prototype.setNumberStateAtPath=function(o,d,w){var C=this.retrieveInputAtPath(o,w);C&&(C.type===G.Number?C.asNumber().value=d:console.warn("Input with name: '".concat(o,"', at path:'").concat(w,"' is not a number")))},p.prototype.fireStateAtPath=function(o,d){var w=this.retrieveInputAtPath(o,d);w&&(w.type===G.Trigger?w.asTrigger().fire():console.warn("Input with name: '".concat(o,"', at path:'").concat(d,"' is not a trigger")))},p.prototype.retrieveTextAtPath=function(o,d){if(!o){console.warn("No text name provided for path '".concat(d,"'"));return}if(!d){console.warn("No path provided for text '".concat(o,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(o,"', at path: '").concat(d,"', but the Artboard is null"));return}var w=this.artboard.textByPath(o,d);if(!w){console.warn("Could not access text with name: '".concat(o,"', at path:'").concat(d,"'"));return}return w},p.prototype.getTextRunValueAtPath=function(o,d){var w=this.retrieveTextAtPath(o,d);if(!w){console.warn("Could not get text with name: '".concat(o,"', at path:'").concat(d,"'"));return}return w.text},p.prototype.setTextRunValueAtPath=function(o,d,w){var C=this.retrieveTextAtPath(o,w);if(!C){console.warn("Could not set text with name: '".concat(o,"', at path:'").concat(w,"'"));return}C.text=d},Object.defineProperty(p.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(o){return o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(o){return o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(o){return!o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(o){return!o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),p.prototype.on=function(o,d){this.eventManager.add({type:o,callback:d})},p.prototype.off=function(o,d){this.eventManager.remove({type:o,callback:d})},p.prototype.unsubscribe=function(o,d){console.warn("This function is deprecated: please use `off()` instead."),this.off(o,d)},p.prototype.removeAllRiveEventListeners=function(o){this.eventManager.removeAll(o)},p.prototype.unsubscribeAll=function(o){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(o)},p.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},p.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},p.prototype.enableFPSCounter=function(o){this.runtime.enableFPSCounter(o)},p.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(p.prototype,"contents",{get:function(){if(this.loaded){for(var o={artboards:[]},d=0;d<this.file.artboardCount();d++){for(var w=this.file.artboardByIndex(d),C={name:w.name,animations:[],stateMachines:[]},O=0;O<w.animationCount();O++){var W=w.animationByIndex(O);C.animations.push(W.name)}for(var de=0;de<w.stateMachineCount();de++){for(var me=w.stateMachineByIndex(de),ae=me.name,Se=new this.runtime.StateMachineInstance(me,w),Be=[],at=0;at<Se.inputCount();at++){var he=Se.input(at);Be.push({name:he.name,type:he.type})}C.stateMachines.push({name:ae,inputs:Be})}o.artboards.push(C)}return o}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(o){this._volume=o,this.artboard&&(this.artboard.volume=o*oe.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardWidth",{get:function(){var o;return this.artboard?this.artboard.width:(o=this._artboardWidth)!==null&&o!==void 0?o:0},set:function(o){this._artboardWidth=o,this.artboard&&(this.artboard.width=o)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardHeight",{get:function(){var o;return this.artboard?this.artboard.height:(o=this._artboardHeight)!==null&&o!==void 0?o:0},set:function(o){this._artboardHeight=o,this.artboard&&(this.artboard.height=o)},enumerable:!1,configurable:!0}),p.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(p.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(o){this._devicePixelRatioUsed=o},enumerable:!1,configurable:!0}),p.prototype.bindViewModelInstance=function(o){var d;this.artboard&&!this.destroyed&&o&&o.runtimeInstance&&(o.internalIncrementReferenceCount(),(d=this._viewModelInstance)===null||d===void 0||d.cleanup(),this._viewModelInstance=o,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(w){return w.bindViewModelInstance(o)}):this.artboard.bindViewModelInstance(o.runtimeInstance))},Object.defineProperty(p.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),p.prototype.viewModelByIndex=function(o){var d=this.file.viewModelByIndex(o);return d!==null?new Pe(d):null},p.prototype.viewModelByName=function(o){var d=this.file.viewModelByName(o);return d!==null?new Pe(d):null},p.prototype.enums=function(){if(this._dataEnums===null){var o=this.file.enums();this._dataEnums=o.map(function(d){return new be(d)})}return this._dataEnums},p.prototype.defaultViewModel=function(){if(this.artboard){var o=this.file.defaultArtboardViewModel(this.artboard);if(o)return new Pe(o)}return null},p.prototype.getArtboard=function(o){var d,w;return(w=(d=this.riveFile)===null||d===void 0?void 0:d.getArtboard(o))!==null&&w!==void 0?w:null},p.missingErrorMessage="Rive source file or data buffer required",p.cleanupErrorMessage="Attempt to use file after calling cleanup.",p})(),Pe=(function(){function p(o){this._viewModel=o}return Object.defineProperty(p.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),p.prototype.instanceByIndex=function(o){var d=this._viewModel.instanceByIndex(o);return d!==null?new pe(d,null):null},p.prototype.instanceByName=function(o){var d=this._viewModel.instanceByName(o);return d!==null?new pe(d,null):null},p.prototype.defaultInstance=function(){var o=this._viewModel.defaultInstance();return o!==null?new pe(o,null):null},p.prototype.instance=function(){var o=this._viewModel.instance();return o!==null?new pe(o,null):null},Object.defineProperty(p.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),p})(),be=(function(){function p(o){this._dataEnum=o}return Object.defineProperty(p.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),p})(),ue;(function(p){p.Number="number",p.String="string",p.Boolean="boolean",p.Color="color",p.Trigger="trigger",p.Enum="enum",p.List="list",p.Image="image",p.Artboard="artboard"})(ue||(ue={}));var pe=(function(){function p(o,d){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=o,d!==null&&this._parents.push(d)}return Object.defineProperty(p.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),p.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(o){o.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(o){o.clearChanges()})),this._children.forEach(function(o){return o.handleCallbacks()})},p.prototype.addParent=function(o){this._parents.includes(o)||(this._parents.push(o),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&o.addToViewModelCallbacks(this))},p.prototype.removeParent=function(o){var d=this._parents.indexOf(o);if(d!==-1){var w=this._parents[d];w.removeFromViewModelCallbacks(this),this._parents.splice(d,1)}},p.prototype.addToPropertyCallbacks=function(o){var d=this;this._propertiesWithCallbacks.includes(o)||(this._propertiesWithCallbacks.push(o),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(w){w.addToViewModelCallbacks(d)}))},p.prototype.removeFromPropertyCallbacks=function(o){var d=this;this._propertiesWithCallbacks.includes(o)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(w){return w!==o}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(d)}))},p.prototype.addToViewModelCallbacks=function(o){var d=this;this._children.includes(o)||(this._children.push(o),this._parents.forEach(function(w){w.addToViewModelCallbacks(d)}))},p.prototype.removeFromViewModelCallbacks=function(o){var d=this;this._children.includes(o)&&(this._children=this._children.filter(function(w){return w!==o}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(d)}))},p.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(o){o.clearCallbacks()})},p.prototype.propertyFromPath=function(o,d){var w=o.split("/");return this.propertyFromPathSegments(w,0,d)},p.prototype.viewModelFromPathSegments=function(o,d){var w=this.internalViewModelInstance(o[d]);return w!==null?d==o.length-1?w:w.viewModelFromPathSegments(o,d++):null},p.prototype.propertyFromPathSegments=function(o,d,w){var C,O,W,de,me,ae,Se,Be,at,he,nt,Qe,lt,rt,Wt,xn,Rn,ln;if(d<o.length-1){var ge=this.internalViewModelInstance(o[d]);return ge!==null?ge.propertyFromPathSegments(o,d+1,w):null}var We=null;switch(w){case ue.Number:if(We=(O=(C=this._runtimeInstance)===null||C===void 0?void 0:C.number(o[d]))!==null&&O!==void 0?O:null,We!==null)return new yt(We,this);break;case ue.String:if(We=(de=(W=this._runtimeInstance)===null||W===void 0?void 0:W.string(o[d]))!==null&&de!==void 0?de:null,We!==null)return new Ye(We,this);break;case ue.Boolean:if(We=(ae=(me=this._runtimeInstance)===null||me===void 0?void 0:me.boolean(o[d]))!==null&&ae!==void 0?ae:null,We!==null)return new kt(We,this);break;case ue.Color:if(We=(Be=(Se=this._runtimeInstance)===null||Se===void 0?void 0:Se.color(o[d]))!==null&&Be!==void 0?Be:null,We!==null)return new jt(We,this);break;case ue.Trigger:if(We=(he=(at=this._runtimeInstance)===null||at===void 0?void 0:at.trigger(o[d]))!==null&&he!==void 0?he:null,We!==null)return new Nt(We,this);break;case ue.Enum:if(We=(Qe=(nt=this._runtimeInstance)===null||nt===void 0?void 0:nt.enum(o[d]))!==null&&Qe!==void 0?Qe:null,We!==null)return new ht(We,this);break;case ue.List:if(We=(rt=(lt=this._runtimeInstance)===null||lt===void 0?void 0:lt.list(o[d]))!==null&&rt!==void 0?rt:null,We!==null)return new St(We,this);break;case ue.Image:if(We=(xn=(Wt=this._runtimeInstance)===null||Wt===void 0?void 0:Wt.image(o[d]))!==null&&xn!==void 0?xn:null,We!==null)return new ot(We,this);break;case ue.Artboard:if(We=(ln=(Rn=this._runtimeInstance)===null||Rn===void 0?void 0:Rn.artboard(o[d]))!==null&&ln!==void 0?ln:null,We!==null)return new tt(We,this);break}return null},p.prototype.internalViewModelInstance=function(o){var d;if(this._viewModelInstances.has(o))return this._viewModelInstances.get(o);var w=(d=this._runtimeInstance)===null||d===void 0?void 0:d.viewModel(o);if(w!==null){var C=new p(w,this);return C.internalIncrementReferenceCount(),this._viewModelInstances.set(o,C),C}return null},p.prototype.number=function(o){var d=this.propertyFromPath(o,ue.Number);return d},p.prototype.string=function(o){var d=this.propertyFromPath(o,ue.String);return d},p.prototype.boolean=function(o){var d=this.propertyFromPath(o,ue.Boolean);return d},p.prototype.color=function(o){var d=this.propertyFromPath(o,ue.Color);return d},p.prototype.trigger=function(o){var d=this.propertyFromPath(o,ue.Trigger);return d},p.prototype.enum=function(o){var d=this.propertyFromPath(o,ue.Enum);return d},p.prototype.list=function(o){var d=this.propertyFromPath(o,ue.List);return d},p.prototype.image=function(o){var d=this.propertyFromPath(o,ue.Image);return d},p.prototype.artboard=function(o){var d=this.propertyFromPath(o,ue.Artboard);return d},p.prototype.viewModel=function(o){var d=o.split("/"),w=d.length>1?this.viewModelFromPathSegments(d.slice(0,d.length-1),0):this;return w!=null?w.internalViewModelInstance(d[d.length-1]):null},p.prototype.internalReplaceViewModel=function(o,d){var w;if(d.runtimeInstance!==null){var C=((w=this._runtimeInstance)===null||w===void 0?void 0:w.replaceViewModel(o,d.runtimeInstance))||!1;if(C){d.internalIncrementReferenceCount();var O=this.internalViewModelInstance(o);O!==null&&(O.removeParent(this),this._children.includes(O)&&(this._children=this._children.filter(function(W){return W!==O})),O.cleanup()),this._viewModelInstances.set(o,d),d.addParent(this)}return C}return!1},p.prototype.replaceViewModel=function(o,d){var w,C=o.split("/"),O=C.length>1?this.viewModelFromPathSegments(C.slice(0,C.length-1),0):this;return(w=O?.internalReplaceViewModel(C[C.length-1],d))!==null&&w!==void 0?w:!1},p.prototype.incrementReferenceCount=function(){var o;this._referenceCount++,(o=this._runtimeInstance)===null||o===void 0||o.incrementReferenceCount()},p.prototype.decrementReferenceCount=function(){var o;this._referenceCount--,(o=this._runtimeInstance)===null||o===void 0||o.decrementReferenceCount()},Object.defineProperty(p.prototype,"properties",{get:function(){var o;return((o=this._runtimeInstance)===null||o===void 0?void 0:o.getProperties().map(function(d){return E({},d)}))||[]},enumerable:!1,configurable:!0}),p.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},p.prototype.cleanup=function(){var o=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(C){C.cleanup()}),this._viewModelInstances.clear();var d=S([],this._children,!0);this._children.length=0;var w=S([],this._parents,!0);this._parents.length=0,d.forEach(function(C){C.removeParent(o)}),w.forEach(function(C){C.removeFromViewModelCallbacks(o)})}},p})(),je=(function(){function p(o,d){this.callbacks=[],this._viewModelInstanceValue=o,this._parentViewModel=d}return p.prototype.on=function(o){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(o)||(this.callbacks.push(o),this._parentViewModel.addToPropertyCallbacks(this))},p.prototype.off=function(o){o?this.callbacks=this.callbacks.filter(function(d){return d!==o}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},p.prototype.internalHandleCallback=function(o){},p.prototype.handleCallbacks=function(){var o=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(d){o.internalHandleCallback(d)})},p.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},p.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),p})(),Ye=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(je),yt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(je),kt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(je),Nt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return o.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},o.prototype.internalHandleCallback=function(d){d()},o})(je),ht=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(d){this._viewModelInstanceValue.valueIndex=d},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(je),St=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),o.prototype.addInstance=function(d){d.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(d.runtimeInstance),d.addParent(this._parentViewModel))},o.prototype.addInstanceAt=function(d,w){return d.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(d.runtimeInstance,w)?(d.addParent(this._parentViewModel),!0):!1},o.prototype.removeInstance=function(d){d.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(d.runtimeInstance),d.removeParent(this._parentViewModel))},o.prototype.removeInstanceAt=function(d){this._viewModelInstanceValue.removeInstanceAt(d)},o.prototype.instanceAt=function(d){var w=this._viewModelInstanceValue.instanceAt(d);if(w!=null){var C=new pe(w,this._parentViewModel);return C}return null},o.prototype.swap=function(d,w){this._viewModelInstanceValue.swap(d,w)},o.prototype.internalHandleCallback=function(d){d()},o})(je),jt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.rgb=function(d,w,C){this._viewModelInstanceValue.rgb(d,w,C)},o.prototype.rgba=function(d,w,C,O){this._viewModelInstanceValue.argb(O,d,w,C)},o.prototype.argb=function(d,w,C,O){this._viewModelInstanceValue.argb(d,w,C,O)},o.prototype.alpha=function(d){this._viewModelInstanceValue.alpha(d)},o.prototype.opacity=function(d){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,d))*255))},o.prototype.internalHandleCallback=function(d){d(this.value)},o})(je),ot=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{set:function(d){var w;this._viewModelInstanceValue.value((w=d?.nativeImage)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d()},o})(je),tt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{set:function(d){var w;this._viewModelInstanceValue.value((w=d?.nativeArtboard)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d()},o})(je),on=function(p){return A(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Request(p),[4,fetch(o)];case 1:return d=C.sent(),[4,d.arrayBuffer()];case 2:return w=C.sent(),[2,w]}})})},ft=function(p){return typeof p=="string"?[p]:p instanceof Array?p:[]},vt={EventManager:ve,TaskQueueManager:qe},Bt=function(p){return A(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Promise(function(O){return H.getInstance(function(W){W.decodeAudio(p,O)})}),[4,o];case 1:return d=C.sent(),w=new g.AudioWrapper(d),g.finalizationRegistry.register(w,d),[2,w]}})})},qn=function(p){return A(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Promise(function(O){return H.getInstance(function(W){W.decodeImage(p,O)})}),[4,o];case 1:return d=C.sent(),w=new g.ImageWrapper(d),g.finalizationRegistry.register(w,d),[2,w]}})})},Mt=function(p){return A(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Promise(function(O){return H.getInstance(function(W){W.decodeFont(p,O)})}),[4,o];case 1:return d=C.sent(),w=new g.FontWrapper(d),g.finalizationRegistry.register(w,d),[2,w]}})})}})(),l})())})(Zi)),Zi.exports}var uv=lv();const ds="dracula",cv="dracula_story_v3.json",hs="https://vycjpmuyscfygstjjied.supabase.co";var dv=ce('<div class="rive-wrapper svelte-nkuq4r"><canvas width="250" height="500" class="svelte-nkuq4r"></canvas></div>');function wl(n,e){sn(e,!0);let t=xt(void 0);ja(()=>{if(!$(t))return;const l=new uv.Rive({src:`${hs}/storage/v1/object/public/${ds}/${e.fileName}`,canvas:$(t),autoplay:!0,stateMachines:"SM1"});return()=>{l.cleanup()}});var r=dv(),s=F(r);hd(s,l=>Tt(t,l),()=>$(t)),ne(n,r),an()}function hv(n,e){$(e)?.nextDialogueId&&Rt.goToDialogue($(e).nextDialogueId)}var fv=ce('<img alt="BG" class="background-image svelte-ik8jti"/>'),vv=ce('<div class="background-media svelte-ik8jti"><!></div>'),pv=ce('<img alt="Char" class="character-image svelte-ik8jti"/>'),gv=ce('<div class="character-media svelte-ik8jti"><!></div>'),_v=(n,e,t)=>e($(t)),mv=ce('<button class="option-button svelte-ik8jti"> </button>'),yv=ce('<div class="options-container svelte-ik8jti"></div>'),wv=ce('<div class="next-container svelte-ik8jti"><button class="next-button svelte-ik8jti">ÐÐ°Ð»ÐµÐµ...</button></div>'),bv=ce('<div class="dialogue-container svelte-ik8jti"><!> <!> <div class="dialogue-content svelte-ik8jti"><div class="dialogue-text svelte-ik8jti"> </div> <!></div></div>'),Ev=ce("<p> </p>");function ku(n,e){sn(e,!0);const t=xc(()=>e.dialogue||Rt.findDialogue(Rt.currentDialogueId));ss(()=>{$(t)?.onEnter&&Rt.runActions($(t).onEnter)});function r(g){if(g.actions&&Rt.runActions(g.actions),g.miniGame){console.log("ÐÐ°Ð¿ÑÑÐº Ð¼Ð¸Ð½Ð¸-Ð¸Ð³ÑÑ:",g.miniGame.id),Rt.goToDialogue(g.miniGame.onWinDialogueId);return}g.nextDialogueId&&Rt.goToDialogue(g.nextDialogueId)}function s(g){return g.visibleIf&&g.visibleIf.hasItem?Rt.hasItem(g.visibleIf.hasItem):!0}var l=Sn(),c=Gt(l);{var h=g=>{var m=bv(),E=F(m);{var A=G=>{var R=vv(),M=F(R);{var ie=le=>{var J=Sn(),ee=Gt(J);Wo(ee,()=>$(t).backgroundImage,ve=>{wl(ve,{get fileName(){return $(t).backgroundImage}})}),ne(le,J)},Y=le=>{var J=fv();xe(()=>Lr(J,"src",`${hs}/storage/v1/object/public/${ds}/${$(t).backgroundImage}`)),ne(le,J)};Ge(M,le=>{$(t).backgroundImage.endsWith(".riv")?le(ie):le(Y,!1)})}ne(G,R)};Ge(E,G=>{$(t).backgroundImage&&G(A)})}var _=B(E,2);{var S=G=>{var R=gv(),M=F(R);{var ie=le=>{var J=Sn(),ee=Gt(J);Wo(ee,()=>$(t).characterImage,ve=>{wl(ve,{get fileName(){return $(t).characterImage}})}),ne(le,J)},Y=le=>{var J=pv();xe(()=>Lr(J,"src",`${hs}/storage/v1/object/public/${ds}/${$(t).characterImage}`)),ne(le,J)};Ge(M,le=>{$(t).characterImage.endsWith(".riv")?le(ie):le(Y,!1)})}ne(G,R)};Ge(_,G=>{$(t).characterImage&&G(S)})}var L=B(_,2),x=F(L),D=F(x),N=B(x,2);{var U=G=>{var R=yv();Et(R,21,()=>$(t).options,M=>M.text,(M,ie)=>{var Y=Sn(),le=Gt(Y);{var J=ee=>{var ve=mv();ve.__click=[_v,r,ie];var qe=F(ve);xe(()=>He(qe,$(ie).text)),ne(ee,ve)};Ge(le,ee=>{s($(ie))&&ee(J)})}ne(M,Y)}),ne(G,R)},H=G=>{var R=Sn(),M=Gt(R);{var ie=Y=>{var le=wv(),J=F(le);J.__click=[hv,t],ne(Y,le)};Ge(M,Y=>{$(t).nextDialogueId&&Y(ie)},!0)}ne(G,R)};Ge(N,G=>{$(t).options&&$(t).options.length>0?G(U):G(H,!1)})}xe(()=>He(D,$(t).text)),ne(g,m)},v=g=>{var m=Ev(),E=F(m);xe(()=>He(E,`ÐÐ¸Ð°Ð»Ð¾Ð³ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ (ID: ${Rt.currentDialogueId??""})`)),ne(g,m)};Ge(c,g=>{$(t)?g(h):g(v,!1)})}ne(n,l),an()}vr(["click"]);var $t=bi(()=>fe),Av=ce('<div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Ð¤Ð¾Ð½:</span> <span class="info-value svelte-1u0yr0g"> </span></div>'),kv=ce('<div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">ÐÐµÑÑÐ¾Ð½Ð°Ð¶:</span> <span class="info-value svelte-1u0yr0g"> </span></div>'),Sv=ce('<div class="preview-warning svelte-1u0yr0g">â ï¸ ÐÐµÑ Ð²Ð°ÑÐ¸Ð°Ð½ÑÐ¾Ð² Ð¾ÑÐ²ÐµÑÐ¾Ð²</div>'),Iv=ce('<div class="preview-warning svelte-1u0yr0g">â ï¸ ÐÐµÐºÐ¾ÑÐ¾ÑÑÐµ Ð²Ð°ÑÐ¸Ð°Ð½ÑÑ Ð½Ðµ Ð²ÐµÐ´ÑÑ Ð´Ð°Ð»ÑÑÐµ</div>'),Cv=ce('<div class="preview-container svelte-1u0yr0g"><!> <div class="preview-info svelte-1u0yr0g"><div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">ID:</span> <span class="info-value svelte-1u0yr0g"> </span></div> <div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">ÐÐ»Ð°Ð²Ð°:</span> <span class="info-value svelte-1u0yr0g"> </span></div> <!> <!></div> <!> <!></div>'),Tv=ce('<div class="empty-preview svelte-1u0yr0g"><div class="empty-icon svelte-1u0yr0g">ð</div> <div class="empty-text svelte-1u0yr0g">ÐÑÐ±ÐµÑÐ¸ÑÐµ ÑÑÐµÐ½Ñ Ð´Ð»Ñ Ð¿ÑÐµÐ´Ð¿ÑÐ¾ÑÐ¼Ð¾ÑÑÐ°</div></div>'),Pv=ce('<aside class="preview-panel svelte-1u0yr0g"><div class="preview-header svelte-1u0yr0g"><h3 class="svelte-1u0yr0g">ÐÑÐµÐ´Ð¿ÑÐ¾ÑÐ¼Ð¾ÑÑ</h3> <button class="btn-link small svelte-1u0yr0g">Ð¡Ð±ÑÐ¾ÑÐ¸ÑÑ ÑÐµÐ´Ð°ÐºÑ. Ð¾Ð¿ÑÐ¸Ð¹</button></div> <div class="preview-wrapper svelte-1u0yr0g"><!></div></aside>');function xv(n,e){sn(e,!1);function t(){$t($t().editingOptionIndex=null)}pr();var r=Pv(),s=F(r),l=B(F(s),2);l.__click=t;var c=B(s,2),h=F(c);{var v=m=>{var E=Cv(),A=F(E);ku(A,{get dialogue(){return $t().currentDialogue},index:0});var _=B(A,2),S=F(_),L=B(F(S),2),x=F(L),D=B(S,2),N=B(F(D),2),U=F(N),H=B(D,2);{var G=ee=>{var ve=Av(),qe=B(F(ve),2),se=F(qe);xe(()=>He(se,$t().currentDialogue.backgroundImage)),ne(ee,ve)};Ge(H,ee=>{$t().currentDialogue.backgroundImage&&ee(G)})}var R=B(H,2);{var M=ee=>{var ve=kv(),qe=B(F(ve),2),se=F(qe);xe(()=>He(se,$t().currentDialogue.characterImage)),ne(ee,ve)};Ge(R,ee=>{$t().currentDialogue.characterImage&&ee(M)})}var ie=B(_,2);{var Y=ee=>{var ve=Sv();ne(ee,ve)};Ge(ie,ee=>{(!$t().currentDialogue.options||$t().currentDialogue.options.length===0)&&ee(Y)})}var le=B(ie,2);{var J=ee=>{var ve=Iv();ne(ee,ve)};Ge(le,ee=>{$t().currentDialogue.options?.some(ve=>!ve.nextDialogueId)&&ee(J)})}xe(()=>{He(x,$t().currentDialogue.id),He(U,$t().currentChapter?.title||"ÐÐµÐ· Ð³Ð»Ð°Ð²Ñ")}),ne(m,E)},g=m=>{var E=Tv();ne(m,E)};Ge(h,m=>{$t().currentDialogue?m(v):m(g,!1)})}ne(n,r),an()}vr(["click"]);var Ln=bi(()=>fe),Rv=n=>In.loadStory(n.target.value),Ov=ce("<option> </option>"),jv=ce('<div class="empty-state svelte-pdwxuy">ÐÑÐ±ÐµÑÐ¸ÑÐµ ÑÑÐµÐ½Ñ</div>'),Mv=ce('<div class="editor-container svelte-pdwxuy"><header class="toolbar svelte-pdwxuy"><div class="logo svelte-pdwxuy"><h2 class="svelte-pdwxuy">Story Editor v3.1</h2></div> <div class="stories-control svelte-pdwxuy"><select class="story-select svelte-pdwxuy"></select> <button class="btn primary small svelte-pdwxuy">+ ÐÐ¾Ð²Ð°Ñ</button> <button class="btn success small svelte-pdwxuy">ð¾ Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ</button> <button class="btn small svelte-pdwxuy">ð ÐÐ¾Ð¿Ð¸Ñ</button></div></header> <div class="main-workspace svelte-pdwxuy"><!> <main class="editor-area svelte-pdwxuy"><!> <!></main> <!></div></div>');function Lv(n,e){sn(e,!1),ja(async()=>{await vi.loadStoriesList(),await In.loadStory(Ln().currentFileName),await vi.loadStoredResources()}),pr();var t=Mv(),r=F(t),s=B(F(r),2),l=F(s);xe(()=>{Ln(),tn(()=>{})}),l.__change=[Rv],Et(l,5,()=>Ln().storiesList,zt,(D,N)=>{var U=Ov(),H=F(U),G={};xe(()=>{He(H,$(N)),G!==(G=$(N))&&(U.value=(U.__value=$(N))??"")}),ne(D,U)});var c=B(l,2);c.__click=function(...D){In.createNewStory?.apply(this,D)};var h=B(c,2);h.__click=function(...D){In.saveCurrentStory?.apply(this,D)};var v=B(h,2);v.__click=function(...D){In.saveStoryCopy?.apply(this,D)};var g=B(r,2),m=F(g);xf(m,{});var E=B(m,2),A=F(E);sv(A,{});var _=B(A,2);{var S=D=>{Gf(D,{get editor(){return Ln()},get storyActions(){return In},get resourceActions(){return vi}})},L=D=>{var N=jv();ne(D,N)};Ge(_,D=>{Ln().currentDialogue?D(S):D(L,!1)})}var x=B(E,2);xv(x,{}),Ur(l,()=>Ln().currentFileName,D=>Ln(Ln().currentFileName=D)),ne(n,t),an()}vr(["change","click"]);var Dv=ce('<div class="loading svelte-fgmugb"><p>ð ÐÐ°Ð³ÑÑÐ·ÐºÐ° Ð¸ÑÑÐ¾ÑÐ¸Ð¸...</p></div>'),$v=ce('<div class="error svelte-fgmugb"> </div>'),Fv=ce('<div class="dialogues-container svelte-fgmugb"><!></div>'),Uv=ce('<div class="app svelte-fgmugb"><!></div>');function Nv(n,e){sn(e,!1);let t=`${hs}/storage/v1/object/public/${ds}/${cv}`;ja(async()=>{console.log("ÐÐ°Ð³ÑÑÐ¶Ð°ÐµÐ¼ Ð¸ÑÑÐ¾ÑÐ¸Ñ Ð¸Ð·:",t),await Rt.loadStory(t)}),pr();var r=Uv(),s=F(r);{var l=h=>{var v=Dv();ne(h,v)},c=h=>{var v=Sn(),g=Gt(v);{var m=A=>{var _=$v(),S=F(_);xe(()=>He(S,`â ï¸ ${Rt.error??""}`)),ne(A,_)},E=A=>{var _=Fv(),S=F(_);{var L=x=>{ku(x,{})};Ge(S,x=>{Rt.storyData&&x(L)})}ne(A,_)};Ge(g,A=>{Rt.error?A(m):A(E,!1)},!0)}ne(h,v)};Ge(s,h=>{Rt.isLoading?h(l):h(c,!1)})}ne(n,r),an()}var Bv=ce('<button style="position:fixed; top:10px; right:500px; z-index:9999;">ÐÐ°ÐºÑÑÑÑ ÑÐµÐ´Ð°ÐºÑÐ¾Ñ</button> <!>',1),Wv=ce('<button style="position:fixed; bottom:10px; right:10px; z-index:9999;">Ð ÐµÐ´Ð°ÐºÑÐ¾Ñ</button> <!>',1);function Vv(n,e){sn(e,!1),pr();var t=Sn(),r=Gt(t);{var s=c=>{var h=Bv(),v=Gt(h),g=B(v,2);Lv(g,{}),tr("click",v,function(...m){Pt.toggleEditor?.apply(this,m)}),ne(c,h)},l=c=>{var h=Wv(),v=Gt(h),g=B(v,2);Nv(g,{}),tr("click",v,function(...m){Pt.toggleEditor?.apply(this,m)}),ne(c,h)};Ge(r,c=>{fe.showEditor?c(s):c(l,!1)})}ne(n,t),an()}rd(Vv,{target:document.getElementById("app")});
