(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();const kl=!1;var fs=Array.isArray,Zu=Array.prototype.indexOf,ma=Array.from,ea=Object.defineProperty,ci=Object.getOwnPropertyDescriptor,El=Object.getOwnPropertyDescriptors,ec=Object.prototype,tc=Array.prototype,ya=Object.getPrototypeOf,Ro=Object.isExtensible;function rc(r){return r()}function ts(r){for(var e=0;e<r.length;e++)r[e]()}function nc(){var r,e,t=new Promise((n,s)=>{r=n,e=s});return{promise:t,resolve:r,reject:e}}const Bt=2,wa=4,vs=8,Hn=16,Pr=32,hn=64,Al=128,Kt=256,rs=512,It=1024,Yt=2048,qr=4096,sr=8192,fn=16384,ba=32768,ka=65536,Oo=1<<17,ic=1<<18,wi=1<<19,Sl=1<<20,ta=1<<21,Ea=1<<22,un=1<<23,Ur=Symbol("$state"),sc=Symbol(""),Aa=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ac(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function oc(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function lc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function uc(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function cc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function dc(r){throw new Error("https://svelte.dev/e/effect_orphan")}function hc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function fc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function vc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function pc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const ps=1,gs=2,Il=4,gc=8,_c=16,mc=1,yc=2,wt=Symbol(),wc="http://www.w3.org/1999/xhtml";function bc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let kc=!1;function Cl(r){return r===this.v}function Tl(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function Ec(r,e){return r!==e}function Pl(r){return!Tl(r,this.v)}let bi=!1,Ac=!1;function Sc(){bi=!0}let ct=null;function ns(r){ct=r}function Jt(r,e=!1,t){ct={p:ct,c:null,e:null,s:r,x:null,l:bi&&!e?{s:null,u:null,$:[]}:null}}function Xt(r){var e=ct,t=e.e;if(t!==null){e.e=null;for(var n of t)ql(n)}return ct=e.p,{}}function zn(){return!bi||ct!==null&&ct.l===null}const Ic=new WeakMap;function Cc(r){var e=Ne;if(e===null)return He.f|=un,r;if((e.f&ba)===0){if((e.f&Al)===0)throw!e.parent&&r instanceof Error&&xl(r),r;e.b.error(r)}else Sa(r,e)}function Sa(r,e){for(;e!==null;){if((e.f&Al)!==0)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r instanceof Error&&xl(r),r}function xl(r){const e=Ic.get(r);e&&(ea(r,"message",{value:e.message}),ea(r,"stack",{value:e.stack}))}let gi=[],ra=[];function Rl(){var r=gi;gi=[],ts(r)}function Tc(){var r=ra;ra=[],ts(r)}function Ia(r){gi.length===0&&queueMicrotask(Rl),gi.push(r)}function Pc(){gi.length>0&&Rl(),ra.length>0&&Tc()}function xc(){for(var r=Ne.b;r!==null&&!r.has_pending_snippet();)r=r.parent;return r===null&&ac(),r}function ki(r){var e=Bt|Yt,t=He!==null&&(He.f&Bt)!==0?He:null;return Ne===null||t!==null&&(t.f&Kt)!==0?e|=Kt:Ne.f|=wi,{ctx:ct,deps:null,effects:null,equals:Cl,f:e,fn:r,reactions:null,rv:0,v:wt,wv:0,parent:t??Ne,ac:null}}function Rc(r,e){let t=Ne;t===null&&lc();var n=t.b,s=void 0,l=Nn(wt),c=null,h=!He;return zc(()=>{try{var v=r();c&&Promise.resolve(v).catch(()=>{})}catch(_){v=Promise.reject(_)}var g=()=>v;s=c?.then(g,g)??Promise.resolve(v),c=s;var m=et,k=n.pending;h&&(n.update_pending_count(1),k||m.increment());const E=(_,S=void 0)=>{c=null,k||m.activate(),S?S!==Aa&&(l.f|=un,Wn(l,S)):((l.f&un)!==0&&(l.f^=un),Wn(l,_)),h&&(n.update_pending_count(-1),k||m.decrement()),Ll()};if(s.then(E,_=>E(null,_||"unknown")),m)return()=>{queueMicrotask(()=>m.neuter())}}),new Promise(v=>{function g(m){function k(){m===s?v(l):g(s)}m.then(k,k)}g(s)})}function Oc(r){const e=ki(r);return Xl(e),e}function Ol(r){const e=ki(r);return e.equals=Pl,e}function jl(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)Tr(e[t])}}function jc(r){for(var e=r.parent;e!==null;){if((e.f&Bt)===0)return e;e=e.parent}return null}function Ca(r){var e,t=Ne;Wr(jc(r));try{jl(r),e=tu(r)}finally{Wr(t)}return e}function Ml(r){var e=Ca(r);if(r.equals(e)||(r.v=e,r.wv=Zl()),!pn){var t=(Fr||(r.f&Kt)!==0)&&r.deps!==null?qr:It;Mt(r,t)}}function Mc(r,e,t){const n=zn()?ki:Ol;if(e.length===0){t(r.map(n));return}var s=et,l=Ne,c=Lc(),h=xc();Promise.all(e.map(v=>Rc(v))).then(v=>{s?.activate(),c();try{t([...r.map(n),...v])}catch(g){(l.f&fn)===0&&Sa(g,l)}s?.deactivate(),Ll()}).catch(v=>{h.error(v)})}function Lc(){var r=Ne,e=He,t=ct,n=et;return function(){Wr(r),_r(e),ns(t),n?.activate()}}function Ll(){Wr(null),_r(null),ns(null)}const Bs=new Set;let et=null,Qi=null,jo=new Set,is=[];function Dl(){const r=is.shift();is.length>0&&queueMicrotask(Dl),r()}let dn=[],_s=null,na=!1,Zi=!1;class Un{current=new Map;#r=new Map;#t=new Set;#e=0;#n=null;#i=!1;#a=[];#l=[];#o=[];#s=[];#u=[];#d=[];#h=[];skipped_effects=new Set;process(e){dn=[],Qi=null;for(const s of e)this.#v(s);if(this.#a.length===0&&this.#e===0){this.#f();var t=this.#o,n=this.#s;this.#o=[],this.#s=[],this.#u=[],Qi=et,et=null,Mo(t),Mo(n),et===null?et=this:Bs.delete(this),this.#n?.resolve()}else this.#c(this.#o),this.#c(this.#s),this.#c(this.#u);for(const s of this.#a)Fn(s);for(const s of this.#l)Fn(s);this.#a=[],this.#l=[]}#v(e){e.f^=It;for(var t=e.first;t!==null;){var n=t.f,s=(n&(Pr|hn))!==0,l=s&&(n&It)!==0,c=l||(n&sr)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(s)t.f^=It;else if((n&wa)!==0)this.#s.push(t);else if((n&It)===0)if((n&Ea)!==0){var h=t.b?.pending?this.#l:this.#a;h.push(t)}else bs(t)&&((t.f&Hn)!==0&&this.#u.push(t),Fn(t));var v=t.first;if(v!==null){t=v;continue}}var g=t.parent;for(t=t.next;t===null&&g!==null;)t=g.next,g=g.parent}}#c(e){for(const t of e)((t.f&Yt)!==0?this.#d:this.#h).push(t),Mt(t,It);e.length=0}capture(e,t){this.#r.has(e)||this.#r.set(e,t),this.current.set(e,e.v)}activate(){et=this}deactivate(){et=null,Qi=null;for(const e of jo)if(jo.delete(e),e(),et!==null)break}neuter(){this.#i=!0}flush(){dn.length>0?$l():this.#f(),et===this&&(this.#e===0&&Bs.delete(this),this.deactivate())}#f(){if(!this.#i)for(const e of this.#t)e();this.#t.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#d)Mt(e,Yt),Bn(e);for(const e of this.#h)Mt(e,qr),Bn(e);this.#o=[],this.#s=[],this.flush()}else this.deactivate()}add_callback(e){this.#t.add(e)}settled(){return(this.#n??=nc()).promise}static ensure(){if(et===null){const e=et=new Un;Bs.add(et),Zi||Un.enqueue(()=>{et===e&&e.flush()})}return et}static enqueue(e){is.length===0&&queueMicrotask(Dl),is.unshift(e)}}function Dc(r){var e=Zi;Zi=!0;try{for(var t;;){if(Pc(),dn.length===0&&(et?.flush(),dn.length===0))return _s=null,t;$l()}}finally{Zi=e}}function $l(){var r=$n;na=!0;try{var e=0;for(Fo(!0);dn.length>0;){var t=Un.ensure();if(e++>1e3){var n,s;$c()}t.process(dn),Br.clear()}}finally{na=!1,Fo(r),_s=null}}function $c(){try{hc()}catch(r){Sa(r,_s)}}let nn=null;function Mo(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var n=r[t++];if((n.f&(fn|sr))===0&&bs(n)&&(nn=[],Fn(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?Kl(n):n.fn=null),nn?.length>0)){Br.clear();for(const s of nn)Fn(s);nn=[]}}nn=null}}function Bn(r){for(var e=_s=r;e.parent!==null;){e=e.parent;var t=e.f;if(na&&e===Ne&&(t&Hn)!==0)return;if((t&(hn|Pr))!==0){if((t&It)===0)return;e.f^=It}}dn.push(e)}const Br=new Map;function Nn(r,e){var t={f:0,v:r,reactions:null,equals:Cl,rv:0,wv:0};return t}function Ot(r,e){const t=Nn(r);return Xl(t),t}function Fc(r,e=!1,t=!0){const n=Nn(r);return e||(n.equals=Pl),bi&&t&&ct!==null&&ct.l!==null&&(ct.l.s??=[]).push(n),n}function Rt(r,e,t=!1){He!==null&&(!pr||(He.f&Oo)!==0)&&zn()&&(He.f&(Bt|Hn|Ea|Oo))!==0&&!Cr?.includes(r)&&pc();let n=t?an(e):e;return Wn(r,n)}function Wn(r,e){if(!r.equals(e)){var t=r.v;pn?Br.set(r,e):Br.set(r,t),r.v=e;var n=Un.ensure();n.capture(r,t),(r.f&Bt)!==0&&((r.f&Yt)!==0&&Ca(r),Mt(r,(r.f&Kt)===0?It:qr)),r.wv=Zl(),Fl(r,Yt),zn()&&Ne!==null&&(Ne.f&It)!==0&&(Ne.f&(Pr|hn))===0&&(zt===null?Jc([r]):zt.push(r))}return e}function Ns(r){Rt(r,r.v+1)}function Fl(r,e){var t=r.reactions;if(t!==null)for(var n=zn(),s=t.length,l=0;l<s;l++){var c=t[l],h=c.f;if(!(!n&&c===Ne)){var v=(h&Yt)===0;v&&Mt(c,e),(h&Bt)!==0?Fl(c,qr):v&&((h&Hn)!==0&&nn!==null&&nn.push(c),Bn(c))}}}function an(r){if(typeof r!="object"||r===null||Ur in r)return r;const e=ya(r);if(e!==ec&&e!==tc)return r;var t=new Map,n=fs(r),s=Ot(0),l=cn,c=h=>{if(cn===l)return h();var v=He,g=cn;_r(null),Bo(l);var m=h();return _r(v),Bo(g),m};return n&&t.set("length",Ot(r.length)),new Proxy(r,{defineProperty(h,v,g){(!("value"in g)||g.configurable===!1||g.enumerable===!1||g.writable===!1)&&fc();var m=t.get(v);return m===void 0?m=c(()=>{var k=Ot(g.value);return t.set(v,k),k}):Rt(m,g.value,!0),!0},deleteProperty(h,v){var g=t.get(v);if(g===void 0){if(v in h){const m=c(()=>Ot(wt));t.set(v,m),Ns(s)}}else Rt(g,wt),Ns(s);return!0},get(h,v,g){if(v===Ur)return r;var m=t.get(v),k=v in h;if(m===void 0&&(!k||ci(h,v)?.writable)&&(m=c(()=>{var _=an(k?h[v]:wt),S=Ot(_);return S}),t.set(v,m)),m!==void 0){var E=F(m);return E===wt?void 0:E}return Reflect.get(h,v,g)},getOwnPropertyDescriptor(h,v){var g=Reflect.getOwnPropertyDescriptor(h,v);if(g&&"value"in g){var m=t.get(v);m&&(g.value=F(m))}else if(g===void 0){var k=t.get(v),E=k?.v;if(k!==void 0&&E!==wt)return{enumerable:!0,configurable:!0,value:E,writable:!0}}return g},has(h,v){if(v===Ur)return!0;var g=t.get(v),m=g!==void 0&&g.v!==wt||Reflect.has(h,v);if(g!==void 0||Ne!==null&&(!m||ci(h,v)?.writable)){g===void 0&&(g=c(()=>{var E=m?an(h[v]):wt,_=Ot(E);return _}),t.set(v,g));var k=F(g);if(k===wt)return!1}return m},set(h,v,g,m){var k=t.get(v),E=v in h;if(n&&v==="length")for(var _=g;_<k.v;_+=1){var S=t.get(_+"");S!==void 0?Rt(S,wt):_ in h&&(S=c(()=>Ot(wt)),t.set(_+"",S))}if(k===void 0)(!E||ci(h,v)?.writable)&&(k=c(()=>Ot(void 0)),Rt(k,an(g)),t.set(v,k));else{E=k.v!==wt;var D=c(()=>an(g));Rt(k,D)}var R=Reflect.getOwnPropertyDescriptor(h,v);if(R?.set&&R.set.call(m,g),!E){if(n&&typeof v=="string"){var U=t.get("length"),B=Number(v);Number.isInteger(B)&&B>=U.v&&Rt(U,B+1)}Ns(s)}return!0},ownKeys(h){F(s);var v=Reflect.ownKeys(h).filter(k=>{var E=t.get(k);return E===void 0||E.v!==wt});for(var[g,m]of t)m.v!==wt&&!(g in h)&&v.push(g);return v},setPrototypeOf(){vc()}})}function Lo(r){try{if(r!==null&&typeof r=="object"&&Ur in r)return r[Ur]}catch{}return r}function Uc(r,e){return Object.is(Lo(r),Lo(e))}var Do,Ul,Bl,Nl;function Bc(){if(Do===void 0){Do=window,Ul=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;Bl=ci(e,"firstChild").get,Nl=ci(e,"nextSibling").get,Ro(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),Ro(t)&&(t.__t=void 0)}}function vn(r=""){return document.createTextNode(r)}function ss(r){return Bl.call(r)}function ms(r){return Nl.call(r)}function $(r,e){return ss(r)}function Ut(r,e){{var t=ss(r);return t instanceof Comment&&t.data===""?ms(t):t}}function N(r,e=1,t=!1){let n=r;for(;e--;)n=ms(n);return n}function Nc(r){r.textContent=""}function Ta(){return!1}let $o=!1;function Wc(){$o||($o=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const e of r.target.elements)e.__on_r?.()})},{capture:!0}))}function ys(r){var e=He,t=Ne;_r(null),Wr(null);try{return r()}finally{_r(e),Wr(t)}}function Pa(r,e,t,n=t){r.addEventListener(e,()=>ys(t));const s=r.__on_r;s?r.__on_r=()=>{s(),n(!0)}:r.__on_r=()=>n(!0),Wc()}function Wl(r){Ne===null&&He===null&&dc(),He!==null&&(He.f&Kt)!==0&&Ne===null&&cc(),pn&&uc()}function Vc(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function mr(r,e,t,n=!0){var s=Ne;s!==null&&(s.f&sr)!==0&&(r|=sr);var l={ctx:ct,deps:null,nodes_start:null,nodes_end:null,f:r|Yt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Fn(l),l.f|=ba}catch(v){throw Tr(l),v}else e!==null&&Bn(l);if(n){var c=l;if(t&&c.deps===null&&c.teardown===null&&c.nodes_start===null&&c.first===c.last&&(c.f&wi)===0&&(c=c.first),c!==null&&(c.parent=s,s!==null&&Vc(c,s),He!==null&&(He.f&Bt)!==0&&(r&hn)===0)){var h=He;(h.effects??=[]).push(c)}}return l}function Vl(r){const e=mr(vs,null,!1);return Mt(e,It),e.teardown=r,e}function _i(r){Wl();var e=Ne.f,t=!He&&(e&Pr)!==0&&(e&ba)===0;if(t){var n=ct;(n.e??=[]).push(r)}else return ql(r)}function ql(r){return mr(wa|Sl,r,!1)}function qc(r){return Wl(),mr(vs|Sl,r,!0)}function Hc(r){Un.ensure();const e=mr(hn|wi,r,!0);return(t={})=>new Promise(n=>{t.outro?ws(e,()=>{Tr(e),n(void 0)}):(Tr(e),n(void 0))})}function Hl(r){return mr(wa,r,!1)}function zc(r){return mr(Ea|wi,r,!0)}function xa(r,e=0){return mr(vs|e,r,!0)}function Ce(r,e=[],t=[]){Mc(e,t,n=>{mr(vs,()=>r(...n.map(F)),!0)})}function Ra(r,e=0){var t=mr(Hn|e,r,!0);return t}function Vn(r,e=!0){return mr(Pr|wi,r,!0,e)}function zl(r){var e=r.teardown;if(e!==null){const t=pn,n=He;Uo(!0),_r(null);try{e.call(null)}finally{Uo(t),_r(n)}}}function Gl(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const s=t.ac;s!==null&&ys(()=>{s.abort(Aa)});var n=t.next;(t.f&hn)!==0?t.parent=null:Tr(t,e),t=n}}function Gc(r){for(var e=r.first;e!==null;){var t=e.next;(e.f&Pr)===0&&Tr(e),e=t}}function Tr(r,e=!0){var t=!1;(e||(r.f&ic)!==0)&&r.nodes_start!==null&&r.nodes_end!==null&&(Kc(r.nodes_start,r.nodes_end),t=!0),Gl(r,e&&!t),as(r,0),Mt(r,fn);var n=r.transitions;if(n!==null)for(const l of n)l.stop();zl(r);var s=r.parent;s!==null&&s.first!==null&&Kl(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function Kc(r,e){for(;r!==null;){var t=r===e?null:ms(r);r.remove(),r=t}}function Kl(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function ws(r,e){var t=[];Oa(r,t,!0),Yl(t,()=>{Tr(r),e&&e()})}function Yl(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var s of r)s.out(n)}else e()}function Oa(r,e,t){if((r.f&sr)===0){if(r.f^=sr,r.transitions!==null)for(const c of r.transitions)(c.is_global||t)&&e.push(c);for(var n=r.first;n!==null;){var s=n.next,l=(n.f&ka)!==0||(n.f&Pr)!==0;Oa(n,e,l?t:!1),n=s}}}function ja(r){Jl(r,!0)}function Jl(r,e){if((r.f&sr)!==0){r.f^=sr,(r.f&It)===0&&(Mt(r,Yt),Bn(r));for(var t=r.first;t!==null;){var n=t.next,s=(t.f&ka)!==0||(t.f&Pr)!==0;Jl(t,s?e:!1),t=n}if(r.transitions!==null)for(const l of r.transitions)(l.is_global||e)&&l.in()}}let jn=null;function Yc(r){var e=jn;try{if(jn=new Set,Gn(r),e!==null)for(var t of jn)e.add(t);return jn}finally{jn=e}}function vr(r){for(var e of Yc(r))Wn(e,e.v)}let $n=!1;function Fo(r){$n=r}let pn=!1;function Uo(r){pn=r}let He=null,pr=!1;function _r(r){He=r}let Ne=null;function Wr(r){Ne=r}let Cr=null;function Xl(r){He!==null&&(Cr===null?Cr=[r]:Cr.push(r))}let xt=null,Ft=0,zt=null;function Jc(r){zt=r}let Ql=1,mi=0,cn=mi;function Bo(r){cn=r}let Fr=!1;function Zl(){return++Ql}function bs(r){var e=r.f;if((e&Yt)!==0)return!0;if((e&qr)!==0){var t=r.deps,n=(e&Kt)!==0;if(t!==null){var s,l,c=(e&rs)!==0,h=n&&Ne!==null&&!Fr,v=t.length;if((c||h)&&(Ne===null||(Ne.f&fn)===0)){var g=r,m=g.parent;for(s=0;s<v;s++)l=t[s],(c||!l?.reactions?.includes(g))&&(l.reactions??=[]).push(g);c&&(g.f^=rs),h&&m!==null&&(m.f&Kt)===0&&(g.f^=Kt)}for(s=0;s<v;s++)if(l=t[s],bs(l)&&Ml(l),l.wv>r.wv)return!0}(!n||Ne!==null&&!Fr)&&Mt(r,It)}return!1}function eu(r,e,t=!0){var n=r.reactions;if(n!==null&&!Cr?.includes(r))for(var s=0;s<n.length;s++){var l=n[s];(l.f&Bt)!==0?eu(l,e,!1):e===l&&(t?Mt(l,Yt):(l.f&It)!==0&&Mt(l,qr),Bn(l))}}function tu(r){var e=xt,t=Ft,n=zt,s=He,l=Fr,c=Cr,h=ct,v=pr,g=cn,m=r.f;xt=null,Ft=0,zt=null,Fr=(m&Kt)!==0&&(pr||!$n||He===null),He=(m&(Pr|hn))===0?r:null,Cr=null,ns(r.ctx),pr=!1,cn=++mi,r.ac!==null&&(ys(()=>{r.ac.abort(Aa)}),r.ac=null);try{r.f|=ta;var k=r.fn,E=k(),_=r.deps;if(xt!==null){var S;if(as(r,Ft),_!==null&&Ft>0)for(_.length=Ft+xt.length,S=0;S<xt.length;S++)_[Ft+S]=xt[S];else r.deps=_=xt;if(!Fr||(m&Bt)!==0&&r.reactions!==null)for(S=Ft;S<_.length;S++)(_[S].reactions??=[]).push(r)}else _!==null&&Ft<_.length&&(as(r,Ft),_.length=Ft);if(zn()&&zt!==null&&!pr&&_!==null&&(r.f&(Bt|qr|Yt))===0)for(S=0;S<zt.length;S++)eu(zt[S],r);return s!==null&&s!==r&&(mi++,zt!==null&&(n===null?n=zt:n.push(...zt))),(r.f&un)!==0&&(r.f^=un),E}catch(D){return Cc(D)}finally{r.f^=ta,xt=e,Ft=t,zt=n,He=s,Fr=l,Cr=c,ns(h),pr=v,cn=g}}function Xc(r,e){let t=e.reactions;if(t!==null){var n=Zu.call(t,r);if(n!==-1){var s=t.length-1;s===0?t=e.reactions=null:(t[n]=t[s],t.pop())}}t===null&&(e.f&Bt)!==0&&(xt===null||!xt.includes(e))&&(Mt(e,qr),(e.f&(Kt|rs))===0&&(e.f^=rs),jl(e),as(e,0))}function as(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)Xc(r,t[n])}function Fn(r){var e=r.f;if((e&fn)===0){Mt(r,It);var t=Ne,n=$n;Ne=r,$n=!0;try{(e&Hn)!==0?Gc(r):Gl(r),zl(r);var s=tu(r);r.teardown=typeof s=="function"?s:null,r.wv=Ql;var l;kl&&Ac&&(r.f&Yt)!==0&&r.deps}finally{$n=n,Ne=t}}}async function Qc(){await Promise.resolve(),Dc()}function F(r){var e=r.f,t=(e&Bt)!==0;if(jn?.add(r),He!==null&&!pr){var n=Ne!==null&&(Ne.f&fn)!==0;if(!n&&!Cr?.includes(r)){var s=He.deps;if((He.f&ta)!==0)r.rv<mi&&(r.rv=mi,xt===null&&s!==null&&s[Ft]===r?Ft++:xt===null?xt=[r]:(!Fr||!xt.includes(r))&&xt.push(r));else{(He.deps??=[]).push(r);var l=r.reactions;l===null?r.reactions=[He]:l.includes(He)||l.push(He)}}}else if(t&&r.deps===null&&r.effects===null){var c=r,h=c.parent;h!==null&&(h.f&Kt)===0&&(c.f^=Kt)}if(pn){if(Br.has(r))return Br.get(r);if(t){c=r;var v=c.v;return((c.f&It)===0&&c.reactions!==null||ru(c))&&(v=Ca(c)),Br.set(c,v),v}}else t&&(c=r,bs(c)&&Ml(c));if((r.f&un)!==0)throw r.v;return r.v}function ru(r){if(r.v===wt)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(Br.has(e)||(e.f&Bt)!==0&&ru(e))return!0;return!1}function Gn(r){var e=pr;try{return pr=!0,r()}finally{pr=e}}const Zc=-7169;function Mt(r,e){r.f=r.f&Zc|e}function ed(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(Ur in r)ia(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&Ur in t&&ia(t)}}}function ia(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{ia(r[n],e)}catch{}const t=ya(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=El(t);for(let s in n){const l=n[s].get;if(l)try{l.call(r)}catch{}}}}}const td=["touchstart","touchmove"];function rd(r){return td.includes(r)}const nu=new Set,sa=new Set;function nd(r,e,t,n={}){function s(l){if(n.capture||li.call(e,l),!l.cancelBubble)return ys(()=>t?.call(this,l))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Ia(()=>{e.addEventListener(r,s,n)}):e.addEventListener(r,s,n),s}function oi(r,e,t,n,s){var l={capture:n,passive:s},c=nd(r,e,t,l);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Vl(()=>{e.removeEventListener(r,c,l)})}function xr(r){for(var e=0;e<r.length;e++)nu.add(r[e]);for(var t of sa)t(r)}let No=null;function li(r){var e=this,t=e.ownerDocument,n=r.type,s=r.composedPath?.()||[],l=s[0]||r.target;No=r;var c=0,h=No===r&&r.__root;if(h){var v=s.indexOf(h);if(v!==-1&&(e===document||e===window)){r.__root=e;return}var g=s.indexOf(e);if(g===-1)return;v<=g&&(c=v)}if(l=s[c]||r.target,l!==e){ea(r,"currentTarget",{configurable:!0,get(){return l||t}});var m=He,k=Ne;_r(null),Wr(null);try{for(var E,_=[];l!==null;){var S=l.assignedSlot||l.parentNode||l.host||null;try{var D=l["__"+n];if(D!=null&&(!l.disabled||r.target===l))if(fs(D)){var[R,...U]=D;R.apply(l,[r,...U])}else D.call(l,r)}catch(B){E?_.push(B):E=B}if(r.cancelBubble||S===e||S===null)break;l=S}if(E){for(let B of _)queueMicrotask(()=>{throw B});throw E}}finally{r.__root=e,delete r.currentTarget,_r(m),Wr(k)}}}function id(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function os(r,e){var t=Ne;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function ue(r,e){var t=(e&mc)!==0,n=(e&yc)!==0,s,l=!r.startsWith("<!>");return()=>{s===void 0&&(s=id(l?r:"<!>"+r),t||(s=ss(s)));var c=n||Ul?document.importNode(s,!0):s.cloneNode(!0);if(t){var h=ss(c),v=c.lastChild;os(h,v)}else os(c,c);return c}}function Ws(r=""){{var e=vn(r+"");return os(e,e),e}}function gr(){var r=document.createDocumentFragment(),e=document.createComment(""),t=vn();return r.append(e,t),os(e,t),r}function ee(r,e){r!==null&&r.before(e)}function Le(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??=r.nodeValue)&&(r.__t=t,r.nodeValue=t+"")}function sd(r,e){return ad(r,e)}const kn=new Map;function ad(r,{target:e,anchor:t,props:n={},events:s,context:l,intro:c=!0}){Bc();var h=new Set,v=k=>{for(var E=0;E<k.length;E++){var _=k[E];if(!h.has(_)){h.add(_);var S=rd(_);e.addEventListener(_,li,{passive:S});var D=kn.get(_);D===void 0?(document.addEventListener(_,li,{passive:S}),kn.set(_,1)):kn.set(_,D+1)}}};v(ma(nu)),sa.add(v);var g=void 0,m=Hc(()=>{var k=t??e.appendChild(vn());return Vn(()=>{if(l){Jt({});var E=ct;E.c=l}s&&(n.$$events=s),g=r(k,n)||{},l&&Xt()}),()=>{for(var E of h){e.removeEventListener(E,li);var _=kn.get(E);--_===0?(document.removeEventListener(E,li),kn.delete(E)):kn.set(E,_)}sa.delete(v),k!==t&&k.parentNode?.removeChild(k)}});return od.set(g,m),g}let od=new WeakMap;function $e(r,e,t=!1){var n=r,s=null,l=null,c=wt,h=t?ka:0,v=!1;const g=(_,S=!0)=>{v=!0,E(S,_)};var m=null;function k(){m!==null&&(m.lastChild.remove(),n.before(m),m=null);var _=c?s:l,S=c?l:s;_&&ja(_),S&&ws(S,()=>{c?l=null:s=null})}const E=(_,S)=>{if(c!==(c=_)){var D=Ta(),R=n;if(D&&(m=document.createDocumentFragment(),m.append(R=vn())),c?s??=S&&Vn(()=>S(R)):l??=S&&Vn(()=>S(R)),D){var U=et,B=c?s:l,W=c?l:s;B&&U.skipped_effects.delete(B),W&&U.skipped_effects.add(W),U.add_callback(k)}else k()}};Ra(()=>{v=!1,e(g),v||E(null,null)},h)}function Wo(r,e,t){var n=r,s=wt,l,c,h=null,v=zn()?Ec:Tl;function g(){l&&ws(l),h!==null&&(h.lastChild.remove(),n.before(h),h=null),l=c}Ra(()=>{if(v(s,s=e())){var m=n,k=Ta();k&&(h=document.createDocumentFragment(),h.append(m=vn())),c=Vn(()=>t(m)),k?et.add_callback(g):g()}})}function Gt(r,e){return e}function ld(r,e,t){for(var n=r.items,s=[],l=e.length,c=0;c<l;c++)Oa(e[c].e,s,!0);var h=l>0&&s.length===0&&t!==null;if(h){var v=t.parentNode;Nc(v),v.append(t),n.clear(),hr(r,e[0].prev,e[l-1].next)}Yl(s,()=>{for(var g=0;g<l;g++){var m=e[g];h||(n.delete(m.k),hr(r,m.prev,m.next)),Tr(m.e,!h)}})}function St(r,e,t,n,s,l=null){var c=r,h={flags:e,items:new Map,first:null},v=(e&Il)!==0;if(v){var g=r;c=g.appendChild(vn())}var m=null,k=!1,E=new Map,_=Ol(()=>{var U=t();return fs(U)?U:U==null?[]:ma(U)}),S,D;function R(){ud(D,S,h,E,c,s,e,n,t),l!==null&&(S.length===0?m?ja(m):m=Vn(()=>l(c)):m!==null&&ws(m,()=>{m=null}))}Ra(()=>{D??=Ne,S=F(_);var U=S.length;if(!(k&&U===0)){k=U===0;var B,W,z,K;if(Ta()){var O=new Set,j=et;for(W=0;W<U;W+=1){z=S[W],K=n(z,W);var ie=h.items.get(K)??E.get(K);ie?(e&(ps|gs))!==0&&iu(ie,z,W,e):(B=su(null,h,null,null,z,K,W,s,e,t,!0),E.set(K,B)),O.add(K)}for(const[X,ce]of h.items)O.has(X)||j.skipped_effects.add(ce.e);j.add_callback(R)}else R();F(_)}})}function ud(r,e,t,n,s,l,c,h,v){var g=(c&gc)!==0,m=(c&(ps|gs))!==0,k=e.length,E=t.items,_=t.first,S=_,D,R=null,U,B=[],W=[],z,K,O,j;if(g)for(j=0;j<k;j+=1)z=e[j],K=h(z,j),O=E.get(K),O!==void 0&&(O.a?.measure(),(U??=new Set).add(O));for(j=0;j<k;j+=1){if(z=e[j],K=h(z,j),O=E.get(K),O===void 0){var ie=n.get(K);if(ie!==void 0){n.delete(K),E.set(K,ie);var X=R?R.next:S;hr(t,R,ie),hr(t,ie,X),Vs(ie,X,s),R=ie}else{var ce=S?S.e.nodes_start:s;R=su(ce,t,R,R===null?t.first:R.next,z,K,j,l,c,v)}E.set(K,R),B=[],W=[],S=R.next;continue}if(m&&iu(O,z,j,c),(O.e.f&sr)!==0&&(ja(O.e),g&&(O.a?.unfix(),(U??=new Set).delete(O))),O!==S){if(D!==void 0&&D.has(O)){if(B.length<W.length){var Q=W[0],ne;R=Q.prev;var fe=B[0],Fe=B[B.length-1];for(ne=0;ne<B.length;ne+=1)Vs(B[ne],Q,s);for(ne=0;ne<W.length;ne+=1)D.delete(W[ne]);hr(t,fe.prev,Fe.next),hr(t,R,fe),hr(t,Fe,Q),S=Q,R=Fe,j-=1,B=[],W=[]}else D.delete(O),Vs(O,S,s),hr(t,O.prev,O.next),hr(t,O,R===null?t.first:R.next),hr(t,R,O),R=O;continue}for(B=[],W=[];S!==null&&S.k!==K;)(S.e.f&sr)===0&&(D??=new Set).add(S),W.push(S),S=S.next;if(S===null)continue;O=S}B.push(O),R=O,S=O.next}if(S!==null||D!==void 0){for(var J=D===void 0?[]:ma(D);S!==null;)(S.e.f&sr)===0&&J.push(S),S=S.next;var ve=J.length;if(ve>0){var oe=(c&Il)!==0&&k===0?s:null;if(g){for(j=0;j<ve;j+=1)J[j].a?.measure();for(j=0;j<ve;j+=1)J[j].a?.fix()}ld(t,J,oe)}}g&&Ia(()=>{if(U!==void 0)for(O of U)O.a?.apply()}),r.first=t.first&&t.first.e,r.last=R&&R.e;for(var Ke of n.values())Tr(Ke.e);n.clear()}function iu(r,e,t,n){(n&ps)!==0&&Wn(r.v,e),(n&gs)!==0?Wn(r.i,t):r.i=t}function su(r,e,t,n,s,l,c,h,v,g,m){var k=(v&ps)!==0,E=(v&_c)===0,_=k?E?Fc(s,!1,!1):Nn(s):s,S=(v&gs)===0?c:Nn(c),D={i:S,v:_,k:l,a:null,e:null,prev:t,next:n};try{if(r===null){var R=document.createDocumentFragment();R.append(r=vn())}return D.e=Vn(()=>h(r,_,S,g),kc),D.e.prev=t&&t.e,D.e.next=n&&n.e,t===null?m||(e.first=D):(t.next=D,t.e.next=D.e),n!==null&&(n.prev=D,n.e.prev=D.e),D}finally{}}function Vs(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,s=e?e.e.nodes_start:t,l=r.e.nodes_start;l!==null&&l!==n;){var c=ms(l);s.before(l),l=c}}function hr(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const Vo=[...` 	
\r\f \v\uFEFF`];function cd(r,e,t){var n=r==null?"":""+r;if(e&&(n=n?n+" "+e:e),t){for(var s in t)if(t[s])n=n?n+" "+s:s;else if(n.length)for(var l=s.length,c=0;(c=n.indexOf(s,c))>=0;){var h=c+l;(c===0||Vo.includes(n[c-1]))&&(h===n.length||Vo.includes(n[h]))?n=(c===0?"":n.substring(0,c))+n.substring(h+1):c=h}}return n===""?null:n}function Nr(r,e,t,n,s,l){var c=r.__className;if(c!==t||c===void 0){var h=cd(t,n,l);h==null?r.removeAttribute("class"):r.className=h,r.__className=t}else if(l&&s!==l)for(var v in l){var g=!!l[v];(s==null||g!==!!s[v])&&r.classList.toggle(v,g)}return l}function ls(r,e,t=!1){if(r.multiple){if(e==null)return;if(!fs(e))return bc();for(var n of r.options)n.selected=e.includes(hi(n));return}for(n of r.options){var s=hi(n);if(Uc(s,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function aa(r){var e=new MutationObserver(()=>{ls(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Vl(()=>{e.disconnect()})}function di(r,e,t=e){var n=!0;Pa(r,"change",s=>{var l=s?"[selected]":":checked",c;if(r.multiple)c=[].map.call(r.querySelectorAll(l),hi);else{var h=r.querySelector(l)??r.querySelector("option:not([disabled])");c=h&&hi(h)}t(c)}),Hl(()=>{var s=e();if(ls(r,s,n),n&&s===void 0){var l=r.querySelector(":checked");l!==null&&(s=hi(l),t(s))}r.__value=s,n=!1}),aa(r)}function hi(r){return"__value"in r?r.__value:r.value}const dd=Symbol("is custom element"),hd=Symbol("is html");function qs(r,e){var t=au(r);t.value===(t.value=e??void 0)||r.value===e&&(e!==0||r.nodeName!=="PROGRESS")||(r.value=e??"")}function Dn(r,e,t,n){var s=au(r);s[e]!==(s[e]=t)&&(e==="loading"&&(r[sc]=t),t==null?r.removeAttribute(e):typeof t!="string"&&fd(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function au(r){return r.__attributes??={[dd]:r.nodeName.includes("-"),[hd]:r.namespaceURI===wc}}var qo=new Map;function fd(r){var e=r.getAttribute("is")||r.nodeName,t=qo.get(e);if(t)return t;qo.set(e,t=[]);for(var n,s=r,l=Element.prototype;l!==s;){n=El(s);for(var c in n)n[c].set&&t.push(c);s=ya(s)}return t}function on(r,e,t=e){var n=new WeakSet;Pa(r,"input",async s=>{var l=s?r.defaultValue:r.value;if(l=Hs(r)?zs(l):l,t(l),et!==null&&n.add(et),await Qc(),l!==(l=e())){var c=r.selectionStart,h=r.selectionEnd;r.value=l??"",h!==null&&(r.selectionStart=c,r.selectionEnd=Math.min(h,r.value.length))}}),Gn(e)==null&&r.value&&(t(Hs(r)?zs(r.value):r.value),et!==null&&n.add(et)),xa(()=>{var s=e();if(r===document.activeElement){var l=Qi??et;if(n.has(l))return}Hs(r)&&s===zs(r.value)||r.type==="date"&&!s&&!r.value||s!==r.value&&(r.value=s??"")})}function Ho(r,e,t=e){Pa(r,"change",n=>{var s=n?r.defaultChecked:r.checked;t(s)}),Gn(e)==null&&t(r.checked),xa(()=>{var n=e();r.checked=!!n})}function Hs(r){var e=r.type;return e==="number"||e==="range"}function zs(r){return r===""?null:+r}function zo(r,e){return r===e||r?.[Ur]===e}function vd(r={},e,t,n){return Hl(()=>{var s,l;return xa(()=>{s=l,l=[],Gn(()=>{r!==t(...l)&&(e(r,...l),s&&zo(t(...s),r)&&e(null,...s))})}),()=>{Ia(()=>{l&&zo(t(...l),r)&&e(null,...l)})}}),r}function gn(r=!1){const e=ct,t=e.l.u;if(!t)return;let n=()=>ed(e.s);if(r){let s=0,l={};const c=ki(()=>{let h=!1;const v=e.s;for(const g in v)v[g]!==l[g]&&(l[g]=v[g],h=!0);return h&&s++,s});n=()=>F(c)}t.b.length&&qc(()=>{Go(e,n),ts(t.b)}),_i(()=>{const s=Gn(()=>t.m.map(rc));return()=>{for(const l of s)typeof l=="function"&&l()}}),t.a.length&&_i(()=>{Go(e,n),ts(t.a)})}function Go(r,e){if(r.l.s)for(const t of r.l.s)F(t);e()}function Kn(r){var e=Nn(0);return function(){return arguments.length===1?(Rt(e,F(e)+1),arguments[0]):(F(e),r())}}function pd(r,e,t,n){var s=n,l=!0,c=()=>(l&&(l=!1,s=n),s);r[e];var h;h=()=>{var k=r[e];return k===void 0?c():(l=!0,k)};var v=!1,g=ki(()=>(v=!1,h())),m=Ne;return(function(k,E){if(arguments.length>0){const _=E?F(g):k;return Rt(g,_),v=!0,s!==void 0&&(s=_),k}return pn&&v||(m.f&fn)!==0?g.v:F(g)})}function ks(r){ct===null&&oc(),bi&&ct.l!==null?gd(ct).m.push(r):_i(()=>{const e=Gn(r);if(typeof e=="function")return e})}function gd(r){var e=r.l;return e.u??={a:[],b:[],m:[]}}const _d="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(_d);Sc();const x=an({showEditor:!1,showItems:!1,editingOptionIndex:null,editingItemIndex:null,selectedChapterId:null,selectedDialogueId:null,selectedBucket:null,availableBuckets:[],data:{meta:{version:"3.1",title:"Новая история"},dialogues:[],chapters:[],items:[],miniGames:[]},storedFiles:[],storiesList:[],currentFileName:"dracula_story.json",statusMessage:{type:"",text:""}}),Et={get currentDialogue(){return x.data?.dialogues.find(r=>r.id===x.selectedDialogueId)},get currentChapter(){return x.data?.chapters?.find(r=>r.id===x.selectedChapterId)},get currentEditingOption(){return Et.currentDialogue&&x.editingOptionIndex!==null?Et.currentDialogue.options?.[x.editingOptionIndex]:void 0},get chapterDialogues(){return!x.data?.dialogues||!x.selectedChapterId?[]:x.data.dialogues.filter(r=>r.chapterId===x.selectedChapterId)},get imageResources(){return x.storedFiles.filter(r=>r.name.match(/\.(png|jpg|jpeg|webp|gif|svg)$/i))},get riveResources(){return x.storedFiles.filter(r=>r.name.endsWith(".riv"))},get availableItems(){return x.data?.items||[]},get backlinks(){return!x.data||!x.selectedDialogueId?[]:x.data.dialogues.filter(r=>r.nextDialogueId===x.selectedDialogueId?!0:r.options?r.options.some(e=>e.nextDialogueId===x.selectedDialogueId):!1)},get hasUnsavedChanges(){return!1}},tt={toggleEditor(){x.showEditor=!x.showEditor},toggleItemsPanel(){x.showItems=!x.showItems},setStatus(r,e){x.statusMessage={type:r,text:e}},clearStatus(){x.statusMessage={type:"",text:""}},selectBucket(r){x.selectedBucket=r,x.data={meta:{version:"3.1",title:"Новая история"},dialogues:[],chapters:[],items:[],miniGames:[]},x.storedFiles=[],x.storiesList=[],x.selectedChapterId=null,x.selectedDialogueId=null},updateBucketsList(r){x.availableBuckets=r},selectChapter(r){x.selectedChapterId=r,x.selectedDialogueId=null},selectDialogue(r){x.selectedDialogueId=r},selectOption(r){x.editingOptionIndex=r},selectItem(r){x.editingItemIndex=r},updateStoryData(r){x.data=r},updateStoredFiles(r){x.storedFiles=r},updateStoriesList(r){x.storiesList=r},setCurrentFileName(r){x.currentFileName=r},addDialogue(r){x.data.dialogues=[...x.data.dialogues,r]},updateDialogue(r,e){x.data.dialogues=x.data.dialogues.map(t=>t.id===r?{...t,...e}:t)},deleteDialogue(r){x.data.dialogues=x.data.dialogues.filter(e=>e.id!==r),x.selectedDialogueId===r&&(x.selectedDialogueId=null)},addChapter(r){x.data.chapters=[...x.data.chapters,r]},updateChapter(r,e){x.data.chapters=x.data.chapters.map(t=>t.id===r?{...t,...e}:t)},deleteChapter(r){x.data.chapters=x.data.chapters.filter(e=>e.id!==r),x.selectedChapterId===r&&(x.selectedChapterId=null,x.selectedDialogueId=null)},addItem(r){x.data.items=[...x.data.items||[],r]},updateItem(r,e){x.data.items&&(x.data.items=x.data.items.map(t=>t.id===r?{...t,...e}:t))},deleteItem(r){x.data.items&&(x.data.items=x.data.items.filter(e=>e.id!==r))},reset(){x.showEditor=!1,x.showItems=!1,x.editingOptionIndex=null,x.editingItemIndex=null,x.selectedChapterId=null,x.selectedDialogueId=null,x.statusMessage={type:"",text:""}}},md="modulepreload",yd=function(r,e){return new URL(r,e).href},Ko={},Ei=function(e,t,n){let s=Promise.resolve();if(t&&t.length>0){let g=function(m){return Promise.all(m.map(k=>Promise.resolve(k).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};const c=document.getElementsByTagName("link"),h=document.querySelector("meta[property=csp-nonce]"),v=h?.nonce||h?.getAttribute("nonce");s=g(t.map(m=>{if(m=yd(m,n),m in Ko)return;Ko[m]=!0;const k=m.endsWith(".css"),E=k?'[rel="stylesheet"]':"";if(!!n)for(let D=c.length-1;D>=0;D--){const R=c[D];if(R.href===m&&(!k||R.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${E}`))return;const S=document.createElement("link");if(S.rel=k?"stylesheet":md,k||(S.as="script"),S.crossOrigin="",S.href=m,v&&S.setAttribute("nonce",v),document.head.appendChild(S),k)return new Promise((D,R)=>{S.addEventListener("load",D),S.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=c,window.dispatchEvent(h),!h.defaultPrevented)throw c}return s.then(c=>{for(const h of c||[])h.status==="rejected"&&l(h.reason);return e().catch(l)})},wd=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Ei(async()=>{const{default:n}=await Promise.resolve().then(()=>Yn);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class Ma extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class bd extends Ma{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Yo extends Ma{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Jo extends Ma{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var oa;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(oa||(oa={}));var kd=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};class Ed{constructor(e,{headers:t={},customFetch:n,region:s=oa.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=wd(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n;return kd(this,void 0,void 0,function*(){try{const{headers:s,method:l,body:c}=t;let h={},{region:v}=t;v||(v=this.region);const g=new URL(`${this.url}/${e}`);v&&v!=="any"&&(h["x-region"]=v,g.searchParams.set("forceFunctionRegion",v));let m;c&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)));const k=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),s),body:m}).catch(D=>{throw new bd(D)}),E=k.headers.get("x-relay-error");if(E&&E==="true")throw new Yo(k);if(!k.ok)throw new Jo(k);let _=((n=k.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return _==="application/json"?S=yield k.json():_==="application/octet-stream"?S=yield k.blob():_==="text/event-stream"?S=k:_==="multipart/form-data"?S=yield k.formData():S=yield k.text(),{data:S,error:null,response:k}}catch(s){return{data:null,error:s,response:s instanceof Jo||s instanceof Yo?s.context:void 0}}})}}function Ad(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Sd(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),t}var yt={},En={},An={},Sn={},In={},Cn={},Id=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},qn=Id();const Cd=qn.fetch,ou=qn.fetch.bind(qn),lu=qn.Headers,Td=qn.Request,Pd=qn.Response,Yn=Object.freeze(Object.defineProperty({__proto__:null,Headers:lu,Request:Td,Response:Pd,default:ou,fetch:Cd},Symbol.toStringTag,{value:"Module"})),xd=Sd(Yn);var Gi={},Xo;function uu(){if(Xo)return Gi;Xo=1,Object.defineProperty(Gi,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Gi.default=r,Gi}var Qo;function cu(){if(Qo)return Cn;Qo=1;var r=Cn&&Cn.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Cn,"__esModule",{value:!0});const e=r(xd),t=r(uu());class n{constructor(l){var c,h;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(h=l.isMaybeSingle)!==null&&h!==void 0?h:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const h=this.fetch;let v=h(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var m,k,E,_;let S=null,D=null,R=null,U=g.status,B=g.statusText;if(g.ok){if(this.method!=="HEAD"){const O=await g.text();O===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?D=O:D=JSON.parse(O))}const z=(k=this.headers.get("Prefer"))===null||k===void 0?void 0:k.match(/count=(exact|planned|estimated)/),K=(E=g.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");z&&K&&K.length>1&&(R=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(D)&&(D.length>1?(S={code:"PGRST116",details:`Results contain ${D.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},D=null,R=null,U=406,B="Not Acceptable"):D.length===1?D=D[0]:D=null)}else{const z=await g.text();try{S=JSON.parse(z),Array.isArray(S)&&g.status===404&&(D=[],S=null,U=200,B="OK")}catch{g.status===404&&z===""?(U=204,B="No Content"):S={message:z}}if(S&&this.isMaybeSingle&&(!((_=S?.details)===null||_===void 0)&&_.includes("0 rows"))&&(S=null,U=200,B="OK"),S&&this.shouldThrowOnError)throw new t.default(S)}return{error:S,data:D,count:R,status:U,statusText:B}});return this.shouldThrowOnError||(v=v.catch(g=>{var m,k,E;return{error:{message:`${(m=g?.name)!==null&&m!==void 0?m:"FetchError"}: ${g?.message}`,details:`${(k=g?.stack)!==null&&k!==void 0?k:""}`,hint:"",code:`${(E=g?.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),v.then(l,c)}returns(){return this}overrideTypes(){return this}}return Cn.default=n,Cn}var Zo;function du(){if(Zo)return In;Zo=1;var r=In&&In.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(In,"__esModule",{value:!0});const e=r(cu());class t extends e.default{select(s){let l=!1;const c=(s??"*").split("").map(h=>/\s/.test(h)&&!l?"":(h==='"'&&(l=!l),h)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:l=!0,nullsFirst:c,foreignTable:h,referencedTable:v=h}={}){const g=v?`${v}.order`:"order",m=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${m?`${m},`:""}${s}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:l,referencedTable:c=l}={}){const h=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(h,`${s}`),this}range(s,l,{foreignTable:c,referencedTable:h=c}={}){const v=typeof h>"u"?"offset":`${h}.offset`,g=typeof h>"u"?"limit":`${h}.limit`;return this.url.searchParams.set(v,`${s}`),this.url.searchParams.set(g,`${l-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:l=!1,settings:c=!1,buffers:h=!1,wal:v=!1,format:g="text"}={}){var m;const k=[s?"analyze":null,l?"verbose":null,c?"settings":null,h?"buffers":null,v?"wal":null].filter(Boolean).join("|"),E=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${E}"; options=${k};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return In.default=t,In}var el;function La(){if(el)return Sn;el=1;var r=Sn&&Sn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Sn,"__esModule",{value:!0});const e=r(du());class t extends e.default{eq(s,l){return this.url.searchParams.append(s,`eq.${l}`),this}neq(s,l){return this.url.searchParams.append(s,`neq.${l}`),this}gt(s,l){return this.url.searchParams.append(s,`gt.${l}`),this}gte(s,l){return this.url.searchParams.append(s,`gte.${l}`),this}lt(s,l){return this.url.searchParams.append(s,`lt.${l}`),this}lte(s,l){return this.url.searchParams.append(s,`lte.${l}`),this}like(s,l){return this.url.searchParams.append(s,`like.${l}`),this}likeAllOf(s,l){return this.url.searchParams.append(s,`like(all).{${l.join(",")}}`),this}likeAnyOf(s,l){return this.url.searchParams.append(s,`like(any).{${l.join(",")}}`),this}ilike(s,l){return this.url.searchParams.append(s,`ilike.${l}`),this}ilikeAllOf(s,l){return this.url.searchParams.append(s,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(s,l){return this.url.searchParams.append(s,`ilike(any).{${l.join(",")}}`),this}is(s,l){return this.url.searchParams.append(s,`is.${l}`),this}in(s,l){const c=Array.from(new Set(l)).map(h=>typeof h=="string"&&new RegExp("[,()]").test(h)?`"${h}"`:`${h}`).join(",");return this.url.searchParams.append(s,`in.(${c})`),this}contains(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cs.{${l.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(l)}`),this}containedBy(s,l){return typeof l=="string"?this.url.searchParams.append(s,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(s,`cd.{${l.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(l)}`),this}rangeGt(s,l){return this.url.searchParams.append(s,`sr.${l}`),this}rangeGte(s,l){return this.url.searchParams.append(s,`nxl.${l}`),this}rangeLt(s,l){return this.url.searchParams.append(s,`sl.${l}`),this}rangeLte(s,l){return this.url.searchParams.append(s,`nxr.${l}`),this}rangeAdjacent(s,l){return this.url.searchParams.append(s,`adj.${l}`),this}overlaps(s,l){return typeof l=="string"?this.url.searchParams.append(s,`ov.${l}`):this.url.searchParams.append(s,`ov.{${l.join(",")}}`),this}textSearch(s,l,{config:c,type:h}={}){let v="";h==="plain"?v="pl":h==="phrase"?v="ph":h==="websearch"&&(v="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(s,`${v}fts${g}.${l}`),this}match(s){return Object.entries(s).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(s,l,c){return this.url.searchParams.append(s,`not.${l}.${c}`),this}or(s,{foreignTable:l,referencedTable:c=l}={}){const h=c?`${c}.or`:"or";return this.url.searchParams.append(h,`(${s})`),this}filter(s,l,c){return this.url.searchParams.append(s,`${l}.${c}`),this}}return Sn.default=t,Sn}var tl;function hu(){if(tl)return An;tl=1;var r=An&&An.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(An,"__esModule",{value:!0});const e=r(La());class t{constructor(s,{headers:l={},schema:c,fetch:h}){this.url=s,this.headers=new Headers(l),this.schema=c,this.fetch=h}select(s,{head:l=!1,count:c}={}){const h=l?"HEAD":"GET";let v=!1;const g=(s??"*").split("").map(m=>/\s/.test(m)&&!v?"":(m==='"'&&(v=!v),m)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:l,defaultToNull:c=!0}={}){var h;const v="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const g=s.reduce((m,k)=>m.concat(Object.keys(k)),[]);if(g.length>0){const m=[...new Set(g)].map(k=>`"${k}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}upsert(s,{onConflict:l,ignoreDuplicates:c=!1,count:h,defaultToNull:v=!0}={}){var g;const m="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),h&&this.headers.append("Prefer",`count=${h}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const k=s.reduce((E,_)=>E.concat(Object.keys(_)),[]);if(k.length>0){const E=[...new Set(k)].map(_=>`"${_}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(s,{count:l}={}){var c;const h="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:s}={}){var l;const c="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return An.default=t,An}var rl;function Rd(){if(rl)return En;rl=1;var r=En&&En.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(En,"__esModule",{value:!0});const e=r(hu()),t=r(La());class n{constructor(l,{headers:c={},schema:h,fetch:v}={}){this.url=l,this.headers=new Headers(c),this.schemaName=h,this.fetch=v}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:h=!1,get:v=!1,count:g}={}){var m;let k;const E=new URL(`${this.url}/rpc/${l}`);let _;h||v?(k=h?"HEAD":"GET",Object.entries(c).filter(([D,R])=>R!==void 0).map(([D,R])=>[D,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([D,R])=>{E.searchParams.append(D,R)})):(k="POST",_=c);const S=new Headers(this.headers);return g&&S.set("Prefer",`count=${g}`),new t.default({method:k,url:E,headers:S,schema:this.schemaName,body:_,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return En.default=n,En}var nl;function Od(){if(nl)return yt;nl=1;var r=yt&&yt.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(yt,"__esModule",{value:!0}),yt.PostgrestError=yt.PostgrestBuilder=yt.PostgrestTransformBuilder=yt.PostgrestFilterBuilder=yt.PostgrestQueryBuilder=yt.PostgrestClient=void 0;const e=r(Rd());yt.PostgrestClient=e.default;const t=r(hu());yt.PostgrestQueryBuilder=t.default;const n=r(La());yt.PostgrestFilterBuilder=n.default;const s=r(du());yt.PostgrestTransformBuilder=s.default;const l=r(cu());yt.PostgrestBuilder=l.default;const c=r(uu());return yt.PostgrestError=c.default,yt.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:l.default,PostgrestError:c.default},yt}var jd=Od();const Md=Ad(jd),{PostgrestClient:Ld,PostgrestQueryBuilder:ep,PostgrestFilterBuilder:tp,PostgrestTransformBuilder:rp,PostgrestBuilder:np,PostgrestError:ip}=Md;class Dd{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const $d="2.15.1",Fd=`realtime-js/${$d}`,Ud="1.0.0",la=1e4,Bd=1e3,Nd=100;var fi;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(fi||(fi={}));var ht;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(ht||(ht={}));var ir;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(ir||(ir={}));var ua;(function(r){r.websocket="websocket"})(ua||(ua={}));var sn;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(sn||(sn={}));class Wd{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const s=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const h=n.decode(e.slice(c,c+s));c=c+s;const v=n.decode(e.slice(c,c+l));c=c+l;const g=JSON.parse(n.decode(e.slice(c,e.byteLength)));return{ref:null,topic:h,event:v,payload:g}}}class fu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Xe;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(Xe||(Xe={}));const il=(r,e,t={})=>{var n;const s=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((l,c)=>(l[c]=Vd(c,r,e,s),l),{})},Vd=(r,e,t,n)=>{const s=e.find(h=>h.name===r),l=s?.type,c=t[r];return l&&!n.includes(l)?vu(l,c):ca(c)},vu=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Gd(e,t)}switch(r){case Xe.bool:return qd(e);case Xe.float4:case Xe.float8:case Xe.int2:case Xe.int4:case Xe.int8:case Xe.numeric:case Xe.oid:return Hd(e);case Xe.json:case Xe.jsonb:return zd(e);case Xe.timestamp:return Kd(e);case Xe.abstime:case Xe.date:case Xe.daterange:case Xe.int4range:case Xe.int8range:case Xe.money:case Xe.reltime:case Xe.text:case Xe.time:case Xe.timestamptz:case Xe.timetz:case Xe.tsrange:case Xe.tstzrange:return ca(e);default:return ca(e)}},ca=r=>r,qd=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Hd=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},zd=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Gd=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,n=r[t];if(r[0]==="{"&&n==="}"){let l;const c=r.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(h=>vu(e,h))}return r},Kd=r=>typeof r=="string"?r.replace(" ","T"):r,pu=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Gs{constructor(e,t,n={},s=la){this.channel=e,this.event=t,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var sl;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(sl||(sl={}));class vi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:l,onLeave:c,onSync:h}=this.caller;this.joinRef=this.channel._joinRef(),this.state=vi.syncState(this.state,s,l,c),this.pendingDiffs.forEach(v=>{this.state=vi.syncDiff(this.state,v,l,c)}),this.pendingDiffs=[],h()}),this.channel._on(n.diff,{},s=>{const{onJoin:l,onLeave:c,onSync:h}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=vi.syncDiff(this.state,s,l,c),h())}),this.onJoin((s,l,c)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:l,newPresences:c})}),this.onLeave((s,l,c)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,s){const l=this.cloneDeep(e),c=this.transformState(t),h={},v={};return this.map(l,(g,m)=>{c[g]||(v[g]=m)}),this.map(c,(g,m)=>{const k=l[g];if(k){const E=m.map(R=>R.presence_ref),_=k.map(R=>R.presence_ref),S=m.filter(R=>_.indexOf(R.presence_ref)<0),D=k.filter(R=>E.indexOf(R.presence_ref)<0);S.length>0&&(h[g]=S),D.length>0&&(v[g]=D)}else h[g]=m}),this.syncDiff(l,{joins:h,leaves:v},n,s)}static syncDiff(e,t,n,s){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(l,(h,v)=>{var g;const m=(g=e[h])!==null&&g!==void 0?g:[];if(e[h]=this.cloneDeep(v),m.length>0){const k=e[h].map(_=>_.presence_ref),E=m.filter(_=>k.indexOf(_.presence_ref)<0);e[h].unshift(...E)}n(h,m,v)}),this.map(c,(h,v)=>{let g=e[h];if(!g)return;const m=v.map(k=>k.presence_ref);g=g.filter(k=>m.indexOf(k.presence_ref)<0),e[h]=g,s(h,g,v),g.length===0&&delete e[h]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return"metas"in s?t[n]=s.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var al;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(al||(al={}));var pi;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(pi||(pi={}));var Sr;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Sr||(Sr={}));class Da{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=ht.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Gs(this,ir.join,this.params,this.timeout),this.rejoinTimer=new fu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ht.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ht.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ht.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ir.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new vi(this),this.broadcastEndpointURL=pu(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,s;if(this.socket.isConnected()||this.socket.connect(),this.state==ht.closed){const{config:{broadcast:l,presence:c,private:h}}=this.params,v=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(E=>E.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[pi.PRESENCE]&&this.bindings[pi.PRESENCE].length>0,m={},k={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:v,private:h};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(E=>e?.(Sr.CHANNEL_ERROR,E)),this._onClose(()=>e?.(Sr.CLOSED)),this.updateJoinPayload(Object.assign({config:k},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:E})=>{var _;if(this.socket.setAuth(),E===void 0){e?.(Sr.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,D=(_=S?.length)!==null&&_!==void 0?_:0,R=[];for(let U=0;U<D;U++){const B=S[U],{filter:{event:W,schema:z,table:K,filter:O}}=B,j=E&&E[U];if(j&&j.event===W&&j.schema===z&&j.table===K&&j.filter===O)R.push(Object.assign(Object.assign({},B),{id:j.id}));else{this.unsubscribe(),this.state=ht.errored,e?.(Sr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,e&&e(Sr.SUBSCRIBED);return}}).receive("error",E=>{this.state=ht.errored,e?.(Sr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{e?.(Sr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===ht.joined&&e===pi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async send(e,t={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=g.body)===null||s===void 0?void 0:s.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,h,v;const g=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(h=(c=this.params)===null||c===void 0?void 0:c.config)===null||h===void 0?void 0:h.broadcast)===null||v===void 0)&&v.ack)&&l("ok"),g.receive("ok",()=>l("ok")),g.receive("error",()=>l("error")),g.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ht.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ir.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Gs(this,ir.leave,{},e),n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ht.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const s=new AbortController,l=setTimeout(()=>s.abort(),n),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(l),c}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Gs(this,e,t,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Nd){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var s,l;const c=e.toLocaleLowerCase(),{close:h,error:v,leave:g,join:m}=ir;if(n&&[h,v,g,m].indexOf(c)>=0&&n!==this._joinRef())return;let E=this._onMessage(c,t,n);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(_=>{var S,D,R;return((S=_.filter)===null||S===void 0?void 0:S.event)==="*"||((R=(D=_.filter)===null||D===void 0?void 0:D.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===c}).map(_=>_.callback(E,n)):(l=this.bindings[c])===null||l===void 0||l.filter(_=>{var S,D,R,U,B,W;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in _){const z=_.id,K=(S=_.filter)===null||S===void 0?void 0:S.event;return z&&((D=t.ids)===null||D===void 0?void 0:D.includes(z))&&(K==="*"||K?.toLocaleLowerCase()===((R=t.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{const z=(B=(U=_?.filter)===null||U===void 0?void 0:U.event)===null||B===void 0?void 0:B.toLocaleLowerCase();return z==="*"||z===((W=t?.event)===null||W===void 0?void 0:W.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===c}).map(_=>{if(typeof E=="object"&&"ids"in E){const S=E.data,{schema:D,table:R,commit_timestamp:U,type:B,errors:W}=S;E=Object.assign(Object.assign({},{schema:D,table:R,commit_timestamp:U,eventType:B,new:{},old:{},errors:W}),this._getPayloadRecords(S))}_.callback(E,n)})}_isClosed(){return this.state===ht.closed}_isJoined(){return this.state===ht.joined}_isJoining(){return this.state===ht.joining}_isLeaving(){return this.state===ht.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const s=e.toLocaleLowerCase(),l={type:s,filter:t,callback:n};return this.bindings[s]?this.bindings[s].push(l):this.bindings[s]=[l],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var l;return!(((l=s.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Da.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ir.close,{},e)}_onError(e){this._on(ir.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ht.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=il(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=il(e.columns,e.old_record)),t}}const ol=()=>{},Ki={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Yd=[1e3,2e3,5e3,1e4],Jd=1e4,Xd=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Qd{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=la,this.transport=null,this.heartbeatIntervalMs=Ki.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ol,this.ref=0,this.reconnectTimer=null,this.logger=ol,this.conn=null,this.sendBuffer=[],this.serializer=new Wd,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let l;return s?l=s:typeof fetch>"u"?l=(...c)=>Ei(async()=>{const{default:h}=await Promise.resolve().then(()=>Yn);return{default:h}},void 0,import.meta.url).then(({default:h})=>h(...c)).catch(h=>{throw new Error(`Failed to load @supabase/node-fetch: ${h.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ua.websocket}`,this.httpEndpoint=pu(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dd.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ud}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case fi.connecting:return sn.Connecting;case fi.open:return sn.Open;case fi.closing:return sn.Closing;default:return sn.Closed}}isConnected(){return this.connectionState()===sn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(l=>l.topic===n);if(s)return s;{const l=new Da(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:n,payload:s,ref:l}=e,c=()=>{this.encode(e,h=>{var v;(v=this.conn)===null||v===void 0||v.send(h)})};this.log("push",`${t} ${n} (${l})`,s),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Bd,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Ki.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:l,ref:c}=t,h=c?`(${c})`:"",v=l.status||"";this.log("receive",`${v} ${n} ${s} ${h}`.trim(),l),this.channels.filter(g=>g._isMember(n)).forEach(g=>g._trigger(s,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ir.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${n}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([Xd],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const s={access_token:t,version:Fd};t&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(ir.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new fu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ki.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,s,l,c,h,v,g;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:la,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Ki.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(m=>Yd[m-1]||Jd),this.encode=(v=e?.encode)!==null&&v!==void 0?v:((m,k)=>k(JSON.stringify(m))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class $a extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ft(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Zd extends $a{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class da extends $a{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var eh=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};const gu=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Ei(async()=>{const{default:n}=await Promise.resolve().then(()=>Yn);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},th=()=>eh(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ei(()=>Promise.resolve().then(()=>Yn),void 0,import.meta.url)).Response:Response}),ha=r=>{if(Array.isArray(r))return r.map(t=>ha(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,n])=>{const s=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[s]=ha(n)}),e},rh=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var _n=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};const Ks=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),nh=(r,e,t)=>_n(void 0,void 0,void 0,function*(){const n=yield th();r instanceof n&&!t?.noResolveJson?r.json().then(s=>{const l=r.status||500,c=s?.statusCode||l+"";e(new Zd(Ks(s),l,c))}).catch(s=>{e(new da(Ks(s),s))}):e(new da(Ks(r),r))}),ih=(r,e,t,n)=>{const s={method:r,headers:e?.headers||{}};return r==="GET"||!n?s:(rh(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(n)):s.body=n,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Ai(r,e,t,n,s,l){return _n(this,void 0,void 0,function*(){return new Promise((c,h)=>{r(t,ih(e,n,s,l)).then(v=>{if(!v.ok)throw v;return n?.noResolveJson?v:v.json()}).then(v=>c(v)).catch(v=>nh(v,h,n))})})}function us(r,e,t,n){return _n(this,void 0,void 0,function*(){return Ai(r,"GET",e,t,n)})}function fr(r,e,t,n,s){return _n(this,void 0,void 0,function*(){return Ai(r,"POST",e,n,s,t)})}function fa(r,e,t,n,s){return _n(this,void 0,void 0,function*(){return Ai(r,"PUT",e,n,s,t)})}function sh(r,e,t,n){return _n(this,void 0,void 0,function*(){return Ai(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function _u(r,e,t,n,s){return _n(this,void 0,void 0,function*(){return Ai(r,"DELETE",e,n,s,t)})}var Pt=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};const ah={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ll={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class oh{constructor(e,t={},n,s){this.url=e,this.headers=t,this.bucketId=n,this.fetch=gu(s)}uploadOrUpdate(e,t,n,s){return Pt(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},ll),s);let h=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const v=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),v&&l.append("metadata",this.encodeMetadata(v)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),v&&l.append("metadata",this.encodeMetadata(v))):(l=n,h["cache-control"]=`max-age=${c.cacheControl}`,h["content-type"]=c.contentType,v&&(h["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),s?.headers&&(h=Object.assign(Object.assign({},h),s.headers));const g=this._removeEmptyFolders(t),m=this._getFinalPath(g),k=yield(e=="PUT"?fa:fr)(this.fetch,`${this.url}/object/${m}`,l,Object.assign({headers:h},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:k.Id,fullPath:k.Key},error:null}}catch(l){if(ft(l))return{data:null,error:l};throw l}})}upload(e,t,n){return Pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,s){return Pt(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),h=new URL(this.url+`/object/upload/sign/${c}`);h.searchParams.set("token",t);try{let v;const g=Object.assign({upsert:ll.upsert},s),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&n instanceof Blob?(v=new FormData,v.append("cacheControl",g.cacheControl),v.append("",n)):typeof FormData<"u"&&n instanceof FormData?(v=n,v.append("cacheControl",g.cacheControl)):(v=n,m["cache-control"]=`max-age=${g.cacheControl}`,m["content-type"]=g.contentType);const k=yield fa(this.fetch,h.toString(),v,{headers:m});return{data:{path:l,fullPath:k.Key},error:null}}catch(v){if(ft(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return Pt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const l=yield fr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),c=new URL(this.url+l.url),h=c.searchParams.get("token");if(!h)throw new $a("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:h},error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}update(e,t,n){return Pt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return Pt(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(ft(s))return{data:null,error:s};throw s}})}copy(e,t,n){return Pt(this,void 0,void 0,function*(){try{return{data:{path:(yield fr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(ft(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,n){return Pt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),l=yield fr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n?.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(s){if(ft(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,n){return Pt(this,void 0,void 0,function*(){try{const s=yield fr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(s){if(ft(s))return{data:null,error:s};throw s}})}download(e,t){return Pt(this,void 0,void 0,function*(){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const h=this._getFinalPath(e);return{data:yield(yield us(this.fetch,`${this.url}/${s}/${h}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(h){if(ft(h))return{data:null,error:h};throw h}})}info(e){return Pt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield us(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ha(n),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}exists(e){return Pt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield sh(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(ft(n)&&n instanceof da){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),s=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&s.push(l);const h=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&s.push(v);let g=s.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${h}/public/${n}${g}`)}}}remove(e){return Pt(this,void 0,void 0,function*(){try{return{data:yield _u(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}list(e,t,n){return Pt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ah),t),{prefix:e||""});return{data:yield fr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(ft(s))return{data:null,error:s};throw s}})}listV2(e,t){return Pt(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield fr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const lh="2.11.0",uh={"X-Client-Info":`storage-js/${lh}`};var Tn=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};class ch{constructor(e,t={},n,s){const l=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},uh),t),this.fetch=gu(n)}listBuckets(){return Tn(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(ft(e))return{data:null,error:e};throw e}})}getBucket(e){return Tn(this,void 0,void 0,function*(){try{return{data:yield us(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Tn(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return Tn(this,void 0,void 0,function*(){try{return{data:yield fa(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Tn(this,void 0,void 0,function*(){try{return{data:yield fr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Tn(this,void 0,void 0,function*(){try{return{data:yield _u(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}})}}class dh extends ch{constructor(e,t={},n,s){super(e,t,n,s)}from(e){return new oh(this.url,this.headers,e,this.fetch)}}const hh="2.56.0";let ui="";typeof Deno<"u"?ui="deno":typeof document<"u"?ui="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ui="react-native":ui="node";const fh={"X-Client-Info":`supabase-js-${ui}/${hh}`},vh={headers:fh},ph={schema:"public"},gh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_h={};var mh=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};const yh=r=>{let e;return r?e=r:typeof fetch>"u"?e=ou:e=fetch,(...t)=>e(...t)},wh=()=>typeof Headers>"u"?lu:Headers,bh=(r,e,t)=>{const n=yh(t),s=wh();return(l,c)=>mh(void 0,void 0,void 0,function*(){var h;const v=(h=yield e())!==null&&h!==void 0?h:r;let g=new s(c?.headers);return g.has("apikey")||g.set("apikey",r),g.has("Authorization")||g.set("Authorization",`Bearer ${v}`),n(l,Object.assign(Object.assign({},c),{headers:g}))})};var kh=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};function Eh(r){return r.endsWith("/")?r:r+"/"}function Ah(r,e){var t,n;const{db:s,auth:l,realtime:c,global:h}=r,{db:v,auth:g,realtime:m,global:k}=e,E={db:Object.assign(Object.assign({},v),s),auth:Object.assign(Object.assign({},g),l),realtime:Object.assign(Object.assign({},m),c),storage:{},global:Object.assign(Object.assign(Object.assign({},k),h),{headers:Object.assign(Object.assign({},(t=k?.headers)!==null&&t!==void 0?t:{}),(n=h?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>kh(this,void 0,void 0,function*(){return""})};return r.accessToken?E.accessToken=r.accessToken:delete E.accessToken,E}const mu="2.71.1",Mn=30*1e3,va=3,Ys=va*Mn,Sh="http://localhost:9999",Ih="supabase.auth.token",Ch={"X-Client-Info":`gotrue-js/${mu}`},pa="X-Supabase-Api-Version",yu={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Th=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ph=600*1e3;class Fa extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function be(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class xh extends Fa{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function Rh(r){return be(r)&&r.name==="AuthApiError"}class wu extends Fa{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Hr extends Fa{constructor(e,t,n,s){super(e,n,s),this.name=t,this.status=n}}class Dr extends Hr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Oh(r){return be(r)&&r.name==="AuthSessionMissingError"}class Yi extends Hr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ji extends Hr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Xi extends Hr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jh(r){return be(r)&&r.name==="AuthImplicitGrantRedirectError"}class ul extends Hr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ga extends Hr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Js(r){return be(r)&&r.name==="AuthRetryableFetchError"}class cl extends Hr{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class _a extends Hr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),dl=` 	
\r=`.split(""),Mh=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<dl.length;e+=1)r[dl[e].charCodeAt(0)]=-2;for(let e=0;e<cs.length;e+=1)r[cs[e].charCodeAt(0)]=e;return r})();function hl(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(cs[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(cs[n]),e.queuedBits-=6}}function bu(r,e,t){const n=Mh[r];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function fl(r){const e=[],t=c=>{e.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},l=c=>{$h(c,n,t)};for(let c=0;c<r.length;c+=1)bu(r.charCodeAt(c),s,l);return e.join("")}function Lh(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function Dh(r,e){for(let t=0;t<r.length;t+=1){let n=r.charCodeAt(t);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(r.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}Lh(n,e)}}function $h(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let n=1;n<6;n+=1)if((r>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Fh(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<r.length;s+=1)bu(r.charCodeAt(s),t,n);return new Uint8Array(e)}function Uh(r){const e=[];return Dh(r,t=>e.push(t)),new Uint8Array(e)}function Bh(r){const e=[],t={queue:0,queuedBits:0},n=s=>{e.push(s)};return r.forEach(s=>hl(s,t,n)),hl(null,t,n),e.join("")}function Nh(r){return Math.round(Date.now()/1e3)+r}function Wh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const nr=()=>typeof window<"u"&&typeof document<"u",Zr={tested:!1,writable:!1},ku=()=>{if(!nr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zr.tested)return Zr.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Zr.tested=!0,Zr.writable=!0}catch{Zr.tested=!0,Zr.writable=!1}return Zr.writable};function Vh(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,l)=>{e[l]=s})}catch{}return t.searchParams.forEach((n,s)=>{e[s]=n}),e}const Eu=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Ei(async()=>{const{default:n}=await Promise.resolve().then(()=>Yn);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},qh=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Ln=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},en=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Lr=async(r,e)=>{await r.removeItem(e)};class Es{constructor(){this.promise=new Es.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Es.promiseConstructor=Promise;function Xs(r){const e=r.split(".");if(e.length!==3)throw new _a("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!Th.test(e[n]))throw new _a("JWT not in base64url format");return{header:JSON.parse(fl(e[0])),payload:JSON.parse(fl(e[1])),signature:Fh(e[2]),raw:{header:e[0],payload:e[1]}}}async function Hh(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function zh(r,e){return new Promise((n,s)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await r(l);if(!e(l,null,c)){n(c);return}}catch(c){if(!e(l,c)){s(c);return}}})()})}function Gh(r){return("0"+r.toString(16)).substr(-2)}function Kh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let s="";for(let l=0;l<56;l++)s+=t.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Gh).join("")}async function Yh(r){const t=new TextEncoder().encode(r),n=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(n);return Array.from(s).map(l=>String.fromCharCode(l)).join("")}async function Jh(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Yh(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Pn(r,e,t=!1){const n=Kh();let s=n;t&&(s+="/PASSWORD_RECOVERY"),await Ln(r,`${e}-code-verifier`,s);const l=await Jh(n);return[l,n===l?"plain":"s256"]}const Xh=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Qh(r){const e=r.headers.get(pa);if(!e||!e.match(Xh))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Zh(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function ef(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const tf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xn(r){if(!tf.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Qs(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function vl(r){return JSON.parse(JSON.stringify(r))}var rf=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};const rn=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),nf=[502,503,504];async function pl(r){var e;if(!qh(r))throw new ga(rn(r),0);if(nf.includes(r.status))throw new ga(rn(r),r.status);let t;try{t=await r.json()}catch(l){throw new wu(rn(l),l)}let n;const s=Qh(r);if(s&&s.getTime()>=yu["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new cl(rn(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Dr}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new cl(rn(t),r.status,t.weak_password.reasons);throw new xh(rn(t),r.status||500,n)}const sf=(r,e,t,n)=>{const s={method:r,headers:e?.headers||{}};return r==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),t))};async function je(r,e,t,n){var s;const l=Object.assign({},n?.headers);l[pa]||(l[pa]=yu["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(c.redirect_to=n.redirectTo);const h=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",v=await af(r,e,t+h,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(v):{data:Object.assign({},v),error:null}}async function af(r,e,t,n,s,l){const c=sf(e,n,s,l);let h;try{h=await r(t,Object.assign({},c))}catch(v){throw console.error(v),new ga(rn(v),0)}if(h.ok||await pl(h),n?.noResolveJson)return h;try{return await h.json()}catch(v){await pl(v)}}function Ar(r){var e;let t=null;cf(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Nh(r.expires_in)));const n=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:n},error:null}}function gl(r){const e=Ar(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=r.weak_password),e}function $r(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function of(r){return{data:r,error:null}}function lf(r){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:l}=r,c=rf(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),h={action_link:e,email_otp:t,hashed_token:n,redirect_to:s,verification_type:l},v=Object.assign({},c);return{data:{properties:h,user:v},error:null}}function uf(r){return r}function cf(r){return r.access_token&&r.refresh_token&&r.expires_in}const Zs=["global","local","others"];var df=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(r);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(r,n[s])&&(t[n[s]]=r[n[s]]);return t};class hf{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=Eu(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Zs[0]){if(Zs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zs.join(", ")}`);try{return await je(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await je(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:$r})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=df(e,["options"]),s=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await je(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:lf,redirectTo:t?.redirectTo})}catch(t){if(be(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await je(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:$r})}catch(t){if(be(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,s,l,c,h,v;try{const g={nextPage:null,lastPage:0,total:0},m=await je(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&l!==void 0?l:""},xform:uf});if(m.error)throw m.error;const k=await m.json(),E=(c=m.headers.get("x-total-count"))!==null&&c!==void 0?c:0,_=(v=(h=m.headers.get("link"))===null||h===void 0?void 0:h.split(","))!==null&&v!==void 0?v:[];return _.length>0&&(_.forEach(S=>{const D=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(S.split(";")[1].split("=")[1]);g[`${R}Page`]=D}),g.total=parseInt(E)),{data:Object.assign(Object.assign({},k),g),error:null}}catch(g){if(be(g))return{data:{users:[]},error:g};throw g}}async getUserById(e){xn(e);try{return await je(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:$r})}catch(t){if(be(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){xn(e);try{return await je(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:$r})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){xn(e);try{return await je(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:$r})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){xn(e.userId);try{const{data:t,error:n}=await je(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:n}}catch(t){if(be(t))return{data:null,error:t};throw t}}async _deleteFactor(e){xn(e.userId),xn(e.id);try{return{data:await je(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(be(t))return{data:null,error:t};throw t}}}function _l(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function ff(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Rn={debug:!!(globalThis&&ku()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Au extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vf extends Au{}async function pf(r,e,t){Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,s.name);try{return await t()}finally{Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,s.name)}}else{if(e===0)throw Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new vf(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Rn.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}ff();const gf={url:Sh,storageKey:Ih,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ch,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ml(r,e,t){return await t()}const On={};class yi{constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=yi.nextInstanceID,yi.nextInstanceID+=1,this.instanceID>0&&nr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},gf),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new hf({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Eu(s.fetch),this.lock=s.lock||ml,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:nr()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=pf:this.lock=ml,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:ku()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=_l(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=_l(this.memoryStorage)),nr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=On[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){On[this.storageKey]=Object.assign(Object.assign({},On[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=On[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){On[this.storageKey]=Object.assign(Object.assign({},On[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${mu}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Vh(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),nr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),jh(l)){const v=(e=l.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:h}=s;return this._debug("#_initialize()","detected session in URL",c,"redirect type",h),await this._saveSession(c),setTimeout(async()=>{h==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return be(t)?{error:t}:{error:new wu("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,s;try{const l=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ar}),{data:c,error:h}=l;if(h||!c)return{data:{user:null,session:null},error:h};const v=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(l){if(be(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(e){var t,n,s;try{let l;if("email"in e){const{email:m,password:k,options:E}=e;let _=null,S=null;this.flowType==="pkce"&&([_,S]=await Pn(this.storage,this.storageKey)),l=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E?.emailRedirectTo,body:{email:m,password:k,data:(t=E?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E?.captchaToken},code_challenge:_,code_challenge_method:S},xform:Ar})}else if("phone"in e){const{phone:m,password:k,options:E}=e;l=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:k,data:(n=E?.data)!==null&&n!==void 0?n:{},channel:(s=E?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:E?.captchaToken}},xform:Ar})}else throw new Ji("You must provide either an email or phone number and a password");const{data:c,error:h}=l;if(h||!c)return{data:{user:null,session:null},error:h};const v=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(l){if(be(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:h}=e;t=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:gl})}else if("phone"in e){const{phone:l,password:c,options:h}=e;t=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:gl})}else throw new Ji("You must provide either an email or phone number and a password");const{data:n,error:s}=t;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Yi}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,s,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,n,s,l,c,h,v,g,m,k,E,_;let S,D;if("message"in e)S=e.message,D=e.signature;else{const{chain:R,wallet:U,statement:B,options:W}=e;let z;if(nr())if(typeof U=="object")z=U;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))z=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof U!="object"||!W?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");z=U}const K=new URL((t=W?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in z&&z.signIn){const O=await z.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},W?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),B?{statement:B}:null));let j;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")j=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)j=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)S=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),D=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in z)||typeof z.signMessage!="function"||!("publicKey"in z)||typeof z!="object"||!z.publicKey||!("toBase58"in z.publicKey)||typeof z.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${K.host} wants you to sign in with your Solana account:`,z.publicKey.toBase58(),...B?["",B,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(s=(n=W?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((l=W?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${W.signInWithSolana.notBefore}`]:[],...!((c=W?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${W.signInWithSolana.expirationTime}`]:[],...!((h=W?.signInWithSolana)===null||h===void 0)&&h.chainId?[`Chain ID: ${W.signInWithSolana.chainId}`]:[],...!((v=W?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${W.signInWithSolana.nonce}`]:[],...!((g=W?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${W.signInWithSolana.requestId}`]:[],...!((k=(m=W?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||k===void 0)&&k.length?["Resources",...W.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const O=await z.signMessage(new TextEncoder().encode(S),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=O}}try{const{data:R,error:U}=await je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:Bh(D)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Ar});if(U)throw U;return!R||!R.session||!R.user?{data:{user:null,session:null},error:new Yi}:(R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),{data:Object.assign({},R),error:U})}catch(R){if(be(R))return{data:{user:null,session:null},error:R};throw R}}async _exchangeCodeForSession(e){const t=await en(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(t??"").split("/");try{const{data:l,error:c}=await je(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Ar});if(await Lr(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Yi}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:s??null}),error:c})}catch(l){if(be(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(e){try{const{options:t,provider:n,token:s,access_token:l,nonce:c}=e,h=await je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ar}),{data:v,error:g}=h;return g?{data:{user:null,session:null},error:g}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new Yi}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:g})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,s,l,c;try{if("email"in e){const{email:h,options:v}=e;let g=null,m=null;this.flowType==="pkce"&&([g,m]=await Pn(this.storage,this.storageKey));const{error:k}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:h,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(n=v?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:g,code_challenge_method:m},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:k}}if("phone"in e){const{phone:h,options:v}=e,{data:g,error:m}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:h,data:(s=v?.data)!==null&&s!==void 0?s:{},create_user:(l=v?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(c=v?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:m}}throw new Ji("You must provide either an email or phone number.")}catch(h){if(be(h))return{data:{user:null,session:null},error:h};throw h}}async verifyOtp(e){var t,n;try{let s,l;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:h}=await je(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:s,xform:Ar});if(h)throw h;if(!c)throw new Error("An error occurred on token verification.");const v=c.session,g=c.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(s){if(be(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,n,s;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Pn(this.storage,this.storageKey)),await je(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:of})}catch(l){if(be(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Dr;const{error:s}=await je(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(be(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:l}=e,{error:c}=await je(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:n,type:s,options:l}=e,{data:c,error:h}=await je(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:h}}throw new Ji("You must provide either an email or phone number and a type")}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await en(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ys:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const c=await en(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=Qs()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(v,g,m)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,g,m))})}return{data:{session:e},error:null}}const{session:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:$r}):await this._useSession(async t=>{var n,s,l;const{data:c,error:h}=t;if(h)throw h;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dr}:await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(s=c.session)===null||s===void 0?void 0:s.access_token)!==null&&l!==void 0?l:void 0,xform:$r})})}catch(t){if(be(t))return Oh(t)&&(await this._removeSession(),await Lr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:s,error:l}=n;if(l)throw l;if(!s.session)throw new Dr;const c=s.session;let h=null,v=null;this.flowType==="pkce"&&e.email!=null&&([h,v]=await Pn(this.storage,this.storageKey));const{data:g,error:m}=await je(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:h,code_challenge_method:v}),jwt:c.access_token,xform:$r});if(m)throw m;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(be(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Dr;const t=Date.now()/1e3;let n=t,s=!0,l=null;const{payload:c}=Xs(e.access_token);if(c.exp&&(n=c.exp,s=n<=t),s){const{session:h,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!h)return{data:{user:null,session:null},error:null};l=h}else{const{data:h,error:v}=await this._getUser(e.access_token);if(v)throw v;l={access_token:e.access_token,refresh_token:e.refresh_token,user:h.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(be(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:c,error:h}=t;if(h)throw h;e=(n=c.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new Dr;const{session:s,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(be(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!nr())throw new Xi("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Xi(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new ul("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Xi("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ul("No code detected.");const{data:B,error:W}=await this._exchangeCodeForSession(e.code);if(W)throw W;const z=new URL(window.location.href);return z.searchParams.delete("code"),window.history.replaceState(window.history.state,"",z.toString()),{data:{session:B.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:l,refresh_token:c,expires_in:h,expires_at:v,token_type:g}=e;if(!l||!h||!c||!g)throw new Xi("No session defined in URL");const m=Math.round(Date.now()/1e3),k=parseInt(h);let E=m+k;v&&(E=parseInt(v));const _=E-m;_*1e3<=Mn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${k}s`);const S=E-k;m-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,E,m):m-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,E,m);const{data:D,error:R}=await this._getUser(l);if(R)throw R;const U={provider_token:n,provider_refresh_token:s,access_token:l,expires_in:k,expires_at:E,refresh_token:c,token_type:g,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:U,redirectType:e.type},error:null}}catch(n){if(be(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await en(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:s,error:l}=t;if(l)return{error:l};const c=(n=s.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:h}=await this.admin.signOut(c,e);if(h&&!(Rh(h)&&(h.status===404||h.status===401||h.status===403)))return{error:h}}return e!=="others"&&(await this._removeSession(),await Lr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Wh(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,s;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Pn(this.storage,this.storageKey,!0));try{return await je(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(be(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(be(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:s}=await this._useSession(async l=>{var c,h,v,g,m;const{data:k,error:E}=l;if(E)throw E;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(h=e.options)===null||h===void 0?void 0:h.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await je(this.fetch,"GET",_,{headers:this.headers,jwt:(m=(g=k.session)===null||g===void 0?void 0:g.access_token)!==null&&m!==void 0?m:void 0})});if(s)throw s;return nr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(be(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,s;const{data:l,error:c}=t;if(c)throw c;return await je(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await zh(async s=>(s>0&&await Hh(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await je(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ar})),(s,l)=>{const c=200*Math.pow(2,s);return l&&Js(l)&&Date.now()+c-n<Mn})}catch(n){if(this._debug(t,"error",n),be(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),nr()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await en(this.storage,this.storageKey);if(s&&this.userStorage){let c=await en(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:s.user},await Ln(this.userStorage,this.storageKey+"-user",c)),s.user=(e=c?.user)!==null&&e!==void 0?e:Qs()}else if(s&&!s.user&&!s.user){const c=await en(this.storage,this.storageKey+"-user");c&&c?.user?(s.user=c.user,await Lr(this.storage,this.storageKey+"-user"),await Ln(this.storage,this.storageKey,s)):s.user=Qs()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const l=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ys;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${Ys}s`),l){if(this.autoRefreshToken&&s.refresh_token){const{error:c}=await this._callRefreshToken(s.refresh_token);c&&(console.error(c),Js(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:h}=await this._getUser(s.access_token);!h&&c?.user?(s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Dr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Es;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Dr;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const h={session:l.session,error:null};return this.refreshingDeferred.resolve(h),h}catch(l){if(this._debug(s,"error",l),be(l)){const c={session:null,error:l};return Js(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async h=>{try{await h.callback(e,t)}catch(v){l.push(v)}});if(await Promise.all(c),l.length>0){for(let h=0;h<l.length;h+=1)console.error(l[h]);throw l[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await Ln(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const l=vl(s);await Ln(this.storage,this.storageKey,l)}else{const s=vl(t);await Ln(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Lr(this.storage,this.storageKey),await Lr(this.storage,this.storageKey+"-code-verifier"),await Lr(this.storage,this.storageKey+"-user"),this.userStorage&&await Lr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&nr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Mn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Mn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Mn}ms, refresh threshold is ${va} ticks`),s<=va&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Au)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!nr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const s=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await Pn(this.storage,this.storageKey),h=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});s.push(h.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);s.push(l.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:s,error:l}=t;return l?{data:null,error:l}:await je(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,s;const{data:l,error:c}=t;if(c)return{data:null,error:c};const h=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:v,error:g}=await je(this.fetch,"POST",`${this.url}/factors`,{body:h,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return g?{data:null,error:g}:(e.factorType==="totp"&&(!((s=v?.totp)===null||s===void 0)&&s.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(t){if(be(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:h}=await je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:h})})}catch(t){if(be(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:s,error:l}=t;return l?{data:null,error:l}:await je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(be(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=e?.factors||[],s=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:s,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:s},error:l}=e;if(l)return{data:null,error:l};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Xs(s.access_token);let h=null;c.aal&&(h=c.aal);let v=h;((n=(t=s.user.factors)===null||t===void 0?void 0:t.filter(k=>k.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(v="aal2");const m=c.amr||[];return{data:{currentLevel:h,nextLevel:v,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(h=>h.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(h=>h.kid===e),n&&this.jwks_cached_at+Ph>s)return n;const{data:l,error:c}=await je(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=s,n=l.keys.find(h=>h.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:_,error:S}=await this.getSession();if(S||!_.session)return{data:null,error:S};n=_.session.access_token}const{header:s,payload:l,signature:c,raw:{header:h,payload:v}}=Xs(n);t?.allowExpired||Zh(l.exp);const g=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:_}=await this.getUser(n);if(_)throw _;return{data:{claims:l,header:s,signature:c},error:null}}const m=ef(s.alg),k=await crypto.subtle.importKey("jwk",g,m,!0,["verify"]);if(!await crypto.subtle.verify(m,k,c,Uh(`${h}.${v}`)))throw new _a("Invalid JWT signature");return{data:{claims:l,header:s,signature:c},error:null}}catch(n){if(be(n))return{data:null,error:n};throw n}}}yi.nextInstanceID=0;const _f=yi;class mf extends _f{constructor(e){super(e)}}var yf=function(r,e,t,n){function s(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function h(m){try{g(n.next(m))}catch(k){c(k)}}function v(m){try{g(n.throw(m))}catch(k){c(k)}}function g(m){m.done?l(m.value):s(m.value).then(h,v)}g((n=n.apply(r,e||[])).next())})};class wf{constructor(e,t,n){var s,l,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=Eh(e),v=new URL(h);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const g=`sb-${v.hostname.split(".")[0]}-auth-token`,m={db:ph,realtime:_h,auth:Object.assign(Object.assign({},gh),{storageKey:g}),global:vh},k=Ah(n??{},m);this.storageKey=(s=k.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(l=k.global.headers)!==null&&l!==void 0?l:{},k.accessToken?(this.accessToken=k.accessToken,this.auth=new Proxy({},{get:(E,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=k.auth)!==null&&c!==void 0?c:{},this.headers,k.global.fetch),this.fetch=bh(t,this._getAccessToken.bind(this),k.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},k.realtime)),this.rest=new Ld(new URL("rest/v1",v).href,{headers:this.headers,schema:k.db.schema,fetch:this.fetch}),this.storage=new dh(this.storageUrl.href,this.headers,this.fetch,n?.storage),k.accessToken||this._listenForAuthEvents()}get functions(){return new Ed(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return yf(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,storageKey:l,flowType:c,lock:h,debug:v},g,m){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new mf({url:this.authUrl.href,headers:Object.assign(Object.assign({},k),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:s,flowType:c,lock:h,debug:v,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Qd(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bf=(r,e,t)=>new wf(r,e,t);function kf(){if(typeof window<"u"||typeof process>"u")return!1;const r=process.version;if(r==null)return!1;const e=r.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}kf()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ef="https://vycjpmuyscfygstjjied.supabase.co",Af="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",Ir=bf(Ef,Af,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}}),Vr={async loadStoriesList(){if(!x.selectedBucket){console.warn("[ResourceStore] No bucket selected");return}console.log(`[ResourceStore] Формирование имени файла для bucket: ${x.selectedBucket}`);const r=`${x.selectedBucket}_story.json`,{data:e,error:t}=await Ir.storage.from(x.selectedBucket).list("",{search:r});console.log(`[ResourceStore] Проверка файла ${r}:`,{files:e,error:t}),!t&&e&&e.some(n=>n.name===r)?(x.storiesList=[r],console.log(`[ResourceStore] Найден файл: ${r}`)):(x.storiesList=[],console.warn(`[ResourceStore] Файл ${r} не найден`))},async loadStoredResources(){if(!x.selectedBucket){console.warn("No bucket selected");return}const{data:r}=await Ir.storage.from(x.selectedBucket).list();r&&(x.storedFiles=r.filter(e=>e.name!==".emptyFolderPlaceholder"&&!e.name.endsWith(".json")))},async uploadNewFile(r){const e=r.target;if(!e.files||e.files.length===0)return;if(!x.selectedBucket){tt.setStatus("error","Не выбрана история");return}const t=e.files[0];tt.setStatus("loading","Загрузка файла...");const{error:n}=await Ir.storage.from(x.selectedBucket).upload(t.name,t,{upsert:!0});n?tt.setStatus("error","Ошибка загрузки"):(tt.setStatus("success","Файл загружен"),await this.loadStoredResources())},async deleteFile(r){if(!x.selectedBucket){tt.setStatus("error","Не выбрана история");return}const{error:e}=await Ir.storage.from(x.selectedBucket).remove([r]);e?tt.setStatus("error","Ошибка удаления файла"):(tt.setStatus("success","Файл удален"),await this.loadStoredResources())}};function Sf(r){return r.dialogues&&r.dialogues.forEach(e=>{e.options&&e.options.forEach(t=>{typeof t.enabled>"u"&&(t.enabled=!0),typeof t.visible>"u"&&(t.visible=!0),t.visibleIf&&!t.visibilityCondition&&(t.visibleIf.hasItem&&(t.visibilityCondition={type:"has_item",itemId:t.visibleIf.hasItem}),delete t.visibleIf),t.visibilityCondition||(t.visibilityCondition={type:"always"})})}),r.chapters||(r.chapters=[{id:"main",title:"Основная история"}],r.dialogues&&r.dialogues.forEach(e=>{e.chapterId||(e.chapterId="main")})),r.items||(r.items=[]),r.meta||(r.meta={version:"3.1",title:r.title||"Untitled"}),r.miniGames&&Array.isArray(r.miniGames)&&(r.miniGames=r.miniGames.map(e=>e.id&&!e.onWinDialogueId?{...e,onWinDialogueId:e.winTarget||"",onLoseDialogueId:e.loseTarget||""}:e)),r}function If(){return{text:"Новый вариант",enabled:!0,visible:!0,visibilityCondition:{type:"always"}}}const ln={async createNewStory(){if(!x.selectedBucket){tt.setStatus("error","Не выбрана история (bucket)");return}const r=prompt("Введите имя файла истории:","new_story.json");if(!r)return;const e={meta:{version:"3.1",title:"New Story"},chapters:[{id:"ch1",title:"Глава 1"}],dialogues:[{id:"start",chapterId:"ch1",text:"Начало...",options:[]}]},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),{error:n}=await Ir.storage.from(x.selectedBucket).upload(r,t);n?tt.setStatus("error","Ошибка создания: "+n.message):(await Vr.loadStoriesList(),await this.loadStory(r))},async loadStory(r){if(!x.selectedBucket){tt.setStatus("error","Не выбрана история (bucket)");return}console.log(`[StoryStore] Загрузка истории: ${r} из bucket: ${x.selectedBucket}`),tt.setStatus("loading","Загрузка..."),x.currentFileName=r;try{const{data:e,error:t}=await Ir.storage.from(x.selectedBucket).download(r);console.log("[StoryStore] Результат загрузки (download):",{hasData:!!e,error:t});let n;if(t){console.warn("[StoryStore] Ошибка download, пробуем публичный URL:",t);const l=Ir.storage.from(x.selectedBucket).getPublicUrl(r).data.publicUrl;console.log(`[StoryStore] Публичный URL: ${l}`);const c=await fetch(l);if(!c.ok)throw new Error(`Не удалось загрузить файл: ${c.statusText}`);n=await c.text(),console.log(`[StoryStore] Данные загружены через публичный URL, длина: ${n.length}`)}else n=await e.text(),console.log(`[StoryStore] Данные загружены через download, длина: ${n.length}`);let s=JSON.parse(n);console.log("[StoryStore] Данные распарсены:",{meta:s.meta,chaptersCount:s.chapters?.length,dialoguesCount:s.dialogues?.length,itemsCount:s.items?.length}),s=Sf(s),console.log("[StoryStore] Присваиваем данные в editor.data"),x.data=s,console.log("[StoryStore] editor.data обновлен:",{chapters:x.data.chapters?.length,dialogues:x.data.dialogues?.length}),x.data.chapters&&x.data.chapters.length>0&&(x.selectedChapterId=x.data.chapters[0].id,console.log(`[StoryStore] Выбрана глава: ${x.selectedChapterId}`)),x.data.dialogues&&x.data.dialogues.length>0&&(x.selectedDialogueId=x.data.dialogues[0].id,console.log(`[StoryStore] Выбран диалог: ${x.selectedDialogueId}`)),console.log("[StoryStore] Загрузка завершена успешно"),tt.setStatus("success","Загружено!")}catch(e){console.error("[StoryStore] Ошибка загрузки:",e),tt.setStatus("error","Ошибка загрузки: "+e.message)}},async saveCurrentStory(){if(!x.data)return;if(!x.selectedBucket){tt.setStatus("error","Не выбрана история (bucket)");return}tt.setStatus("loading","Сохранение...");const r=new Blob([JSON.stringify(x.data,null,2)],{type:"application/json"}),{error:e}=await Ir.storage.from(x.selectedBucket).upload(x.currentFileName,r,{upsert:!0});tt.setStatus(e?"error":"success",e?"Ошибка сохранения":"Сохранено!")},async saveStoryCopy(){if(!x.data)return;if(!x.selectedBucket){tt.setStatus("error","Не выбрана история (bucket)");return}const r=x.currentFileName.replace(".json",""),e=new Date().getTime();let t=`${r}_copy_${e}.json`.trim();const n=prompt("Введите имя для копии:",t);if(!n)return;t=n.trim(),t.endsWith(".json")||(t+=".json"),tt.setStatus("loading","Создание копии...");const s=new Blob([JSON.stringify(x.data,null,2)],{type:"application/json"}),{error:l}=await Ir.storage.from(x.selectedBucket).upload(t,s,{upsert:!0});l?tt.setStatus("error",`Ошибка копии: ${l.message}`):(await Vr.loadStoriesList(),tt.setStatus("success","Копия сохранена!"))},addChapter(){if(!x.data||!x.data.chapters)return;const r="ch_"+Date.now();x.data.chapters.push({id:r,title:"Новая глава"}),x.selectedChapterId=r},addDialogue(){if(!x.data||!x.selectedChapterId)return;const r="d_"+Date.now();x.data.dialogues.push({id:r,chapterId:x.selectedChapterId,text:"Новый текст...",options:[]}),x.selectedDialogueId=r},deleteDialogue(r){confirm("Удалить диалог "+r+"?")&&x.data&&(x.data.dialogues=x.data.dialogues.filter(e=>e.id!==r),x.data.dialogues.forEach(e=>{e.nextDialogueId===r&&(e.nextDialogueId=""),e.options&&e.options.forEach(t=>{t.nextDialogueId===r&&(t.nextDialogueId="")})}),x.selectedDialogueId===r&&(x.selectedDialogueId=null))},jumpTo(r){const e=x.data?.dialogues.find(t=>t.id===r);e&&(x.selectedChapterId=e.chapterId,x.selectedDialogueId=r)},getLinkType(r,e){return r.nextDialogueId===e?"Auto":"Option"}};var rr=Kn(()=>x),Cf=ue("<div> </div>"),Tf=ue('<div><span class="id-badge svelte-chskml"> </span> <span class="preview-text svelte-chskml"> </span></div>'),Pf=ue("<div> </div>"),xf=ue('<aside class="sidebar svelte-chskml"><div class="sidebar-section svelte-chskml"><div class="section-header"><h3>Главы</h3> <button class="btn-icon">+</button></div> <div class="chapter-list svelte-chskml"></div></div> <div class="sidebar-section flex-1 svelte-chskml"><div class="section-header"><h3> </h3> <button class="btn-icon">+</button></div> <div class="dialogue-list svelte-chskml"></div></div> <div class="status-box svelte-chskml"><!></div></aside>');function Rf(r,e){Jt(e,!1),gn();var t=xf(),n=$(t),s=$(n),l=N($(s),2);l.__click=function(...R){ln.addChapter?.apply(this,R)};var c=N(s,2);St(c,5,()=>rr().data?.chapters||[],R=>R.id,(R,U)=>{var B=Cf();let W;B.__click=()=>rr(rr().selectedChapterId=F(U).id);var z=$(B);Ce(K=>{W=Nr(B,1,"chapter-item svelte-chskml",null,W,K),Le(z,F(U).title)},[()=>({active:rr().selectedChapterId===F(U).id})]),ee(R,B)});var h=N(n,2),v=$(h),g=$(v),m=$(g),k=N(g,2);k.__click=function(...R){ln.addDialogue?.apply(this,R)};var E=N(v,2);St(E,5,()=>Et.chapterDialogues,R=>R.id,(R,U)=>{var B=Tf();let W;B.__click=()=>rr(rr().selectedDialogueId=F(U).id);var z=$(B),K=$(z),O=N(z,2),j=$(O);Ce((ie,X)=>{W=Nr(B,1,"dialogue-item svelte-chskml",null,W,ie),Le(K,F(U).id),Le(j,`${X??""}...`)},[()=>({active:rr().selectedDialogueId===F(U).id}),()=>F(U).text.substring(0,25)]),ee(R,B)});var _=N(h,2),S=$(_);{var D=R=>{var U=Pf(),B=$(U);Ce(()=>{Nr(U,1,`alert ${rr().statusMessage.type??""}`,"svelte-chskml"),Le(B,rr().statusMessage.text)}),ee(R,U)};$e(S,R=>{rr().statusMessage.text&&R(D)})}Ce(()=>{Le(m,`Сцены (${Et.chapterDialogues.length??""})`),k.disabled=!rr().selectedChapterId}),ee(r,t),Xt()}xr(["click"]);var Of=ue("<option> </option>"),jf=ue("<option> </option>"),Mf=ue("<option> </option>"),Lf=ue('<div class="form-group full-width svelte-1br6fha"><label>Предмет</label> <select class="input select"><option>-- Выберите предмет --</option><!></select></div>'),Df=ue('<div class="form-group svelte-1br6fha"><label>Стата</label> <input type="text" class="input" placeholder="knowledge"/></div> <div class="form-group svelte-1br6fha"><label>Значение ></label> <input type="number" class="input"/></div>',1),$f=ue('<div class="form-group full-width svelte-1br6fha"><label>Имя флага</label> <input type="text" class="input" placeholder="metDracula"/></div>'),Ff=ue('<div class="option-details svelte-1br6fha"><div class="form-group"><label>Текст кнопки</label> <input type="text" class="input"/></div> <div class="form-group"><label>Переход</label> <select class="input select"><option>-- Конец ветки --</option><!></select></div> <div class="options-settings-grid svelte-1br6fha"><div class="setting-col svelte-1br6fha"><label class="checkbox-row svelte-1br6fha"><input type="checkbox"/> Включено (Enable)</label> <p class="setting-desc svelte-1br6fha">Если выключено, кнопка серая и не кликабельна.</p></div> <div class="setting-col svelte-1br6fha"><label class="checkbox-row svelte-1br6fha"><input type="checkbox"/> Видимо (Visible)</label> <p class="setting-desc svelte-1br6fha">Если скрыто, кнопки нет в списке.</p></div></div> <div class="trigger-section svelte-1br6fha"><h5 class="svelte-1br6fha">Условие видимости</h5> <div class="form-row svelte-1br6fha"><div class="form-group svelte-1br6fha"><label>Тип условия</label> <select class="input select"></select></div> <!> <!> <!></div></div></div>');function Uf(r,e){Jt(e,!0);const t=pd(e,"option");function n(){t().visibilityCondition||(t().visibilityCondition={type:"always"})}function s(){return n(),t().visibilityCondition}function l(J){n(),t().visibilityCondition={...t().visibilityCondition,...J}}var c=Ff(),h=$(c),v=N($(h),2),g=N(h,2),m=N($(g),2),k=$(m);k.value=k.__value="";var E=N(k);St(E,17,()=>e.dialogues,Gt,(J,ve)=>{var oe=Of(),Ke=$(oe),We={};Ce(xe=>{Le(Ke,`${F(ve).id??""}: ${xe??""}...`),We!==(We=F(ve).id)&&(oe.value=(oe.__value=F(ve).id)??"")},[()=>F(ve).text.substring(0,30)]),ee(J,oe)});var _=N(g,2),S=$(_),D=$(S),R=$(D),U=N(S,2),B=$(U),W=$(B),z=N(_,2),K=N($(z),2),O=$(K),j=N($(O),2);St(j,21,()=>e.conditionTypes,Gt,(J,ve)=>{var oe=jf(),Ke=$(oe),We={};Ce(()=>{Le(Ke,F(ve)),We!==(We=F(ve))&&(oe.value=(oe.__value=F(ve))??"")}),ee(J,oe)});var ie;aa(j);var X=N(O,2);{var ce=J=>{var ve=Lf(),oe=N($(ve),2),Ke=$(oe);Ke.value=Ke.__value="";var We=N(Ke);St(We,17,()=>e.availableItems,Gt,(Re,at)=>{var ye=Mf(),Pe=$(ye),ke={};Ce(()=>{Le(Pe,F(at).name),ke!==(ke=F(at).id)&&(ye.value=(ye.__value=F(at).id)??"")}),ee(Re,ye)});var xe;aa(oe),Ce(Re=>{xe!==(xe=Re)&&(oe.value=(oe.__value=Re)??"",ls(oe,Re))},[()=>s().itemId||""]),oi("change",oe,Re=>l({itemId:Re.target.value})),ee(J,ve)};$e(X,J=>{s().type==="has_item"&&J(ce)})}var Q=N(X,2);{var ne=J=>{var ve=Df(),oe=Ut(ve),Ke=N($(oe),2),We=N(oe,2),xe=N($(We),2);Ce((Re,at)=>{qs(Ke,Re),qs(xe,at)},[()=>s().statName||"",()=>s().statValue||""]),oi("input",Ke,Re=>l({statName:Re.target.value})),oi("input",xe,Re=>l({statValue:parseInt(Re.target.value)||0})),ee(J,ve)};$e(Q,J=>{s().type==="stat_greater"&&J(ne)})}var fe=N(Q,2);{var Fe=J=>{var ve=$f(),oe=N($(ve),2);Ce(Ke=>qs(oe,Ke),[()=>s().flagName||""]),oi("input",oe,Ke=>l({flagName:Ke.target.value})),ee(J,ve)};$e(fe,J=>{s().type==="flag_true"&&J(Fe)})}Ce(J=>{ie!==(ie=J)&&(j.value=(j.__value=J)??"",ls(j,J))},[()=>s().type]),on(v,()=>t().text,J=>t().text=J),di(m,()=>t().nextDialogueId,J=>t().nextDialogueId=J),Ho(R,()=>t().enabled,J=>t().enabled=J),Ho(W,()=>t().visible,J=>t().visible=J),oi("change",j,J=>{const ve=J.target.value;l({type:ve})}),ee(r,c),Xt()}var dt=Kn(()=>x),Je=Kn(()=>Et),Bf=ue("<option> </option>"),Nf=ue("<option> </option>"),Wf=ue("<option> </option>"),Vf=ue("<option> </option>"),qf=ue('<div><div class="option-header svelte-1x64pwp"><span class="status-icons svelte-1x64pwp"><!></span> <span> </span> <button class="btn-icon danger">×</button></div> <!></div>'),Hf=ue("<option> </option>"),zf=ue('<div class="dialogue-form svelte-1x64pwp"><div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">ID диалога</label> <input type="text" class="input svelte-1x64pwp"/></div> <div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">Текст</label> <textarea class="textarea svelte-1x64pwp" rows="3"></textarea></div> <div class="media-section svelte-1x64pwp"><h4 class="svelte-1x64pwp">Медиа ресурсы</h4> <div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">Фон</label> <div class="input-group svelte-1x64pwp"><select class="input select svelte-1x64pwp"><option>-- Нет --</option><!><!></select> <label class="btn-file svelte-1x64pwp">Загрузить <input type="file" accept="image/*,.riv" hidden/></label></div></div> <div class="form-group svelte-1x64pwp"><label class="svelte-1x64pwp">Персонаж</label> <div class="input-group svelte-1x64pwp"><select class="input select svelte-1x64pwp"><option>-- Нет --</option><!><!></select></div></div></div> <div class="options-section svelte-1x64pwp"><div class="section-header svelte-1x64pwp"><h4 class="svelte-1x64pwp">Варианты ответов</h4> <button class="btn small">+ Добавить</button></div> <!></div> <div class="links-section svelte-1x64pwp"><h4 class="svelte-1x64pwp">Авто-переход</h4> <select class="input select svelte-1x64pwp"><option>-- Нет --</option><!></select></div> <div class="form-actions svelte-1x64pwp"><button class="btn danger">Удалить сцену</button></div></div>'),Gf=ue('<div class="empty-state">Выберите сцену</div>');function Kf(r,e){Jt(e,!1);const t=["always","has_item","stat_greater","flag_true"];function n(m){m.options||(m.options=[]);const k=If();m.options.push(k),dt(dt().editingOptionIndex=m.options.length-1)}function s(m){if(dt().editingOptionIndex===m)dt(dt().editingOptionIndex=null);else{dt(dt().editingOptionIndex=m);const k=Je().currentDialogue?.options?.[m];k&&!k.visibilityCondition&&(k.visibilityCondition={type:"always"})}}function l(m,k){confirm("Удалить вариант ответа?")&&(m.options?.splice(k,1),dt().editingOptionIndex===k?dt(dt().editingOptionIndex=null):dt().editingOptionIndex&&dt().editingOptionIndex>k&&dt(dt().editingOptionIndex--))}gn();var c=gr(),h=Ut(c);{var v=m=>{var k=zf(),E=$(k),_=N($(E),2),S=N(E,2),D=N($(S),2),R=N(S,2),U=N($(R),2),B=N($(U),2),W=$(B);Ce(()=>{Je(),vr(()=>{})});var z=$(W);z.value=z.__value="";var K=N(z);St(K,1,()=>Je().imageResources,Gt,(ke,de)=>{var ge=Bf(),Oe=$(ge),Ye={};Ce(()=>{Le(Oe,F(de).name),Ye!==(Ye=F(de).name)&&(ge.value=(ge.__value=F(de).name)??"")}),ee(ke,ge)});var O=N(K);St(O,1,()=>Je().riveResources,Gt,(ke,de)=>{var ge=Nf(),Oe=$(ge),Ye={};Ce(()=>{Le(Oe,`${F(de).name??""} (Rive)`),Ye!==(Ye=F(de).name)&&(ge.value=(ge.__value=F(de).name)??"")}),ee(ke,ge)});var j=N(W,2),ie=N($(j));ie.__change=function(...ke){Vr.uploadNewFile?.apply(this,ke)};var X=N(U,2),ce=N($(X),2),Q=$(ce);Ce(()=>{Je(),vr(()=>{})});var ne=$(Q);ne.value=ne.__value="";var fe=N(ne);St(fe,1,()=>Je().imageResources,Gt,(ke,de)=>{var ge=Wf(),Oe=$(ge),Ye={};Ce(()=>{Le(Oe,F(de).name),Ye!==(Ye=F(de).name)&&(ge.value=(ge.__value=F(de).name)??"")}),ee(ke,ge)});var Fe=N(fe);St(Fe,1,()=>Je().riveResources,Gt,(ke,de)=>{var ge=Vf(),Oe=$(ge),Ye={};Ce(()=>{Le(Oe,`${F(de).name??""} (Rive)`),Ye!==(Ye=F(de).name)&&(ge.value=(ge.__value=F(de).name)??"")}),ee(ke,ge)});var J=N(R,2),ve=$(J),oe=N($(ve),2);oe.__click=()=>n(Je().currentDialogue);var Ke=N(ve,2);St(Ke,1,()=>Je().currentDialogue.options||[],Gt,(ke,de,ge)=>{var Oe=qf();let Ye;var bt=$(Oe);bt.__click=()=>s(ge);var Ct=$(bt),Nt=$(Ct);{var vt=gt=>{var Wt=Ws("👁️‍🗨️");ee(gt,Wt)},Tt=gt=>{var Wt=gr(),zr=Ut(Wt);{var Dt=o=>{var d=Ws("🔒");ee(o,d)},p=o=>{var d=Ws("✅");ee(o,d)};$e(zr,o=>{F(de).enabled?o(p,!1):o(Dt)},!0)}ee(gt,Wt)};$e(Nt,gt=>{F(de).visible?gt(Tt,!1):gt(vt)})}var Lt=N(Ct,2),lt=$(Lt),rt=N(Lt,2);rt.__click=()=>l(Je().currentDialogue,ge);var ar=N(bt,2);{var pt=gt=>{Uf(gt,{get option(){return F(de)},index:ge,get dialogues(){return dt().data.dialogues},get availableItems(){return Je().availableItems},get conditionTypes(){return t}})};$e(ar,gt=>{dt().editingOptionIndex===ge&&gt(pt)})}Ce(gt=>{Ye=Nr(Oe,1,"option-card svelte-1x64pwp",null,Ye,gt),Le(lt,`#${ge+1} ${F(de).text??""}`)},[()=>({editing:dt().editingOptionIndex===ge})]),ee(ke,Oe)});var We=N(J,2),xe=N($(We),2);Ce(()=>{Je(),vr(()=>{dt()})});var Re=$(xe);Re.value=Re.__value="";var at=N(Re);St(at,1,()=>dt().data.dialogues,Gt,(ke,de)=>{var ge=Hf(),Oe=$(ge),Ye={};Ce(bt=>{Le(Oe,`${F(de).id??""}: ${bt??""}...`),Ye!==(Ye=F(de).id)&&(ge.value=(ge.__value=F(de).id)??"")},[()=>F(de).text.substring(0,30)]),ee(ke,ge)});var ye=N(We,2),Pe=$(ye);Pe.__click=()=>ln.deleteDialogue(Je().currentDialogue.id),on(_,()=>Je().currentDialogue.id,ke=>Je(Je().currentDialogue.id=ke)),on(D,()=>Je().currentDialogue.text,ke=>Je(Je().currentDialogue.text=ke)),di(W,()=>Je().currentDialogue.backgroundImage,ke=>Je(Je().currentDialogue.backgroundImage=ke)),di(Q,()=>Je().currentDialogue.characterImage,ke=>Je(Je().currentDialogue.characterImage=ke)),di(xe,()=>Je().currentDialogue.nextDialogueId,ke=>Je(Je().currentDialogue.nextDialogueId=ke)),ee(m,k)},g=m=>{var k=Gf();ee(m,k)};$e(h,m=>{Je().currentDialogue?m(v):m(g,!1)})}ee(r,c),Xt()}xr(["change","click"]);var we=Kn(()=>x),Yf=ue('<img class="icon-preview svelte-lxnltn"/>'),Jf=ue('<div class="icon-placeholder svelte-lxnltn">📦</div>'),Xf=ue("<option> </option>"),Qf=ue('<div class="icon-preview-small svelte-lxnltn"><img alt="Preview" class="preview-image svelte-lxnltn"/> <span class="preview-name svelte-lxnltn"> </span></div>'),Zf=ue("<option> </option>"),ev=ue('<div class="item-edit-form svelte-lxnltn"><div class="edit-grid svelte-lxnltn"><div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">ID предмета</label> <input type="text" class="input svelte-lxnltn" placeholder="item_unique_id"/></div> <div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">Название</label> <input type="text" class="input svelte-lxnltn" placeholder="Название предмета"/></div> <div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">Описание</label> <textarea class="textarea svelte-lxnltn" rows="2" placeholder="Описание предмета..."></textarea></div> <div class="form-group full-width-edit svelte-lxnltn"><label class="svelte-lxnltn">Иконка</label> <div class="input-group svelte-lxnltn"><input type="text" class="input svelte-lxnltn" placeholder="icon.png"/> <select class="input select svelte-lxnltn"><option>-- Выбрать из загруженных --</option><!></select> <label class="btn-file svelte-lxnltn">Загрузить <input type="file" accept="image/*" hidden/></label></div> <!></div> <div class="form-group svelte-lxnltn"><label class="svelte-lxnltn">Тип</label> <select class="item-type-select svelte-lxnltn"></select></div></div></div>'),tv=ue('<div><div class="item-info svelte-lxnltn"><div class="item-header svelte-lxnltn"><div class="item-icon svelte-lxnltn"><!></div> <div class="item-details svelte-lxnltn"><div class="item-name svelte-lxnltn"> </div> <div class="item-meta svelte-lxnltn"><span class="item-id svelte-lxnltn"> </span> <span> </span></div></div></div> <div class="item-description svelte-lxnltn"> <em>Нет описания</em></div></div> <div class="item-actions svelte-lxnltn"><button class="btn-icon svelte-lxnltn" title="Дублировать">⎘</button> <button class="btn-icon svelte-lxnltn" title="Редактировать">✎️</button> <button class="btn-icon danger svelte-lxnltn" title="Удалить">×</button></div> <!></div>'),rv=ue('<div class="items-list svelte-lxnltn"></div>'),nv=ue('<div class="empty-items svelte-lxnltn"><div class="empty-icon svelte-lxnltn">📦</div> <div class="empty-text svelte-lxnltn">Нет предметов</div> <div class="empty-subtext svelte-lxnltn">Добавьте предметы для использования в условиях</div></div>'),iv=ue('<div class="items-container svelte-lxnltn"><!> <button class="btn primary full-width svelte-lxnltn">+ Добавить предмет</button></div>'),sv=ue('<div class="items-manager svelte-lxnltn"><div class="section-header svelte-lxnltn"><h4 class="svelte-lxnltn"><span class="icon svelte-lxnltn">📦</span> </h4> <span class="toggle-icon svelte-lxnltn"> </span></div> <!></div>');function av(r,e){Jt(e,!1);const t=[{value:"tool",label:"Инструмент"},{value:"key",label:"Ключ"},{value:"consumable",label:"Расходуемый"},{value:"quest",label:"Квестовый"},{value:"misc",label:"Разное"}];function n(){if(!we().data)return;we().data.items||we(we().data.items=[]);const R={id:`item_${Date.now()}`,name:"Новый предмет",description:"Описание предмета",icon:"icon_default.png",type:"misc"};we().data.items.push(R),we(we().editingItemIndex=we().data.items.length-1)}function s(R){we().editingItemIndex===R?we(we().editingItemIndex=null):we(we().editingItemIndex=R)}function l(R){confirm("Удалить предмет?")&&we().data?.items&&(we().data.items.splice(R,1),we(we().editingItemIndex=null))}function c(R){if(!we().data?.items)return;const U=we().data.items[R],B={...U,id:`${U.id}_copy_${Date.now()}`,name:`${U.name} (копия)`};we().data.items.splice(R+1,0,B),we(we().editingItemIndex=R+1)}function h(R){return t.find(U=>U.value===R)?.label||R}gn();var v=sv(),g=$(v);g.__click=()=>we(we().showItems=!we().showItems);var m=$(g),k=N($(m)),E=N(m,2),_=$(E),S=N(g,2);{var D=R=>{var U=iv(),B=$(U);{var W=O=>{var j=rv();St(j,7,()=>we().data.items,ie=>ie.id,(ie,X,ce)=>{var Q=tv();let ne;var fe=$(Q);fe.__click=()=>s(F(ce));var Fe=$(fe),J=$(Fe),ve=$(J);{var oe=lt=>{var rt=Yf();Ce(()=>{Dn(rt,"src",`https://vycjpmuyscfygstjjied.supabase.co/${we().bucketName}/${F(X).icon}`),Dn(rt,"alt",F(X).name)}),ee(lt,rt)},Ke=lt=>{var rt=Jf();ee(lt,rt)};$e(ve,lt=>{F(X).icon?lt(oe):lt(Ke,!1)})}var We=N(J,2),xe=$(We),Re=$(xe),at=N(xe,2),ye=$(at),Pe=$(ye),ke=N(ye,2);let de;var ge=$(ke),Oe=N(Fe,2),Ye=$(Oe),bt=N(fe,2),Ct=$(bt);Ct.__click=()=>c(F(ce));var Nt=N(Ct,2);Nt.__click=()=>s(F(ce));var vt=N(Nt,2);vt.__click=()=>l(F(ce));var Tt=N(bt,2);{var Lt=lt=>{var rt=ev(),ar=$(rt),pt=$(ar),gt=N($(pt),2),Wt=N(pt,2),zr=N($(Wt),2),Dt=N(Wt,2),p=N($(Dt),2),o=N(Dt,2),d=N($(o),2),w=$(d),C=N(w,2);C.__change=pe=>(F(X).icon=pe.target.value,vr(()=>we()));var M=$(C);M.value=M.__value="";var V=N(M);St(V,1,()=>we().storedFiles.filter(pe=>pe.name.match(/\.(png|jpg|jpeg|webp|gif|svg)$/i)),Gt,(pe,nt)=>{var Qe=Xf(),ut=$(Qe),it={};Ce(()=>{Le(ut,F(nt).name),it!==(it=F(nt).name)&&(Qe.value=(Qe.__value=F(nt).name)??"")}),ee(pe,Qe)});var he=N(C,2),me=N($(he));me.__change=function(...pe){Vr.uploadNewFile?.apply(this,pe)};var le=N(d,2);{var Ie=pe=>{var nt=Qf(),Qe=$(nt),ut=N(Qe,2),it=$(ut);Ce(()=>{Dn(Qe,"src",`https://vycjpmuyscfygstjjied.supabase.co/${we().bucketName}/${F(X).icon}`),Le(it,F(X).icon)}),ee(pe,nt)};$e(le,pe=>{F(X).icon&&pe(Ie)})}var Ve=N(o,2),ot=N($(Ve),2);Ce(()=>{F(X),vr(()=>{})}),St(ot,5,()=>t,Gt,(pe,nt)=>{var Qe=Zf(),ut=$(Qe),it={};Ce(()=>{Le(ut,F(nt).label),it!==(it=F(nt).value)&&(Qe.value=(Qe.__value=F(nt).value)??"")}),ee(pe,Qe)}),on(gt,()=>F(X).id,pe=>(F(X).id=pe,vr(()=>we()))),on(zr,()=>F(X).name,pe=>(F(X).name=pe,vr(()=>we()))),on(p,()=>F(X).description,pe=>(F(X).description=pe,vr(()=>we()))),on(w,()=>F(X).icon,pe=>(F(X).icon=pe,vr(()=>we()))),di(ot,()=>F(X).type,pe=>(F(X).type=pe,vr(()=>we()))),ee(lt,rt)};$e(Tt,lt=>{we().editingItemIndex===F(ce)&&lt(Lt)})}Ce((lt,rt,ar)=>{ne=Nr(Q,1,"item-row svelte-lxnltn",null,ne,lt),Le(Re,F(X).name),Le(Pe,F(X).id),de=Nr(ke,1,"item-type-badge svelte-lxnltn",null,de,rt),Le(ge,ar),Le(Ye,`${F(X).description??""} || `)},[()=>({editing:we().editingItemIndex===F(ce)}),()=>({tool:F(X).type==="tool",key:F(X).type==="key",consumable:F(X).type==="consumable",quest:F(X).type==="quest",misc:F(X).type==="misc"}),()=>h(F(X).type)]),ee(ie,Q)}),ee(O,j)},z=O=>{var j=nv();ee(O,j)};$e(B,O=>{we().data?.items?.length?O(W):O(z,!1)})}var K=N(B,2);K.__click=n,ee(R,U)};$e(S,R=>{we().showItems&&R(D)})}Ce(()=>{Dn(g,"title",we().showItems?"Скрыть предметы":"Показать предметы"),Le(k,` Предметы (${(we().data?.items?.length||0)??""})`),Le(_,we().showItems?"▼":"▶")}),ee(r,v),Xt()}xr(["click","change"]);xr(["click"]);class ov{#r=Ot(an({inventory:[],stats:{knowledge:0,courage:0,charisma:0}}));get player(){return F(this.#r)}set player(e){Rt(this.#r,e,!0)}#t=Ot(null);get storyData(){return F(this.#t)}set storyData(e){Rt(this.#t,e,!0)}#e=Ot("0");get currentDialogueId(){return F(this.#e)}set currentDialogueId(e){Rt(this.#e,e,!0)}#n=Ot(!0);get isLoading(){return F(this.#n)}set isLoading(e){Rt(this.#n,e,!0)}#i=Ot("");get error(){return F(this.#i)}set error(e){Rt(this.#i,e,!0)}get currentDialogue(){return this.findDialogue(this.currentDialogueId)}async loadStory(e){this.isLoading=!0,this.error="";try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const n=await t.json();this.storyData=n,this.currentDialogueId=this.storyData.dialogues[0]?.id||"0"}catch(t){const n=t instanceof Error?t.message:"Неизвестная ошибка";this.error=`Ошибка загрузки: ${n}`,console.error("Ошибка загрузки истории:",t)}finally{this.isLoading=!1}}findDialogue(e){return this.storyData?.dialogues.find(t=>t.id===e)}getItem(e){return this.storyData?.items.find(t=>t.id===e)}hasItem(e){return this.player.inventory.includes(e)}addItem(e){this.player.inventory.includes(e)||(this.player.inventory=[...this.player.inventory,e])}removeItem(e){this.player.inventory=this.player.inventory.filter(t=>t!==e)}changeStat(e,t){e in this.player.stats&&(this.player.stats[e]+=t)}getStat(e){return this.player.stats[e]??0}checkVisibilityCondition(e){return e.visibleIf&&e.visibleIf.hasItem?this.hasItem(e.visibleIf.hasItem):!0}runActions(e){e&&e.forEach(t=>{switch(t.type){case"add_item":t.id&&this.addItem(t.id);break;case"remove_item":t.id&&this.removeItem(t.id);break;case"stat_change":t.stat&&t.value!==void 0&&this.changeStat(t.stat,t.value);break;case"set_flag":console.log(`Set flag: ${t.flagName} = ${t.value}`);break;default:console.warn("Неизвестный тип действия:",t.type)}})}goToDialogue(e){this.currentDialogueId=e}reset(){this.player.inventory=[],this.player.stats={knowledge:0,courage:0,charisma:0},this.currentDialogueId=this.storyData?.dialogues[0]?.id||"0",this.error=""}getInventoryItems(){return this.player.inventory.map(e=>this.getItem(e)).filter(e=>e!==void 0)}}const jt=new ov;var es={exports:{}},lv=es.exports,yl;function uv(){return yl||(yl=1,(function(r,e){(function(n,s){r.exports=s()})(lv,()=>(()=>{var t=[,((c,h,v)=>{v.r(h),v.d(h,{default:()=>m});var g=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(E={}){var _=E,S,D;_.ready=new Promise((i,a)=>{S=i,D=a});function R(){function i(A){const P=f;u=a=0,f=new Map,P.forEach(L=>{try{L(A)}catch(T){console.error(T)}}),this.pb(),y&&y.Tb()}let a=0,u=0,f=new Map,y=null,b=null;this.requestAnimationFrame=function(A){a||(a=requestAnimationFrame(i.bind(this)));const P=++u;return f.set(P,A),P},this.cancelAnimationFrame=function(A){f.delete(A),a&&f.size==0&&(cancelAnimationFrame(a),a=0)},this.Rb=function(A){b&&(document.body.remove(b),b=null),A||(b=document.createElement("div"),b.style.backgroundColor="black",b.style.position="fixed",b.style.right=0,b.style.top=0,b.style.color="white",b.style.padding="4px",b.innerHTML="RIVE FPS",A=function(P){b.innerHTML="RIVE FPS "+P.toFixed(1)},document.body.appendChild(b)),y=new function(){let P=0,L=0;this.Tb=function(){var T=performance.now();L?(++P,T-=L,1e3<T&&(A(1e3*P/T),P=L=0)):(L=T,P=0)}}},this.Ob=function(){b&&(document.body.remove(b),b=null),y=null},this.pb=function(){}}function U(i){console.assert(!0);const a=new Map;let u=-1/0;this.push=function(f){return f=f+((1<<i)-1)>>i,a.has(f)&&clearTimeout(a.get(f)),a.set(f,setTimeout(function(){a.delete(f),a.length==0?u=-1/0:f==u&&(u=Math.max(...a.keys()),console.assert(u<f))},1e3)),u=Math.max(f,u),u<<i}}const B=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){B&&B();let i=_.decodeAudio;_.decodeAudio=function(y,b){y=i(y),b(y)};let a=_.decodeFont;_.decodeFont=function(y,b){y=a(y),b(y)};const u=_.FileAssetLoader;_.ptrToAsset=y=>{let b=_.ptrToFileAsset(y);return b.isImage?_.ptrToImageAsset(y):b.isFont?_.ptrToFontAsset(y):b.isAudio?_.ptrToAudioAsset(y):b},_.CustomFileAssetLoader=u.extend("CustomFileAssetLoader",{__construct:function({loadContents:y}){this.__parent.__construct.call(this),this.Gb=y},loadContents:function(y,b){return y=_.ptrToAsset(y),this.Gb(y,b)}}),_.CDNFileAssetLoader=u.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(y){let b=_.ptrToAsset(y);return y=b.cdnUuid,y===""?!1:((function(A,P){var L=new XMLHttpRequest;L.responseType="arraybuffer",L.onreadystatechange=function(){L.readyState==4&&L.status==200&&P(L)},L.open("GET",A,!0),L.send(null)})(b.cdnBaseUrl+"/"+y,A=>{b.decode(new Uint8Array(A.response))}),!0)}}),_.FallbackFileAssetLoader=u.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(y){this.lb.push(y)},loadContents:function(y,b){for(let A of this.lb)if(A.loadContents(y,b))return!0;return!1}});let f=_.computeAlignment;_.computeAlignment=function(y,b,A,P,L=1){return f.call(this,y,b,A,P,L)}};const W="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),z=new function(){function i(){if(!a){let Ae=function(Te,te,Ze){if(te=H.createShader(te),H.shaderSource(te,Ze),H.compileShader(te),Ze=H.getShaderInfoLog(te),0<(Ze||"").length)throw Ze;H.attachShader(Te,te)};var I=document.createElement("canvas"),G={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let H;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(H=I.getContext("webgl",G),u=1,!H)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(H=I.getContext("webgl2",G))u=2;else if(H=I.getContext("webgl",G))u=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(H=new Proxy(H,{get(Te,te){if(Te.isContextLost()){if(L||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",te),L=!0),typeof Te[te]=="function")return function(){}}else return typeof Te[te]=="function"?function(...Ze){return Te[te].apply(Te,Ze)}:Te[te]},set(Te,te,Ze){if(Te.isContextLost())L||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+te),L=!0);else return Te[te]=Ze,!0}}),f=Math.min(H.getParameter(H.MAX_RENDERBUFFER_SIZE),H.getParameter(H.MAX_TEXTURE_SIZE)),I=H.createProgram(),Ae(I,H.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),Ae(I,H.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),H.bindAttribLocation(I,0,"vertex"),H.bindAttribLocation(I,1,"uv"),H.linkProgram(I),G=H.getProgramInfoLog(I),0<(G||"").trim().length)throw G;y=H.getUniformLocation(I,"mat"),b=H.getUniformLocation(I,"translate"),H.useProgram(I),H.bindBuffer(H.ARRAY_BUFFER,H.createBuffer()),H.enableVertexAttribArray(0),H.enableVertexAttribArray(1),H.bindBuffer(H.ELEMENT_ARRAY_BUFFER,H.createBuffer()),H.uniform1i(H.getUniformLocation(I,"image"),0),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),a=H}return!0}let a=null,u=0,f=0,y=null,b=null,A=0,P=0,L=!1;i(),this.hc=function(){return i(),f},this.Mb=function(I){a.deleteTexture&&a.deleteTexture(I)},this.Lb=function(I){if(!i())return null;const G=a.createTexture();return G?(a.bindTexture(a.TEXTURE_2D,G),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,I),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),u==2?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR),a.generateMipmap(a.TEXTURE_2D)):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),G):null};const T=new U(8),Y=new U(8),Z=new U(10),se=new U(10);this.Qb=function(I,G,H,Ae,Te){if(i()){var te=T.push(I),Ze=Y.push(G);if(a.canvas){(a.canvas.width!=te||a.canvas.height!=Ze)&&(a.canvas.width=te,a.canvas.height=Ze),a.viewport(0,Ze-G,I,G),a.disable(a.SCISSOR_TEST),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.enable(a.SCISSOR_TEST),H.sort((Ue,dr)=>dr.xb-Ue.xb),te=Z.push(Ae),A!=te&&(a.bufferData(a.ARRAY_BUFFER,8*te,a.DYNAMIC_DRAW),A=te),te=0;for(var kt of H)a.bufferSubData(a.ARRAY_BUFFER,te,kt.Ua),te+=4*kt.Ua.length;console.assert(te==4*Ae);for(var cr of H)a.bufferSubData(a.ARRAY_BUFFER,te,cr.Db),te+=4*cr.Db.length;console.assert(te==8*Ae),te=se.push(Te),P!=te&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,2*te,a.DYNAMIC_DRAW),P=te),kt=0;for(var Jr of H)a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,kt,Jr.indices),kt+=2*Jr.indices.length;console.assert(kt==2*Te),Jr=0,cr=!0,te=kt=0;for(const Ue of H){Ue.image.Ka!=Jr&&(a.bindTexture(a.TEXTURE_2D,Ue.image.Ja||null),Jr=Ue.image.Ka),Ue.mc?(a.scissor(Ue.Za,Ze-Ue.$a-Ue.kb,Ue.Ac,Ue.kb),cr=!0):cr&&(a.scissor(0,Ze-G,I,G),cr=!1),H=2/I;const dr=-2/G;a.uniform4f(y,Ue.ha[0]*H*Ue.Ba,Ue.ha[1]*dr*Ue.Ca,Ue.ha[2]*H*Ue.Ba,Ue.ha[3]*dr*Ue.Ca),a.uniform2f(b,Ue.ha[4]*H*Ue.Ba+H*(Ue.Za-Ue.ic*Ue.Ba)-1,Ue.ha[5]*dr*Ue.Ca+dr*(Ue.$a-Ue.jc*Ue.Ca)+1),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,te),a.vertexAttribPointer(1,2,a.FLOAT,!1,0,te+4*Ae),a.drawElements(a.TRIANGLES,Ue.indices.length,a.UNSIGNED_SHORT,kt),te+=4*Ue.Ua.length,kt+=2*Ue.indices.length}console.assert(te==4*Ae),console.assert(kt==2*Te)}}},this.canvas=function(){return i()&&a.canvas}},K=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){function i(q){switch(q){case T.srcOver:return"source-over";case T.screen:return"screen";case T.overlay:return"overlay";case T.darken:return"darken";case T.lighten:return"lighten";case T.colorDodge:return"color-dodge";case T.colorBurn:return"color-burn";case T.hardLight:return"hard-light";case T.softLight:return"soft-light";case T.difference:return"difference";case T.exclusion:return"exclusion";case T.multiply:return"multiply";case T.hue:return"hue";case T.saturation:return"saturation";case T.color:return"color";case T.luminosity:return"luminosity"}}function a(q){return"rgba("+((16711680&q)>>>16)+","+((65280&q)>>>8)+","+((255&q)>>>0)+","+((4278190080&q)>>>24)/255+")"}function u(){0<Ze.length&&(z.Qb(te.drawWidth(),te.drawHeight(),Ze,kt,cr),Ze=[],cr=kt=0,te.reset(512,512));for(const q of Te){for(const re of q.H)re();q.H=[]}Te.clear()}K&&K();var f=_.RenderPaintStyle;const y=_.RenderPath,b=_.RenderPaint,A=_.Renderer,P=_.StrokeCap,L=_.StrokeJoin,T=_.BlendMode,Y=f.fill,Z=f.stroke,se=_.FillRule.evenOdd;let I=1;var G=_.RenderImage.extend("CanvasRenderImage",{__construct:function({la:q,xa:re}={}){this.__parent.__construct.call(this),this.Ka=I,I=I+1&2147483647||1,this.la=q,this.xa=re},__destruct:function(){this.Ja&&(z.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(q){var re=this;re.xa&&re.xa(re);var Me=new Image;re.Xa=URL.createObjectURL(new Blob([q],{type:"image/png"})),Me.onload=function(){re.Fb=Me,re.Ja=z.Lb(Me),re.size(Me.width,Me.height),re.la&&re.la(re)},Me.src=re.Xa}}),H=y.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(q,re,Me,Be,Se,De,ze){var Ge=this.T,tr=Ge.addPath;q=q.T;const _t=new DOMMatrix;_t.a=re,_t.b=Me,_t.c=Be,_t.d=Se,_t.e=De,_t.f=ze,tr.call(Ge,q,_t)},fillRule:function(q){this.Wa=q},moveTo:function(q,re){this.T.moveTo(q,re)},lineTo:function(q,re){this.T.lineTo(q,re)},cubicTo:function(q,re,Me,Be,Se,De){this.T.bezierCurveTo(q,re,Me,Be,Se,De)},close:function(){this.T.closePath()}}),Ae=b.extend("CanvasRenderPaint",{color:function(q){this.Ya=a(q)},thickness:function(q){this.Ib=q},join:function(q){switch(q){case L.miter:this.Ia="miter";break;case L.round:this.Ia="round";break;case L.bevel:this.Ia="bevel"}},cap:function(q){switch(q){case P.butt:this.Ha="butt";break;case P.round:this.Ha="round";break;case P.square:this.Ha="square"}},style:function(q){this.Hb=q},blendMode:function(q){this.Eb=i(q)},clearGradient:function(){this.ja=null},linearGradient:function(q,re,Me,Be){this.ja={zb:q,Ab:re,cb:Me,eb:Be,Ra:[]}},radialGradient:function(q,re,Me,Be){this.ja={zb:q,Ab:re,cb:Me,eb:Be,Ra:[],ec:!0}},addStop:function(q,re){this.ja.Ra.push({color:q,stop:re})},completeGradient:function(){},draw:function(q,re,Me){let Be=this.Hb;var Se=this.Ya,De=this.ja;if(q.globalCompositeOperation=this.Eb,De!=null){Se=De.zb;var ze=De.Ab;const tr=De.cb;var Ge=De.eb;const _t=De.Ra;De.ec?(De=tr-Se,Ge-=ze,Se=q.createRadialGradient(Se,ze,0,Se,ze,Math.sqrt(De*De+Ge*Ge))):Se=q.createLinearGradient(Se,ze,tr,Ge);for(let Ht=0,mt=_t.length;Ht<mt;Ht++)ze=_t[Ht],Se.addColorStop(ze.stop,a(ze.color));this.Ya=Se,this.ja=null}switch(Be){case Z:q.strokeStyle=Se,q.lineWidth=this.Ib,q.lineCap=this.Ha,q.lineJoin=this.Ia,q.stroke(re);break;case Y:q.fillStyle=Se,q.fill(re,Me)}}});const Te=new Set;let te=null,Ze=[],kt=0,cr=0;var Jr=_.CanvasRenderer=A.extend("Renderer",{__construct:function(q){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=q.getContext("2d"),this.Va=q,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const q=this.S.length-6;if(6>q)throw"restore() called without matching save().";this.S.splice(q),this.H.push(this.C.restore.bind(this.C))},transform:function(q,re,Me,Be,Se,De){const ze=this.S,Ge=ze.length-6;ze.splice(Ge,6,ze[Ge]*q+ze[Ge+2]*re,ze[Ge+1]*q+ze[Ge+3]*re,ze[Ge]*Me+ze[Ge+2]*Be,ze[Ge+1]*Me+ze[Ge+3]*Be,ze[Ge]*Se+ze[Ge+2]*De+ze[Ge+4],ze[Ge+1]*Se+ze[Ge+3]*De+ze[Ge+5]),this.H.push(this.C.transform.bind(this.C,q,re,Me,Be,Se,De))},rotate:function(q){const re=Math.sin(q);q=Math.cos(q),this.transform(q,re,-re,q,0,0)},_drawPath:function(q,re){this.H.push(re.draw.bind(re,this.C,q.T,q.Wa===se?"evenodd":"nonzero"))},_drawRiveImage:function(q,re,Me,Be){var Se=q.Fb;if(Se){var De=this.C,ze=i(Me);this.H.push(function(){De.globalCompositeOperation=ze,De.globalAlpha=Be,De.drawImage(Se,0,0),De.globalAlpha=1})}},_getMatrix:function(q){const re=this.S,Me=re.length-6;for(let Be=0;6>Be;++Be)q[Be]=re[Me+Be]},_drawImageMesh:function(q,re,Me,Be,Se,De,ze,Ge,tr,_t,Ht){re=this.C.canvas.width;var mt=this.C.canvas.height;const Io=_t-Ge,Co=Ht-tr;Ge=Math.max(Ge,0),tr=Math.max(tr,0),_t=Math.min(_t,re),Ht=Math.min(Ht,mt);const si=_t-Ge,ai=Ht-tr;if(console.assert(si<=Math.min(Io,re)),console.assert(ai<=Math.min(Co,mt)),!(0>=si||0>=ai)){_t=si<Io||ai<Co,re=Ht=1;var Xr=Math.ceil(si*Ht),Qr=Math.ceil(ai*re);mt=z.hc(),Xr>mt&&(Ht*=mt/Xr,Xr=mt),Qr>mt&&(re*=mt/Qr,Qr=mt),te||(te=new _.DynamicRectanizer(mt),te.reset(512,512)),mt=te.addRect(Xr,Qr),0>mt&&(u(),Te.add(this),mt=te.addRect(Xr,Qr),console.assert(0<=mt));var To=mt&65535,Po=mt>>16;Ze.push({ha:this.S.slice(this.S.length-6),image:q,Za:To,$a:Po,ic:Ge,jc:tr,Ac:Xr,kb:Qr,Ba:Ht,Ca:re,Ua:new Float32Array(Se),Db:new Float32Array(De),indices:new Uint16Array(ze),mc:_t,xb:q.Ka<<1|(_t?1:0)}),kt+=Se.length,cr+=ze.length;var bn=this.C,Qu=i(Me);this.H.push(function(){bn.save(),bn.resetTransform(),bn.globalCompositeOperation=Qu,bn.globalAlpha=Be;const xo=z.canvas();xo&&bn.drawImage(xo,To,Po,Xr,Qr,Ge,tr,si,ai),bn.restore()})}},_clipPath:function(q){this.H.push(this.C.clip.bind(this.C,q.T,q.Wa===se?"evenodd":"nonzero"))},clear:function(){Te.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(q,re){this.transform(1,0,0,1,q,re)}});_.makeRenderer=function(q){const re=new Jr(q),Me=re.C;return new Proxy(re,{get(Be,Se){if(typeof Be[Se]=="function")return function(...De){return Be[Se].apply(Be,De)};if(typeof Me[Se]=="function"){if(-1<W.indexOf(Se))throw Error("RiveException: Method call to '"+Se+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(...De){re.H.push(Me[Se].bind(Me,...De))}}return Be[Se]},set(Be,Se,De){if(Se in Me)return re.H.push(()=>{Me[Se]=De}),!0}})},_.decodeImage=function(q,re){new G({la:re}).decode(q)},_.renderFactory={makeRenderPaint:function(){return new Ae},makeRenderPath:function(){return new H},makeRenderImage:function(){let q=dr;return new G({xa:()=>{q.total++},la:()=>{if(q.loaded++,q.loaded===q.total){const re=q.ready;re&&(re(),q.ready=null)}}})}};let Ue=_.load,dr=null;_.load=function(q,re,Me=!0){const Be=new _.FallbackFileAssetLoader;return re!==void 0&&Be.addLoader(re),Me&&(re=new _.CDNFileAssetLoader,Be.addLoader(re)),new Promise(function(Se){let De=null;dr={total:0,loaded:0,ready:function(){Se(De)}},De=Ue(q,Be),dr.total==0&&Se(De)})};let Xu=_.RendererWrapper.prototype.align;_.RendererWrapper.prototype.align=function(q,re,Me,Be,Se=1){Xu.call(this,q,re,Me,Be,Se)},f=new R,_.requestAnimationFrame=f.requestAnimationFrame.bind(f),_.cancelAnimationFrame=f.cancelAnimationFrame.bind(f),_.enableFPSCounter=f.Rb.bind(f),_.disableFPSCounter=f.Ob,f.pb=u,_.resolveAnimationFrame=u,_.cleanup=function(){te&&te.delete()}};var O=Object.assign({},_),j="./this.program",ie=typeof window=="object",X=typeof importScripts=="function",ce="",Q,ne;(ie||X)&&(X?ce=self.location.href:typeof document<"u"&&document.currentScript&&(ce=document.currentScript.src),k&&(ce=k),ce.indexOf("blob:")!==0?ce=ce.substr(0,ce.replace(/[?#].*/,"").lastIndexOf("/")+1):ce="",X&&(ne=i=>{var a=new XMLHttpRequest;return a.open("GET",i,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),Q=(i,a,u)=>{var f=new XMLHttpRequest;f.open("GET",i,!0),f.responseType="arraybuffer",f.onload=()=>{f.status==200||f.status==0&&f.response?a(f.response):u()},f.onerror=u,f.send(null)});var fe=_.print||console.log.bind(console),Fe=_.printErr||console.error.bind(console);Object.assign(_,O),O=null,_.thisProgram&&(j=_.thisProgram);var J;_.wasmBinary&&(J=_.wasmBinary),_.noExitRuntime,typeof WebAssembly!="object"&&Lt("no native wasm support detected");var ve,oe,Ke=!1,We,xe,Re,at,ye,Pe,ke,de;function ge(){var i=ve.buffer;_.HEAP8=We=new Int8Array(i),_.HEAP16=Re=new Int16Array(i),_.HEAP32=ye=new Int32Array(i),_.HEAPU8=xe=new Uint8Array(i),_.HEAPU16=at=new Uint16Array(i),_.HEAPU32=Pe=new Uint32Array(i),_.HEAPF32=ke=new Float32Array(i),_.HEAPF64=de=new Float64Array(i)}var Oe,Ye=[],bt=[],Ct=[];function Nt(){var i=_.preRun.shift();Ye.unshift(i)}var vt=0,Tt=null;function Lt(i){throw _.onAbort&&_.onAbort(i),i="Aborted("+i+")",Fe(i),Ke=!0,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),D(i),i}function lt(i){return i.startsWith("data:application/octet-stream;base64,")}var rt;if(rt="canvas_advanced.wasm",!lt(rt)){var ar=rt;rt=_.locateFile?_.locateFile(ar,ce):ce+ar}function pt(i){if(i==rt&&J)return new Uint8Array(J);if(ne)return ne(i);throw"both async and sync fetching of the wasm failed"}function gt(i){if(!J&&(ie||X)){if(typeof fetch=="function"&&!i.startsWith("file://"))return fetch(i,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at '"+i+"'";return a.arrayBuffer()}).catch(()=>pt(i));if(Q)return new Promise((a,u)=>{Q(i,f=>a(new Uint8Array(f)),u)})}return Promise.resolve().then(()=>pt(i))}function Wt(i,a,u){return gt(i).then(f=>WebAssembly.instantiate(f,a)).then(f=>f).then(u,f=>{Fe("failed to asynchronously prepare wasm: "+f),Lt(f)})}function zr(i,a){var u=rt;return J||typeof WebAssembly.instantiateStreaming!="function"||lt(u)||u.startsWith("file://")||typeof fetch!="function"?Wt(u,i,a):fetch(u,{credentials:"same-origin"}).then(f=>WebAssembly.instantiateStreaming(f,i).then(a,function(y){return Fe("wasm streaming compile failed: "+y),Fe("falling back to ArrayBuffer instantiation"),Wt(u,i,a)}))}var Dt,p,o={460492:(i,a,u,f,y)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=i,window.h.I.capture=a,window.h.I.La=u,window.h.ga={},window.h.ga.stopped=f,window.h.ga.yb=y;let b=window.h;b.D=[],b.yc=function(A){for(var P=0;P<b.D.length;++P)if(b.D[P]==null)return b.D[P]=A,P;return b.D.push(A),b.D.length-1},b.Cb=function(A){for(b.D[A]=null;0<b.D.length&&b.D[b.D.length-1]==null;)b.D.pop()},b.Sc=function(A){for(var P=0;P<b.D.length;++P)if(b.D[P]==A)return b.Cb(P)},b.ra=function(A){return b.D[A]},b.Ta=["touchend","click"],b.unlock=function(){for(var A=0;A<b.D.length;++A){var P=b.D[A];P!=null&&P.J!=null&&P.state===b.ga.yb&&P.J.resume().then(()=>{bo(P.qb)},L=>{console.error("Failed to resume audiocontext",L)})}b.Ta.map(function(L){document.removeEventListener(L,b.unlock,!0)})},b.Ta.map(function(A){document.addEventListener(A,b.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(i){document.removeEventListener(i,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var i=new(window.AudioContext||window.webkitAudioContext),a=i.sampleRate;return i.close(),a}catch{return 0}},463249:(i,a,u,f,y,b)=>{if(typeof window.h>"u")return-1;var A={},P={};return i==window.h.I.ya&&u!=0&&(P.sampleRate=u),A.J=new(window.AudioContext||window.webkitAudioContext)(P),A.J.suspend(),A.state=window.h.ga.stopped,u=0,i!=window.h.I.ya&&(u=a),A.Z=A.J.createScriptProcessor(f,u,a),A.Z.onaudioprocess=function(L){if((A.sa==null||A.sa.length==0)&&(A.sa=new Float32Array(ke.buffer,y,f*a)),i==window.h.I.capture||i==window.h.I.La){for(var T=0;T<a;T+=1)for(var Y=L.inputBuffer.getChannelData(T),Z=A.sa,se=0;se<f;se+=1)Z[se*a+T]=Y[se];ko(b,f,y)}if(i==window.h.I.ya||i==window.h.I.La)for(Eo(b,f,y),T=0;T<L.outputBuffer.numberOfChannels;++T)for(Y=L.outputBuffer.getChannelData(T),Z=A.sa,se=0;se<f;se+=1)Y[se]=Z[se*a+T];else for(T=0;T<L.outputBuffer.numberOfChannels;++T)L.outputBuffer.getChannelData(T).fill(0)},i!=window.h.I.capture&&i!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(L){A.Da=A.J.createMediaStreamSource(L),A.Da.connect(A.Z),A.Z.connect(A.J.destination)}).catch(function(L){console.log("Failed to get user media: "+L)}),i==window.h.I.ya&&A.Z.connect(A.J.destination),A.qb=b,window.h.yc(A)},466126:i=>window.h.ra(i).J.sampleRate,466199:i=>{i=window.h.ra(i),i.Z!==void 0&&(i.Z.onaudioprocess=function(){},i.Z.disconnect(),i.Z=void 0),i.Da!==void 0&&(i.Da.disconnect(),i.Da=void 0),i.J.close(),i.J=void 0,i.qb=void 0},466599:i=>{window.h.Cb(i)},466649:i=>{i=window.h.ra(i),i.J.resume(),i.state=window.h.ga.yb},466788:i=>{i=window.h.ra(i),i.J.suspend(),i.state=window.h.ga.stopped}},d=i=>{for(;0<i.length;)i.shift()(_)},w=(i,a)=>{for(var u=0,f=i.length-1;0<=f;f--){var y=i[f];y==="."?i.splice(f,1):y===".."?(i.splice(f,1),u++):u&&(i.splice(f,1),u--)}if(a)for(;u;u--)i.unshift("..");return i},C=i=>{var a=i.charAt(0)==="/",u=i.substr(-1)==="/";return(i=w(i.split("/").filter(f=>!!f),!a).join("/"))||a||(i="."),i&&u&&(i+="/"),(a?"/":"")+i},M=i=>{var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(i).slice(1);return i=a[0],a=a[1],!i&&!a?".":(a&&(a=a.substr(0,a.length-1)),i+a)},V=i=>{if(i==="/")return"/";i=C(i),i=i.replace(/\/$/,"");var a=i.lastIndexOf("/");return a===-1?i:i.substr(a+1)},he=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return i=>crypto.getRandomValues(i);Lt("initRandomDevice")},me=i=>(me=he())(i);function le(){for(var i="",a=!1,u=arguments.length-1;-1<=u&&!a;u--){if(a=0<=u?arguments[u]:"/",typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";i=a+"/"+i,a=a.charAt(0)==="/"}return i=w(i.split("/").filter(f=>!!f),!a).join("/"),(a?"/":"")+i||"."}var Ie=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Ve=(i,a,u)=>{var f=a+u;for(u=a;i[u]&&!(u>=f);)++u;if(16<u-a&&i.buffer&&Ie)return Ie.decode(i.subarray(a,u));for(f="";a<u;){var y=i[a++];if(y&128){var b=i[a++]&63;if((y&224)==192)f+=String.fromCharCode((y&31)<<6|b);else{var A=i[a++]&63;y=(y&240)==224?(y&15)<<12|b<<6|A:(y&7)<<18|b<<12|A<<6|i[a++]&63,65536>y?f+=String.fromCharCode(y):(y-=65536,f+=String.fromCharCode(55296|y>>10,56320|y&1023))}}else f+=String.fromCharCode(y)}return f},ot=[],pe=i=>{for(var a=0,u=0;u<i.length;++u){var f=i.charCodeAt(u);127>=f?a++:2047>=f?a+=2:55296<=f&&57343>=f?(a+=4,++u):a+=3}return a},nt=(i,a,u,f)=>{if(!(0<f))return 0;var y=u;f=u+f-1;for(var b=0;b<i.length;++b){var A=i.charCodeAt(b);if(55296<=A&&57343>=A){var P=i.charCodeAt(++b);A=65536+((A&1023)<<10)|P&1023}if(127>=A){if(u>=f)break;a[u++]=A}else{if(2047>=A){if(u+1>=f)break;a[u++]=192|A>>6}else{if(65535>=A){if(u+2>=f)break;a[u++]=224|A>>12}else{if(u+3>=f)break;a[u++]=240|A>>18,a[u++]=128|A>>12&63}a[u++]=128|A>>6&63}a[u++]=128|A&63}}return a[u]=0,u-y};function Qe(i,a){var u=Array(pe(i)+1);return i=nt(i,u,0,u.length),a&&(u.length=i),u}var ut=[];function it(i,a){ut[i]={input:[],F:[],V:a},Ss(i,Vt)}var Vt={open:function(i){var a=ut[i.node.za];if(!a)throw new ae(43);i.s=a,i.seekable=!1},close:function(i){i.s.V.qa(i.s)},qa:function(i){i.s.V.qa(i.s)},read:function(i,a,u,f){if(!i.s||!i.s.V.jb)throw new ae(60);for(var y=0,b=0;b<f;b++){try{var A=i.s.V.jb(i.s)}catch{throw new ae(29)}if(A===void 0&&y===0)throw new ae(6);if(A==null)break;y++,a[u+b]=A}return y&&(i.node.timestamp=Date.now()),y},write:function(i,a,u,f){if(!i.s||!i.s.V.Oa)throw new ae(60);try{for(var y=0;y<f;y++)i.s.V.Oa(i.s,a[u+y])}catch{throw new ae(29)}return f&&(i.node.timestamp=Date.now()),y}},Rr={jb:function(){e:{if(!ot.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i){i=null;break e}ot=Qe(i,!0)}i=ot.shift()}return i},Oa:function(i,a){a===null||a===10?(fe(Ve(i.F,0)),i.F=[]):a!=0&&i.F.push(a)},qa:function(i){i.F&&0<i.F.length&&(fe(Ve(i.F,0)),i.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},Or={Oa:function(i,a){a===null||a===10?(Fe(Ve(i.F,0)),i.F=[]):a!=0&&i.F.push(a)},qa:function(i){i.F&&0<i.F.length&&(Fe(Ve(i.F,0)),i.F=[])}};function or(i,a){var u=i.j?i.j.length:0;u>=a||(a=Math.max(a,u*(1048576>u?2:1.125)>>>0),u!=0&&(a=Math.max(a,256)),u=i.j,i.j=new Uint8Array(a),0<i.v&&i.j.set(u.subarray(0,i.v),0))}var _e={O:null,U(){return _e.createNode(null,"/",16895,0)},createNode(i,a,u,f){if((u&61440)===24576||(u&61440)===4096)throw new ae(63);return _e.O||(_e.O={dir:{node:{Y:_e.l.Y,P:_e.l.P,ka:_e.l.ka,va:_e.l.va,vb:_e.l.vb,Bb:_e.l.Bb,wb:_e.l.wb,tb:_e.l.tb,Ea:_e.l.Ea},stream:{ba:_e.m.ba}},file:{node:{Y:_e.l.Y,P:_e.l.P},stream:{ba:_e.m.ba,read:_e.m.read,write:_e.m.write,pa:_e.m.pa,mb:_e.m.mb,ob:_e.m.ob}},link:{node:{Y:_e.l.Y,P:_e.l.P,ma:_e.l.ma},stream:{}},ab:{node:{Y:_e.l.Y,P:_e.l.P},stream:Pu}}),u=Va(i,a,u,f),(u.mode&61440)===16384?(u.l=_e.O.dir.node,u.m=_e.O.dir.stream,u.j={}):(u.mode&61440)===32768?(u.l=_e.O.file.node,u.m=_e.O.file.stream,u.v=0,u.j=null):(u.mode&61440)===40960?(u.l=_e.O.link.node,u.m=_e.O.link.stream):(u.mode&61440)===8192&&(u.l=_e.O.ab.node,u.m=_e.O.ab.stream),u.timestamp=Date.now(),i&&(i.j[a]=u,i.timestamp=u.timestamp),u},Kc(i){return i.j?i.j.subarray?i.j.subarray(0,i.v):new Uint8Array(i.j):new Uint8Array(0)},l:{Y(i){var a={};return a.Jc=(i.mode&61440)===8192?i.id:1,a.Mc=i.id,a.mode=i.mode,a.Oc=1,a.uid=0,a.Lc=0,a.za=i.za,(i.mode&61440)===16384?a.size=4096:(i.mode&61440)===32768?a.size=i.v:(i.mode&61440)===40960?a.size=i.link.length:a.size=0,a.Bc=new Date(i.timestamp),a.Nc=new Date(i.timestamp),a.Ic=new Date(i.timestamp),a.Jb=4096,a.Cc=Math.ceil(a.size/a.Jb),a},P(i,a){if(a.mode!==void 0&&(i.mode=a.mode),a.timestamp!==void 0&&(i.timestamp=a.timestamp),a.size!==void 0&&(a=a.size,i.v!=a))if(a==0)i.j=null,i.v=0;else{var u=i.j;i.j=new Uint8Array(a),u&&i.j.set(u.subarray(0,Math.min(a,i.v))),i.v=a}},ka(){throw As[44]},va(i,a,u,f){return _e.createNode(i,a,u,f)},vb(i,a,u){if((i.mode&61440)===16384){try{var f=Ii(a,u)}catch{}if(f)for(var y in f.j)throw new ae(55)}delete i.parent.j[i.name],i.parent.timestamp=Date.now(),i.name=u,a.j[u]=i,a.timestamp=i.parent.timestamp,i.parent=a},Bb(i,a){delete i.j[a],i.timestamp=Date.now()},wb(i,a){var u=Ii(i,a),f;for(f in u.j)throw new ae(55);delete i.j[a],i.timestamp=Date.now()},tb(i){var a=[".",".."],u;for(u in i.j)i.j.hasOwnProperty(u)&&a.push(u);return a},Ea(i,a,u){return i=_e.createNode(i,a,41471,0),i.link=u,i},ma(i){if((i.mode&61440)!==40960)throw new ae(28);return i.link}},m:{read(i,a,u,f,y){var b=i.node.j;if(y>=i.node.v)return 0;if(i=Math.min(i.node.v-y,f),8<i&&b.subarray)a.set(b.subarray(y,y+i),u);else for(f=0;f<i;f++)a[u+f]=b[y+f];return i},write(i,a,u,f,y,b){if(a.buffer===We.buffer&&(b=!1),!f)return 0;if(i=i.node,i.timestamp=Date.now(),a.subarray&&(!i.j||i.j.subarray)){if(b)return i.j=a.subarray(u,u+f),i.v=f;if(i.v===0&&y===0)return i.j=a.slice(u,u+f),i.v=f;if(y+f<=i.v)return i.j.set(a.subarray(u,u+f),y),f}if(or(i,y+f),i.j.subarray&&a.subarray)i.j.set(a.subarray(u,u+f),y);else for(b=0;b<f;b++)i.j[y+b]=a[u+b];return i.v=Math.max(i.v,y+f),f},ba(i,a,u){if(u===1?a+=i.position:u===2&&(i.node.mode&61440)===32768&&(a+=i.node.v),0>a)throw new ae(28);return a},pa(i,a,u){or(i.node,a+u),i.node.v=Math.max(i.node.v,a+u)},mb(i,a,u,f,y){if((i.node.mode&61440)!==32768)throw new ae(43);if(i=i.node.j,y&2||i.buffer!==We.buffer){if((0<u||u+a<i.length)&&(i.subarray?i=i.subarray(u,u+a):i=Array.prototype.slice.call(i,u,u+a)),u=!0,Lt(),a=void 0,!a)throw new ae(48);We.set(i,a)}else u=!1,a=i.byteOffset;return{o:a,M:u}},ob(i,a,u,f){return _e.m.write(i,a,0,f,u,!1),0}}};function qe(i,a){var u=0;return i&&(u|=365),a&&(u|=146),u}var lr=null,Ua={},Si=[],Cu=1,Jn=null,Ba=!0,ae=null,As={},Gr=(i,a={})=>{if(i=le(i),!i)return{path:"",node:null};if(a=Object.assign({hb:!0,Qa:0},a),8<a.Qa)throw new ae(32);i=i.split("/").filter(A=>!!A);for(var u=lr,f="/",y=0;y<i.length;y++){var b=y===i.length-1;if(b&&a.parent)break;if(u=Ii(u,i[y]),f=C(f+"/"+i[y]),u.wa&&(!b||b&&a.hb)&&(u=u.wa.root),!b||a.gb){for(b=0;(u.mode&61440)===40960;)if(u=xu(f),f=le(M(f),u),u=Gr(f,{Qa:a.Qa+1}).node,40<b++)throw new ae(32)}}return{path:f,node:u}},Na=i=>{for(var a;;){if(i===i.parent)return i=i.U.nb,a?i[i.length-1]!=="/"?`${i}/${a}`:i+a:i;a=a?`${i.name}/${a}`:i.name,i=i.parent}},Wa=(i,a)=>{for(var u=0,f=0;f<a.length;f++)u=(u<<5)-u+a.charCodeAt(f)|0;return(i+u>>>0)%Jn.length},Ii=(i,a)=>{var u;if(u=(u=Ci(i,"x"))?u:i.l.ka?0:2)throw new ae(u,i);for(u=Jn[Wa(i.id,a)];u;u=u.lc){var f=u.name;if(u.parent.id===i.id&&f===a)return u}return i.l.ka(i,a)},Va=(i,a,u,f)=>(i=new _o(i,a,u,f),a=Wa(i.parent.id,i.name),i.lc=Jn[a],Jn[a]=i),qa=i=>{var a=["r","w","rw"][i&3];return i&512&&(a+="w"),a},Ci=(i,a)=>{if(Ba)return 0;if(!a.includes("r")||i.mode&292){if(a.includes("w")&&!(i.mode&146)||a.includes("x")&&!(i.mode&73))return 2}else return 2;return 0},Ha=(i,a)=>{try{return Ii(i,a),20}catch{}return Ci(i,"wx")},Tu=()=>{for(var i=0;4096>=i;i++)if(!Si[i])return i;throw new ae(33)},jr=i=>{if(i=Si[i],!i)throw new ae(8);return i},za=(i,a=-1)=>(Qn||(Qn=function(){this.h={}},Qn.prototype={},Object.defineProperties(Qn.prototype,{object:{get(){return this.node},set(u){this.node=u}},flags:{get(){return this.h.flags},set(u){this.h.flags=u}},position:{get(){return this.h.position},set(u){this.h.position=u}}})),i=Object.assign(new Qn,i),a==-1&&(a=Tu()),i.X=a,Si[a]=i),Pu={open:i=>{i.m=Ua[i.node.za].m,i.m.open&&i.m.open(i)},ba:()=>{throw new ae(70)}},Ss=(i,a)=>{Ua[i]={m:a}},Ga=(i,a)=>{var u=a==="/",f=!a;if(u&&lr)throw new ae(10);if(!u&&!f){var y=Gr(a,{hb:!1});if(a=y.path,y=y.node,y.wa)throw new ae(10);if((y.mode&61440)!==16384)throw new ae(54)}a={type:i,Qc:{},nb:a,kc:[]},i=i.U(a),i.U=a,a.root=i,u?lr=i:y&&(y.wa=a,y.U&&y.U.kc.push(a))},Qt=(i,a,u)=>{var f=Gr(i,{parent:!0}).node;if(i=V(i),!i||i==="."||i==="..")throw new ae(28);var y=Ha(f,i);if(y)throw new ae(y);if(!f.l.va)throw new ae(63);return f.l.va(f,i,a,u)},Ti=(i,a,u)=>{typeof u>"u"&&(u=a,a=438),Qt(i,a|8192,u)},Is=(i,a)=>{if(!le(i))throw new ae(44);var u=Gr(a,{parent:!0}).node;if(!u)throw new ae(44);a=V(a);var f=Ha(u,a);if(f)throw new ae(f);if(!u.l.Ea)throw new ae(63);u.l.Ea(u,a,i)},xu=i=>{if(i=Gr(i).node,!i)throw new ae(44);if(!i.l.ma)throw new ae(28);return le(Na(i.parent),i.l.ma(i))},Pi=(i,a,u)=>{if(i==="")throw new ae(44);if(typeof a=="string"){var f={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[a];if(typeof f>"u")throw Error(`Unknown file open mode: ${a}`);a=f}if(u=a&64?(typeof u>"u"?438:u)&4095|32768:0,typeof i=="object")var y=i;else{i=C(i);try{y=Gr(i,{gb:!(a&131072)}).node}catch{}}if(f=!1,a&64)if(y){if(a&128)throw new ae(20)}else y=Qt(i,u,0),f=!0;if(!y)throw new ae(44);if((y.mode&61440)===8192&&(a&=-513),a&65536&&(y.mode&61440)!==16384)throw new ae(54);if(!f&&(u=y?(y.mode&61440)===40960?32:(y.mode&61440)===16384&&(qa(a)!=="r"||a&512)?31:Ci(y,qa(a)):44))throw new ae(u);if(a&512&&!f){if(u=y,u=typeof u=="string"?Gr(u,{gb:!0}).node:u,!u.l.P)throw new ae(63);if((u.mode&61440)===16384)throw new ae(31);if((u.mode&61440)!==32768)throw new ae(28);if(f=Ci(u,"w"))throw new ae(f);u.l.P(u,{size:0,timestamp:Date.now()})}return a&=-131713,y=za({node:y,path:Na(y),flags:a,seekable:!0,position:0,m:y.m,zc:[],error:!1}),y.m.open&&y.m.open(y),!_.logReadFiles||a&1||(xi||(xi={}),i in xi||(xi[i]=1)),y},Ka=(i,a,u)=>{if(i.X===null)throw new ae(8);if(!i.seekable||!i.m.ba)throw new ae(70);if(u!=0&&u!=1&&u!=2)throw new ae(28);i.position=i.m.ba(i,a,u),i.zc=[]},Ya=()=>{ae||(ae=function(i,a){this.name="ErrnoError",this.node=a,this.pc=function(u){this.aa=u},this.pc(i),this.message="FS error"},ae.prototype=Error(),ae.prototype.constructor=ae,[44].forEach(i=>{As[i]=new ae(i),As[i].stack="<generic error, no stack>"}))},Ja,Xn=(i,a,u)=>{i=C("/dev/"+i);var f=qe(!!a,!!u);Cs||(Cs=64);var y=Cs++<<8|0;Ss(y,{open:b=>{b.seekable=!1},close:()=>{u&&u.buffer&&u.buffer.length&&u(10)},read:(b,A,P,L)=>{for(var T=0,Y=0;Y<L;Y++){try{var Z=a()}catch{throw new ae(29)}if(Z===void 0&&T===0)throw new ae(6);if(Z==null)break;T++,A[P+Y]=Z}return T&&(b.node.timestamp=Date.now()),T},write:(b,A,P,L)=>{for(var T=0;T<L;T++)try{u(A[P+T])}catch{throw new ae(29)}return L&&(b.node.timestamp=Date.now()),T}}),Ti(i,f,y)},Cs,Kr={},Qn,xi,Zn=void 0;function yr(){return Zn+=4,ye[Zn-4>>2]}function Xa(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var a=i.charCodeAt(0);return 48<=a&&57>=a?`_${i}`:i}function Ri(i,a){return i=Xa(i),{[i]:function(){return a.apply(this,arguments)}}[i]}function Qa(){this.M=[void 0],this.ib=[]}var qt=new Qa,mn=void 0;function Ee(i){throw new mn(i)}var Zt=i=>(i||Ee("Cannot use deleted val. handle = "+i),qt.get(i).value),er=i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return qt.pa({ub:1,value:i})}};function Za(i){var a=Error,u=Ri(i,function(f){this.name=i,this.message=f,f=Error(f).stack,f!==void 0&&(this.stack=this.toString()+`
`+f.replace(/^Error(:[^\n]*)?\n/,""))});return u.prototype=Object.create(a.prototype),u.prototype.constructor=u,u.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},u}var eo=void 0,to=void 0;function st(i){for(var a="";xe[i];)a+=to[xe[i++]];return a}var ei=[];function Ts(){for(;ei.length;){var i=ei.pop();i.g.fa=!1,i.delete()}}var ti=void 0,wr={};function Ps(i,a){for(a===void 0&&Ee("ptr should not be undefined");i.A;)a=i.na(a),i=i.A;return a}var Yr={};function ro(i){i=Ao(i);var a=st(i);return Er(i),a}function ri(i,a){var u=Yr[i];return u===void 0&&Ee(a+" has unknown type "+ro(i)),u}function Oi(){}var xs=!1;function no(i){--i.count.value,i.count.value===0&&(i.G?i.L.W(i.G):i.u.i.W(i.o))}function io(i,a,u){return a===u?i:u.A===void 0?null:(i=io(i,a,u.A),i===null?null:u.Pb(i))}var so={};function Ru(i,a){return a=Ps(i,a),wr[a]}var ao=void 0;function ji(i){throw new ao(i)}function Mi(i,a){return a.u&&a.o||ji("makeClassHandle requires ptr and ptrType"),!!a.L!=!!a.G&&ji("Both smartPtrType and smartPtr must be specified"),a.count={value:1},yn(Object.create(i,{g:{value:a}}))}function yn(i){return typeof FinalizationRegistry>"u"?(yn=a=>a,i):(xs=new FinalizationRegistry(a=>{no(a.g)}),yn=a=>{var u=a.g;return u.G&&xs.register(a,{g:u},a),a},Oi=a=>{xs.unregister(a)},yn(i))}var Li={};function ni(i){for(;i.length;){var a=i.pop();i.pop()(a)}}function ii(i){return this.fromWireType(ye[i>>2])}var wn={},Di={};function $t(i,a,u){function f(P){P=u(P),P.length!==i.length&&ji("Mismatched type converter count");for(var L=0;L<i.length;++L)ur(i[L],P[L])}i.forEach(function(P){Di[P]=a});var y=Array(a.length),b=[],A=0;a.forEach((P,L)=>{Yr.hasOwnProperty(P)?y[L]=Yr[P]:(b.push(P),wn.hasOwnProperty(P)||(wn[P]=[]),wn[P].push(()=>{y[L]=Yr[P],++A,A===b.length&&f(y)}))}),b.length===0&&f(y)}function $i(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${i}`)}}function Ou(i,a,u={}){var f=a.name;if(i||Ee(`type "${f}" must have a positive integer typeid pointer`),Yr.hasOwnProperty(i)){if(u.$b)return;Ee(`Cannot register type '${f}' twice`)}Yr[i]=a,delete Di[i],wn.hasOwnProperty(i)&&(a=wn[i],delete wn[i],a.forEach(y=>y()))}function ur(i,a,u={}){if(!("argPackAdvance"in a))throw new TypeError("registerType registeredInstance requires argPackAdvance");Ou(i,a,u)}function Rs(i){Ee(i.g.u.i.name+" instance already deleted")}function Mr(){}function Os(i,a,u){if(i[a].B===void 0){var f=i[a];i[a]=function(){return i[a].B.hasOwnProperty(arguments.length)||Ee(`Function '${u}' called with an invalid number of arguments (${arguments.length}) - expects one of (${i[a].B})!`),i[a].B[arguments.length].apply(this,arguments)},i[a].B=[],i[a].B[f.ea]=f}}function js(i,a,u){_.hasOwnProperty(i)?((u===void 0||_[i].B!==void 0&&_[i].B[u]!==void 0)&&Ee(`Cannot register public name '${i}' twice`),Os(_,i,i),_.hasOwnProperty(u)&&Ee(`Cannot register multiple overloads of a function with the same number of arguments (${u})!`),_[i].B[u]=a):(_[i]=a,u!==void 0&&(_[i].Pc=u))}function ju(i,a,u,f,y,b,A,P){this.name=i,this.constructor=a,this.N=u,this.W=f,this.A=y,this.Ub=b,this.na=A,this.Pb=P,this.rb=[]}function Fi(i,a,u){for(;a!==u;)a.na||Ee(`Expected null or instance of ${u.name}, got an instance of ${a.name}`),i=a.na(i),a=a.A;return i}function Mu(i,a){return a===null?(this.Na&&Ee(`null is not a valid ${this.name}`),0):(a.g||Ee(`Cannot pass "${Ls(a)}" as a ${this.name}`),a.g.o||Ee(`Cannot pass deleted object as a pointer of type ${this.name}`),Fi(a.g.o,a.g.u.i,this.i))}function Lu(i,a){if(a===null){if(this.Na&&Ee(`null is not a valid ${this.name}`),this.ua){var u=this.Pa();return i!==null&&i.push(this.W,u),u}return 0}if(a.g||Ee(`Cannot pass "${Ls(a)}" as a ${this.name}`),a.g.o||Ee(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&a.g.u.ta&&Ee(`Cannot convert argument of type ${a.g.L?a.g.L.name:a.g.u.name} to parameter type ${this.name}`),u=Fi(a.g.o,a.g.u.i,this.i),this.ua)switch(a.g.G===void 0&&Ee("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:a.g.L===this?u=a.g.G:Ee(`Cannot convert argument of type ${a.g.L?a.g.L.name:a.g.u.name} to parameter type ${this.name}`);break;case 1:u=a.g.G;break;case 2:if(a.g.L===this)u=a.g.G;else{var f=a.clone();u=this.oc(u,er(function(){f.delete()})),i!==null&&i.push(this.W,u)}break;default:Ee("Unsupporting sharing policy")}return u}function Du(i,a){return a===null?(this.Na&&Ee(`null is not a valid ${this.name}`),0):(a.g||Ee(`Cannot pass "${Ls(a)}" as a ${this.name}`),a.g.o||Ee(`Cannot pass deleted object as a pointer of type ${this.name}`),a.g.u.ta&&Ee(`Cannot convert argument of type ${a.g.u.name} to parameter type ${this.name}`),Fi(a.g.o,a.g.u.i,this.i))}function br(i,a,u,f){this.name=i,this.i=a,this.Na=u,this.ta=f,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,a.A!==void 0?this.toWireType=Lu:(this.toWireType=f?Mu:Du,this.K=null)}function oo(i,a,u){_.hasOwnProperty(i)||ji("Replacing nonexistant public symbol"),_[i].B!==void 0&&u!==void 0?_[i].B[u]=a:(_[i]=a,_[i].ea=u)}var Ui=[],lo=i=>{var a=Ui[i];return a||(i>=Ui.length&&(Ui.length=i+1),Ui[i]=a=Oe.get(i)),a},$u=(i,a)=>{var u=[];return function(){if(u.length=0,Object.assign(u,arguments),i.includes("j")){var f=_["dynCall_"+i];f=u&&u.length?f.apply(null,[a].concat(u)):f.call(null,a)}else f=lo(a).apply(null,u);return f}};function At(i,a){i=st(i);var u=i.includes("j")?$u(i,a):lo(a);return typeof u!="function"&&Ee(`unknown function pointer with signature ${i}: ${a}`),u}var uo=void 0;function kr(i,a){function u(b){y[b]||Yr[b]||(Di[b]?Di[b].forEach(u):(f.push(b),y[b]=!0))}var f=[],y={};throw a.forEach(u),new uo(`${i}: `+f.map(ro).join([", "]))}function Bi(i,a,u,f,y){var b=a.length;2>b&&Ee("argTypes array size mismatch! Must at least get return value and 'this' types!");var A=a[1]!==null&&u!==null,P=!1;for(u=1;u<a.length;++u)if(a[u]!==null&&a[u].K===void 0){P=!0;break}var L=a[0].name!=="void",T=b-2,Y=Array(T),Z=[],se=[];return function(){if(arguments.length!==T&&Ee(`function ${i} called with ${arguments.length} arguments, expected ${T} args!`),se.length=0,Z.length=A?2:1,Z[0]=y,A){var I=a[1].toWireType(se,this);Z[1]=I}for(var G=0;G<T;++G)Y[G]=a[G+2].toWireType(se,arguments[G]),Z.push(Y[G]);if(G=f.apply(null,Z),P)ni(se);else for(var H=A?1:2;H<a.length;H++){var Ae=H===1?I:Y[H-2];a[H].K!==null&&a[H].K(Ae)}return I=L?a[0].fromWireType(G):void 0,I}}function Ni(i,a){for(var u=[],f=0;f<i;f++)u.push(Pe[a+4*f>>2]);return u}function co(i,a,u){return i instanceof Object||Ee(`${u} with invalid "this": ${i}`),i instanceof a.i.constructor||Ee(`${u} incompatible with "this" of type ${i.constructor.name}`),i.g.o||Ee(`cannot call emscripten binding method ${u} on deleted object`),Fi(i.g.o,i.g.u.i,a.i)}function Ms(i){i>=qt.h&&--qt.get(i).ub===0&&qt.Zb(i)}function Fu(i,a,u){switch(a){case 0:return function(f){return this.fromWireType((u?We:xe)[f])};case 1:return function(f){return this.fromWireType((u?Re:at)[f>>1])};case 2:return function(f){return this.fromWireType((u?ye:Pe)[f>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Ls(i){if(i===null)return"null";var a=typeof i;return a==="object"||a==="array"||a==="function"?i.toString():""+i}function Uu(i,a){switch(a){case 2:return function(u){return this.fromWireType(ke[u>>2])};case 3:return function(u){return this.fromWireType(de[u>>3])};default:throw new TypeError("Unknown float type: "+i)}}function Bu(i,a,u){switch(a){case 0:return u?function(f){return We[f]}:function(f){return xe[f]};case 1:return u?function(f){return Re[f>>1]}:function(f){return at[f>>1]};case 2:return u?function(f){return ye[f>>2]}:function(f){return Pe[f>>2]};default:throw new TypeError("Unknown integer type: "+i)}}var ho=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Nu=(i,a)=>{for(var u=i>>1,f=u+a/2;!(u>=f)&&at[u];)++u;if(u<<=1,32<u-i&&ho)return ho.decode(xe.subarray(i,u));for(u="",f=0;!(f>=a/2);++f){var y=Re[i+2*f>>1];if(y==0)break;u+=String.fromCharCode(y)}return u},Wu=(i,a,u)=>{if(u===void 0&&(u=2147483647),2>u)return 0;u-=2;var f=a;u=u<2*i.length?u/2:i.length;for(var y=0;y<u;++y)Re[a>>1]=i.charCodeAt(y),a+=2;return Re[a>>1]=0,a-f},Vu=i=>2*i.length,qu=(i,a)=>{for(var u=0,f="";!(u>=a/4);){var y=ye[i+4*u>>2];if(y==0)break;++u,65536<=y?(y-=65536,f+=String.fromCharCode(55296|y>>10,56320|y&1023)):f+=String.fromCharCode(y)}return f},Hu=(i,a,u)=>{if(u===void 0&&(u=2147483647),4>u)return 0;var f=a;u=f+u-4;for(var y=0;y<i.length;++y){var b=i.charCodeAt(y);if(55296<=b&&57343>=b){var A=i.charCodeAt(++y);b=65536+((b&1023)<<10)|A&1023}if(ye[a>>2]=b,a+=4,a+4>u)break}return ye[a>>2]=0,a-f},zu=i=>{for(var a=0,u=0;u<i.length;++u){var f=i.charCodeAt(u);55296<=f&&57343>=f&&++u,a+=4}return a},Gu={};function Wi(i){var a=Gu[i];return a===void 0?st(i):a}var Vi=[];function Ku(i){var a=Vi.length;return Vi.push(i),a}function Yu(i,a){for(var u=Array(i),f=0;f<i;++f)u[f]=ri(Pe[a+4*f>>2],"parameter "+f);return u}var fo=[],Ds=[],$s={},vo=()=>{if(!Fs){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:j||"./this.program"},a;for(a in $s)$s[a]===void 0?delete i[a]:i[a]=$s[a];var u=[];for(a in i)u.push(`${a}=${i[a]}`);Fs=u}return Fs},Fs,qi=i=>i%4===0&&(i%100!==0||i%400===0),po=[31,29,31,30,31,30,31,31,30,31,30,31],go=[31,28,31,30,31,30,31,31,30,31,30,31],Ju=(i,a,u,f)=>{function y(I,G,H){for(I=typeof I=="number"?I.toString():I||"";I.length<G;)I=H[0]+I;return I}function b(I,G){return y(I,G,"0")}function A(I,G){function H(Te){return 0>Te?-1:0<Te?1:0}var Ae;return(Ae=H(I.getFullYear()-G.getFullYear()))===0&&(Ae=H(I.getMonth()-G.getMonth()))===0&&(Ae=H(I.getDate()-G.getDate())),Ae}function P(I){switch(I.getDay()){case 0:return new Date(I.getFullYear()-1,11,29);case 1:return I;case 2:return new Date(I.getFullYear(),0,3);case 3:return new Date(I.getFullYear(),0,2);case 4:return new Date(I.getFullYear(),0,1);case 5:return new Date(I.getFullYear()-1,11,31);case 6:return new Date(I.getFullYear()-1,11,30)}}function L(I){var G=I.ca;for(I=new Date(new Date(I.da+1900,0,1).getTime());0<G;){var H=I.getMonth(),Ae=(qi(I.getFullYear())?po:go)[H];if(G>Ae-I.getDate())G-=Ae-I.getDate()+1,I.setDate(1),11>H?I.setMonth(H+1):(I.setMonth(0),I.setFullYear(I.getFullYear()+1));else{I.setDate(I.getDate()+G);break}}return H=new Date(I.getFullYear()+1,0,4),G=P(new Date(I.getFullYear(),0,4)),H=P(H),0>=A(G,I)?0>=A(H,I)?I.getFullYear()+1:I.getFullYear():I.getFullYear()-1}var T=ye[f+40>>2];f={wc:ye[f>>2],vc:ye[f+4>>2],Fa:ye[f+8>>2],Sa:ye[f+12>>2],Ga:ye[f+16>>2],da:ye[f+20>>2],R:ye[f+24>>2],ca:ye[f+28>>2],Rc:ye[f+32>>2],uc:ye[f+36>>2],xc:T&&T?Ve(xe,T):""},u=u?Ve(xe,u):"",T={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var Y in T)u=u.replace(new RegExp(Y,"g"),T[Y]);var Z="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),se="January February March April May June July August September October November December".split(" ");T={"%a":I=>Z[I.R].substring(0,3),"%A":I=>Z[I.R],"%b":I=>se[I.Ga].substring(0,3),"%B":I=>se[I.Ga],"%C":I=>b((I.da+1900)/100|0,2),"%d":I=>b(I.Sa,2),"%e":I=>y(I.Sa,2," "),"%g":I=>L(I).toString().substring(2),"%G":I=>L(I),"%H":I=>b(I.Fa,2),"%I":I=>(I=I.Fa,I==0?I=12:12<I&&(I-=12),b(I,2)),"%j":I=>{for(var G=0,H=0;H<=I.Ga-1;G+=(qi(I.da+1900)?po:go)[H++]);return b(I.Sa+G,3)},"%m":I=>b(I.Ga+1,2),"%M":I=>b(I.vc,2),"%n":()=>`
`,"%p":I=>0<=I.Fa&&12>I.Fa?"AM":"PM","%S":I=>b(I.wc,2),"%t":()=>"	","%u":I=>I.R||7,"%U":I=>b(Math.floor((I.ca+7-I.R)/7),2),"%V":I=>{var G=Math.floor((I.ca+7-(I.R+6)%7)/7);if(2>=(I.R+371-I.ca-2)%7&&G++,G)G==53&&(H=(I.R+371-I.ca)%7,H==4||H==3&&qi(I.da)||(G=1));else{G=52;var H=(I.R+7-I.ca-1)%7;(H==4||H==5&&qi(I.da%400-1))&&G++}return b(G,2)},"%w":I=>I.R,"%W":I=>b(Math.floor((I.ca+7-(I.R+6)%7)/7),2),"%y":I=>(I.da+1900).toString().substring(2),"%Y":I=>I.da+1900,"%z":I=>{I=I.uc;var G=0<=I;return I=Math.abs(I)/60,(G?"+":"-")+("0000"+(I/60*100+I%60)).slice(-4)},"%Z":I=>I.xc,"%%":()=>"%"},u=u.replace(/%%/g,"\0\0");for(Y in T)u.includes(Y)&&(u=u.replace(new RegExp(Y,"g"),T[Y](f)));return u=u.replace(/\0\0/g,"%"),Y=Qe(u,!1),Y.length>a?0:(We.set(Y,i),Y.length-1)};function _o(i,a,u,f){i||(i=this),this.parent=i,this.U=i.U,this.wa=null,this.id=Cu++,this.name=a,this.mode=u,this.l={},this.m={},this.za=f}Object.defineProperties(_o.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(i){i?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(i){i?this.mode|=146:this.mode&=-147}}}),Ya(),Jn=Array(4096),Ga(_e,"/"),Qt("/tmp",16895,0),Qt("/home",16895,0),Qt("/home/web_user",16895,0),(()=>{Qt("/dev",16895,0),Ss(259,{read:()=>0,write:(f,y,b,A)=>A}),Ti("/dev/null",259),it(1280,Rr),it(1536,Or),Ti("/dev/tty",1280),Ti("/dev/tty1",1536);var i=new Uint8Array(1024),a=0,u=()=>(a===0&&(a=me(i).byteLength),i[--a]);Xn("random",u),Xn("urandom",u),Qt("/dev/shm",16895,0),Qt("/dev/shm/tmp",16895,0)})(),(()=>{Qt("/proc",16895,0);var i=Qt("/proc/self",16895,0);Qt("/proc/self/fd",16895,0),Ga({U:()=>{var a=Va(i,"fd",16895,73);return a.l={ka:(u,f)=>{var y=jr(+f);return u={parent:null,U:{nb:"fake"},l:{ma:()=>y.path}},u.parent=u}},a}},"/proc/self/fd")})(),Object.assign(Qa.prototype,{get(i){return this.M[i]},has(i){return this.M[i]!==void 0},pa(i){var a=this.ib.pop()||this.M.length;return this.M[a]=i,a},Zb(i){this.M[i]=void 0,this.ib.push(i)}}),mn=_.BindingError=class extends Error{constructor(i){super(i),this.name="BindingError"}},qt.M.push({value:void 0},{value:null},{value:!0},{value:!1}),qt.h=qt.M.length,_.count_emval_handles=function(){for(var i=0,a=qt.h;a<qt.M.length;++a)qt.M[a]!==void 0&&++i;return i},eo=_.PureVirtualError=Za("PureVirtualError");for(var mo=Array(256),Hi=0;256>Hi;++Hi)mo[Hi]=String.fromCharCode(Hi);to=mo,_.getInheritedInstanceCount=function(){return Object.keys(wr).length},_.getLiveInheritedInstances=function(){var i=[],a;for(a in wr)wr.hasOwnProperty(a)&&i.push(wr[a]);return i},_.flushPendingDeletes=Ts,_.setDelayFunction=function(i){ti=i,ei.length&&ti&&ti(Ts)},ao=_.InternalError=class extends Error{constructor(i){super(i),this.name="InternalError"}},Mr.prototype.isAliasOf=function(i){if(!(this instanceof Mr&&i instanceof Mr))return!1;var a=this.g.u.i,u=this.g.o,f=i.g.u.i;for(i=i.g.o;a.A;)u=a.na(u),a=a.A;for(;f.A;)i=f.na(i),f=f.A;return a===f&&u===i},Mr.prototype.clone=function(){if(this.g.o||Rs(this),this.g.ia)return this.g.count.value+=1,this;var i=yn,a=Object,u=a.create,f=Object.getPrototypeOf(this),y=this.g;return i=i(u.call(a,f,{g:{value:{count:y.count,fa:y.fa,ia:y.ia,o:y.o,u:y.u,G:y.G,L:y.L}}})),i.g.count.value+=1,i.g.fa=!1,i},Mr.prototype.delete=function(){this.g.o||Rs(this),this.g.fa&&!this.g.ia&&Ee("Object already scheduled for deletion"),Oi(this),no(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},Mr.prototype.isDeleted=function(){return!this.g.o},Mr.prototype.deleteLater=function(){return this.g.o||Rs(this),this.g.fa&&!this.g.ia&&Ee("Object already scheduled for deletion"),ei.push(this),ei.length===1&&ti&&ti(Ts),this.g.fa=!0,this},br.prototype.Vb=function(i){return this.sb&&(i=this.sb(i)),i},br.prototype.bb=function(i){this.W&&this.W(i)},br.prototype.argPackAdvance=8,br.prototype.readValueFromPointer=ii,br.prototype.deleteObject=function(i){i!==null&&i.delete()},br.prototype.fromWireType=function(i){function a(){return this.ua?Mi(this.i.N,{u:this.nc,o:u,L:this,G:i}):Mi(this.i.N,{u:this,o:i})}var u=this.Vb(i);if(!u)return this.bb(i),null;var f=Ru(this.i,u);if(f!==void 0)return f.g.count.value===0?(f.g.o=u,f.g.G=i,f.clone()):(f=f.clone(),this.bb(i),f);if(f=this.i.Ub(u),f=so[f],!f)return a.call(this);f=this.ta?f.Kb:f.pointerType;var y=io(u,this.i,f.i);return y===null?a.call(this):this.ua?Mi(f.i.N,{u:f,o:y,L:this,G:i}):Mi(f.i.N,{u:f,o:y})},uo=_.UnboundTypeError=Za("UnboundTypeError");var yo={__syscall_fcntl64:function(i,a,u){Zn=u;try{var f=jr(i);switch(a){case 0:var y=yr();return 0>y?-28:za(f,y).X;case 1:case 2:return 0;case 3:return f.flags;case 4:return y=yr(),f.flags|=y,0;case 5:return y=yr(),Re[y+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return ye[wo()>>2]=28,-1;default:return-28}}catch(b){if(typeof Kr>"u"||b.name!=="ErrnoError")throw b;return-b.aa}},__syscall_ioctl:function(i,a,u){Zn=u;try{var f=jr(i);switch(a){case 21509:return f.s?0:-59;case 21505:if(!f.s)return-59;if(f.s.V.bc){a=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var y=yr();ye[y>>2]=25856,ye[y+4>>2]=5,ye[y+8>>2]=191,ye[y+12>>2]=35387;for(var b=0;32>b;b++)We[y+b+17>>0]=a[b]||0}return 0;case 21510:case 21511:case 21512:return f.s?0:-59;case 21506:case 21507:case 21508:if(!f.s)return-59;if(f.s.V.cc)for(y=yr(),a=[],b=0;32>b;b++)a.push(We[y+b+17>>0]);return 0;case 21519:return f.s?(y=yr(),ye[y>>2]=0):-59;case 21520:return f.s?-28:-59;case 21531:if(y=yr(),!f.m.ac)throw new ae(59);return f.m.ac(f,a,y);case 21523:return f.s?(f.s.V.dc&&(b=[24,80],y=yr(),Re[y>>1]=b[0],Re[y+2>>1]=b[1]),0):-59;case 21524:return f.s?0:-59;case 21515:return f.s?0:-59;default:return-28}}catch(A){if(typeof Kr>"u"||A.name!=="ErrnoError")throw A;return-A.aa}},__syscall_openat:function(i,a,u,f){Zn=f;try{a=a?Ve(xe,a):"";var y=a;if(y.charAt(0)==="/")a=y;else{var b=i===-100?"/":jr(i).path;if(y.length==0)throw new ae(44);a=C(b+"/"+y)}var A=f?yr():0;return Pi(a,u,A).X}catch(P){if(typeof Kr>"u"||P.name!=="ErrnoError")throw P;return-P.aa}},_embind_create_inheriting_constructor:function(i,a,u){i=st(i),a=ri(a,"wrapper"),u=Zt(u);var f=[].slice,y=a.i,b=y.N,A=y.A.N,P=y.A.constructor;i=Ri(i,function(){y.A.rb.forEach((function(T){if(this[T]===A[T])throw new eo(`Pure virtual function ${T} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:b}),this.__construct.apply(this,f.call(arguments))}),b.__construct=function(){this===b&&Ee("Pass correct 'this' to __construct");var T=P.implement.apply(void 0,[this].concat(f.call(arguments)));Oi(T);var Y=T.g;T.notifyOnDestruction(),Y.ia=!0,Object.defineProperties(this,{g:{value:Y}}),yn(this),T=Y.o,T=Ps(y,T),wr.hasOwnProperty(T)?Ee(`Tried to register registered instance: ${T}`):wr[T]=this},b.__destruct=function(){this===b&&Ee("Pass correct 'this' to __destruct"),Oi(this);var T=this.g.o;T=Ps(y,T),wr.hasOwnProperty(T)?delete wr[T]:Ee(`Tried to unregister unregistered instance: ${T}`)},i.prototype=Object.create(b);for(var L in u)i.prototype[L]=u[L];return er(i)},_embind_finalize_value_object:function(i){var a=Li[i];delete Li[i];var u=a.Pa,f=a.W,y=a.fb,b=y.map(A=>A.Yb).concat(y.map(A=>A.rc));$t([i],b,A=>{var P={};return y.forEach((L,T)=>{var Y=A[T],Z=L.Wb,se=L.Xb,I=A[T+y.length],G=L.qc,H=L.sc;P[L.Sb]={read:Ae=>Y.fromWireType(Z(se,Ae)),write:(Ae,Te)=>{var te=[];G(H,Ae,I.toWireType(te,Te)),ni(te)}}}),[{name:a.name,fromWireType:function(L){var T={},Y;for(Y in P)T[Y]=P[Y].read(L);return f(L),T},toWireType:function(L,T){for(var Y in P)if(!(Y in T))throw new TypeError(`Missing field: "${Y}"`);var Z=u();for(Y in P)P[Y].write(Z,T[Y]);return L!==null&&L.push(f,Z),Z},argPackAdvance:8,readValueFromPointer:ii,K:f}]})},_embind_register_bigint:function(){},_embind_register_bool:function(i,a,u,f,y){var b=$i(u);a=st(a),ur(i,{name:a,fromWireType:function(A){return!!A},toWireType:function(A,P){return P?f:y},argPackAdvance:8,readValueFromPointer:function(A){if(u===1)var P=We;else if(u===2)P=Re;else if(u===4)P=ye;else throw new TypeError("Unknown boolean type size: "+a);return this.fromWireType(P[A>>b])},K:null})},_embind_register_class:function(i,a,u,f,y,b,A,P,L,T,Y,Z,se){Y=st(Y),b=At(y,b),P&&(P=At(A,P)),T&&(T=At(L,T)),se=At(Z,se);var I=Xa(Y);js(I,function(){kr(`Cannot construct ${Y} due to unbound types`,[f])}),$t([i,a,u],f?[f]:[],function(G){if(G=G[0],f)var H=G.i,Ae=H.N;else Ae=Mr.prototype;G=Ri(I,function(){if(Object.getPrototypeOf(this)!==Te)throw new mn("Use 'new' to construct "+Y);if(te.$===void 0)throw new mn(Y+" has no accessible constructor");var kt=te.$[arguments.length];if(kt===void 0)throw new mn(`Tried to invoke ctor of ${Y} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(te.$).toString()}) parameters instead!`);return kt.apply(this,arguments)});var Te=Object.create(Ae,{constructor:{value:G}});G.prototype=Te;var te=new ju(Y,G,Te,se,H,b,P,T);te.A&&(te.A.oa===void 0&&(te.A.oa=[]),te.A.oa.push(te)),H=new br(Y,te,!0,!1),Ae=new br(Y+"*",te,!1,!1);var Ze=new br(Y+" const*",te,!1,!0);return so[i]={pointerType:Ae,Kb:Ze},oo(I,G),[H,Ae,Ze]})},_embind_register_class_class_function:function(i,a,u,f,y,b,A){var P=Ni(u,f);a=st(a),b=At(y,b),$t([],[i],function(L){function T(){kr(`Cannot call ${Y} due to unbound types`,P)}L=L[0];var Y=`${L.name}.${a}`;a.startsWith("@@")&&(a=Symbol[a.substring(2)]);var Z=L.i.constructor;return Z[a]===void 0?(T.ea=u-1,Z[a]=T):(Os(Z,a,Y),Z[a].B[u-1]=T),$t([],P,function(se){if(se=Bi(Y,[se[0],null].concat(se.slice(1)),null,b,A),Z[a].B===void 0?(se.ea=u-1,Z[a]=se):Z[a].B[u-1]=se,L.i.oa)for(const I of L.i.oa)I.constructor.hasOwnProperty(a)||(I.constructor[a]=se);return[]}),[]})},_embind_register_class_class_property:function(i,a,u,f,y,b,A,P){a=st(a),b=At(y,b),$t([],[i],function(L){L=L[0];var T=`${L.name}.${a}`,Y={get(){kr(`Cannot access ${T} due to unbound types`,[u])},enumerable:!0,configurable:!0};return Y.set=P?()=>{kr(`Cannot access ${T} due to unbound types`,[u])}:()=>{Ee(`${T} is a read-only property`)},Object.defineProperty(L.i.constructor,a,Y),$t([],[u],function(Z){Z=Z[0];var se={get(){return Z.fromWireType(b(f))},enumerable:!0};return P&&(P=At(A,P),se.set=I=>{var G=[];P(f,Z.toWireType(G,I)),ni(G)}),Object.defineProperty(L.i.constructor,a,se),[]}),[]})},_embind_register_class_constructor:function(i,a,u,f,y,b){var A=Ni(a,u);y=At(f,y),$t([],[i],function(P){P=P[0];var L=`constructor ${P.name}`;if(P.i.$===void 0&&(P.i.$=[]),P.i.$[a-1]!==void 0)throw new mn(`Cannot register multiple constructors with identical number of parameters (${a-1}) for class '${P.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return P.i.$[a-1]=()=>{kr(`Cannot construct ${P.name} due to unbound types`,A)},$t([],A,function(T){return T.splice(1,0,null),P.i.$[a-1]=Bi(L,T,null,y,b),[]}),[]})},_embind_register_class_function:function(i,a,u,f,y,b,A,P){var L=Ni(u,f);a=st(a),b=At(y,b),$t([],[i],function(T){function Y(){kr(`Cannot call ${Z} due to unbound types`,L)}T=T[0];var Z=`${T.name}.${a}`;a.startsWith("@@")&&(a=Symbol[a.substring(2)]),P&&T.i.rb.push(a);var se=T.i.N,I=se[a];return I===void 0||I.B===void 0&&I.className!==T.name&&I.ea===u-2?(Y.ea=u-2,Y.className=T.name,se[a]=Y):(Os(se,a,Z),se[a].B[u-2]=Y),$t([],L,function(G){return G=Bi(Z,G,T,b,A),se[a].B===void 0?(G.ea=u-2,se[a]=G):se[a].B[u-2]=G,[]}),[]})},_embind_register_class_property:function(i,a,u,f,y,b,A,P,L,T){a=st(a),y=At(f,y),$t([],[i],function(Y){Y=Y[0];var Z=`${Y.name}.${a}`,se={get(){kr(`Cannot access ${Z} due to unbound types`,[u,A])},enumerable:!0,configurable:!0};return se.set=L?()=>{kr(`Cannot access ${Z} due to unbound types`,[u,A])}:()=>{Ee(Z+" is a read-only property")},Object.defineProperty(Y.i.N,a,se),$t([],L?[u,A]:[u],function(I){var G=I[0],H={get(){var Te=co(this,Y,Z+" getter");return G.fromWireType(y(b,Te))},enumerable:!0};if(L){L=At(P,L);var Ae=I[1];H.set=function(Te){var te=co(this,Y,Z+" setter"),Ze=[];L(T,te,Ae.toWireType(Ze,Te)),ni(Ze)}}return Object.defineProperty(Y.i.N,a,H),[]}),[]})},_embind_register_emval:function(i,a){a=st(a),ur(i,{name:a,fromWireType:function(u){var f=Zt(u);return Ms(u),f},toWireType:function(u,f){return er(f)},argPackAdvance:8,readValueFromPointer:ii,K:null})},_embind_register_enum:function(i,a,u,f){function y(){}u=$i(u),a=st(a),y.values={},ur(i,{name:a,constructor:y,fromWireType:function(b){return this.constructor.values[b]},toWireType:function(b,A){return A.value},argPackAdvance:8,readValueFromPointer:Fu(a,u,f),K:null}),js(a,y)},_embind_register_enum_value:function(i,a,u){var f=ri(i,"enum");a=st(a),i=f.constructor,f=Object.create(f.constructor.prototype,{value:{value:u},constructor:{value:Ri(`${f.name}_${a}`,function(){})}}),i.values[u]=f,i[a]=f},_embind_register_float:function(i,a,u){u=$i(u),a=st(a),ur(i,{name:a,fromWireType:function(f){return f},toWireType:function(f,y){return y},argPackAdvance:8,readValueFromPointer:Uu(a,u),K:null})},_embind_register_function:function(i,a,u,f,y,b){var A=Ni(a,u);i=st(i),y=At(f,y),js(i,function(){kr(`Cannot call ${i} due to unbound types`,A)},a-1),$t([],A,function(P){return oo(i,Bi(i,[P[0],null].concat(P.slice(1)),null,y,b),a-1),[]})},_embind_register_integer:function(i,a,u,f,y){a=st(a),y===-1&&(y=4294967295),y=$i(u);var b=P=>P;if(f===0){var A=32-8*u;b=P=>P<<A>>>A}u=a.includes("unsigned")?function(P,L){return L>>>0}:function(P,L){return L},ur(i,{name:a,fromWireType:b,toWireType:u,argPackAdvance:8,readValueFromPointer:Bu(a,y,f!==0),K:null})},_embind_register_memory_view:function(i,a,u){function f(b){b>>=2;var A=Pe;return new y(A.buffer,A[b+1],A[b])}var y=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][a];u=st(u),ur(i,{name:u,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{$b:!0})},_embind_register_std_string:function(i,a){a=st(a);var u=a==="std::string";ur(i,{name:a,fromWireType:function(f){var y=Pe[f>>2],b=f+4;if(u)for(var A=b,P=0;P<=y;++P){var L=b+P;if(P==y||xe[L]==0){if(A=A?Ve(xe,A,L-A):"",T===void 0)var T=A;else T+="\0",T+=A;A=L+1}}else{for(T=Array(y),P=0;P<y;++P)T[P]=String.fromCharCode(xe[b+P]);T=T.join("")}return Er(f),T},toWireType:function(f,y){y instanceof ArrayBuffer&&(y=new Uint8Array(y));var b=typeof y=="string";b||y instanceof Uint8Array||y instanceof Uint8ClampedArray||y instanceof Int8Array||Ee("Cannot pass non-string to std::string");var A=u&&b?pe(y):y.length,P=Us(4+A+1),L=P+4;if(Pe[P>>2]=A,u&&b)nt(y,xe,L,A+1);else if(b)for(b=0;b<A;++b){var T=y.charCodeAt(b);255<T&&(Er(L),Ee("String has UTF-16 code units that do not fit in 8 bits")),xe[L+b]=T}else for(b=0;b<A;++b)xe[L+b]=y[b];return f!==null&&f.push(Er,P),P},argPackAdvance:8,readValueFromPointer:ii,K:function(f){Er(f)}})},_embind_register_std_wstring:function(i,a,u){if(u=st(u),a===2)var f=Nu,y=Wu,b=Vu,A=()=>at,P=1;else a===4&&(f=qu,y=Hu,b=zu,A=()=>Pe,P=2);ur(i,{name:u,fromWireType:function(L){for(var T=Pe[L>>2],Y=A(),Z,se=L+4,I=0;I<=T;++I){var G=L+4+I*a;(I==T||Y[G>>P]==0)&&(se=f(se,G-se),Z===void 0?Z=se:(Z+="\0",Z+=se),se=G+a)}return Er(L),Z},toWireType:function(L,T){typeof T!="string"&&Ee(`Cannot pass non-string to C++ string type ${u}`);var Y=b(T),Z=Us(4+Y+a);return Pe[Z>>2]=Y>>P,y(T,Z+4,Y+a),L!==null&&L.push(Er,Z),Z},argPackAdvance:8,readValueFromPointer:ii,K:function(L){Er(L)}})},_embind_register_value_object:function(i,a,u,f,y,b){Li[i]={name:st(a),Pa:At(u,f),W:At(y,b),fb:[]}},_embind_register_value_object_field:function(i,a,u,f,y,b,A,P,L,T){Li[i].fb.push({Sb:st(a),Yb:u,Wb:At(f,y),Xb:b,rc:A,qc:At(P,L),sc:T})},_embind_register_void:function(i,a){a=st(a),ur(i,{fc:!0,name:a,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(i,a,u){i=Zt(i),a=ri(a,"emval::as");var f=[],y=er(f);return Pe[u>>2]=y,a.toWireType(f,i)},_emval_call_method:function(i,a,u,f,y){i=Vi[i],a=Zt(a),u=Wi(u);var b=[];return Pe[f>>2]=er(b),i(a,u,b,y)},_emval_call_void_method:function(i,a,u,f){i=Vi[i],a=Zt(a),u=Wi(u),i(a,u,null,f)},_emval_decref:Ms,_emval_get_method_caller:function(i,a){var u=Yu(i,a),f=u[0];a=f.name+"_$"+u.slice(1).map(function(A){return A.name}).join("_")+"$";var y=fo[a];if(y!==void 0)return y;var b=Array(i-1);return y=Ku((A,P,L,T)=>{for(var Y=0,Z=0;Z<i-1;++Z)b[Z]=u[Z+1].readValueFromPointer(T+Y),Y+=u[Z+1].argPackAdvance;for(A=A[P].apply(A,b),Z=0;Z<i-1;++Z)u[Z+1].Nb&&u[Z+1].Nb(b[Z]);if(!f.fc)return f.toWireType(L,A)}),fo[a]=y},_emval_get_module_property:function(i){return i=Wi(i),er(_[i])},_emval_get_property:function(i,a){return i=Zt(i),a=Zt(a),er(i[a])},_emval_incref:function(i){4<i&&(qt.get(i).ub+=1)},_emval_new_array:function(){return er([])},_emval_new_cstring:function(i){return er(Wi(i))},_emval_new_object:function(){return er({})},_emval_run_destructors:function(i){var a=Zt(i);ni(a),Ms(i)},_emval_set_property:function(i,a,u){i=Zt(i),a=Zt(a),u=Zt(u),i[a]=u},_emval_take_value:function(i,a){return i=ri(i,"_emval_take_value"),i=i.readValueFromPointer(a),er(i)},abort:()=>{Lt("")},emscripten_asm_const_int:(i,a,u)=>{Ds.length=0;var f;for(u>>=2;f=xe[a++];)u+=f!=105&u,Ds.push(f==105?ye[u]:de[u++>>1]),++u;return o[i].apply(null,Ds)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(i,a,u)=>xe.copyWithin(i,a,a+u),emscripten_resize_heap:i=>{var a=xe.length;if(i>>>=0,2147483648<i)return!1;for(var u=1;4>=u;u*=2){var f=a*(1+.2/u);f=Math.min(f,i+100663296);var y=Math;f=Math.max(i,f);e:{y=y.min.call(y,2147483648,f+(65536-f%65536)%65536)-ve.buffer.byteLength+65535>>>16;try{ve.grow(y),ge();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},environ_get:(i,a)=>{var u=0;return vo().forEach(function(f,y){var b=a+u;for(y=Pe[i+4*y>>2]=b,b=0;b<f.length;++b)We[y++>>0]=f.charCodeAt(b);We[y>>0]=0,u+=f.length+1}),0},environ_sizes_get:(i,a)=>{var u=vo();Pe[i>>2]=u.length;var f=0;return u.forEach(function(y){f+=y.length+1}),Pe[a>>2]=f,0},fd_close:function(i){try{var a=jr(i);if(a.X===null)throw new ae(8);a.Ma&&(a.Ma=null);try{a.m.close&&a.m.close(a)}catch(u){throw u}finally{Si[a.X]=null}return a.X=null,0}catch(u){if(typeof Kr>"u"||u.name!=="ErrnoError")throw u;return u.aa}},fd_read:function(i,a,u,f){try{e:{var y=jr(i);i=a;for(var b,A=a=0;A<u;A++){var P=Pe[i>>2],L=Pe[i+4>>2];i+=8;var T=y,Y=P,Z=L,se=b,I=We;if(0>Z||0>se)throw new ae(28);if(T.X===null)throw new ae(8);if((T.flags&2097155)===1)throw new ae(8);if((T.node.mode&61440)===16384)throw new ae(31);if(!T.m.read)throw new ae(28);var G=typeof se<"u";if(!G)se=T.position;else if(!T.seekable)throw new ae(70);var H=T.m.read(T,I,Y,Z,se);G||(T.position+=H);var Ae=H;if(0>Ae){var Te=-1;break e}if(a+=Ae,Ae<L)break;typeof b<"u"&&(b+=Ae)}Te=a}return Pe[f>>2]=Te,0}catch(te){if(typeof Kr>"u"||te.name!=="ErrnoError")throw te;return te.aa}},fd_seek:function(i,a,u,f,y){a=u+2097152>>>0<4194305-!!a?(a>>>0)+4294967296*u:NaN;try{if(isNaN(a))return 61;var b=jr(i);return Ka(b,a,f),p=[b.position>>>0,(Dt=b.position,1<=+Math.abs(Dt)?0<Dt?+Math.floor(Dt/4294967296)>>>0:~~+Math.ceil((Dt-+(~~Dt>>>0))/4294967296)>>>0:0)],ye[y>>2]=p[0],ye[y+4>>2]=p[1],b.Ma&&a===0&&f===0&&(b.Ma=null),0}catch(A){if(typeof Kr>"u"||A.name!=="ErrnoError")throw A;return A.aa}},fd_write:function(i,a,u,f){try{e:{var y=jr(i);i=a;for(var b,A=a=0;A<u;A++){var P=Pe[i>>2],L=Pe[i+4>>2];i+=8;var T=y,Y=P,Z=L,se=b,I=We;if(0>Z||0>se)throw new ae(28);if(T.X===null)throw new ae(8);if((T.flags&2097155)===0)throw new ae(8);if((T.node.mode&61440)===16384)throw new ae(31);if(!T.m.write)throw new ae(28);T.seekable&&T.flags&1024&&Ka(T,0,2);var G=typeof se<"u";if(!G)se=T.position;else if(!T.seekable)throw new ae(70);var H=T.m.write(T,I,Y,Z,se,void 0);G||(T.position+=H);var Ae=H;if(0>Ae){var Te=-1;break e}a+=Ae,typeof b<"u"&&(b+=Ae)}Te=a}return Pe[f>>2]=Te,0}catch(te){if(typeof Kr>"u"||te.name!=="ErrnoError")throw te;return te.aa}},strftime_l:(i,a,u,f)=>Ju(i,a,u,f)};(function(){function i(u){if(oe=u=u.exports,ve=oe.memory,ge(),Oe=oe.__indirect_function_table,bt.unshift(oe.__wasm_call_ctors),vt--,_.monitorRunDependencies&&_.monitorRunDependencies(vt),vt==0&&Tt){var f=Tt;Tt=null,f()}return u}var a={env:yo,wasi_snapshot_preview1:yo};if(vt++,_.monitorRunDependencies&&_.monitorRunDependencies(vt),_.instantiateWasm)try{return _.instantiateWasm(a,i)}catch(u){Fe("Module.instantiateWasm callback failed with error: "+u),D(u)}return zr(a,function(u){i(u.instance)}).catch(D),{}})();var Er=i=>(Er=oe.free)(i),Us=i=>(Us=oe.malloc)(i),wo=()=>(wo=oe.__errno_location)(),bo=_._ma_device__on_notification_unlocked=i=>(bo=_._ma_device__on_notification_unlocked=oe.ma_device__on_notification_unlocked)(i);_._ma_malloc_emscripten=(i,a)=>(_._ma_malloc_emscripten=oe.ma_malloc_emscripten)(i,a),_._ma_free_emscripten=(i,a)=>(_._ma_free_emscripten=oe.ma_free_emscripten)(i,a);var ko=_._ma_device_process_pcm_frames_capture__webaudio=(i,a,u)=>(ko=_._ma_device_process_pcm_frames_capture__webaudio=oe.ma_device_process_pcm_frames_capture__webaudio)(i,a,u),Eo=_._ma_device_process_pcm_frames_playback__webaudio=(i,a,u)=>(Eo=_._ma_device_process_pcm_frames_playback__webaudio=oe.ma_device_process_pcm_frames_playback__webaudio)(i,a,u),Ao=i=>(Ao=oe.__getTypeName)(i);_.__embind_initialize_bindings=()=>(_.__embind_initialize_bindings=oe._embind_initialize_bindings)(),_.dynCall_iiji=(i,a,u,f,y)=>(_.dynCall_iiji=oe.dynCall_iiji)(i,a,u,f,y),_.dynCall_jiji=(i,a,u,f,y)=>(_.dynCall_jiji=oe.dynCall_jiji)(i,a,u,f,y),_.dynCall_iiiji=(i,a,u,f,y,b)=>(_.dynCall_iiiji=oe.dynCall_iiiji)(i,a,u,f,y,b),_.dynCall_iij=(i,a,u,f)=>(_.dynCall_iij=oe.dynCall_iij)(i,a,u,f),_.dynCall_jii=(i,a,u)=>(_.dynCall_jii=oe.dynCall_jii)(i,a,u),_.dynCall_viijii=(i,a,u,f,y,b,A)=>(_.dynCall_viijii=oe.dynCall_viijii)(i,a,u,f,y,b,A),_.dynCall_iiiiij=(i,a,u,f,y,b,A)=>(_.dynCall_iiiiij=oe.dynCall_iiiiij)(i,a,u,f,y,b,A),_.dynCall_iiiiijj=(i,a,u,f,y,b,A,P,L)=>(_.dynCall_iiiiijj=oe.dynCall_iiiiijj)(i,a,u,f,y,b,A,P,L),_.dynCall_iiiiiijj=(i,a,u,f,y,b,A,P,L,T)=>(_.dynCall_iiiiiijj=oe.dynCall_iiiiiijj)(i,a,u,f,y,b,A,P,L,T);var zi;Tt=function i(){zi||So(),zi||(Tt=i)};function So(){function i(){if(!zi&&(zi=!0,_.calledRun=!0,!Ke)){if(_.noFSInit||Ja||(Ja=!0,Ya(),_.stdin=_.stdin,_.stdout=_.stdout,_.stderr=_.stderr,_.stdin?Xn("stdin",_.stdin):Is("/dev/tty","/dev/stdin"),_.stdout?Xn("stdout",null,_.stdout):Is("/dev/tty","/dev/stdout"),_.stderr?Xn("stderr",null,_.stderr):Is("/dev/tty1","/dev/stderr"),Pi("/dev/stdin",0),Pi("/dev/stdout",1),Pi("/dev/stderr",1)),Ba=!1,d(bt),S(_),_.onRuntimeInitialized&&_.onRuntimeInitialized(),_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;){var a=_.postRun.shift();Ct.unshift(a)}d(Ct)}}if(!(0<vt)){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)Nt();d(Ye),0<vt||(_.setStatus?(_.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_.setStatus("")},1),i()},1)):i())}}if(_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);0<_.preInit.length;)_.preInit.pop()();return So(),E.ready})})();const m=g}),(c=>{c.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((c,h,v)=>{v.r(h),v.d(h,{Animation:()=>g.Animation});var g=v(4)}),((c,h,v)=>{v.r(h),v.d(h,{Animation:()=>g});var g=(function(){function m(k,E,_,S){this.animation=k,this.artboard=E,this.playing=S,this.loopCount=0,this.scrubTo=null,this.instance=new _.LinearAnimationInstance(k,E)}return Object.defineProperty(m.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"time",{get:function(){return this.instance.time},set:function(k){this.instance.time=k},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),m.prototype.advance=function(k){this.scrubTo===null?this.instance.advance(k):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},m.prototype.apply=function(k){this.instance.apply(k)},m.prototype.cleanup=function(){this.instance.delete()},m})()}),((c,h,v)=>{v.r(h),v.d(h,{AudioAssetWrapper:()=>k.AudioAssetWrapper,AudioWrapper:()=>k.AudioWrapper,BLANK_URL:()=>m.BLANK_URL,CustomFileAssetLoaderWrapper:()=>k.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>k.FileAssetWrapper,Finalizable:()=>k.Finalizable,FontAssetWrapper:()=>k.FontAssetWrapper,FontWrapper:()=>k.FontWrapper,ImageAssetWrapper:()=>k.ImageAssetWrapper,ImageWrapper:()=>k.ImageWrapper,finalizationRegistry:()=>k.finalizationRegistry,registerTouchInteractions:()=>g.registerTouchInteractions,sanitizeUrl:()=>m.sanitizeUrl});var g=v(6),m=v(7),k=v(8)}),((c,h,v)=>{v.r(h),v.d(h,{registerTouchInteractions:()=>k});var g=void 0,m=function(E,_){var S,D;return["touchstart","touchmove"].indexOf(E.type)>-1&&(!((S=E.touches)===null||S===void 0)&&S.length)?(_||E.preventDefault(),{clientX:E.touches[0].clientX,clientY:E.touches[0].clientY}):E.type==="touchend"&&(!((D=E.changedTouches)===null||D===void 0)&&D.length)?{clientX:E.changedTouches[0].clientX,clientY:E.changedTouches[0].clientY}:{clientX:E.clientX,clientY:E.clientY}},k=function(E){var _=E.canvas,S=E.artboard,D=E.stateMachines,R=D===void 0?[]:D,U=E.renderer,B=E.rive,W=E.fit,z=E.alignment,K=E.isTouchScrollEnabled,O=K===void 0?!1:K,j=E.layoutScaleFactor,ie=j===void 0?1:j;if(!_||!R.length||!U||!B||!S||typeof window>"u")return null;var X=null,ce=!1,Q=function(fe){if(ce&&fe instanceof MouseEvent){fe.type=="mouseup"&&(ce=!1);return}ce=O&&fe.type==="touchend"&&X==="touchstart",X=fe.type;var Fe=fe.currentTarget.getBoundingClientRect(),J=m(fe,O),ve=J.clientX,oe=J.clientY;if(!(!ve&&!oe)){var Ke=ve-Fe.left,We=oe-Fe.top,xe=B.computeAlignment(W,z,{minX:0,minY:0,maxX:Fe.width,maxY:Fe.height},S.bounds,ie),Re=new B.Mat2D;xe.invert(Re);var at=new B.Vec2D(Ke,We),ye=B.mapXY(Re,at),Pe=ye.x(),ke=ye.y();switch(ye.delete(),Re.delete(),at.delete(),xe.delete(),fe.type){case"mouseout":for(var de=0,ge=R;de<ge.length;de++){var Oe=ge[de];Oe.pointerMove(Pe,ke)}break;case"touchmove":case"mouseover":case"mousemove":{for(var Ye=0,bt=R;Ye<bt.length;Ye++){var Oe=bt[Ye];Oe.pointerMove(Pe,ke)}break}case"touchstart":case"mousedown":{for(var Ct=0,Nt=R;Ct<Nt.length;Ct++){var Oe=Nt[Ct];Oe.pointerDown(Pe,ke)}break}case"touchend":case"mouseup":{for(var vt=0,Tt=R;vt<Tt.length;vt++){var Oe=Tt[vt];Oe.pointerUp(Pe,ke)}break}}}},ne=Q.bind(g);return _.addEventListener("mouseover",ne),_.addEventListener("mouseout",ne),_.addEventListener("mousemove",ne),_.addEventListener("mousedown",ne),_.addEventListener("mouseup",ne),_.addEventListener("touchmove",ne,{passive:O}),_.addEventListener("touchstart",ne,{passive:O}),_.addEventListener("touchend",ne),function(){_.removeEventListener("mouseover",ne),_.removeEventListener("mouseout",ne),_.removeEventListener("mousemove",ne),_.removeEventListener("mousedown",ne),_.removeEventListener("mouseup",ne),_.removeEventListener("touchmove",ne),_.removeEventListener("touchstart",ne),_.removeEventListener("touchend",ne)}}}),((c,h,v)=>{v.r(h),v.d(h,{BLANK_URL:()=>D,sanitizeUrl:()=>B});var g=/^([^\w]*)(javascript|data|vbscript)/im,m=/&#(\w+)(^\w|;)?/g,k=/&(newline|tab);/gi,E=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,_=/^.+(:|&colon;)/gim,S=[".","/"],D="about:blank";function R(W){return S.indexOf(W[0])>-1}function U(W){var z=W.replace(E,"");return z.replace(m,function(K,O){return String.fromCharCode(O)})}function B(W){if(!W)return D;var z=U(W).replace(k,"").replace(E,"").trim();if(!z)return D;if(R(z))return z;var K=z.match(_);if(!K)return z;var O=K[0];return g.test(O)?D:z}}),((c,h,v)=>{v.r(h),v.d(h,{AudioAssetWrapper:()=>U,AudioWrapper:()=>E,CustomFileAssetLoaderWrapper:()=>S,FileAssetWrapper:()=>D,Finalizable:()=>m,FontAssetWrapper:()=>B,FontWrapper:()=>_,ImageAssetWrapper:()=>R,ImageWrapper:()=>k,finalizationRegistry:()=>K});var g=(function(){var O=function(j,ie){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,ce){X.__proto__=ce}||function(X,ce){for(var Q in ce)Object.prototype.hasOwnProperty.call(ce,Q)&&(X[Q]=ce[Q])},O(j,ie)};return function(j,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Class extends value "+String(ie)+" is not a constructor or null");O(j,ie);function X(){this.constructor=j}j.prototype=ie===null?Object.create(ie):(X.prototype=ie.prototype,new X)}})(),m=(function(){function O(){this.selfUnref=!1}return O})(),k=(function(O){g(j,O);function j(ie){var X=O.call(this)||this;return X._nativeImage=ie,X}return Object.defineProperty(j.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),j.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},j})(m),E=(function(O){g(j,O);function j(ie){var X=O.call(this)||this;return X._nativeAudio=ie,X}return Object.defineProperty(j.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),j.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},j})(m),_=(function(O){g(j,O);function j(ie){var X=O.call(this)||this;return X._nativeFont=ie,X}return Object.defineProperty(j.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),j.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},j})(m),S=(function(){function O(j,ie){this._assetLoaderCallback=ie,this.assetLoader=new j.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return O.prototype.loadContents=function(j,ie){var X;return j.isImage?X=new R(j):j.isAudio?X=new U(j):j.isFont&&(X=new B(j)),this._assetLoaderCallback(X,ie)},O})(),D=(function(){function O(j){this._nativeFileAsset=j}return O.prototype.decode=function(j){this._nativeFileAsset.decode(j)},Object.defineProperty(O.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),O})(),R=(function(O){g(j,O);function j(){return O!==null&&O.apply(this,arguments)||this}return j.prototype.setRenderImage=function(ie){this._nativeFileAsset.setRenderImage(ie.nativeImage)},j})(D),U=(function(O){g(j,O);function j(){return O!==null&&O.apply(this,arguments)||this}return j.prototype.setAudioSource=function(ie){this._nativeFileAsset.setAudioSource(ie.nativeAudio)},j})(D),B=(function(O){g(j,O);function j(){return O!==null&&O.apply(this,arguments)||this}return j.prototype.setFont=function(ie){this._nativeFileAsset.setFont(ie.nativeFont)},j})(D),W=(function(){function O(j){}return O.prototype.register=function(j){j.selfUnref=!0},O.prototype.unregister=function(j){},O})(),z=typeof FinalizationRegistry<"u"?FinalizationRegistry:W,K=new z(function(O){O.unref()})})],n={};function s(c){var h=n[c];if(h!==void 0)return h.exports;var v=n[c]={exports:{}};return t[c](v,v.exports,s),v.exports}s.d=(c,h)=>{for(var v in h)s.o(h,v)&&!s.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:h[v]})},s.o=(c,h)=>Object.prototype.hasOwnProperty.call(c,h),s.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var l={};return(()=>{s.r(l),s.d(l,{Alignment:()=>B,DataEnum:()=>ke,EventType:()=>Q,Fit:()=>U,Layout:()=>W,LoopType:()=>ne,Rive:()=>ye,RiveEventType:()=>j,RiveFile:()=>at,RuntimeLoader:()=>z,StateMachineInput:()=>O,StateMachineInputType:()=>K,Testing:()=>gt,ViewModel:()=>Pe,ViewModelInstance:()=>ge,ViewModelInstanceArtboard:()=>rt,ViewModelInstanceAssetImage:()=>lt,ViewModelInstanceBoolean:()=>Ct,ViewModelInstanceColor:()=>Lt,ViewModelInstanceEnum:()=>vt,ViewModelInstanceList:()=>Tt,ViewModelInstanceNumber:()=>bt,ViewModelInstanceString:()=>Ye,ViewModelInstanceTrigger:()=>Nt,ViewModelInstanceValue:()=>Oe,decodeAudio:()=>Wt,decodeFont:()=>Dt,decodeImage:()=>zr});var c=s(1),h=s(2),v=s(3),g=s(5),m=(function(){var p=function(o,d){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,C){w.__proto__=C}||function(w,C){for(var M in C)Object.prototype.hasOwnProperty.call(C,M)&&(w[M]=C[M])},p(o,d)};return function(o,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");p(o,d);function w(){this.constructor=o}o.prototype=d===null?Object.create(d):(w.prototype=d.prototype,new w)}})(),k=function(){return k=Object.assign||function(p){for(var o,d=1,w=arguments.length;d<w;d++){o=arguments[d];for(var C in o)Object.prototype.hasOwnProperty.call(o,C)&&(p[C]=o[C])}return p},k.apply(this,arguments)},E=function(p,o,d,w){function C(M){return M instanceof d?M:new d(function(V){V(M)})}return new(d||(d=Promise))(function(M,V){function he(Ie){try{le(w.next(Ie))}catch(Ve){V(Ve)}}function me(Ie){try{le(w.throw(Ie))}catch(Ve){V(Ve)}}function le(Ie){Ie.done?M(Ie.value):C(Ie.value).then(he,me)}le((w=w.apply(p,o||[])).next())})},_=function(p,o){var d={label:0,sent:function(){if(M[0]&1)throw M[1];return M[1]},trys:[],ops:[]},w,C,M,V=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return V.next=he(0),V.throw=he(1),V.return=he(2),typeof Symbol=="function"&&(V[Symbol.iterator]=function(){return this}),V;function he(le){return function(Ie){return me([le,Ie])}}function me(le){if(w)throw new TypeError("Generator is already executing.");for(;V&&(V=0,le[0]&&(d=0)),d;)try{if(w=1,C&&(M=le[0]&2?C.return:le[0]?C.throw||((M=C.return)&&M.call(C),0):C.next)&&!(M=M.call(C,le[1])).done)return M;switch(C=0,M&&(le=[le[0]&2,M.value]),le[0]){case 0:case 1:M=le;break;case 4:return d.label++,{value:le[1],done:!1};case 5:d.label++,C=le[1],le=[0];continue;case 7:le=d.ops.pop(),d.trys.pop();continue;default:if(M=d.trys,!(M=M.length>0&&M[M.length-1])&&(le[0]===6||le[0]===2)){d=0;continue}if(le[0]===3&&(!M||le[1]>M[0]&&le[1]<M[3])){d.label=le[1];break}if(le[0]===6&&d.label<M[1]){d.label=M[1],M=le;break}if(M&&d.label<M[2]){d.label=M[2],d.ops.push(le);break}M[2]&&d.ops.pop(),d.trys.pop();continue}le=o.call(p,d)}catch(Ie){le=[6,Ie],C=0}finally{w=M=0}if(le[0]&5)throw le[1];return{value:le[0]?le[1]:void 0,done:!0}}},S=function(p,o,d){if(d||arguments.length===2)for(var w=0,C=o.length,M;w<C;w++)(M||!(w in o))&&(M||(M=Array.prototype.slice.call(o,0,w)),M[w]=o[w]);return p.concat(M||Array.prototype.slice.call(o))},D=(function(p){m(o,p);function o(){var d=p!==null&&p.apply(this,arguments)||this;return d.isHandledError=!0,d}return o})(Error),R=function(p){return p&&p.isHandledError?p.message:"Problem loading file; may be corrupt!"},U;(function(p){p.Cover="cover",p.Contain="contain",p.Fill="fill",p.FitWidth="fitWidth",p.FitHeight="fitHeight",p.None="none",p.ScaleDown="scaleDown",p.Layout="layout"})(U||(U={}));var B;(function(p){p.Center="center",p.TopLeft="topLeft",p.TopCenter="topCenter",p.TopRight="topRight",p.CenterLeft="centerLeft",p.CenterRight="centerRight",p.BottomLeft="bottomLeft",p.BottomCenter="bottomCenter",p.BottomRight="bottomRight"})(B||(B={}));var W=(function(){function p(o){var d,w,C,M,V,he,me;this.fit=(d=o?.fit)!==null&&d!==void 0?d:U.Contain,this.alignment=(w=o?.alignment)!==null&&w!==void 0?w:B.Center,this.layoutScaleFactor=(C=o?.layoutScaleFactor)!==null&&C!==void 0?C:1,this.minX=(M=o?.minX)!==null&&M!==void 0?M:0,this.minY=(V=o?.minY)!==null&&V!==void 0?V:0,this.maxX=(he=o?.maxX)!==null&&he!==void 0?he:0,this.maxY=(me=o?.maxY)!==null&&me!==void 0?me:0}return p.new=function(o){var d=o.fit,w=o.alignment,C=o.minX,M=o.minY,V=o.maxX,he=o.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new p({fit:d,alignment:w,minX:C,minY:M,maxX:V,maxY:he})},p.prototype.copyWith=function(o){var d=o.fit,w=o.alignment,C=o.layoutScaleFactor,M=o.minX,V=o.minY,he=o.maxX,me=o.maxY;return new p({fit:d??this.fit,alignment:w??this.alignment,layoutScaleFactor:C??this.layoutScaleFactor,minX:M??this.minX,minY:V??this.minY,maxX:he??this.maxX,maxY:me??this.maxY})},p.prototype.runtimeFit=function(o){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var d;return this.fit===U.Cover?d=o.Fit.cover:this.fit===U.Contain?d=o.Fit.contain:this.fit===U.Fill?d=o.Fit.fill:this.fit===U.FitWidth?d=o.Fit.fitWidth:this.fit===U.FitHeight?d=o.Fit.fitHeight:this.fit===U.ScaleDown?d=o.Fit.scaleDown:this.fit===U.Layout?d=o.Fit.layout:d=o.Fit.none,this.cachedRuntimeFit=d,d},p.prototype.runtimeAlignment=function(o){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var d;return this.alignment===B.TopLeft?d=o.Alignment.topLeft:this.alignment===B.TopCenter?d=o.Alignment.topCenter:this.alignment===B.TopRight?d=o.Alignment.topRight:this.alignment===B.CenterLeft?d=o.Alignment.centerLeft:this.alignment===B.CenterRight?d=o.Alignment.centerRight:this.alignment===B.BottomLeft?d=o.Alignment.bottomLeft:this.alignment===B.BottomCenter?d=o.Alignment.bottomCenter:this.alignment===B.BottomRight?d=o.Alignment.bottomRight:d=o.Alignment.center,this.cachedRuntimeAlignment=d,d},p})(),z=(function(){function p(){}return p.loadRuntime=function(){c.default({locateFile:function(){return p.wasmURL}}).then(function(o){var d;for(p.runtime=o;p.callBackQueue.length>0;)(d=p.callBackQueue.shift())===null||d===void 0||d(p.runtime)}).catch(function(o){var d={message:o?.message||"Unknown error",type:o?.name||"Error",wasmError:o instanceof WebAssembly.CompileError||o instanceof WebAssembly.RuntimeError,originalError:o};console.debug("Rive WASM load error details:",d);var w="https://cdn.jsdelivr.net/npm/".concat(h.name,"@").concat(h.version,"/rive_fallback.wasm");if(p.wasmURL.toLowerCase()!==w)console.warn("Failed to load WASM from ".concat(p.wasmURL," (").concat(d.message,"), trying jsdelivr as a backup")),p.setWasmUrl(w),p.loadRuntime();else{var C=["Could not load Rive WASM file from ".concat(p.wasmURL," or ").concat(w,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(d.type),"- Message: ".concat(d.message),"- WebAssembly-specific error: ".concat(d.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(C)}})},p.getInstance=function(o){p.isLoading||(p.isLoading=!0,p.loadRuntime()),p.runtime?o(p.runtime):p.callBackQueue.push(o)},p.awaitInstance=function(){return new Promise(function(o){return p.getInstance(function(d){return o(d)})})},p.setWasmUrl=function(o){p.wasmURL=o},p.getWasmUrl=function(){return p.wasmURL},p.isLoading=!1,p.callBackQueue=[],p.wasmURL="https://unpkg.com/".concat(h.name,"@").concat(h.version,"/rive.wasm"),p})(),K;(function(p){p[p.Number=56]="Number",p[p.Trigger=58]="Trigger",p[p.Boolean=59]="Boolean"})(K||(K={}));var O=(function(){function p(o,d){this.type=o,this.runtimeInput=d}return Object.defineProperty(p.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(o){this.runtimeInput.value=o},enumerable:!1,configurable:!0}),p.prototype.fire=function(){this.type===K.Trigger&&this.runtimeInput.fire()},p.prototype.delete=function(){this.runtimeInput=null},p})(),j;(function(p){p[p.General=128]="General",p[p.OpenUrl=131]="OpenUrl"})(j||(j={}));var ie=(function(){function p(o){this.nativeArtboard=o}return p})(),X=(function(){function p(o,d,w,C){this.stateMachine=o,this.playing=w,this.artboard=C,this.inputs=[],this.instance=new d.StateMachineInstance(o,C),this.initInputs(d)}return Object.defineProperty(p.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statesChanged",{get:function(){for(var o=[],d=0;d<this.instance.stateChangedCount();d++)o.push(this.instance.stateChangedNameByIndex(d));return o},enumerable:!1,configurable:!0}),p.prototype.advance=function(o){this.instance.advance(o)},p.prototype.advanceAndApply=function(o){this.instance.advanceAndApply(o)},p.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},p.prototype.reportedEventAt=function(o){return this.instance.reportedEventAt(o)},p.prototype.initInputs=function(o){for(var d=0;d<this.instance.inputCount();d++){var w=this.instance.input(d);this.inputs.push(this.mapRuntimeInput(w,o))}},p.prototype.mapRuntimeInput=function(o,d){if(o.type===d.SMIInput.bool)return new O(K.Boolean,o.asBool());if(o.type===d.SMIInput.number)return new O(K.Number,o.asNumber());if(o.type===d.SMIInput.trigger)return new O(K.Trigger,o.asTrigger())},p.prototype.cleanup=function(){this.inputs.forEach(function(o){o.delete()}),this.inputs.length=0,this.instance.delete()},p.prototype.bindViewModelInstance=function(o){o.runtimeInstance!=null&&this.instance.bindViewModelInstance(o.runtimeInstance)},p})(),ce=(function(){function p(o,d,w,C,M){C===void 0&&(C=[]),M===void 0&&(M=[]),this.runtime=o,this.artboard=d,this.eventManager=w,this.animations=C,this.stateMachines=M}return p.prototype.add=function(o,d,w){if(w===void 0&&(w=!0),o=pt(o),o.length===0)this.animations.forEach(function(pe){return pe.playing=d}),this.stateMachines.forEach(function(pe){return pe.playing=d});else for(var C=this.animations.map(function(pe){return pe.name}),M=this.stateMachines.map(function(pe){return pe.name}),V=0;V<o.length;V++){var he=C.indexOf(o[V]),me=M.indexOf(o[V]);if(he>=0||me>=0)he>=0?this.animations[he].playing=d:this.stateMachines[me].playing=d;else{var le=this.artboard.animationByName(o[V]);if(le){var Ie=new v.Animation(le,this.artboard,this.runtime,d);Ie.advance(0),Ie.apply(1),this.animations.push(Ie)}else{var Ve=this.artboard.stateMachineByName(o[V]);if(Ve){var ot=new X(Ve,this.runtime,d,this.artboard);this.stateMachines.push(ot)}}}}return w&&(d?this.eventManager.fire({type:Q.Play,data:this.playing}):this.eventManager.fire({type:Q.Pause,data:this.paused})),d?this.playing:this.paused},p.prototype.initLinearAnimations=function(o,d){for(var w=this.animations.map(function(me){return me.name}),C=0;C<o.length;C++){var M=w.indexOf(o[C]);if(M>=0)this.animations[M].playing=d;else{var V=this.artboard.animationByName(o[C]);if(V){var he=new v.Animation(V,this.artboard,this.runtime,d);he.advance(0),he.apply(1),this.animations.push(he)}else console.error("Animation with name ".concat(o[C]," not found."))}}},p.prototype.initStateMachines=function(o,d){for(var w=this.stateMachines.map(function(me){return me.name}),C=0;C<o.length;C++){var M=w.indexOf(o[C]);if(M>=0)this.stateMachines[M].playing=d;else{var V=this.artboard.stateMachineByName(o[C]);if(V){var he=new X(V,this.runtime,d,this.artboard);this.stateMachines.push(he),d||he.advanceAndApply(0)}else console.warn("State Machine with name ".concat(o[C]," not found.")),this.initLinearAnimations([o[C]],d)}}},p.prototype.play=function(o){return this.add(o,!0)},p.prototype.pause=function(o){return this.add(o,!1)},p.prototype.scrub=function(o,d){var w=this.animations.filter(function(C){return o.includes(C.name)});return w.forEach(function(C){return C.scrubTo=d}),w.map(function(C){return C.name})},Object.defineProperty(p.prototype,"playing",{get:function(){return this.animations.filter(function(o){return o.playing}).map(function(o){return o.name}).concat(this.stateMachines.filter(function(o){return o.playing}).map(function(o){return o.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"paused",{get:function(){return this.animations.filter(function(o){return!o.playing}).map(function(o){return o.name}).concat(this.stateMachines.filter(function(o){return!o.playing}).map(function(o){return o.name}))},enumerable:!1,configurable:!0}),p.prototype.stop=function(o){var d=this;o=pt(o);var w=[];if(o.length===0)w=this.animations.map(function(V){return V.name}).concat(this.stateMachines.map(function(V){return V.name})),this.animations.forEach(function(V){return V.cleanup()}),this.stateMachines.forEach(function(V){return V.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var C=this.animations.filter(function(V){return o.includes(V.name)});C.forEach(function(V){V.cleanup(),d.animations.splice(d.animations.indexOf(V),1)});var M=this.stateMachines.filter(function(V){return o.includes(V.name)});M.forEach(function(V){V.cleanup(),d.stateMachines.splice(d.stateMachines.indexOf(V),1)}),w=C.map(function(V){return V.name}).concat(M.map(function(V){return V.name}))}return this.eventManager.fire({type:Q.Stop,data:w}),w},Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(o,d){return o||d.playing},!1)||this.stateMachines.reduce(function(o,d){return o||d.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),p.prototype.atLeastOne=function(o,d){d===void 0&&(d=!0);var w;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([w=this.artboard.animationByIndex(0).name],o,d):this.artboard.stateMachineCount()>0&&this.add([w=this.artboard.stateMachineByIndex(0).name],o,d)),w},p.prototype.handleLooping=function(){for(var o=0,d=this.animations.filter(function(C){return C.playing});o<d.length;o++){var w=d[o];w.loopValue===0&&w.loopCount?(w.loopCount=0,this.stop(w.name)):w.loopValue===1&&w.loopCount?(this.eventManager.fire({type:Q.Loop,data:{animation:w.name,type:ne.Loop}}),w.loopCount=0):w.loopValue===2&&w.loopCount>1&&(this.eventManager.fire({type:Q.Loop,data:{animation:w.name,type:ne.PingPong}}),w.loopCount=0)}},p.prototype.handleStateChanges=function(){for(var o=[],d=0,w=this.stateMachines.filter(function(M){return M.playing});d<w.length;d++){var C=w[d];o.push.apply(o,C.statesChanged)}o.length>0&&this.eventManager.fire({type:Q.StateChange,data:o})},p.prototype.handleAdvancing=function(o){this.eventManager.fire({type:Q.Advance,data:o})},p})(),Q;(function(p){p.Load="load",p.LoadError="loaderror",p.Play="play",p.Pause="pause",p.Stop="stop",p.Loop="loop",p.Draw="draw",p.Advance="advance",p.StateChange="statechange",p.RiveEvent="riveevent",p.AudioStatusChange="audiostatuschange"})(Q||(Q={}));var ne;(function(p){p.OneShot="oneshot",p.Loop="loop",p.PingPong="pingpong"})(ne||(ne={}));var fe=(function(){function p(o){o===void 0&&(o=[]),this.listeners=o}return p.prototype.getListeners=function(o){return this.listeners.filter(function(d){return d.type===o})},p.prototype.add=function(o){this.listeners.includes(o)||this.listeners.push(o)},p.prototype.remove=function(o){for(var d=0;d<this.listeners.length;d++){var w=this.listeners[d];if(w.type===o.type&&w.callback===o.callback){this.listeners.splice(d,1);break}}},p.prototype.removeAll=function(o){var d=this;o?this.listeners.filter(function(w){return w.type===o}).forEach(function(w){return d.remove(w)}):this.listeners.splice(0,this.listeners.length)},p.prototype.fire=function(o){var d=this.getListeners(o.type);d.forEach(function(w){return w.callback(o)})},p})(),Fe=(function(){function p(o){this.eventManager=o,this.queue=[]}return p.prototype.add=function(o){this.queue.push(o)},p.prototype.process=function(){for(;this.queue.length>0;){var o=this.queue.shift();o?.action&&o.action(),o?.event&&this.eventManager.fire(o.event)}},p})(),J;(function(p){p[p.AVAILABLE=0]="AVAILABLE",p[p.UNAVAILABLE=1]="UNAVAILABLE"})(J||(J={}));var ve=(function(p){m(o,p);function o(){var d=p!==null&&p.apply(this,arguments)||this;return d._started=!1,d._enabled=!1,d._status=J.UNAVAILABLE,d}return o.prototype.delay=function(d){return E(this,void 0,void 0,function(){return _(this,function(w){return[2,new Promise(function(C){return setTimeout(C,d)})]})})},o.prototype.timeout=function(){return E(this,void 0,void 0,function(){return _(this,function(d){return[2,new Promise(function(w,C){return setTimeout(C,50)})]})})},o.prototype.reportToListeners=function(){this.fire({type:Q.AudioStatusChange}),this.removeAll()},o.prototype.enableAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(d){return this._enabled||(this._enabled=!0,this._status=J.AVAILABLE,this.reportToListeners()),[2]})})},o.prototype.testAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:if(!(this._status===J.UNAVAILABLE&&this._audioContext!==null))return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return d.sent(),this.enableAudio(),[3,4];case 3:return d.sent(),[3,4];case 4:return[2]}})})},o.prototype._establishAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),d.label=2;case 2:return this._status!==J.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return d.sent(),[4,this.delay(1e3)];case 4:return d.sent(),[3,2];case 5:return[2]}})})},o.prototype.listenForUserAction=function(){var d=this,w=function(){return E(d,void 0,void 0,function(){return _(this,function(C){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",w,{once:!0})},o.prototype.establishAudio=function(){return E(this,void 0,void 0,function(){return _(this,function(d){return this._establishAudio(),[2]})})},Object.defineProperty(o.prototype,"systemVolume",{get:function(){return this._status===J.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),o})(fe),oe=new ve,Ke=(function(){function p(){}return p.prototype.observe=function(){},p.prototype.unobserve=function(){},p.prototype.disconnect=function(){},p})(),We=globalThis.ResizeObserver||Ke,xe=(function(){function p(){var o=this;this._elementsMap=new Map,this._onObservedEntry=function(d){var w=o._elementsMap.get(d.target);w!==null?w.onResize(d.target.clientWidth==0||d.target.clientHeight==0):o._resizeObserver.unobserve(d.target)},this._onObserved=function(d){d.forEach(o._onObservedEntry)},this._resizeObserver=new We(this._onObserved)}return p.prototype.add=function(o,d){var w={onResize:d,element:o};return this._elementsMap.set(o,w),this._resizeObserver.observe(o),w},p.prototype.remove=function(o){this._resizeObserver.unobserve(o.element),this._elementsMap.delete(o.element)},p})(),Re=new xe,at=(function(){function p(o){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=o.src,this.buffer=o.buffer,o.assetLoader&&(this.assetLoader=o.assetLoader),this.enableRiveAssetCDN=typeof o.enableRiveAssetCDN=="boolean"?o.enableRiveAssetCDN:!0,this.eventManager=new fe,o.onLoad&&this.on(Q.Load,o.onLoad),o.onLoadError&&this.on(Q.LoadError,o.onLoadError)}return p.prototype.initData=function(){return E(this,void 0,void 0,function(){var o,d,w,C,M;return _(this,function(V){switch(V.label){case 0:return this.src?(o=this,[4,ar(this.src)]):[3,2];case 1:o.buffer=V.sent(),V.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(w=new g.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),d=w.assetLoader),C=this,[4,this.runtime.load(new Uint8Array(this.buffer),d,this.enableRiveAssetCDN)]);case 3:return C.file=V.sent(),this.destroyed?((M=this.file)===null||M===void 0||M.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:Q.Load,data:this}):this.fireLoadError(p.fileLoadErrorMessage),[2])}})})},p.prototype.init=function(){return E(this,void 0,void 0,function(){var o,d;return _(this,function(w){switch(w.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(p.missingErrorMessage),[2];w.label=1;case 1:return w.trys.push([1,4,,5]),o=this,[4,z.awaitInstance()];case 2:return o.runtime=w.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return w.sent(),[3,5];case 4:return d=w.sent(),this.fireLoadError(d instanceof Error?d.message:p.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},p.prototype.fireLoadError=function(o){throw this.eventManager.fire({type:Q.LoadError,data:o}),new Error(o)},p.prototype.on=function(o,d){this.eventManager.add({type:o,callback:d})},p.prototype.off=function(o,d){this.eventManager.remove({type:o,callback:d})},p.prototype.cleanup=function(){var o;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(o=this.file)===null||o===void 0||o.delete(),this.file=null,this.destroyed=!0)},p.prototype.removeAllRiveEventListeners=function(o){this.eventManager.removeAll(o)},p.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},p.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},p.prototype.getArtboard=function(o){var d=this.file.artboardByName(o);return d!=null?new ie(d):null},p.missingErrorMessage="Rive source file or data buffer required",p.fileLoadErrorMessage="The file failed to load",p})(),ye=(function(){function p(o){var d=this,w;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(C){var M=d._hasZeroSize!==C;d._hasZeroSize=C,C?(!d._layout.maxX||!d._layout.maxY)&&d.resizeToCanvas():M&&d.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=o.canvas,o.canvas.constructor===HTMLCanvasElement&&(this._observed=Re.add(this.canvas,this.onCanvasResize)),this.src=o.src,this.buffer=o.buffer,this.riveFile=o.riveFile,this.layout=(w=o.layout)!==null&&w!==void 0?w:new W,this.shouldDisableRiveListeners=!!o.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!o.isTouchScrollEnabled,this.automaticallyHandleEvents=!!o.automaticallyHandleEvents,this.enableRiveAssetCDN=o.enableRiveAssetCDN===void 0?!0:o.enableRiveAssetCDN,this.eventManager=new fe,o.onLoad&&this.on(Q.Load,o.onLoad),o.onLoadError&&this.on(Q.LoadError,o.onLoadError),o.onPlay&&this.on(Q.Play,o.onPlay),o.onPause&&this.on(Q.Pause,o.onPause),o.onStop&&this.on(Q.Stop,o.onStop),o.onLoop&&this.on(Q.Loop,o.onLoop),o.onStateChange&&this.on(Q.StateChange,o.onStateChange),o.onAdvance&&this.on(Q.Advance,o.onAdvance),o.onload&&!o.onLoad&&this.on(Q.Load,o.onload),o.onloaderror&&!o.onLoadError&&this.on(Q.LoadError,o.onloaderror),o.onplay&&!o.onPlay&&this.on(Q.Play,o.onplay),o.onpause&&!o.onPause&&this.on(Q.Pause,o.onpause),o.onstop&&!o.onStop&&this.on(Q.Stop,o.onstop),o.onloop&&!o.onLoop&&this.on(Q.Loop,o.onloop),o.onstatechange&&!o.onStateChange&&this.on(Q.StateChange,o.onstatechange),o.assetLoader&&(this.assetLoader=o.assetLoader),this.taskQueue=new Fe(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:o.autoplay,autoBind:o.autoBind,animations:o.animations,stateMachines:o.stateMachines,artboard:o.artboard,useOffscreenRenderer:o.useOffscreenRenderer})}return Object.defineProperty(p.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),p.new=function(o){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new p(o)},p.prototype.onSystemAudioChanged=function(){this.volume=this._volume},p.prototype.init=function(o){var d=this,w=o.src,C=o.buffer,M=o.riveFile,V=o.animations,he=o.stateMachines,me=o.artboard,le=o.autoplay,Ie=le===void 0?!1:le,Ve=o.useOffscreenRenderer,ot=Ve===void 0?!1:Ve,pe=o.autoBind,nt=pe===void 0?!1:pe;if(!this.destroyed){if(this.src=w,this.buffer=C,this.riveFile=M,!this.src&&!this.buffer&&!this.riveFile)throw new D(p.missingErrorMessage);var Qe=pt(V),ut=pt(he);this.loaded=!1,this.readyForPlaying=!1,z.awaitInstance().then(function(it){d.destroyed||(d.runtime=it,d.removeRiveListeners(),d.deleteRiveRenderer(),d.renderer=d.runtime.makeRenderer(d.canvas,ot),d.canvas.width||d.canvas.height||d.resizeDrawingSurfaceToCanvas(),d.initData(me,Qe,ut,Ie,nt).then(function(Vt){if(Vt)return d.setupRiveListeners()}).catch(function(Vt){console.error(Vt)}))}).catch(function(it){console.error(it)})}},p.prototype.setupRiveListeners=function(o){var d=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var w=(this.animator.stateMachines||[]).filter(function(M){return M.playing&&d.runtime.hasListeners(M.instance)}).map(function(M){return M.instance}),C=this.isTouchScrollEnabled;o&&"isTouchScrollEnabled"in o&&(C=o.isTouchScrollEnabled),this.eventCleanup=(0,g.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:w,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:C,layoutScaleFactor:this._layout.layoutScaleFactor})}},p.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},p.prototype.initializeAudio=function(){var o=this,d;oe.status==J.UNAVAILABLE&&!((d=this.artboard)===null||d===void 0)&&d.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:Q.AudioStatusChange,callback:function(){return o.onSystemAudioChanged()}},oe.add(this._audioEventListener),oe.establishAudio())},p.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},p.prototype.initData=function(o,d,w,C,M){return E(this,void 0,void 0,function(){var V,he,me,le;return _(this,function(Ie){switch(Ie.label){case 0:return Ie.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(V=new at({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=V,[4,V.init()]);case 1:if(Ie.sent(),this.destroyed)return V.destroyIfUnused(),[2,!1];Ie.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(o,d,w,C,M),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:Q.Load,data:(le=this.src)!==null&&le!==void 0?le:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return he=Ie.sent(),me=R(he),console.warn(me),this.eventManager.fire({type:Q.LoadError,data:me}),[2,Promise.reject(me)];case 4:return[2]}})})},p.prototype.initArtboard=function(o,d,w,C,M){if(this.file){var V=o?this.file.artboardByName(o):this.file.defaultArtboard();if(!V){var he="Invalid artboard name or no default artboard";console.warn(he),this.eventManager.fire({type:Q.LoadError,data:he});return}if(this.artboard=V,V.volume=this._volume*oe.systemVolume,this.artboard.animationCount()<1){var he="Artboard has no animations";throw this.eventManager.fire({type:Q.LoadError,data:he}),he}this.animator=new ce(this.runtime,this.artboard,this.eventManager);var me;if(d.length>0||w.length>0?(me=d.concat(w),this.animator.initLinearAnimations(d,C),this.animator.initStateMachines(w,C)):me=[this.animator.atLeastOne(C,!1)],this.taskQueue.add({event:{type:C?Q.Play:Q.Pause,data:me}}),M){var le=this.file.defaultArtboardViewModel(V);if(le!==null){var Ie=le.defaultInstance();if(Ie!==null){var Ve=new ge(Ie,null);this.bindViewModelInstance(Ve)}}}}},p.prototype.drawFrame=function(){var o,d;!((o=document?.timeline)===null||o===void 0)&&o.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(d=this.runtime)===null||d===void 0||d.resolveAnimationFrame()):this.startRendering()},p.prototype.draw=function(o,d){var w;this.frameRequestId=null;var C=performance.now();this.lastRenderTime||(this.lastRenderTime=o),this.renderSecondTimer+=o-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,d?.());var M=(o-this.lastRenderTime)/1e3;this.lastRenderTime=o;for(var V=this.animator.animations.filter(function(lr){return lr.playing||lr.needsScrub}).sort(function(lr){return lr.needsScrub?-1:1}),he=0,me=V;he<me.length;he++){var le=me[he];le.advance(M),le.instance.didLoop&&(le.loopCount+=1),le.apply(1)}for(var Ie=this.animator.stateMachines.filter(function(lr){return lr.playing}),Ve=0,ot=Ie;Ve<ot.length;Ve++){var pe=ot[Ve],nt=pe.reportedEventCount();if(nt)for(var Qe=0;Qe<nt;Qe++){var ut=pe.reportedEventAt(Qe);if(ut)if(ut.type===j.OpenUrl){if(this.eventManager.fire({type:Q.RiveEvent,data:ut}),this.automaticallyHandleEvents){var it=document.createElement("a"),Vt=ut,Rr=Vt.url,Or=Vt.target,or=(0,g.sanitizeUrl)(Rr);Rr&&it.setAttribute("href",or),Or&&it.setAttribute("target",Or),or&&or!==g.BLANK_URL&&it.click()}}else this.eventManager.fire({type:Q.RiveEvent,data:ut})}pe.advanceAndApply(M)}this.animator.stateMachines.length==0&&this.artboard.advance(M);var _e=this.renderer;_e.clear(),_e.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(_e),_e.restore(),_e.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(M),this.frameCount++;var qe=performance.now();for(this.frameTimes.push(qe),this.durations.push(qe-C);this.frameTimes[0]<=qe-1e3;)this.frameTimes.shift(),this.durations.shift();(w=this._viewModelInstance)===null||w===void 0||w.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},p.prototype.alignRenderer=function(){var o=this,d=o.renderer,w=o.runtime,C=o._layout,M=o.artboard;d.align(C.runtimeFit(w),C.runtimeAlignment(w),{minX:C.minX,minY:C.minY,maxX:C.maxX,maxY:C.maxY},M.bounds,this._devicePixelRatioUsed*C.layoutScaleFactor)},Object.defineProperty(p.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(o,d){return o+d},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),p.prototype.cleanup=function(){var o,d;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&Re.remove(this._observed),this.removeRiveListeners(),this.file&&((o=this.riveFile)===null||o===void 0||o.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(oe.remove(this._audioEventListener),this._audioEventListener=null),(d=this._viewModelInstance)===null||d===void 0||d.cleanup(),this._viewModelInstance=null,this._dataEnums=null},p.prototype.deleteRiveRenderer=function(){var o;(o=this.renderer)===null||o===void 0||o.delete(),this.renderer=null},p.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},p.prototype.retrieveTextRun=function(o){var d;if(!o){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var w=this.artboard.textRun(o);if(!w){console.warn("Could not access a text run with name '".concat(o,"' in the '").concat((d=this.artboard)===null||d===void 0?void 0:d.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return w},p.prototype.getTextRunValue=function(o){var d=this.retrieveTextRun(o);return d?d.text:void 0},p.prototype.setTextRunValue=function(o,d){var w=this.retrieveTextRun(o);w&&(w.text=d)},p.prototype.play=function(o,d){var w=this;if(o=pt(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.play(o,d)}});return}this.animator.play(o),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},p.prototype.pause=function(o){var d=this;if(o=pt(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.pause(o)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(o)},p.prototype.scrub=function(o,d){var w=this;if(o=pt(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.scrub(o,d)}});return}this.animator.scrub(o,d||0),this.drawFrame()},p.prototype.stop=function(o){var d=this;if(o=pt(o),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.stop(o)}});return}this.animator&&this.animator.stop(o),this.eventCleanup&&this.eventCleanup()},p.prototype.reset=function(o){var d,w,C=o?.artboard,M=pt(o?.animations),V=pt(o?.stateMachines),he=(d=o?.autoplay)!==null&&d!==void 0?d:!1,me=(w=o?.autoBind)!==null&&w!==void 0?w:!1;this.cleanupInstances(),this.initArtboard(C,M,V,he,me),this.taskQueue.process()},p.prototype.load=function(o){this.file=null,this.stop(),this.init(o)},Object.defineProperty(p.prototype,"layout",{get:function(){return this._layout},set:function(o){this._layout=o,(!o.maxX||!o.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),p.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},p.prototype.resizeDrawingSurfaceToCanvas=function(o){if(this.canvas instanceof HTMLCanvasElement&&window){var d=this.canvas.getBoundingClientRect(),w=d.width,C=d.height,M=o||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=M,this.canvas.width=M*w,this.canvas.height=M*C,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===U.Layout){var V=this._layout.layoutScaleFactor;this.artboard.width=w/V,this.artboard.height=C/V}}},Object.defineProperty(p.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var o=[],d=0;d<this.artboard.animationCount();d++)o.push(this.artboard.animationByIndex(d).name);return o},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var o=[],d=0;d<this.artboard.stateMachineCount();d++)o.push(this.artboard.stateMachineByIndex(d).name);return o},enumerable:!1,configurable:!0}),p.prototype.stateMachineInputs=function(o){if(this.loaded){var d=this.animator.stateMachines.find(function(w){return w.name===o});return d?.inputs}},p.prototype.retrieveInputAtPath=function(o,d){if(!o){console.warn("No input name provided for path '".concat(d,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(o,"', at path: '").concat(d,"', but the Artboard is null"));return}var w=this.artboard.inputByPath(o,d);if(!w){console.warn("Could not access an input with name: '".concat(o,"', at path:'").concat(d,"'"));return}return w},p.prototype.setBooleanStateAtPath=function(o,d,w){var C=this.retrieveInputAtPath(o,w);C&&(C.type===K.Boolean?C.asBool().value=d:console.warn("Input with name: '".concat(o,"', at path:'").concat(w,"' is not a boolean")))},p.prototype.setNumberStateAtPath=function(o,d,w){var C=this.retrieveInputAtPath(o,w);C&&(C.type===K.Number?C.asNumber().value=d:console.warn("Input with name: '".concat(o,"', at path:'").concat(w,"' is not a number")))},p.prototype.fireStateAtPath=function(o,d){var w=this.retrieveInputAtPath(o,d);w&&(w.type===K.Trigger?w.asTrigger().fire():console.warn("Input with name: '".concat(o,"', at path:'").concat(d,"' is not a trigger")))},p.prototype.retrieveTextAtPath=function(o,d){if(!o){console.warn("No text name provided for path '".concat(d,"'"));return}if(!d){console.warn("No path provided for text '".concat(o,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(o,"', at path: '").concat(d,"', but the Artboard is null"));return}var w=this.artboard.textByPath(o,d);if(!w){console.warn("Could not access text with name: '".concat(o,"', at path:'").concat(d,"'"));return}return w},p.prototype.getTextRunValueAtPath=function(o,d){var w=this.retrieveTextAtPath(o,d);if(!w){console.warn("Could not get text with name: '".concat(o,"', at path:'").concat(d,"'"));return}return w.text},p.prototype.setTextRunValueAtPath=function(o,d,w){var C=this.retrieveTextAtPath(o,w);if(!C){console.warn("Could not set text with name: '".concat(o,"', at path:'").concat(w,"'"));return}C.text=d},Object.defineProperty(p.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(o){return o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(o){return o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(o){return!o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(o){return!o.playing}).map(function(o){return o.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),p.prototype.on=function(o,d){this.eventManager.add({type:o,callback:d})},p.prototype.off=function(o,d){this.eventManager.remove({type:o,callback:d})},p.prototype.unsubscribe=function(o,d){console.warn("This function is deprecated: please use `off()` instead."),this.off(o,d)},p.prototype.removeAllRiveEventListeners=function(o){this.eventManager.removeAll(o)},p.prototype.unsubscribeAll=function(o){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(o)},p.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},p.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},p.prototype.enableFPSCounter=function(o){this.runtime.enableFPSCounter(o)},p.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(p.prototype,"contents",{get:function(){if(this.loaded){for(var o={artboards:[]},d=0;d<this.file.artboardCount();d++){for(var w=this.file.artboardByIndex(d),C={name:w.name,animations:[],stateMachines:[]},M=0;M<w.animationCount();M++){var V=w.animationByIndex(M);C.animations.push(V.name)}for(var he=0;he<w.stateMachineCount();he++){for(var me=w.stateMachineByIndex(he),le=me.name,Ie=new this.runtime.StateMachineInstance(me,w),Ve=[],ot=0;ot<Ie.inputCount();ot++){var pe=Ie.input(ot);Ve.push({name:pe.name,type:pe.type})}C.stateMachines.push({name:le,inputs:Ve})}o.artboards.push(C)}return o}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(o){this._volume=o,this.artboard&&(this.artboard.volume=o*oe.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardWidth",{get:function(){var o;return this.artboard?this.artboard.width:(o=this._artboardWidth)!==null&&o!==void 0?o:0},set:function(o){this._artboardWidth=o,this.artboard&&(this.artboard.width=o)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardHeight",{get:function(){var o;return this.artboard?this.artboard.height:(o=this._artboardHeight)!==null&&o!==void 0?o:0},set:function(o){this._artboardHeight=o,this.artboard&&(this.artboard.height=o)},enumerable:!1,configurable:!0}),p.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(p.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(o){this._devicePixelRatioUsed=o},enumerable:!1,configurable:!0}),p.prototype.bindViewModelInstance=function(o){var d;this.artboard&&!this.destroyed&&o&&o.runtimeInstance&&(o.internalIncrementReferenceCount(),(d=this._viewModelInstance)===null||d===void 0||d.cleanup(),this._viewModelInstance=o,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(w){return w.bindViewModelInstance(o)}):this.artboard.bindViewModelInstance(o.runtimeInstance))},Object.defineProperty(p.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),p.prototype.viewModelByIndex=function(o){var d=this.file.viewModelByIndex(o);return d!==null?new Pe(d):null},p.prototype.viewModelByName=function(o){var d=this.file.viewModelByName(o);return d!==null?new Pe(d):null},p.prototype.enums=function(){if(this._dataEnums===null){var o=this.file.enums();this._dataEnums=o.map(function(d){return new ke(d)})}return this._dataEnums},p.prototype.defaultViewModel=function(){if(this.artboard){var o=this.file.defaultArtboardViewModel(this.artboard);if(o)return new Pe(o)}return null},p.prototype.getArtboard=function(o){var d,w;return(w=(d=this.riveFile)===null||d===void 0?void 0:d.getArtboard(o))!==null&&w!==void 0?w:null},p.missingErrorMessage="Rive source file or data buffer required",p.cleanupErrorMessage="Attempt to use file after calling cleanup.",p})(),Pe=(function(){function p(o){this._viewModel=o}return Object.defineProperty(p.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),p.prototype.instanceByIndex=function(o){var d=this._viewModel.instanceByIndex(o);return d!==null?new ge(d,null):null},p.prototype.instanceByName=function(o){var d=this._viewModel.instanceByName(o);return d!==null?new ge(d,null):null},p.prototype.defaultInstance=function(){var o=this._viewModel.defaultInstance();return o!==null?new ge(o,null):null},p.prototype.instance=function(){var o=this._viewModel.instance();return o!==null?new ge(o,null):null},Object.defineProperty(p.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),p})(),ke=(function(){function p(o){this._dataEnum=o}return Object.defineProperty(p.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),p})(),de;(function(p){p.Number="number",p.String="string",p.Boolean="boolean",p.Color="color",p.Trigger="trigger",p.Enum="enum",p.List="list",p.Image="image",p.Artboard="artboard"})(de||(de={}));var ge=(function(){function p(o,d){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=o,d!==null&&this._parents.push(d)}return Object.defineProperty(p.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),p.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(o){o.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(o){o.clearChanges()})),this._children.forEach(function(o){return o.handleCallbacks()})},p.prototype.addParent=function(o){this._parents.includes(o)||(this._parents.push(o),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&o.addToViewModelCallbacks(this))},p.prototype.removeParent=function(o){var d=this._parents.indexOf(o);if(d!==-1){var w=this._parents[d];w.removeFromViewModelCallbacks(this),this._parents.splice(d,1)}},p.prototype.addToPropertyCallbacks=function(o){var d=this;this._propertiesWithCallbacks.includes(o)||(this._propertiesWithCallbacks.push(o),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(w){w.addToViewModelCallbacks(d)}))},p.prototype.removeFromPropertyCallbacks=function(o){var d=this;this._propertiesWithCallbacks.includes(o)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(w){return w!==o}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(d)}))},p.prototype.addToViewModelCallbacks=function(o){var d=this;this._children.includes(o)||(this._children.push(o),this._parents.forEach(function(w){w.addToViewModelCallbacks(d)}))},p.prototype.removeFromViewModelCallbacks=function(o){var d=this;this._children.includes(o)&&(this._children=this._children.filter(function(w){return w!==o}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(d)}))},p.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(o){o.clearCallbacks()})},p.prototype.propertyFromPath=function(o,d){var w=o.split("/");return this.propertyFromPathSegments(w,0,d)},p.prototype.viewModelFromPathSegments=function(o,d){var w=this.internalViewModelInstance(o[d]);return w!==null?d==o.length-1?w:w.viewModelFromPathSegments(o,d++):null},p.prototype.propertyFromPathSegments=function(o,d,w){var C,M,V,he,me,le,Ie,Ve,ot,pe,nt,Qe,ut,it,Vt,Rr,Or,or;if(d<o.length-1){var _e=this.internalViewModelInstance(o[d]);return _e!==null?_e.propertyFromPathSegments(o,d+1,w):null}var qe=null;switch(w){case de.Number:if(qe=(M=(C=this._runtimeInstance)===null||C===void 0?void 0:C.number(o[d]))!==null&&M!==void 0?M:null,qe!==null)return new bt(qe,this);break;case de.String:if(qe=(he=(V=this._runtimeInstance)===null||V===void 0?void 0:V.string(o[d]))!==null&&he!==void 0?he:null,qe!==null)return new Ye(qe,this);break;case de.Boolean:if(qe=(le=(me=this._runtimeInstance)===null||me===void 0?void 0:me.boolean(o[d]))!==null&&le!==void 0?le:null,qe!==null)return new Ct(qe,this);break;case de.Color:if(qe=(Ve=(Ie=this._runtimeInstance)===null||Ie===void 0?void 0:Ie.color(o[d]))!==null&&Ve!==void 0?Ve:null,qe!==null)return new Lt(qe,this);break;case de.Trigger:if(qe=(pe=(ot=this._runtimeInstance)===null||ot===void 0?void 0:ot.trigger(o[d]))!==null&&pe!==void 0?pe:null,qe!==null)return new Nt(qe,this);break;case de.Enum:if(qe=(Qe=(nt=this._runtimeInstance)===null||nt===void 0?void 0:nt.enum(o[d]))!==null&&Qe!==void 0?Qe:null,qe!==null)return new vt(qe,this);break;case de.List:if(qe=(it=(ut=this._runtimeInstance)===null||ut===void 0?void 0:ut.list(o[d]))!==null&&it!==void 0?it:null,qe!==null)return new Tt(qe,this);break;case de.Image:if(qe=(Rr=(Vt=this._runtimeInstance)===null||Vt===void 0?void 0:Vt.image(o[d]))!==null&&Rr!==void 0?Rr:null,qe!==null)return new lt(qe,this);break;case de.Artboard:if(qe=(or=(Or=this._runtimeInstance)===null||Or===void 0?void 0:Or.artboard(o[d]))!==null&&or!==void 0?or:null,qe!==null)return new rt(qe,this);break}return null},p.prototype.internalViewModelInstance=function(o){var d;if(this._viewModelInstances.has(o))return this._viewModelInstances.get(o);var w=(d=this._runtimeInstance)===null||d===void 0?void 0:d.viewModel(o);if(w!==null){var C=new p(w,this);return C.internalIncrementReferenceCount(),this._viewModelInstances.set(o,C),C}return null},p.prototype.number=function(o){var d=this.propertyFromPath(o,de.Number);return d},p.prototype.string=function(o){var d=this.propertyFromPath(o,de.String);return d},p.prototype.boolean=function(o){var d=this.propertyFromPath(o,de.Boolean);return d},p.prototype.color=function(o){var d=this.propertyFromPath(o,de.Color);return d},p.prototype.trigger=function(o){var d=this.propertyFromPath(o,de.Trigger);return d},p.prototype.enum=function(o){var d=this.propertyFromPath(o,de.Enum);return d},p.prototype.list=function(o){var d=this.propertyFromPath(o,de.List);return d},p.prototype.image=function(o){var d=this.propertyFromPath(o,de.Image);return d},p.prototype.artboard=function(o){var d=this.propertyFromPath(o,de.Artboard);return d},p.prototype.viewModel=function(o){var d=o.split("/"),w=d.length>1?this.viewModelFromPathSegments(d.slice(0,d.length-1),0):this;return w!=null?w.internalViewModelInstance(d[d.length-1]):null},p.prototype.internalReplaceViewModel=function(o,d){var w;if(d.runtimeInstance!==null){var C=((w=this._runtimeInstance)===null||w===void 0?void 0:w.replaceViewModel(o,d.runtimeInstance))||!1;if(C){d.internalIncrementReferenceCount();var M=this.internalViewModelInstance(o);M!==null&&(M.removeParent(this),this._children.includes(M)&&(this._children=this._children.filter(function(V){return V!==M})),M.cleanup()),this._viewModelInstances.set(o,d),d.addParent(this)}return C}return!1},p.prototype.replaceViewModel=function(o,d){var w,C=o.split("/"),M=C.length>1?this.viewModelFromPathSegments(C.slice(0,C.length-1),0):this;return(w=M?.internalReplaceViewModel(C[C.length-1],d))!==null&&w!==void 0?w:!1},p.prototype.incrementReferenceCount=function(){var o;this._referenceCount++,(o=this._runtimeInstance)===null||o===void 0||o.incrementReferenceCount()},p.prototype.decrementReferenceCount=function(){var o;this._referenceCount--,(o=this._runtimeInstance)===null||o===void 0||o.decrementReferenceCount()},Object.defineProperty(p.prototype,"properties",{get:function(){var o;return((o=this._runtimeInstance)===null||o===void 0?void 0:o.getProperties().map(function(d){return k({},d)}))||[]},enumerable:!1,configurable:!0}),p.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},p.prototype.cleanup=function(){var o=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(C){C.cleanup()}),this._viewModelInstances.clear();var d=S([],this._children,!0);this._children.length=0;var w=S([],this._parents,!0);this._parents.length=0,d.forEach(function(C){C.removeParent(o)}),w.forEach(function(C){C.removeFromViewModelCallbacks(o)})}},p})(),Oe=(function(){function p(o,d){this.callbacks=[],this._viewModelInstanceValue=o,this._parentViewModel=d}return p.prototype.on=function(o){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(o)||(this.callbacks.push(o),this._parentViewModel.addToPropertyCallbacks(this))},p.prototype.off=function(o){o?this.callbacks=this.callbacks.filter(function(d){return d!==o}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},p.prototype.internalHandleCallback=function(o){},p.prototype.handleCallbacks=function(){var o=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(d){o.internalHandleCallback(d)})},p.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},p.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),p})(),Ye=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(Oe),bt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(Oe),Ct=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(Oe),Nt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return o.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},o.prototype.internalHandleCallback=function(d){d()},o})(Oe),vt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(d){this._viewModelInstanceValue.valueIndex=d},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d(this.value)},o})(Oe),Tt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),o.prototype.addInstance=function(d){d.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(d.runtimeInstance),d.addParent(this._parentViewModel))},o.prototype.addInstanceAt=function(d,w){return d.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(d.runtimeInstance,w)?(d.addParent(this._parentViewModel),!0):!1},o.prototype.removeInstance=function(d){d.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(d.runtimeInstance),d.removeParent(this._parentViewModel))},o.prototype.removeInstanceAt=function(d){this._viewModelInstanceValue.removeInstanceAt(d)},o.prototype.instanceAt=function(d){var w=this._viewModelInstanceValue.instanceAt(d);if(w!=null){var C=new ge(w,this._parentViewModel);return C}return null},o.prototype.swap=function(d,w){this._viewModelInstanceValue.swap(d,w)},o.prototype.internalHandleCallback=function(d){d()},o})(Oe),Lt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),o.prototype.rgb=function(d,w,C){this._viewModelInstanceValue.rgb(d,w,C)},o.prototype.rgba=function(d,w,C,M){this._viewModelInstanceValue.argb(M,d,w,C)},o.prototype.argb=function(d,w,C,M){this._viewModelInstanceValue.argb(d,w,C,M)},o.prototype.alpha=function(d){this._viewModelInstanceValue.alpha(d)},o.prototype.opacity=function(d){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,d))*255))},o.prototype.internalHandleCallback=function(d){d(this.value)},o})(Oe),lt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{set:function(d){var w;this._viewModelInstanceValue.value((w=d?.nativeImage)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d()},o})(Oe),rt=(function(p){m(o,p);function o(d,w){return p.call(this,d,w)||this}return Object.defineProperty(o.prototype,"value",{set:function(d){var w;this._viewModelInstanceValue.value((w=d?.nativeArtboard)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),o.prototype.internalHandleCallback=function(d){d()},o})(Oe),ar=function(p){return E(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Request(p),[4,fetch(o)];case 1:return d=C.sent(),[4,d.arrayBuffer()];case 2:return w=C.sent(),[2,w]}})})},pt=function(p){return typeof p=="string"?[p]:p instanceof Array?p:[]},gt={EventManager:fe,TaskQueueManager:Fe},Wt=function(p){return E(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Promise(function(M){return z.getInstance(function(V){V.decodeAudio(p,M)})}),[4,o];case 1:return d=C.sent(),w=new g.AudioWrapper(d),g.finalizationRegistry.register(w,d),[2,w]}})})},zr=function(p){return E(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Promise(function(M){return z.getInstance(function(V){V.decodeImage(p,M)})}),[4,o];case 1:return d=C.sent(),w=new g.ImageWrapper(d),g.finalizationRegistry.register(w,d),[2,w]}})})},Dt=function(p){return E(void 0,void 0,void 0,function(){var o,d,w;return _(this,function(C){switch(C.label){case 0:return o=new Promise(function(M){return z.getInstance(function(V){V.decodeFont(p,M)})}),[4,o];case 1:return d=C.sent(),w=new g.FontWrapper(d),g.finalizationRegistry.register(w,d),[2,w]}})})}})(),l})())})(es)),es.exports}var cv=uv();const ds="dracula",dv="dracula_story.json",hs="https://vycjpmuyscfygstjjied.supabase.co";var hv=ue('<div class="rive-wrapper svelte-nkuq4r"><canvas width="250" height="500" class="svelte-nkuq4r"></canvas></div>');function wl(r,e){Jt(e,!0);let t=Ot(void 0);ks(()=>{if(!F(t))return;const l=new cv.Rive({src:`${hs}/storage/v1/object/public/${ds}/${e.fileName}`,canvas:F(t),autoplay:!0,stateMachines:"SM1"});return()=>{l.cleanup()}});var n=hv(),s=$(n);vd(s,l=>Rt(t,l),()=>F(t)),ee(r,n),Xt()}function fv(r,e){F(e)?.nextDialogueId&&jt.goToDialogue(F(e).nextDialogueId)}var vv=ue('<img alt="BG" class="background-image svelte-ik8jti"/>'),pv=ue('<div class="background-media svelte-ik8jti"><!></div>'),gv=ue('<img alt="Char" class="character-image svelte-ik8jti"/>'),_v=ue('<div class="character-media svelte-ik8jti"><!></div>'),mv=(r,e,t)=>e(F(t)),yv=ue('<button class="option-button svelte-ik8jti"> </button>'),wv=ue('<div class="options-container svelte-ik8jti"></div>'),bv=ue('<div class="next-container svelte-ik8jti"><button class="next-button svelte-ik8jti">Далее...</button></div>'),kv=ue('<div class="dialogue-container svelte-ik8jti"><!> <!> <div class="dialogue-content svelte-ik8jti"><div class="dialogue-text svelte-ik8jti"> </div> <!></div></div>'),Ev=ue("<p> </p>");function Su(r,e){Jt(e,!0);const t=Oc(()=>e.dialogue||jt.findDialogue(jt.currentDialogueId));_i(()=>{F(t)?.onEnter&&jt.runActions(F(t).onEnter)});function n(g){if(g.actions&&jt.runActions(g.actions),g.miniGame){console.log("Запуск мини-игры:",g.miniGame.id),jt.goToDialogue(g.miniGame.onWinDialogueId);return}g.nextDialogueId&&jt.goToDialogue(g.nextDialogueId)}function s(g){return g.visibleIf&&g.visibleIf.hasItem?jt.hasItem(g.visibleIf.hasItem):!0}var l=gr(),c=Ut(l);{var h=g=>{var m=kv(),k=$(m);{var E=K=>{var O=pv(),j=$(O);{var ie=ce=>{var Q=gr(),ne=Ut(Q);Wo(ne,()=>F(t).backgroundImage,fe=>{wl(fe,{get fileName(){return F(t).backgroundImage}})}),ee(ce,Q)},X=ce=>{var Q=vv();Ce(()=>Dn(Q,"src",`${hs}/storage/v1/object/public/${ds}/${F(t).backgroundImage}`)),ee(ce,Q)};$e(j,ce=>{F(t).backgroundImage.endsWith(".riv")?ce(ie):ce(X,!1)})}ee(K,O)};$e(k,K=>{F(t).backgroundImage&&K(E)})}var _=N(k,2);{var S=K=>{var O=_v(),j=$(O);{var ie=ce=>{var Q=gr(),ne=Ut(Q);Wo(ne,()=>F(t).characterImage,fe=>{wl(fe,{get fileName(){return F(t).characterImage}})}),ee(ce,Q)},X=ce=>{var Q=gv();Ce(()=>Dn(Q,"src",`${hs}/storage/v1/object/public/${ds}/${F(t).characterImage}`)),ee(ce,Q)};$e(j,ce=>{F(t).characterImage.endsWith(".riv")?ce(ie):ce(X,!1)})}ee(K,O)};$e(_,K=>{F(t).characterImage&&K(S)})}var D=N(_,2),R=$(D),U=$(R),B=N(R,2);{var W=K=>{var O=wv();St(O,21,()=>F(t).options,j=>j.text,(j,ie)=>{var X=gr(),ce=Ut(X);{var Q=ne=>{var fe=yv();fe.__click=[mv,n,ie];var Fe=$(fe);Ce(()=>Le(Fe,F(ie).text)),ee(ne,fe)};$e(ce,ne=>{s(F(ie))&&ne(Q)})}ee(j,X)}),ee(K,O)},z=K=>{var O=gr(),j=Ut(O);{var ie=X=>{var ce=bv(),Q=$(ce);Q.__click=[fv,t],ee(X,ce)};$e(j,X=>{F(t).nextDialogueId&&X(ie)},!0)}ee(K,O)};$e(B,K=>{F(t).options&&F(t).options.length>0?K(W):K(z,!1)})}Ce(()=>Le(U,F(t).text)),ee(g,m)},v=g=>{var m=Ev(),k=$(m);Ce(()=>Le(k,`Диалог не найден (ID: ${jt.currentDialogueId??""})`)),ee(g,m)};$e(c,g=>{F(t)?g(h):g(v,!1)})}ee(r,l),Xt()}xr(["click"]);var bl=Kn(()=>x),Av=ue('<div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Фон:</span> <span class="info-value svelte-1u0yr0g"> </span></div>'),Sv=ue('<div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Персонаж:</span> <span class="info-value svelte-1u0yr0g"> </span></div>'),Iv=ue('<div class="preview-warning svelte-1u0yr0g">⚠️ Нет вариантов ответов</div>'),Cv=ue('<div class="preview-warning svelte-1u0yr0g">⚠️ Некоторые варианты не ведут дальше</div>'),Tv=ue('<div class="preview-container svelte-1u0yr0g"><!> <div class="preview-info svelte-1u0yr0g"><div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">ID:</span> <span class="info-value svelte-1u0yr0g"> </span></div> <div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Глава:</span> <span class="info-value svelte-1u0yr0g"> </span></div> <!> <!></div> <!> <!></div>'),Pv=ue('<div class="empty-preview svelte-1u0yr0g"><div class="empty-icon svelte-1u0yr0g">👈</div> <div class="empty-text svelte-1u0yr0g">Выберите сцену для предпросмотра</div></div>'),xv=ue('<aside class="preview-panel svelte-1u0yr0g"><div class="preview-header svelte-1u0yr0g"><h3 class="svelte-1u0yr0g">Предпросмотр</h3> <button class="btn-link small svelte-1u0yr0g">Сбросить редакт. опций</button></div> <div class="preview-wrapper svelte-1u0yr0g"><!></div></aside>');function Rv(r,e){Jt(e,!1);function t(){bl(bl().editingOptionIndex=null)}gn();var n=xv(),s=$(n),l=N($(s),2);l.__click=t;var c=N(s,2),h=$(c);{var v=m=>{var k=Tv(),E=$(k);Su(E,{get dialogue(){return Et.currentDialogue},index:0});var _=N(E,2),S=$(_),D=N($(S),2),R=$(D),U=N(S,2),B=N($(U),2),W=$(B),z=N(U,2);{var K=ne=>{var fe=Av(),Fe=N($(fe),2),J=$(Fe);Ce(()=>Le(J,Et.currentDialogue.backgroundImage)),ee(ne,fe)};$e(z,ne=>{Et.currentDialogue.backgroundImage&&ne(K)})}var O=N(z,2);{var j=ne=>{var fe=Sv(),Fe=N($(fe),2),J=$(Fe);Ce(()=>Le(J,Et.currentDialogue.characterImage)),ee(ne,fe)};$e(O,ne=>{Et.currentDialogue.characterImage&&ne(j)})}var ie=N(_,2);{var X=ne=>{var fe=Iv();ee(ne,fe)};$e(ie,ne=>{(!Et.currentDialogue.options||Et.currentDialogue.options.length===0)&&ne(X)})}var ce=N(ie,2);{var Q=ne=>{var fe=Cv();ee(ne,fe)};$e(ce,ne=>{Et.currentDialogue.options?.some(fe=>!fe.nextDialogueId)&&ne(Q)})}Ce(()=>{Le(R,Et.currentDialogue.id),Le(W,Et.currentChapter?.title||"Без главы")}),ee(m,k)},g=m=>{var k=Pv();ee(m,k)};$e(h,m=>{Et.currentDialogue?m(v):m(g,!1)})}ee(r,n),Xt()}xr(["click"]);const Ov=["dracula","zombie","fairy_tale"];function Iu(){const r=Ov.map(e=>({id:e,name:e,public:!1,file_count:0,created_at:new Date().toISOString()}));return tt.updateBucketsList(r),r}var tn=Kn(()=>x),jv=ue('<span class="selected-badge svelte-1enye7i">Выбрано</span>'),Mv=(r,e,t)=>e(F(t).name),Lv=ue('<button class="btn small svelte-1enye7i">Выбрать</button>'),Dv=ue('<div><div class="bucket-info svelte-1enye7i"><div class="bucket-name svelte-1enye7i"> </div> <div class="bucket-meta svelte-1enye7i">📖 Интерактивная история</div></div> <div class="bucket-actions svelte-1enye7i"><!></div></div>'),$v=ue('<div class="story-selector svelte-1enye7i"><div class="selector-header svelte-1enye7i"><h2 class="svelte-1enye7i">Выберите историю</h2></div> <div class="buckets-list svelte-1enye7i"></div></div>');function Fv(r,e){Jt(e,!1),ks(()=>{t()});function t(){Iu()}async function n(c){tn(tn().selectedBucket=c),tn(tn().data={meta:{version:"3.1",title:"Новая история"},dialogues:[],chapters:[],items:[],miniGames:[]}),await Vr.loadStoriesList(),await Vr.loadStoredResources()}gn();var s=$v(),l=N($(s),2);St(l,5,()=>tn().availableBuckets,Gt,(c,h)=>{var v=Dv();let g;var m=$(v),k=$(m),E=$(k),_=N(m,2),S=$(_);{var D=U=>{var B=jv();ee(U,B)},R=U=>{var B=Lv();B.__click=[Mv,n,h],ee(U,B)};$e(S,U=>{tn().selectedBucket===F(h).name?U(D):U(R,!1)})}Ce(U=>{g=Nr(v,1,"bucket-card svelte-1enye7i",null,g,U),Le(E,F(h).name)},[()=>({selected:tn().selectedBucket===F(h).name})]),ee(c,v)}),ee(r,s),Xt()}xr(["click"]);var Uv=ue("<span> </span>"),Bv=ue('<div class="debug-info svelte-1k4krym"><small> </small></div>'),Nv=ue('<div class="debug-info warning svelte-1k4krym"><small>⚠️ Данные не загружены</small></div>'),Wv=ue('<div class="empty-state svelte-1k4krym">Выберите сцену</div>'),Vv=ue('<div class="editor-container svelte-1k4krym"><header class="toolbar svelte-1k4krym"><div class="logo svelte-1k4krym"><button class="btn-link svelte-1k4krym">← Сменить историю</button> <h2 class="svelte-1k4krym"> </h2></div> <div class="stories-control svelte-1k4krym"><span class="story-file-name svelte-1k4krym"> </span> <!> <button class="btn success small svelte-1k4krym">💾 Сохранить</button> <button class="btn small svelte-1k4krym">📋 Копия</button></div></header> <div class="main-workspace svelte-1k4krym"><!> <main class="editor-area svelte-1k4krym"><!> <!> <!></main> <!></div></div>');function qv(r,e){Jt(e,!0),ks(async()=>{Iu(),x.availableBuckets.length>0&&!x.selectedBucket&&(x.selectedBucket=x.availableBuckets[0].name)}),_i(async()=>{if(x.selectedBucket){console.log(`[Editor] Bucket выбран: ${x.selectedBucket}`),await Vr.loadStoredResources();const c=`${x.selectedBucket}_story.json`;x.currentFileName=c,await ln.loadStory(c)}});var t=gr(),n=Ut(t);{var s=c=>{Fv(c,{})},l=c=>{var h=Vv(),v=$(h),g=$(v),m=$(g);m.__click=()=>x.selectedBucket=null;var k=N(m,2),E=$(k),_=N(g,2),S=$(_),D=$(S),R=N(S,2);{var U=J=>{var ve=Uv(),oe=$(ve);Ce(()=>{Nr(ve,1,`status-message ${x.statusMessage.type??""}`,"svelte-1k4krym"),Le(oe,x.statusMessage.text)}),ee(J,ve)};$e(R,J=>{x.statusMessage.text&&J(U)})}var B=N(R,2);B.__click=function(...J){ln.saveCurrentStory?.apply(this,J)};var W=N(B,2);W.__click=function(...J){ln.saveStoryCopy?.apply(this,J)};var z=N(v,2),K=$(z);Rf(K,{});var O=N(K,2),j=$(O);{var ie=J=>{var ve=Bv(),oe=$(ve),Ke=$(oe);Ce(()=>Le(Ke,`Загружено: ${x.data.meta?.title??""} |
              Глав: ${(x.data.chapters?.length||0)??""} |
              Диалогов: ${(x.data.dialogues?.length||0)??""} |
              Предметов: ${(x.data.items?.length||0)??""}`)),ee(J,ve)},X=J=>{var ve=Nv();ee(J,ve)};$e(j,J=>{x.data?J(ie):J(X,!1)})}var ce=N(j,2);av(ce,{});var Q=N(ce,2);{var ne=J=>{Kf(J,{get editor(){return x},get storyActions(){return ln},get resourceActions(){return Vr}})},fe=J=>{var ve=Wv();ee(J,ve)};$e(Q,J=>{Et.currentDialogue?J(ne):J(fe,!1)})}var Fe=N(O,2);Rv(Fe,{}),Ce(()=>{Le(E,`Story Editor v3.1 - ${x.selectedBucket??""}`),Le(D,x.currentFileName||"Нет файла")}),ee(c,h)};$e(n,c=>{x.selectedBucket?c(l,!1):c(s)})}ee(r,t),Xt()}xr(["click"]);var Hv=ue('<div class="loading svelte-fgmugb"><p>🔄 Загрузка истории...</p></div>'),zv=ue('<div class="error svelte-fgmugb"> </div>'),Gv=ue('<div class="dialogues-container svelte-fgmugb"><!></div>'),Kv=ue('<div class="app svelte-fgmugb"><!></div>');function Yv(r,e){Jt(e,!1);let t=`${hs}/storage/v1/object/public/${ds}/${dv}`;ks(async()=>{console.log("Загружаем историю из:",t),await jt.loadStory(t)}),gn();var n=Kv(),s=$(n);{var l=h=>{var v=Hv();ee(h,v)},c=h=>{var v=gr(),g=Ut(v);{var m=E=>{var _=zv(),S=$(_);Ce(()=>Le(S,`⚠️ ${jt.error??""}`)),ee(E,_)},k=E=>{var _=Gv(),S=$(_);{var D=R=>{Su(R,{})};$e(S,R=>{jt.storyData&&R(D)})}ee(E,_)};$e(g,E=>{jt.error?E(m):E(k,!1)},!0)}ee(h,v)};$e(s,h=>{jt.isLoading?h(l):h(c,!1)})}ee(r,n),Xt()}var Jv=ue('<button style="position:fixed; top:10px; right:500px; z-index:9999;">Закрыть редактор</button> <!>',1),Xv=ue('<button style="position:fixed; bottom:10px; right:10px; z-index:9999;">Редактор</button> <!>',1);function Qv(r,e){Jt(e,!1),gn();var t=gr(),n=Ut(t);{var s=c=>{var h=Jv(),v=Ut(h);v.__click=function(...m){tt.toggleEditor?.apply(this,m)};var g=N(v,2);qv(g,{}),ee(c,h)},l=c=>{var h=Xv(),v=Ut(h);v.__click=function(...m){tt.toggleEditor?.apply(this,m)};var g=N(v,2);Yv(g,{}),ee(c,h)};$e(n,c=>{x.showEditor?c(s):c(l,!1)})}ee(r,t),Xt()}xr(["click"]);sd(Qv,{target:document.getElementById("app")});
