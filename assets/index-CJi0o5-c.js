(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();const Dl=!1;var As=Array.isArray,pc=Array.prototype.indexOf,Da=Array.from,ga=Object.defineProperty,ei=Object.getOwnPropertyDescriptor,Fl=Object.getOwnPropertyDescriptors,gc=Object.prototype,mc=Array.prototype,Fa=Object.getPrototypeOf,Ho=Object.isExtensible;const _c=()=>{};function yc(n){return n()}function _s(n){for(var e=0;e<n.length;e++)n[e]()}function wc(){var n,e,t=new Promise((r,i)=>{n=r,e=i});return{promise:t,resolve:n,reject:e}}const un=2,$a=4,Cs=8,ci=16,qn=32,Tr=64,$l=128,hn=256,ys=512,Qt=1024,vn=2048,nr=4096,kn=8192,xr=16384,Ua=32768,Ts=65536,Ko=1<<17,bc=1<<18,Li=1<<19,Ul=1<<20,ma=1<<21,Na=1<<22,Sr=1<<23,Wn=Symbol("$state"),kc=Symbol("legacy props"),Ic=Symbol(""),Ba=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Sc(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Ec(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ac(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Cc(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Tc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function xc(n){throw new Error("https://svelte.dev/e/effect_orphan")}function jc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Pc(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function Rc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Oc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Mc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const xs=1,js=2,Nl=4,Lc=8,Dc=16,Fc=1,$c=2,Uc=4,Nc=8,Bc=16,Wc=1,Vc=2,Ht=Symbol(),qc="http://www.w3.org/1999/xhtml";function Gc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let zc=!1;function Bl(n){return n===this.v}function Wl(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function Hc(n,e){return n!==e}function Vl(n){return!Wl(n,this.v)}let di=!1,Kc=!1;function Yc(){di=!0}let Nt=null;function ws(n){Nt=n}function Tt(n,e=!1,t){Nt={p:Nt,c:null,e:null,s:n,x:null,l:di&&!e?{s:null,u:null,$:[]}:null}}function xt(n){var e=Nt,t=e.e;if(t!==null){e.e=null;for(var r of t)ru(r)}return Nt=e.p,{}}function fi(){return!di||Nt!==null&&Nt.l===null}const Jc=new WeakMap;function Xc(n){var e=ht;if(e===null)return pt.f|=Sr,n;if((e.f&Ua)===0){if((e.f&$l)===0)throw!e.parent&&n instanceof Error&&ql(n),n;e.b.error(n)}else Wa(n,e)}function Wa(n,e){for(;e!==null;){if((e.f&$l)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&ql(n),n}function ql(n){const e=Jc.get(n);e&&(ga(n,"message",{value:e.message}),ga(n,"stack",{value:e.stack}))}let Pi=[],_a=[];function Gl(){var n=Pi;Pi=[],_s(n)}function Qc(){var n=_a;_a=[],_s(n)}function Va(n){Pi.length===0&&queueMicrotask(Gl),Pi.push(n)}function Zc(){Pi.length>0&&Gl(),_a.length>0&&Qc()}function ed(){for(var n=ht.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&Sc(),n}function Di(n){var e=un|vn,t=pt!==null&&(pt.f&un)!==0?pt:null;return ht===null||t!==null&&(t.f&hn)!==0?e|=hn:ht.f|=Li,{ctx:Nt,deps:null,effects:null,equals:Bl,f:e,fn:n,reactions:null,rv:0,v:Ht,wv:0,parent:t??ht,ac:null}}function td(n,e){let t=ht;t===null&&Ac();var r=t.b,i=void 0,o=si(Ht),u=null,f=!pt;return pd(()=>{try{var v=n();u&&Promise.resolve(v).catch(()=>{})}catch(_){v=Promise.reject(_)}var p=()=>v;i=u?.then(p,p)??Promise.resolve(v),u=i;var m=Rt,w=r.pending;f&&(r.update_pending_count(1),w||m.increment());const I=(_,k=void 0)=>{u=null,w||m.activate(),k?k!==Ba&&(o.f|=Sr,ai(o,k)):((o.f&Sr)!==0&&(o.f^=Sr),ai(o,_)),f&&(r.update_pending_count(-1),w||m.decrement()),Kl()};if(i.then(I,_=>I(null,_||"unknown")),m)return()=>{queueMicrotask(()=>m.neuter())}}),new Promise(v=>{function p(m){function w(){m===i?v(o):p(i)}m.then(w,w)}p(i)})}function Ot(n){const e=Di(n);return cu(e),e}function Fi(n){const e=Di(n);return e.equals=Vl,e}function zl(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Pn(e[t])}}function nd(n){for(var e=n.parent;e!==null;){if((e.f&un)===0)return e;e=e.parent}return null}function qa(n){var e,t=ht;er(nd(n));try{zl(n),e=vu(n)}finally{er(t)}return e}function Hl(n){var e=qa(n);if(n.equals(e)||(n.v=e,n.wv=fu()),!Pr){var t=(Xn||(n.f&hn)!==0)&&n.deps!==null?nr:Qt;an(n,t)}}function rd(n,e,t){const r=fi()?Di:Fi;if(e.length===0){t(n.map(r));return}var i=Rt,o=ht,u=id(),f=ed();Promise.all(e.map(v=>td(v))).then(v=>{i?.activate(),u();try{t([...n.map(r),...v])}catch(p){(o.f&xr)===0&&Wa(p,o)}i?.deactivate(),Kl()}).catch(v=>{f.error(v)})}function id(){var n=ht,e=pt,t=Nt,r=Rt;return function(){er(n),Rn(e),ws(t),r?.activate()}}function Kl(){er(null),Rn(null),ws(null)}const ea=new Set;let Rt=null,ps=null,Yo=new Set,bs=[];function Yl(){const n=bs.shift();bs.length>0&&queueMicrotask(Yl),n()}let Ar=[],Ps=null,ya=!1,gs=!1;class ri{current=new Map;#i=new Map;#n=new Set;#e=0;#s=null;#a=!1;#t=[];#r=[];#l=[];#o=[];#u=[];#d=[];#f=[];skipped_effects=new Set;process(e){Ar=[],ps=null;for(const i of e)this.#v(i);if(this.#t.length===0&&this.#e===0){this.#h();var t=this.#l,r=this.#o;this.#l=[],this.#o=[],this.#u=[],ps=Rt,Rt=null,Jo(t),Jo(r),Rt===null?Rt=this:ea.delete(this),this.#s?.resolve()}else this.#c(this.#l),this.#c(this.#o),this.#c(this.#u);for(const i of this.#t)ni(i);for(const i of this.#r)ni(i);this.#t=[],this.#r=[]}#v(e){e.f^=Qt;for(var t=e.first;t!==null;){var r=t.f,i=(r&(qn|Tr))!==0,o=i&&(r&Qt)!==0,u=o||(r&kn)!==0||this.skipped_effects.has(t);if(!u&&t.fn!==null){if(i)t.f^=Qt;else if((r&$a)!==0)this.#o.push(t);else if((r&Qt)===0)if((r&Na)!==0){var f=t.b?.pending?this.#r:this.#t;f.push(t)}else Ds(t)&&((t.f&ci)!==0&&this.#u.push(t),ni(t));var v=t.first;if(v!==null){t=v;continue}}var p=t.parent;for(t=t.next;t===null&&p!==null;)t=p.next,p=p.parent}}#c(e){for(const t of e)((t.f&vn)!==0?this.#d:this.#f).push(t),an(t,Qt);e.length=0}capture(e,t){this.#i.has(e)||this.#i.set(e,t),this.current.set(e,e.v)}activate(){Rt=this}deactivate(){Rt=null,ps=null;for(const e of Yo)if(Yo.delete(e),e(),Rt!==null)break}neuter(){this.#a=!0}flush(){Ar.length>0?Jl():this.#h(),Rt===this&&(this.#e===0&&ea.delete(this),this.deactivate())}#h(){if(!this.#a)for(const e of this.#n)e();this.#n.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#d)an(e,vn),ii(e);for(const e of this.#f)an(e,nr),ii(e);this.#l=[],this.#o=[],this.flush()}else this.deactivate()}add_callback(e){this.#n.add(e)}settled(){return(this.#s??=wc()).promise}static ensure(){if(Rt===null){const e=Rt=new ri;ea.add(Rt),gs||ri.enqueue(()=>{Rt===e&&e.flush()})}return Rt}static enqueue(e){bs.length===0&&queueMicrotask(Yl),bs.unshift(e)}}function sd(n){var e=gs;gs=!0;try{for(var t;;){if(Zc(),Ar.length===0&&(Rt?.flush(),Ar.length===0))return Ps=null,t;Jl()}}finally{gs=e}}function Jl(){var n=ti;ya=!0;try{var e=0;for(el(!0);Ar.length>0;){var t=ri.ensure();if(e++>1e3){var r,i;ad()}t.process(Ar),Qn.clear()}}finally{ya=!1,el(n),Ps=null}}function ad(){try{jc()}catch(n){Wa(n,Ps)}}let br=null;function Jo(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(xr|kn))===0&&Ds(r)&&(br=[],ni(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?ou(r):r.fn=null),br?.length>0)){Qn.clear();for(const i of br)ni(i);br=[]}}br=null}}function ii(n){for(var e=Ps=n;e.parent!==null;){e=e.parent;var t=e.f;if(ya&&e===ht&&(t&ci)!==0)return;if((t&(Tr|qn))!==0){if((t&Qt)===0)return;e.f^=Qt}}Ar.push(e)}const Qn=new Map;function si(n,e){var t={f:0,v:n,reactions:null,equals:Bl,rv:0,wv:0};return t}function Re(n,e){const t=si(n);return cu(t),t}function od(n,e=!1,t=!0){const r=si(n);return e||(r.equals=Vl),di&&t&&Nt!==null&&Nt.l!==null&&(Nt.l.s??=[]).push(r),r}function ie(n,e,t=!1){pt!==null&&(!jn||(pt.f&Ko)!==0)&&fi()&&(pt.f&(un|ci|Na|Ko))!==0&&!Vn?.includes(n)&&Mc();let r=t?ft(e):e;return ai(n,r)}function ai(n,e){if(!n.equals(e)){var t=n.v;Pr?Qn.set(n,e):Qn.set(n,t),n.v=e;var r=ri.ensure();r.capture(n,t),(n.f&un)!==0&&((n.f&vn)!==0&&qa(n),an(n,(n.f&hn)===0?Qt:nr)),n.wv=fu(),Xl(n,vn),fi()&&ht!==null&&(ht.f&Qt)!==0&&(ht.f&(qn|Tr))===0&&(fn===null?yd([n]):fn.push(n))}return e}function Zn(n,e=1){var t=h(n),r=e===1?t++:t--;return ie(n,t),r}function ta(n){ie(n,n.v+1)}function Xl(n,e){var t=n.reactions;if(t!==null)for(var r=fi(),i=t.length,o=0;o<i;o++){var u=t[o],f=u.f;if(!(!r&&u===ht)){var v=(f&vn)===0;v&&an(u,e),(f&un)!==0?Xl(u,nr):v&&((f&ci)!==0&&br!==null&&br.push(u),ii(u))}}}function ft(n){if(typeof n!="object"||n===null||Wn in n)return n;const e=Fa(n);if(e!==gc&&e!==mc)return n;var t=new Map,r=As(n),i=Re(0),o=Er,u=f=>{if(Er===o)return f();var v=pt,p=Er;Rn(null),nl(o);var m=f();return Rn(v),nl(p),m};return r&&t.set("length",Re(n.length)),new Proxy(n,{defineProperty(f,v,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&Rc();var m=t.get(v);return m===void 0?m=u(()=>{var w=Re(p.value);return t.set(v,w),w}):ie(m,p.value,!0),!0},deleteProperty(f,v){var p=t.get(v);if(p===void 0){if(v in f){const m=u(()=>Re(Ht));t.set(v,m),ta(i)}}else ie(p,Ht),ta(i);return!0},get(f,v,p){if(v===Wn)return n;var m=t.get(v),w=v in f;if(m===void 0&&(!w||ei(f,v)?.writable)&&(m=u(()=>{var _=ft(w?f[v]:Ht),k=Re(_);return k}),t.set(v,m)),m!==void 0){var I=h(m);return I===Ht?void 0:I}return Reflect.get(f,v,p)},getOwnPropertyDescriptor(f,v){var p=Reflect.getOwnPropertyDescriptor(f,v);if(p&&"value"in p){var m=t.get(v);m&&(p.value=h(m))}else if(p===void 0){var w=t.get(v),I=w?.v;if(w!==void 0&&I!==Ht)return{enumerable:!0,configurable:!0,value:I,writable:!0}}return p},has(f,v){if(v===Wn)return!0;var p=t.get(v),m=p!==void 0&&p.v!==Ht||Reflect.has(f,v);if(p!==void 0||ht!==null&&(!m||ei(f,v)?.writable)){p===void 0&&(p=u(()=>{var I=m?ft(f[v]):Ht,_=Re(I);return _}),t.set(v,p));var w=h(p);if(w===Ht)return!1}return m},set(f,v,p,m){var w=t.get(v),I=v in f;if(r&&v==="length")for(var _=p;_<w.v;_+=1){var k=t.get(_+"");k!==void 0?ie(k,Ht):_ in f&&(k=u(()=>Re(Ht)),t.set(_+"",k))}if(w===void 0)(!I||ei(f,v)?.writable)&&(w=u(()=>Re(void 0)),ie(w,ft(p)),t.set(v,w));else{I=w.v!==Ht;var P=u(()=>ft(p));ie(w,P)}var x=Reflect.getOwnPropertyDescriptor(f,v);if(x?.set&&x.set.call(m,p),!I){if(r&&typeof v=="string"){var $=t.get("length"),z=Number(v);Number.isInteger(z)&&z>=$.v&&ie($,z+1)}ta(i)}return!0},ownKeys(f){h(i);var v=Reflect.ownKeys(f).filter(w=>{var I=t.get(w);return I===void 0||I.v!==Ht});for(var[p,m]of t)m.v!==Ht&&!(p in f)&&v.push(p);return v},setPrototypeOf(){Oc()}})}function Xo(n){try{if(n!==null&&typeof n=="object"&&Wn in n)return n[Wn]}catch{}return n}function ld(n,e){return Object.is(Xo(n),Xo(e))}var Qo,Ql,Zl,eu;function ud(){if(Qo===void 0){Qo=window,Ql=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Zl=ei(e,"firstChild").get,eu=ei(e,"nextSibling").get,Ho(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Ho(t)&&(t.__t=void 0)}}function jr(n=""){return document.createTextNode(n)}function oi(n){return Zl.call(n)}function Rs(n){return eu.call(n)}function A(n,e){return oi(n)}function Je(n,e){{var t=oi(n);return t instanceof Comment&&t.data===""?Rs(t):t}}function T(n,e=1,t=!1){let r=n;for(;e--;)r=Rs(r);return r}function cd(n){n.textContent=""}function Ga(){return!1}let Zo=!1;function dd(){Zo||(Zo=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function Os(n){var e=pt,t=ht;Rn(null),er(null);try{return n()}finally{Rn(e),er(t)}}function za(n,e,t,r=t){n.addEventListener(e,()=>Os(t));const i=n.__on_r;i?n.__on_r=()=>{i(),r(!0)}:n.__on_r=()=>r(!0),dd()}function tu(n){ht===null&&pt===null&&xc(),pt!==null&&(pt.f&hn)!==0&&ht===null&&Tc(),Pr&&Cc()}function fd(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function On(n,e,t,r=!0){var i=ht;i!==null&&(i.f&kn)!==0&&(n|=kn);var o={ctx:Nt,deps:null,nodes_start:null,nodes_end:null,f:n|vn,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{ni(o),o.f|=Ua}catch(v){throw Pn(o),v}else e!==null&&ii(o);if(r){var u=o;if(t&&u.deps===null&&u.teardown===null&&u.nodes_start===null&&u.first===u.last&&(u.f&Li)===0&&(u=u.first),u!==null&&(u.parent=i,i!==null&&fd(u,i),pt!==null&&(pt.f&un)!==0&&(n&Tr)===0)){var f=pt;(f.effects??=[]).push(u)}}return o}function nu(n){const e=On(Cs,null,!1);return an(e,Qt),e.teardown=n,e}function li(n){tu();var e=ht.f,t=!pt&&(e&qn)!==0&&(e&Ua)===0;if(t){var r=Nt;(r.e??=[]).push(n)}else return ru(n)}function ru(n){return On($a|Ul,n,!1)}function hd(n){return tu(),On(Cs|Ul,n,!0)}function vd(n){ri.ensure();const e=On(Tr|Li,n,!0);return(t={})=>new Promise(r=>{t.outro?Ls(e,()=>{Pn(e),r(void 0)}):(Pn(e),r(void 0))})}function iu(n){return On($a,n,!1)}function pd(n){return On(Na|Li,n,!0)}function Ha(n,e=0){return On(Cs|e,n,!0)}function Ee(n,e=[],t=[]){rd(e,t,r=>{On(Cs,()=>n(...r.map(h)),!0)})}function Ms(n,e=0){var t=On(ci|e,n,!0);return t}function Cr(n,e=!0){return On(qn|Li,n,!0,e)}function su(n){var e=n.teardown;if(e!==null){const t=Pr,r=pt;tl(!0),Rn(null);try{e.call(null)}finally{tl(t),Rn(r)}}}function au(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const i=t.ac;i!==null&&Os(()=>{i.abort(Ba)});var r=t.next;(t.f&Tr)!==0?t.parent=null:Pn(t,e),t=r}}function gd(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&qn)===0&&Pn(e),e=t}}function Pn(n,e=!0){var t=!1;(e||(n.f&bc)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(md(n.nodes_start,n.nodes_end),t=!0),au(n,e&&!t),ks(n,0),an(n,xr);var r=n.transitions;if(r!==null)for(const o of r)o.stop();su(n);var i=n.parent;i!==null&&i.first!==null&&ou(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function md(n,e){for(;n!==null;){var t=n===e?null:Rs(n);n.remove(),n=t}}function ou(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Ls(n,e){var t=[];Ka(n,t,!0),lu(t,()=>{Pn(n),e&&e()})}function lu(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var i of n)i.out(r)}else e()}function Ka(n,e,t){if((n.f&kn)===0){if(n.f^=kn,n.transitions!==null)for(const u of n.transitions)(u.is_global||t)&&e.push(u);for(var r=n.first;r!==null;){var i=r.next,o=(r.f&Ts)!==0||(r.f&qn)!==0;Ka(r,e,o?t:!1),r=i}}}function Ya(n){uu(n,!0)}function uu(n,e){if((n.f&kn)!==0){n.f^=kn,(n.f&Qt)===0&&(an(n,vn),ii(n));for(var t=n.first;t!==null;){var r=t.next,i=(t.f&Ts)!==0||(t.f&qn)!==0;uu(t,i?e:!1),t=r}if(n.transitions!==null)for(const o of n.transitions)(o.is_global||e)&&o.in()}}let Jr=null;function _d(n){var e=Jr;try{if(Jr=new Set,Rr(n),e!==null)for(var t of Jr)e.add(t);return Jr}finally{Jr=e}}function wn(n){for(var e of _d(n))ai(e,e.v)}let ti=!1;function el(n){ti=n}let Pr=!1;function tl(n){Pr=n}let pt=null,jn=!1;function Rn(n){pt=n}let ht=null;function er(n){ht=n}let Vn=null;function cu(n){pt!==null&&(Vn===null?Vn=[n]:Vn.push(n))}let tn=null,ln=0,fn=null;function yd(n){fn=n}let du=1,Ri=0,Er=Ri;function nl(n){Er=n}let Xn=!1;function fu(){return++du}function Ds(n){var e=n.f;if((e&vn)!==0)return!0;if((e&nr)!==0){var t=n.deps,r=(e&hn)!==0;if(t!==null){var i,o,u=(e&ys)!==0,f=r&&ht!==null&&!Xn,v=t.length;if((u||f)&&(ht===null||(ht.f&xr)===0)){var p=n,m=p.parent;for(i=0;i<v;i++)o=t[i],(u||!o?.reactions?.includes(p))&&(o.reactions??=[]).push(p);u&&(p.f^=ys),f&&m!==null&&(m.f&hn)===0&&(p.f^=hn)}for(i=0;i<v;i++)if(o=t[i],Ds(o)&&Hl(o),o.wv>n.wv)return!0}(!r||ht!==null&&!Xn)&&an(n,Qt)}return!1}function hu(n,e,t=!0){var r=n.reactions;if(r!==null&&!Vn?.includes(n))for(var i=0;i<r.length;i++){var o=r[i];(o.f&un)!==0?hu(o,e,!1):e===o&&(t?an(o,vn):(o.f&Qt)!==0&&an(o,nr),ii(o))}}function vu(n){var e=tn,t=ln,r=fn,i=pt,o=Xn,u=Vn,f=Nt,v=jn,p=Er,m=n.f;tn=null,ln=0,fn=null,Xn=(m&hn)!==0&&(jn||!ti||pt===null),pt=(m&(qn|Tr))===0?n:null,Vn=null,ws(n.ctx),jn=!1,Er=++Ri,n.ac!==null&&(Os(()=>{n.ac.abort(Ba)}),n.ac=null);try{n.f|=ma;var w=n.fn,I=w(),_=n.deps;if(tn!==null){var k;if(ks(n,ln),_!==null&&ln>0)for(_.length=ln+tn.length,k=0;k<tn.length;k++)_[ln+k]=tn[k];else n.deps=_=tn;if(!Xn||(m&un)!==0&&n.reactions!==null)for(k=ln;k<_.length;k++)(_[k].reactions??=[]).push(n)}else _!==null&&ln<_.length&&(ks(n,ln),_.length=ln);if(fi()&&fn!==null&&!jn&&_!==null&&(n.f&(un|nr|vn))===0)for(k=0;k<fn.length;k++)hu(fn[k],n);return i!==null&&i!==n&&(Ri++,fn!==null&&(r===null?r=fn:r.push(...fn))),(n.f&Sr)!==0&&(n.f^=Sr),I}catch(P){return Xc(P)}finally{n.f^=ma,tn=e,ln=t,fn=r,pt=i,Xn=o,Vn=u,ws(f),jn=v,Er=p}}function wd(n,e){let t=e.reactions;if(t!==null){var r=pc.call(t,n);if(r!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[r]=t[i],t.pop())}}t===null&&(e.f&un)!==0&&(tn===null||!tn.includes(e))&&(an(e,nr),(e.f&(hn|ys))===0&&(e.f^=ys),zl(e),ks(e,0))}function ks(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)wd(n,t[r])}function ni(n){var e=n.f;if((e&xr)===0){an(n,Qt);var t=ht,r=ti;ht=n,ti=!0;try{(e&ci)!==0?gd(n):au(n),su(n);var i=vu(n);n.teardown=typeof i=="function"?i:null,n.wv=du;var o;Dl&&Kc&&(n.f&vn)!==0&&n.deps}finally{ti=r,ht=t}}}async function pu(){await Promise.resolve(),sd()}function h(n){var e=n.f,t=(e&un)!==0;if(Jr?.add(n),pt!==null&&!jn){var r=ht!==null&&(ht.f&xr)!==0;if(!r&&!Vn?.includes(n)){var i=pt.deps;if((pt.f&ma)!==0)n.rv<Ri&&(n.rv=Ri,tn===null&&i!==null&&i[ln]===n?ln++:tn===null?tn=[n]:(!Xn||!tn.includes(n))&&tn.push(n));else{(pt.deps??=[]).push(n);var o=n.reactions;o===null?n.reactions=[pt]:o.includes(pt)||o.push(pt)}}}else if(t&&n.deps===null&&n.effects===null){var u=n,f=u.parent;f!==null&&(f.f&hn)===0&&(u.f^=hn)}if(Pr){if(Qn.has(n))return Qn.get(n);if(t){u=n;var v=u.v;return((u.f&Qt)===0&&u.reactions!==null||gu(u))&&(v=qa(u)),Qn.set(u,v),v}}else t&&(u=n,Ds(u)&&Hl(u));if((n.f&Sr)!==0)throw n.v;return n.v}function gu(n){if(n.v===Ht)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Qn.has(e)||(e.f&un)!==0&&gu(e))return!0;return!1}function Rr(n){var e=jn;try{return jn=!0,n()}finally{jn=e}}const bd=-7169;function an(n,e){n.f=n.f&bd|e}function kd(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Wn in n)wa(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Wn in t&&wa(t)}}}function wa(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{wa(n[r],e)}catch{}const t=Fa(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Fl(t);for(let i in r){const o=r[i].get;if(o)try{o.call(n)}catch{}}}}}const Id=["touchstart","touchmove"];function Sd(n){return Id.includes(n)}const mu=new Set,ba=new Set;function Ed(n,e,t,r={}){function i(o){if(r.capture||Ei.call(e,o),!o.cancelBubble)return Os(()=>t?.call(this,o))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Va(()=>{e.addEventListener(n,i,r)}):e.addEventListener(n,i,r),i}function ka(n,e,t,r,i){var o={capture:r,passive:i},u=Ed(n,e,t,o);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&nu(()=>{e.removeEventListener(n,u,o)})}function Lt(n){for(var e=0;e<n.length;e++)mu.add(n[e]);for(var t of ba)t(n)}let rl=null;function Ei(n){var e=this,t=e.ownerDocument,r=n.type,i=n.composedPath?.()||[],o=i[0]||n.target;rl=n;var u=0,f=rl===n&&n.__root;if(f){var v=i.indexOf(f);if(v!==-1&&(e===document||e===window)){n.__root=e;return}var p=i.indexOf(e);if(p===-1)return;v<=p&&(u=v)}if(o=i[u]||n.target,o!==e){ga(n,"currentTarget",{configurable:!0,get(){return o||t}});var m=pt,w=ht;Rn(null),er(null);try{for(var I,_=[];o!==null;){var k=o.assignedSlot||o.parentNode||o.host||null;try{var P=o["__"+r];if(P!=null&&(!o.disabled||n.target===o))if(As(P)){var[x,...$]=P;x.apply(o,[n,...$])}else P.call(o,n)}catch(z){I?_.push(z):I=z}if(n.cancelBubble||k===e||k===null)break;o=k}if(I){for(let z of _)queueMicrotask(()=>{throw z});throw I}}finally{n.__root=e,delete n.currentTarget,Rn(m),er(w)}}}function _u(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Oi(n,e){var t=ht;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function ee(n,e){var t=(e&Wc)!==0,r=(e&Vc)!==0,i,o=!n.startsWith("<!>");return()=>{i===void 0&&(i=_u(o?n:"<!>"+n),t||(i=oi(i)));var u=r||Ql?document.importNode(i,!0):i.cloneNode(!0);if(t){var f=oi(u),v=u.lastChild;Oi(f,v)}else Oi(u,u);return u}}function Ad(n,e,t="svg"){var r=!n.startsWith("<!>"),i=`<${t}>${r?n:"<!>"+n}</${t}>`,o;return()=>{if(!o){var u=_u(i),f=oi(u);o=oi(f)}var v=o.cloneNode(!0);return Oi(v,v),v}}function Cd(n,e){return Ad(n,e,"svg")}function ls(n=""){{var e=jr(n+"");return Oi(e,e),e}}function kt(){var n=document.createDocumentFragment(),e=document.createComment(""),t=jr();return n.append(e,t),Oi(e,t),n}function H(n,e){n!==null&&n.before(e)}function Se(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Td(n,e){return xd(n,e)}const Ur=new Map;function xd(n,{target:e,anchor:t,props:r={},events:i,context:o,intro:u=!0}){ud();var f=new Set,v=w=>{for(var I=0;I<w.length;I++){var _=w[I];if(!f.has(_)){f.add(_);var k=Sd(_);e.addEventListener(_,Ei,{passive:k});var P=Ur.get(_);P===void 0?(document.addEventListener(_,Ei,{passive:k}),Ur.set(_,1)):Ur.set(_,P+1)}}};v(Da(mu)),ba.add(v);var p=void 0,m=vd(()=>{var w=t??e.appendChild(jr());return Cr(()=>{if(o){Tt({});var I=Nt;I.c=o}i&&(r.$$events=i),p=n(w,r)||{},o&&xt()}),()=>{for(var I of f){e.removeEventListener(I,Ei);var _=Ur.get(I);--_===0?(document.removeEventListener(I,Ei),Ur.delete(I)):Ur.set(I,_)}ba.delete(v),w!==t&&w.parentNode?.removeChild(w)}});return jd.set(p,m),p}let jd=new WeakMap;function De(n,e,t=!1){var r=n,i=null,o=null,u=Ht,f=t?Ts:0,v=!1;const p=(_,k=!0)=>{v=!0,I(k,_)};var m=null;function w(){m!==null&&(m.lastChild.remove(),r.before(m),m=null);var _=u?i:o,k=u?o:i;_&&Ya(_),k&&Ls(k,()=>{u?o=null:i=null})}const I=(_,k)=>{if(u!==(u=_)){var P=Ga(),x=r;if(P&&(m=document.createDocumentFragment(),m.append(x=jr())),u?i??=k&&Cr(()=>k(x)):o??=k&&Cr(()=>k(x)),P){var $=Rt,z=u?i:o,M=u?o:i;z&&$.skipped_effects.delete(z),M&&$.skipped_effects.add(M),$.add_callback(w)}else w()}};Ms(()=>{v=!1,e(p),v||I(null,null)},f)}function Ia(n,e,t){var r=n,i=Ht,o,u,f=null,v=fi()?Hc:Wl;function p(){o&&Ls(o),f!==null&&(f.lastChild.remove(),r.before(f),f=null),o=u}Ms(()=>{if(v(i,i=e())){var m=r,w=Ga();w&&(f=document.createDocumentFragment(),f.append(m=jr())),u=Cr(()=>t(m)),w?Rt.add_callback(p):p()}})}function Ct(n,e){return e}function Pd(n,e,t){for(var r=n.items,i=[],o=e.length,u=0;u<o;u++)Ka(e[u].e,i,!0);var f=o>0&&i.length===0&&t!==null;if(f){var v=t.parentNode;cd(v),v.append(t),r.clear(),Cn(n,e[0].prev,e[o-1].next)}lu(i,()=>{for(var p=0;p<o;p++){var m=e[p];f||(r.delete(m.k),Cn(n,m.prev,m.next)),Pn(m.e,!f)}})}function et(n,e,t,r,i,o=null){var u=n,f={flags:e,items:new Map,first:null},v=(e&Nl)!==0;if(v){var p=n;u=p.appendChild(jr())}var m=null,w=!1,I=new Map,_=Fi(()=>{var $=t();return As($)?$:$==null?[]:Da($)}),k,P;function x(){Rd(P,k,f,I,u,i,e,r,t),o!==null&&(k.length===0?m?Ya(m):m=Cr(()=>o(u)):m!==null&&Ls(m,()=>{m=null}))}Ms(()=>{P??=ht,k=h(_);var $=k.length;if(!(w&&$===0)){w=$===0;var z,M,U,F;if(Ga()){var C=new Set,j=Rt;for(M=0;M<$;M+=1){U=k[M],F=r(U,M);var ne=f.items.get(F)??I.get(F);ne?(e&(xs|js))!==0&&yu(ne,U,M,e):(z=wu(null,f,null,null,U,F,M,i,e,t,!0),I.set(F,z)),C.add(F)}for(const[le,_e]of f.items)C.has(le)||j.skipped_effects.add(_e.e);j.add_callback(x)}else x();h(_)}})}function Rd(n,e,t,r,i,o,u,f,v){var p=(u&Lc)!==0,m=(u&(xs|js))!==0,w=e.length,I=t.items,_=t.first,k=_,P,x=null,$,z=[],M=[],U,F,C,j;if(p)for(j=0;j<w;j+=1)U=e[j],F=f(U,j),C=I.get(F),C!==void 0&&(C.a?.measure(),($??=new Set).add(C));for(j=0;j<w;j+=1){if(U=e[j],F=f(U,j),C=I.get(F),C===void 0){var ne=r.get(F);if(ne!==void 0){r.delete(F),I.set(F,ne);var le=x?x.next:k;Cn(t,x,ne),Cn(t,ne,le),na(ne,le,i),x=ne}else{var _e=k?k.e.nodes_start:i;x=wu(_e,t,x,x===null?t.first:x.next,U,F,j,o,u,v)}I.set(F,x),z=[],M=[],k=x.next;continue}if(m&&yu(C,U,j,u),(C.e.f&kn)!==0&&(Ya(C.e),p&&(C.a?.unfix(),($??=new Set).delete(C))),C!==k){if(P!==void 0&&P.has(C)){if(z.length<M.length){var he=M[0],ue;x=he.prev;var J=z[0],Y=z[z.length-1];for(ue=0;ue<z.length;ue+=1)na(z[ue],he,i);for(ue=0;ue<M.length;ue+=1)P.delete(M[ue]);Cn(t,J.prev,Y.next),Cn(t,x,J),Cn(t,Y,he),k=he,x=Y,j-=1,z=[],M=[]}else P.delete(C),na(C,k,i),Cn(t,C.prev,C.next),Cn(t,C,x===null?t.first:x.next),Cn(t,x,C),x=C;continue}for(z=[],M=[];k!==null&&k.k!==F;)(k.e.f&kn)===0&&(P??=new Set).add(k),M.push(k),k=k.next;if(k===null)continue;C=k}z.push(C),x=C,k=C.next}if(k!==null||P!==void 0){for(var W=P===void 0?[]:Da(P);k!==null;)(k.e.f&kn)===0&&W.push(k),k=k.next;var Z=W.length;if(Z>0){var L=(u&Nl)!==0&&w===0?i:null;if(p){for(j=0;j<Z;j+=1)W[j].a?.measure();for(j=0;j<Z;j+=1)W[j].a?.fix()}Pd(t,W,L)}}p&&Va(()=>{if($!==void 0)for(C of $)C.a?.apply()}),n.first=t.first&&t.first.e,n.last=x&&x.e;for(var V of r.values())Pn(V.e);r.clear()}function yu(n,e,t,r){(r&xs)!==0&&ai(n.v,e),(r&js)!==0?ai(n.i,t):n.i=t}function wu(n,e,t,r,i,o,u,f,v,p,m){var w=(v&xs)!==0,I=(v&Dc)===0,_=w?I?od(i,!1,!1):si(i):i,k=(v&js)===0?u:si(u),P={i:k,v:_,k:o,a:null,e:null,prev:t,next:r};try{if(n===null){var x=document.createDocumentFragment();x.append(n=jr())}return P.e=Cr(()=>f(n,_,k,p),zc),P.e.prev=t&&t.e,P.e.next=r&&r.e,t===null?m||(e.first=P):(t.next=P,t.e.next=P.e),r!==null&&(r.prev=P,r.e.prev=P.e),P}finally{}}function na(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,i=e?e.e.nodes_start:t,o=n.e.nodes_start;o!==null&&o!==r;){var u=Rs(o);i.before(o),o=u}}function Cn(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Od(n,e,t,r,i){var o=e.$$slots?.[t],u=!1;o===!0&&(o=e.children,u=!0),o===void 0||o(n,u?()=>r:r)}function bu(n,e,...t){var r=n,i=_c,o;Ms(()=>{i!==(i=e())&&(o&&(Pn(o),o=null),o=Cr(()=>i(r,...t)))},Ts)}const il=[...` 	
\r\f \v\uFEFF`];function Md(n,e,t){var r=n==null?"":""+n;if(e&&(r=r?r+" "+e:e),t){for(var i in t)if(t[i])r=r?r+" "+i:i;else if(r.length)for(var o=i.length,u=0;(u=r.indexOf(i,u))>=0;){var f=u+o;(u===0||il.includes(r[u-1]))&&(f===r.length||il.includes(r[f]))?r=(u===0?"":r.substring(0,u))+r.substring(f+1):u=f}}return r===""?null:r}function Ld(n,e){return n==null?null:String(n)}function Ut(n,e,t,r,i,o){var u=n.__className;if(u!==t||u===void 0){var f=Md(t,r,o);f==null?n.removeAttribute("class"):n.className=f,n.__className=t}else if(o&&i!==o)for(var v in o){var p=!!o[v];(i==null||p!==!!i[v])&&n.classList.toggle(v,p)}return o}function sn(n,e,t,r){var i=n.__style;if(i!==e){var o=Ld(e);o==null?n.removeAttribute("style"):n.style.cssText=o,n.__style=e}return r}function Yn(n,e,t=!1){if(n.multiple){if(e==null)return;if(!As(e))return Gc();for(var r of n.options)r.selected=e.includes(Ci(r));return}for(r of n.options){var i=Ci(r);if(ld(i,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function yr(n){var e=new MutationObserver(()=>{Yn(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),nu(()=>{e.disconnect()})}function Zr(n,e,t=e){var r=!0;za(n,"change",i=>{var o=i?"[selected]":":checked",u;if(n.multiple)u=[].map.call(n.querySelectorAll(o),Ci);else{var f=n.querySelector(o)??n.querySelector("option:not([disabled])");u=f&&Ci(f)}t(u)}),iu(()=>{var i=e();if(Yn(n,i,r),r&&i===void 0){var o=n.querySelector(":checked");o!==null&&(i=Ci(o),t(i))}n.__value=i,r=!1}),yr(n)}function Ci(n){return"__value"in n?n.__value:n.value}const Dd=Symbol("is custom element"),Fd=Symbol("is html");function ra(n,e){var t=Ja(n);t.value===(t.value=e??void 0)||n.value===e&&(e!==0||n.nodeName!=="PROGRESS")||(n.value=e??"")}function $d(n,e){var t=Ja(n);t.checked!==(t.checked=e??void 0)&&(n.checked=e)}function Be(n,e,t,r){var i=Ja(n);i[e]!==(i[e]=t)&&(e==="loading"&&(n[Ic]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Ud(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function Ja(n){return n.__attributes??={[Dd]:n.nodeName.includes("-"),[Fd]:n.namespaceURI===qc}}var sl=new Map;function Ud(n){var e=n.getAttribute("is")||n.nodeName,t=sl.get(e);if(t)return t;sl.set(e,t=[]);for(var r,i=n,o=Element.prototype;o!==i;){r=Fl(i);for(var u in r)r[u].set&&t.push(u);i=Fa(i)}return t}function Bn(n,e,t=e){var r=new WeakSet;za(n,"input",async i=>{var o=i?n.defaultValue:n.value;if(o=ia(n)?sa(o):o,t(o),Rt!==null&&r.add(Rt),await pu(),o!==(o=e())){var u=n.selectionStart,f=n.selectionEnd;n.value=o??"",f!==null&&(n.selectionStart=u,n.selectionEnd=Math.min(f,n.value.length))}}),Rr(e)==null&&n.value&&(t(ia(n)?sa(n.value):n.value),Rt!==null&&r.add(Rt)),Ha(()=>{var i=e();if(n===document.activeElement){var o=ps??Rt;if(r.has(o))return}ia(n)&&i===sa(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}function al(n,e,t=e){za(n,"change",r=>{var i=r?n.defaultChecked:n.checked;t(i)}),Rr(e)==null&&t(n.checked),Ha(()=>{var r=e();n.checked=!!r})}function ia(n){var e=n.type;return e==="number"||e==="range"}function sa(n){return n===""?null:+n}function ol(n,e){return n===e||n?.[Wn]===e}function Sa(n={},e,t,r){return iu(()=>{var i,o;return Ha(()=>{i=o,o=[],Rr(()=>{n!==t(...o)&&(e(n,...o),i&&ol(t(...i),n)&&e(null,...i))})}),()=>{Va(()=>{o&&ol(t(...o),n)&&e(null,...o)})}}),n}function rr(n=!1){const e=Nt,t=e.l.u;if(!t)return;let r=()=>kd(e.s);if(n){let i=0,o={};const u=Di(()=>{let f=!1;const v=e.s;for(const p in v)v[p]!==o[p]&&(o[p]=v[p],f=!0);return f&&i++,i});r=()=>h(u)}t.b.length&&hd(()=>{ll(e,r),_s(t.b)}),li(()=>{const i=Rr(()=>t.m.map(yc));return()=>{for(const o of i)typeof o=="function"&&o()}}),t.a.length&&li(()=>{ll(e,r),_s(t.a)})}function ll(n,e){if(n.l.s)for(const t of n.l.s)h(t);e()}function ir(n){var e=si(0);return function(){return arguments.length===1?(ie(e,h(e)+1),arguments[0]):(h(e),n())}}let us=!1;function Nd(n){var e=us;try{return us=!1,[n(),us]}finally{us=e}}function Ge(n,e,t,r){var i=!di||(t&$c)!==0,o=(t&Nc)!==0,u=(t&Bc)!==0,f=r,v=!0,p=()=>(v&&(v=!1,f=u?Rr(r):r),f),m;if(o){var w=Wn in n||kc in n;m=ei(n,e)?.set??(w&&e in n?M=>n[e]=M:void 0)}var I,_=!1;o?[I,_]=Nd(()=>n[e]):I=n[e],I===void 0&&r!==void 0&&(I=p(),m&&(i&&Pc(),m(I)));var k;if(i?k=()=>{var M=n[e];return M===void 0?p():(v=!0,M)}:k=()=>{var M=n[e];return M!==void 0&&(f=void 0),M===void 0?f:M},i&&(t&Uc)===0)return k;if(m){var P=n.$$legacy;return(function(M,U){return arguments.length>0?((!i||!U||P||_)&&m(U?k():M),M):k()})}var x=!1,$=((t&Fc)!==0?Di:Fi)(()=>(x=!1,k()));o&&h($);var z=ht;return(function(M,U){if(arguments.length>0){const F=U?h($):i&&o?ft(M):M;return ie($,F),x=!0,f!==void 0&&(f=F),M}return Pr&&x||(z.f&xr)!==0?$.v:h($)})}function In(n){Nt===null&&Ec(),di&&Nt.l!==null?Bd(Nt).m.push(n):li(()=>{const e=Rr(n);if(typeof e=="function")return e})}function Bd(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const Wd="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Wd);Yc();const B=ft({showEditor:!1,showItems:!1,editingOptionIndex:null,editingItemIndex:null,editingChapterId:null,selectedChapterId:null,selectedDialogueId:null,selectedBucket:null,availableBuckets:[],data:{meta:{version:"3.1",title:"Новая история"},dialogues:[],chapters:[],items:[],miniGames:[]},storedFiles:[],storiesList:[],currentFileName:"dracula_story.json",statusMessage:{type:"",text:""}}),Kt={get currentDialogue(){return B.data?.dialogues.find(n=>n.id===B.selectedDialogueId)},get currentChapter(){return B.data?.chapters?.find(n=>n.id===B.selectedChapterId)},get currentEditingChapter(){return B.data?.chapters?.find(n=>n.id===B.editingChapterId)},get currentEditingOption(){return Kt.currentDialogue&&B.editingOptionIndex!==null?Kt.currentDialogue.options?.[B.editingOptionIndex]:void 0},get chapterDialogues(){return!B.data?.dialogues||!B.selectedChapterId?[]:B.data.dialogues.filter(n=>n.chapterId===B.selectedChapterId)},get imageResources(){return B.storedFiles.filter(n=>n.name.match(/\.(png|jpg|jpeg|webp|gif|svg)$/i))},get riveResources(){return B.storedFiles.filter(n=>n.name.endsWith(".riv"))},get availableItems(){return B.data?.items||[]},get backlinks(){return!B.data||!B.selectedDialogueId?[]:B.data.dialogues.filter(n=>n.nextDialogueId===B.selectedDialogueId?!0:n.options?n.options.some(e=>e.nextDialogueId===B.selectedDialogueId):!1)},get hasUnsavedChanges(){return!1}},_t={toggleEditor(){B.showEditor=!B.showEditor},toggleItemsPanel(){B.showItems=!B.showItems},setStatus(n,e){B.statusMessage={type:n,text:e}},clearStatus(){B.statusMessage={type:"",text:""}},selectBucket(n){B.selectedBucket=n,B.data={meta:{version:"3.1",title:"Новая история"},dialogues:[],chapters:[],items:[],miniGames:[]},B.storedFiles=[],B.storiesList=[],B.selectedChapterId=null,B.selectedDialogueId=null},updateBucketsList(n){B.availableBuckets=n},selectChapter(n){B.selectedChapterId=n,B.selectedDialogueId=null},selectDialogue(n){B.selectedDialogueId=n},selectOption(n){B.editingOptionIndex=n},selectItem(n){B.editingItemIndex=n},updateStoryData(n){B.data=n},updateStoredFiles(n){B.storedFiles=n},updateStoriesList(n){B.storiesList=n},setCurrentFileName(n){B.currentFileName=n},addDialogue(n){B.data.dialogues=[...B.data.dialogues,n]},updateDialogue(n,e){B.data.dialogues=B.data.dialogues.map(t=>t.id===n?{...t,...e}:t)},deleteDialogue(n){B.data.dialogues=B.data.dialogues.filter(e=>e.id!==n),B.selectedDialogueId===n&&(B.selectedDialogueId=null)},addChapter(n){B.data.chapters=[...B.data.chapters||[],n]},updateChapter(n,e){B.data.chapters&&(B.data.chapters=B.data.chapters.map(t=>t.id===n?{...t,...e}:t))},selectEditingChapter(n){B.editingChapterId=n},deleteChapter(n){B.data.chapters&&(B.data.chapters=B.data.chapters.filter(e=>e.id!==n),B.selectedChapterId===n&&(B.selectedChapterId=null,B.selectedDialogueId=null))},addItem(n){B.data.items=[...B.data.items||[],n]},updateItem(n,e){B.data.items&&(B.data.items=B.data.items.map(t=>t.id===n?{...t,...e}:t))},deleteItem(n){B.data.items&&(B.data.items=B.data.items.filter(e=>e.id!==n))},reset(){B.showEditor=!1,B.showItems=!1,B.editingOptionIndex=null,B.editingItemIndex=null,B.selectedChapterId=null,B.selectedDialogueId=null,B.statusMessage={type:"",text:""}}},Vd="modulepreload",qd=function(n,e){return new URL(n,e).href},ul={},$i=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let p=function(m){return Promise.all(m.map(w=>Promise.resolve(w).then(I=>({status:"fulfilled",value:I}),I=>({status:"rejected",reason:I}))))};const u=document.getElementsByTagName("link"),f=document.querySelector("meta[property=csp-nonce]"),v=f?.nonce||f?.getAttribute("nonce");i=p(t.map(m=>{if(m=qd(m,r),m in ul)return;ul[m]=!0;const w=m.endsWith(".css"),I=w?'[rel="stylesheet"]':"";if(!!r)for(let P=u.length-1;P>=0;P--){const x=u[P];if(x.href===m&&(!w||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${I}`))return;const k=document.createElement("link");if(k.rel=w?"stylesheet":Vd,w||(k.as="script"),k.crossOrigin="",k.href=m,v&&k.setAttribute("nonce",v),document.head.appendChild(k),w)return new Promise((P,x)=>{k.addEventListener("load",P),k.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return i.then(u=>{for(const f of u||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})},Gd=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>hi);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Xa extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class zd extends Xa{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class cl extends Xa{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class dl extends Xa{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ea;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Ea||(Ea={}));var Hd=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};class Kd{constructor(e,{headers:t={},customFetch:r,region:i=Ea.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Gd(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Hd(this,void 0,void 0,function*(){try{const{headers:i,method:o,body:u}=t;let f={},{region:v}=t;v||(v=this.region);const p=new URL(`${this.url}/${e}`);v&&v!=="any"&&(f["x-region"]=v,p.searchParams.set("forceFunctionRegion",v));let m;u&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(f["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(f["Content-Type"]="application/json",m=JSON.stringify(u)));const w=yield this.fetch(p.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),i),body:m}).catch(P=>{throw new zd(P)}),I=w.headers.get("x-relay-error");if(I&&I==="true")throw new cl(w);if(!w.ok)throw new dl(w);let _=((r=w.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),k;return _==="application/json"?k=yield w.json():_==="application/octet-stream"?k=yield w.blob():_==="text/event-stream"?k=w:_==="multipart/form-data"?k=yield w.formData():k=yield w.text(),{data:k,error:null,response:w}}catch(i){return{data:null,error:i,response:i instanceof dl||i instanceof cl?i.context:void 0}}})}}function Yd(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Jd(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var zt={},Nr={},Br={},Wr={},Vr={},qr={},Xd=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},ui=Xd();const Qd=ui.fetch,ku=ui.fetch.bind(ui),Iu=ui.Headers,Zd=ui.Request,ef=ui.Response,hi=Object.freeze(Object.defineProperty({__proto__:null,Headers:Iu,Request:Zd,Response:ef,default:ku,fetch:Qd},Symbol.toStringTag,{value:"Module"})),tf=Jd(hi);var cs={},fl;function Su(){if(fl)return cs;fl=1,Object.defineProperty(cs,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return cs.default=n,cs}var hl;function Eu(){if(hl)return qr;hl=1;var n=qr&&qr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(qr,"__esModule",{value:!0});const e=n(tf),t=n(Su());class r{constructor(o){var u,f;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(u=o.shouldThrowOnError)!==null&&u!==void 0?u:!1,this.signal=o.signal,this.isMaybeSingle=(f=o.isMaybeSingle)!==null&&f!==void 0?f:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,u){return this.headers=new Headers(this.headers),this.headers.set(o,u),this}then(o,u){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let v=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var m,w,I,_;let k=null,P=null,x=null,$=p.status,z=p.statusText;if(p.ok){if(this.method!=="HEAD"){const C=await p.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((m=this.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?P=C:P=JSON.parse(C))}const U=(w=this.headers.get("Prefer"))===null||w===void 0?void 0:w.match(/count=(exact|planned|estimated)/),F=(I=p.headers.get("content-range"))===null||I===void 0?void 0:I.split("/");U&&F&&F.length>1&&(x=parseInt(F[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(P)&&(P.length>1?(k={code:"PGRST116",details:`Results contain ${P.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},P=null,x=null,$=406,z="Not Acceptable"):P.length===1?P=P[0]:P=null)}else{const U=await p.text();try{k=JSON.parse(U),Array.isArray(k)&&p.status===404&&(P=[],k=null,$=200,z="OK")}catch{p.status===404&&U===""?($=204,z="No Content"):k={message:U}}if(k&&this.isMaybeSingle&&(!((_=k?.details)===null||_===void 0)&&_.includes("0 rows"))&&(k=null,$=200,z="OK"),k&&this.shouldThrowOnError)throw new t.default(k)}return{error:k,data:P,count:x,status:$,statusText:z}});return this.shouldThrowOnError||(v=v.catch(p=>{var m,w,I;return{error:{message:`${(m=p?.name)!==null&&m!==void 0?m:"FetchError"}: ${p?.message}`,details:`${(w=p?.stack)!==null&&w!==void 0?w:""}`,hint:"",code:`${(I=p?.code)!==null&&I!==void 0?I:""}`},data:null,count:null,status:0,statusText:""}})),v.then(o,u)}returns(){return this}overrideTypes(){return this}}return qr.default=r,qr}var vl;function Au(){if(vl)return Vr;vl=1;var n=Vr&&Vr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vr,"__esModule",{value:!0});const e=n(Eu());class t extends e.default{select(i){let o=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!o?"":(f==='"'&&(o=!o),f)).join("");return this.url.searchParams.set("select",u),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:o=!0,nullsFirst:u,foreignTable:f,referencedTable:v=f}={}){const p=v?`${v}.order`:"order",m=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${m?`${m},`:""}${i}.${o?"asc":"desc"}${u===void 0?"":u?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:o,referencedTable:u=o}={}){const f=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(f,`${i}`),this}range(i,o,{foreignTable:u,referencedTable:f=u}={}){const v=typeof f>"u"?"offset":`${f}.offset`,p=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(v,`${i}`),this.url.searchParams.set(p,`${o-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:o=!1,settings:u=!1,buffers:f=!1,wal:v=!1,format:p="text"}={}){var m;const w=[i?"analyze":null,o?"verbose":null,u?"settings":null,f?"buffers":null,v?"wal":null].filter(Boolean).join("|"),I=(m=this.headers.get("Accept"))!==null&&m!==void 0?m:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${p}; for="${I}"; options=${w};`),p==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Vr.default=t,Vr}var pl;function Qa(){if(pl)return Wr;pl=1;var n=Wr&&Wr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Wr,"__esModule",{value:!0});const e=n(Au());class t extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}in(i,o){const u=Array.from(new Set(o)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(i,`in.(${u})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:u,type:f}={}){let v="";f==="plain"?v="pl":f==="phrase"?v="ph":f==="websearch"&&(v="w");const p=u===void 0?"":`(${u})`;return this.url.searchParams.append(i,`${v}fts${p}.${o}`),this}match(i){return Object.entries(i).forEach(([o,u])=>{this.url.searchParams.append(o,`eq.${u}`)}),this}not(i,o,u){return this.url.searchParams.append(i,`not.${o}.${u}`),this}or(i,{foreignTable:o,referencedTable:u=o}={}){const f=u?`${u}.or`:"or";return this.url.searchParams.append(f,`(${i})`),this}filter(i,o,u){return this.url.searchParams.append(i,`${o}.${u}`),this}}return Wr.default=t,Wr}var gl;function Cu(){if(gl)return Br;gl=1;var n=Br&&Br.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Br,"__esModule",{value:!0});const e=n(Qa());class t{constructor(i,{headers:o={},schema:u,fetch:f}){this.url=i,this.headers=new Headers(o),this.schema=u,this.fetch=f}select(i,{head:o=!1,count:u}={}){const f=o?"HEAD":"GET";let v=!1;const p=(i??"*").split("").map(m=>/\s/.test(m)&&!v?"":(m==='"'&&(v=!v),m)).join("");return this.url.searchParams.set("select",p),u&&this.headers.append("Prefer",`count=${u}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:o,defaultToNull:u=!0}={}){var f;const v="POST";if(o&&this.headers.append("Prefer",`count=${o}`),u||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const p=i.reduce((m,w)=>m.concat(Object.keys(w)),[]);if(p.length>0){const m=[...new Set(p)].map(w=>`"${w}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(i,{onConflict:o,ignoreDuplicates:u=!1,count:f,defaultToNull:v=!0}={}){var p;const m="POST";if(this.headers.append("Prefer",`resolution=${u?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),f&&this.headers.append("Prefer",`count=${f}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const w=i.reduce((I,_)=>I.concat(Object.keys(_)),[]);if(w.length>0){const I=[...new Set(w)].map(_=>`"${_}"`);this.url.searchParams.set("columns",I.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}update(i,{count:o}={}){var u;const f="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}delete({count:i}={}){var o;const u="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Br.default=t,Br}var ml;function nf(){if(ml)return Nr;ml=1;var n=Nr&&Nr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Nr,"__esModule",{value:!0});const e=n(Cu()),t=n(Qa());class r{constructor(o,{headers:u={},schema:f,fetch:v}={}){this.url=o,this.headers=new Headers(u),this.schemaName=f,this.fetch=v}from(o){const u=new URL(`${this.url}/${o}`);return new e.default(u,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new r(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,u={},{head:f=!1,get:v=!1,count:p}={}){var m;let w;const I=new URL(`${this.url}/rpc/${o}`);let _;f||v?(w=f?"HEAD":"GET",Object.entries(u).filter(([P,x])=>x!==void 0).map(([P,x])=>[P,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([P,x])=>{I.searchParams.append(P,x)})):(w="POST",_=u);const k=new Headers(this.headers);return p&&k.set("Prefer",`count=${p}`),new t.default({method:w,url:I,headers:k,schema:this.schemaName,body:_,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}}return Nr.default=r,Nr}var _l;function rf(){if(_l)return zt;_l=1;var n=zt&&zt.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.PostgrestError=zt.PostgrestBuilder=zt.PostgrestTransformBuilder=zt.PostgrestFilterBuilder=zt.PostgrestQueryBuilder=zt.PostgrestClient=void 0;const e=n(nf());zt.PostgrestClient=e.default;const t=n(Cu());zt.PostgrestQueryBuilder=t.default;const r=n(Qa());zt.PostgrestFilterBuilder=r.default;const i=n(Au());zt.PostgrestTransformBuilder=i.default;const o=n(Eu());zt.PostgrestBuilder=o.default;const u=n(Su());return zt.PostgrestError=u.default,zt.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:o.default,PostgrestError:u.default},zt}var sf=rf();const af=Yd(sf),{PostgrestClient:of,PostgrestQueryBuilder:fm,PostgrestFilterBuilder:hm,PostgrestTransformBuilder:vm,PostgrestBuilder:pm,PostgrestError:gm}=af;class lf{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const uf="2.15.1",cf=`realtime-js/${uf}`,df="1.0.0",Aa=1e4,ff=1e3,hf=100;var Ti;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ti||(Ti={}));var Wt;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Wt||(Wt={}));var bn;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(bn||(bn={}));var Ca;(function(n){n.websocket="websocket"})(Ca||(Ca={}));var kr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(kr||(kr={}));class vf{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const i=t.getUint8(1),o=t.getUint8(2);let u=this.HEADER_LENGTH+2;const f=r.decode(e.slice(u,u+i));u=u+i;const v=r.decode(e.slice(u,u+o));u=u+o;const p=JSON.parse(r.decode(e.slice(u,e.byteLength)));return{ref:null,topic:f,event:v,payload:p}}}class Tu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var At;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(At||(At={}));const yl=(n,e,t={})=>{var r;const i=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,u)=>(o[u]=pf(u,n,e,i),o),{})},pf=(n,e,t,r)=>{const i=e.find(f=>f.name===n),o=i?.type,u=t[n];return o&&!r.includes(o)?xu(o,u):Ta(u)},xu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return yf(e,t)}switch(n){case At.bool:return gf(e);case At.float4:case At.float8:case At.int2:case At.int4:case At.int8:case At.numeric:case At.oid:return mf(e);case At.json:case At.jsonb:return _f(e);case At.timestamp:return wf(e);case At.abstime:case At.date:case At.daterange:case At.int4range:case At.int8range:case At.money:case At.reltime:case At.text:case At.time:case At.timestamptz:case At.timetz:case At.tsrange:case At.tstzrange:return Ta(e);default:return Ta(e)}},Ta=n=>n,gf=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},mf=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},_f=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},yf=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let o;const u=n.slice(1,t);try{o=JSON.parse("["+u+"]")}catch{o=u?u.split(","):[]}return o.map(f=>xu(e,f))}return n},wf=n=>typeof n=="string"?n.replace(" ","T"):n,ju=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class aa{constructor(e,t,r={},i=Aa){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var wl;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(wl||(wl={}));class xi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:o,onLeave:u,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xi.syncState(this.state,i,o,u),this.pendingDiffs.forEach(v=>{this.state=xi.syncDiff(this.state,v,o,u)}),this.pendingDiffs=[],f()}),this.channel._on(r.diff,{},i=>{const{onJoin:o,onLeave:u,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=xi.syncDiff(this.state,i,o,u),f())}),this.onJoin((i,o,u)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:u})}),this.onLeave((i,o,u)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){const o=this.cloneDeep(e),u=this.transformState(t),f={},v={};return this.map(o,(p,m)=>{u[p]||(v[p]=m)}),this.map(u,(p,m)=>{const w=o[p];if(w){const I=m.map(x=>x.presence_ref),_=w.map(x=>x.presence_ref),k=m.filter(x=>_.indexOf(x.presence_ref)<0),P=w.filter(x=>I.indexOf(x.presence_ref)<0);k.length>0&&(f[p]=k),P.length>0&&(v[p]=P)}else f[p]=m}),this.syncDiff(o,{joins:f,leaves:v},r,i)}static syncDiff(e,t,r,i){const{joins:o,leaves:u}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(o,(f,v)=>{var p;const m=(p=e[f])!==null&&p!==void 0?p:[];if(e[f]=this.cloneDeep(v),m.length>0){const w=e[f].map(_=>_.presence_ref),I=m.filter(_=>w.indexOf(_.presence_ref)<0);e[f].unshift(...I)}r(f,m,v)}),this.map(u,(f,v)=>{let p=e[f];if(!p)return;const m=v.map(w=>w.presence_ref);p=p.filter(w=>m.indexOf(w.presence_ref)<0),e[f]=p,i(f,p,v),p.length===0&&delete e[f]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const i=e[r];return"metas"in i?t[r]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var bl;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(bl||(bl={}));var ji;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(ji||(ji={}));var Nn;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Nn||(Nn={}));class Za{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Wt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new aa(this,bn.join,this.params,this.timeout),this.rejoinTimer=new Tu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Wt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Wt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Wt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(bn.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new xi(this),this.broadcastEndpointURL=ju(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Wt.closed){const{config:{broadcast:o,presence:u,private:f}}=this.params,v=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(I=>I.filter))!==null&&i!==void 0?i:[],p=!!this.bindings[ji.PRESENCE]&&this.bindings[ji.PRESENCE].length>0,m={},w={broadcast:o,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:v,private:f};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(I=>e?.(Nn.CHANNEL_ERROR,I)),this._onClose(()=>e?.(Nn.CLOSED)),this.updateJoinPayload(Object.assign({config:w},m)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:I})=>{var _;if(this.socket.setAuth(),I===void 0){e?.(Nn.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,P=(_=k?.length)!==null&&_!==void 0?_:0,x=[];for(let $=0;$<P;$++){const z=k[$],{filter:{event:M,schema:U,table:F,filter:C}}=z,j=I&&I[$];if(j&&j.event===M&&j.schema===U&&j.table===F&&j.filter===C)x.push(Object.assign(Object.assign({},z),{id:j.id}));else{this.unsubscribe(),this.state=Wt.errored,e?.(Nn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(Nn.SUBSCRIBED);return}}).receive("error",I=>{this.state=Wt.errored,e?.(Nn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(I).join(", ")||"error")))}).receive("timeout",()=>{e?.(Nn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Wt.joined&&e===ji.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:u}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:u,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=p.body)===null||i===void 0?void 0:i.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var u,f,v;const p=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(f=(u=this.params)===null||u===void 0?void 0:u.config)===null||f===void 0?void 0:f.broadcast)===null||v===void 0)&&v.ack)&&o("ok"),p.receive("ok",()=>o("ok")),p.receive("error",()=>o("error")),p.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Wt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(bn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new aa(this,bn.leave,{},e),r.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Wt.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const i=new AbortController,o=setTimeout(()=>i.abort(),r),u=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(o),u}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new aa(this,e,t,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>hf){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,o;const u=e.toLocaleLowerCase(),{close:f,error:v,leave:p,join:m}=bn;if(r&&[f,v,p,m].indexOf(u)>=0&&r!==this._joinRef())return;let I=this._onMessage(u,t,r);if(t&&!I)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(_=>{var k,P,x;return((k=_.filter)===null||k===void 0?void 0:k.event)==="*"||((x=(P=_.filter)===null||P===void 0?void 0:P.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===u}).map(_=>_.callback(I,r)):(o=this.bindings[u])===null||o===void 0||o.filter(_=>{var k,P,x,$,z,M;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in _){const U=_.id,F=(k=_.filter)===null||k===void 0?void 0:k.event;return U&&((P=t.ids)===null||P===void 0?void 0:P.includes(U))&&(F==="*"||F?.toLocaleLowerCase()===((x=t.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const U=(z=($=_?.filter)===null||$===void 0?void 0:$.event)===null||z===void 0?void 0:z.toLocaleLowerCase();return U==="*"||U===((M=t?.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===u}).map(_=>{if(typeof I=="object"&&"ids"in I){const k=I.data,{schema:P,table:x,commit_timestamp:$,type:z,errors:M}=k;I=Object.assign(Object.assign({},{schema:P,table:x,commit_timestamp:$,eventType:z,new:{},old:{},errors:M}),this._getPayloadRecords(k))}_.callback(I,r)})}_isClosed(){return this.state===Wt.closed}_isJoined(){return this.state===Wt.joined}_isJoining(){return this.state===Wt.joining}_isLeaving(){return this.state===Wt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const i=e.toLocaleLowerCase(),o={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&Za.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(bn.close,{},e)}_onError(e){this._on(bn.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Wt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=yl(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=yl(e.columns,e.old_record)),t}}const kl=()=>{},ds={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},bf=[1e3,2e3,5e3,1e4],kf=1e4,If=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Sf{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Aa,this.transport=null,this.heartbeatIntervalMs=ds.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=kl,this.ref=0,this.reconnectTimer=null,this.logger=kl,this.conn=null,this.sendBuffer=[],this.serializer=new vf,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...u)=>$i(async()=>{const{default:f}=await Promise.resolve().then(()=>hi);return{default:f}},void 0,import.meta.url).then(({default:f})=>f(...u)).catch(f=>{throw new Error(`Failed to load @supabase/node-fetch: ${f.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...u)=>o(...u)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ca.websocket}`,this.httpEndpoint=ju(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=lf.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:df}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ti.connecting:return kr.Connecting;case Ti.open:return kr.Open;case Ti.closing:return kr.Closing;default:return kr.Closed}}isConnected(){return this.connectionState()===kr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(o=>o.topic===r);if(i)return i;{const o=new Za(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:r,payload:i,ref:o}=e,u=()=>{this.encode(e,f=>{var v;(v=this.conn)===null||v===void 0||v.send(f)})};this.log("push",`${t} ${r} (${o})`,i),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(ff,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},ds.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:o,ref:u}=t,f=u?`(${u})`:"",v=o.status||"";this.log("receive",`${v} ${r} ${i} ${f}`.trim(),o),this.channels.filter(p=>p._isMember(r)).forEach(p=>p._trigger(i,o,u)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(bn.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([If],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const i={access_token:t,version:cf};t&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(bn.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Tu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ds.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,i,o,u,f,v,p;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:Aa,this.heartbeatIntervalMs=(i=e?.heartbeatIntervalMs)!==null&&i!==void 0?i:ds.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(u=e?.accessToken)!==null&&u!==void 0?u:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(m=>bf[m-1]||kf),this.encode=(v=e?.encode)!==null&&v!==void 0?v:((m,w)=>w(JSON.stringify(m))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class eo extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Vt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Ef extends eo{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class xa extends eo{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Af=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};const Pu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>hi);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Cf=()=>Af(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $i(()=>Promise.resolve().then(()=>hi),void 0,import.meta.url)).Response:Response}),ja=n=>{if(Array.isArray(n))return n.map(t=>ja(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const i=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=ja(r)}),e},Tf=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Or=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};const oa=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),xf=(n,e,t)=>Or(void 0,void 0,void 0,function*(){const r=yield Cf();n instanceof r&&!t?.noResolveJson?n.json().then(i=>{const o=n.status||500,u=i?.statusCode||o+"";e(new Ef(oa(i),o,u))}).catch(i=>{e(new xa(oa(i),i))}):e(new xa(oa(n),n))}),jf=(n,e,t,r)=>{const i={method:n,headers:e?.headers||{}};return n==="GET"||!r?i:(Tf(r)?(i.headers=Object.assign({"Content-Type":"application/json"},e?.headers),i.body=JSON.stringify(r)):i.body=r,e?.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),t))};function Ui(n,e,t,r,i,o){return Or(this,void 0,void 0,function*(){return new Promise((u,f)=>{n(t,jf(e,r,i,o)).then(v=>{if(!v.ok)throw v;return r?.noResolveJson?v:v.json()}).then(v=>u(v)).catch(v=>xf(v,f,r))})})}function Is(n,e,t,r){return Or(this,void 0,void 0,function*(){return Ui(n,"GET",e,t,r)})}function Tn(n,e,t,r,i){return Or(this,void 0,void 0,function*(){return Ui(n,"POST",e,r,i,t)})}function Pa(n,e,t,r,i){return Or(this,void 0,void 0,function*(){return Ui(n,"PUT",e,r,i,t)})}function Pf(n,e,t,r){return Or(this,void 0,void 0,function*(){return Ui(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Ru(n,e,t,r,i){return Or(this,void 0,void 0,function*(){return Ui(n,"DELETE",e,r,i,t)})}var en=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};const Rf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Il={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Of{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Pu(i)}uploadOrUpdate(e,t,r,i){return en(this,void 0,void 0,function*(){try{let o;const u=Object.assign(Object.assign({},Il),i);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(u.upsert)});const v=u.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",u.cacheControl),v&&o.append("metadata",this.encodeMetadata(v)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",u.cacheControl),v&&o.append("metadata",this.encodeMetadata(v))):(o=r,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType,v&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),i?.headers&&(f=Object.assign(Object.assign({},f),i.headers));const p=this._removeEmptyFolders(t),m=this._getFinalPath(p),w=yield(e=="PUT"?Pa:Tn)(this.fetch,`${this.url}/object/${m}`,o,Object.assign({headers:f},u?.duplex?{duplex:u.duplex}:{}));return{data:{path:p,id:w.Id,fullPath:w.Key},error:null}}catch(o){if(Vt(o))return{data:null,error:o};throw o}})}upload(e,t,r){return en(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return en(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),u=this._getFinalPath(o),f=new URL(this.url+`/object/upload/sign/${u}`);f.searchParams.set("token",t);try{let v;const p=Object.assign({upsert:Il.upsert},i),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&r instanceof Blob?(v=new FormData,v.append("cacheControl",p.cacheControl),v.append("",r)):typeof FormData<"u"&&r instanceof FormData?(v=r,v.append("cacheControl",p.cacheControl)):(v=r,m["cache-control"]=`max-age=${p.cacheControl}`,m["content-type"]=p.contentType);const w=yield Pa(this.fetch,f.toString(),v,{headers:m});return{data:{path:o,fullPath:w.Key},error:null}}catch(v){if(Vt(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return en(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);t?.upsert&&(i["x-upsert"]="true");const o=yield Tn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),u=new URL(this.url+o.url),f=u.searchParams.get("token");if(!f)throw new eo("No token returned by API");return{data:{signedUrl:u.toString(),path:e,token:f},error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}update(e,t,r){return en(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return en(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(Vt(i))return{data:null,error:i};throw i}})}copy(e,t,r){return en(this,void 0,void 0,function*(){try{return{data:{path:(yield Tn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(Vt(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,r){return en(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield Tn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const u=r?.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${u}`)},{data:o,error:null}}catch(i){if(Vt(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,r){return en(this,void 0,void 0,function*(){try{const i=yield Tn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(u=>Object.assign(Object.assign({},u),{signedUrl:u.signedURL?encodeURI(`${this.url}${u.signedURL}${o}`):null})),error:null}}catch(i){if(Vt(i))return{data:null,error:i};throw i}})}download(e,t){return en(this,void 0,void 0,function*(){const i=typeof t?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(t?.transform||{}),u=o?`?${o}`:"";try{const f=this._getFinalPath(e);return{data:yield(yield Is(this.fetch,`${this.url}/${i}/${f}${u}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(Vt(f))return{data:null,error:f};throw f}})}info(e){return en(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Is(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ja(r),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}exists(e){return en(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Pf(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Vt(r)&&r instanceof xa){const i=r.originalError;if([400,404].includes(i?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),i=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&i.push(o);const f=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&i.push(v);let p=i.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${r}${p}`)}}}remove(e){return en(this,void 0,void 0,function*(){try{return{data:yield Ru(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Vt(t))return{data:null,error:t};throw t}})}list(e,t,r){return en(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Rf),t),{prefix:e||""});return{data:yield Tn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(Vt(i))return{data:null,error:i};throw i}})}listV2(e,t){return en(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Tn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Mf="2.11.0",Lf={"X-Client-Info":`storage-js/${Mf}`};var Gr=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};class Df{constructor(e,t={},r,i){const o=new URL(e);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},Lf),t),this.fetch=Pu(r)}listBuckets(){return Gr(this,void 0,void 0,function*(){try{return{data:yield Is(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Vt(e))return{data:null,error:e};throw e}})}getBucket(e){return Gr(this,void 0,void 0,function*(){try{return{data:yield Is(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Vt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Gr(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Gr(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Vt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Gr(this,void 0,void 0,function*(){try{return{data:yield Tn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Vt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Gr(this,void 0,void 0,function*(){try{return{data:yield Ru(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Vt(t))return{data:null,error:t};throw t}})}}class Ff extends Df{constructor(e,t={},r,i){super(e,t,r,i)}from(e){return new Of(this.url,this.headers,e,this.fetch)}}const $f="2.56.0";let Ai="";typeof Deno<"u"?Ai="deno":typeof document<"u"?Ai="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ai="react-native":Ai="node";const Uf={"X-Client-Info":`supabase-js-${Ai}/${$f}`},Nf={headers:Uf},Bf={schema:"public"},Wf={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Vf={};var qf=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};const Gf=n=>{let e;return n?e=n:typeof fetch>"u"?e=ku:e=fetch,(...t)=>e(...t)},zf=()=>typeof Headers>"u"?Iu:Headers,Hf=(n,e,t)=>{const r=Gf(t),i=zf();return(o,u)=>qf(void 0,void 0,void 0,function*(){var f;const v=(f=yield e())!==null&&f!==void 0?f:n;let p=new i(u?.headers);return p.has("apikey")||p.set("apikey",n),p.has("Authorization")||p.set("Authorization",`Bearer ${v}`),r(o,Object.assign(Object.assign({},u),{headers:p}))})};var Kf=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};function Yf(n){return n.endsWith("/")?n:n+"/"}function Jf(n,e){var t,r;const{db:i,auth:o,realtime:u,global:f}=n,{db:v,auth:p,realtime:m,global:w}=e,I={db:Object.assign(Object.assign({},v),i),auth:Object.assign(Object.assign({},p),o),realtime:Object.assign(Object.assign({},m),u),storage:{},global:Object.assign(Object.assign(Object.assign({},w),f),{headers:Object.assign(Object.assign({},(t=w?.headers)!==null&&t!==void 0?t:{}),(r=f?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Kf(this,void 0,void 0,function*(){return""})};return n.accessToken?I.accessToken=n.accessToken:delete I.accessToken,I}const Ou="2.71.1",Xr=30*1e3,Ra=3,la=Ra*Xr,Xf="http://localhost:9999",Qf="supabase.auth.token",Zf={"X-Client-Info":`gotrue-js/${Ou}`},Oa="X-Supabase-Api-Version",Mu={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eh=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,th=600*1e3;class to extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ye(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class nh extends to{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function rh(n){return Ye(n)&&n.name==="AuthApiError"}class Lu extends to{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class sr extends to{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class Kn extends sr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ih(n){return Ye(n)&&n.name==="AuthSessionMissingError"}class fs extends sr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class hs extends sr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class vs extends sr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sh(n){return Ye(n)&&n.name==="AuthImplicitGrantRedirectError"}class Sl extends sr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ma extends sr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ua(n){return Ye(n)&&n.name==="AuthRetryableFetchError"}class El extends sr{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class La extends sr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ss="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Al=` 	
\r=`.split(""),ah=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Al.length;e+=1)n[Al[e].charCodeAt(0)]=-2;for(let e=0;e<Ss.length;e+=1)n[Ss[e].charCodeAt(0)]=e;return n})();function Cl(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ss[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ss[r]),e.queuedBits-=6}}function Du(n,e,t){const r=ah[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Tl(n){const e=[],t=u=>{e.push(String.fromCodePoint(u))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},o=u=>{uh(u,r,t)};for(let u=0;u<n.length;u+=1)Du(n.charCodeAt(u),i,o);return e.join("")}function oh(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function lh(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}oh(r,e)}}function uh(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ch(n){const e=[],t={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<n.length;i+=1)Du(n.charCodeAt(i),t,r);return new Uint8Array(e)}function dh(n){const e=[];return lh(n,t=>e.push(t)),new Uint8Array(e)}function fh(n){const e=[],t={queue:0,queuedBits:0},r=i=>{e.push(i)};return n.forEach(i=>Cl(i,t,r)),Cl(null,t,r),e.join("")}function hh(n){return Math.round(Date.now()/1e3)+n}function vh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const yn=()=>typeof window<"u"&&typeof document<"u",gr={tested:!1,writable:!1},Fu=()=>{if(!yn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(gr.tested)return gr.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),gr.tested=!0,gr.writable=!0}catch{gr.tested=!0,gr.writable=!1}return gr.writable};function ph(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return t.searchParams.forEach((r,i)=>{e[i]=r}),e}const $u=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>$i(async()=>{const{default:r}=await Promise.resolve().then(()=>hi);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},gh=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Qr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},mr=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Hn=async(n,e)=>{await n.removeItem(e)};class Fs{constructor(){this.promise=new Fs.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Fs.promiseConstructor=Promise;function ca(n){const e=n.split(".");if(e.length!==3)throw new La("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!eh.test(e[r]))throw new La("JWT not in base64url format");return{header:JSON.parse(Tl(e[0])),payload:JSON.parse(Tl(e[1])),signature:ch(e[2]),raw:{header:e[0],payload:e[1]}}}async function mh(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function _h(n,e){return new Promise((r,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const u=await n(o);if(!e(o,null,u)){r(u);return}}catch(u){if(!e(o,u)){i(u);return}}})()})}function yh(n){return("0"+n.toString(16)).substr(-2)}function wh(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let i="";for(let o=0;o<56;o++)i+=t.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,yh).join("")}async function bh(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(r);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}async function kh(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await bh(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zr(n,e,t=!1){const r=wh();let i=r;t&&(i+="/PASSWORD_RECOVERY"),await Qr(n,`${e}-code-verifier`,i);const o=await kh(r);return[o,r===o?"plain":"s256"]}const Ih=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Sh(n){const e=n.headers.get(Oa);if(!e||!e.match(Ih))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Eh(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Ah(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ch=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hr(n){if(!Ch.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function da(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function xl(n){return JSON.parse(JSON.stringify(n))}var Th=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};const wr=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),xh=[502,503,504];async function jl(n){var e;if(!gh(n))throw new Ma(wr(n),0);if(xh.includes(n.status))throw new Ma(wr(n),n.status);let t;try{t=await n.json()}catch(o){throw new Lu(wr(o),o)}let r;const i=Sh(n);if(i&&i.getTime()>=Mu["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new El(wr(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Kn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,u)=>o&&typeof u=="string",!0))throw new El(wr(t),n.status,t.weak_password.reasons);throw new nh(wr(t),n.status||500,r)}const jh=(n,e,t,r)=>{const i={method:n,headers:e?.headers||{}};return n==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),t))};async function st(n,e,t,r){var i;const o=Object.assign({},r?.headers);o[Oa]||(o[Oa]=Mu["2024-01-01"].name),r?.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const u=(i=r?.query)!==null&&i!==void 0?i:{};r?.redirectTo&&(u.redirect_to=r.redirectTo);const f=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",v=await Ph(n,e,t+f,{headers:o,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(v):{data:Object.assign({},v),error:null}}async function Ph(n,e,t,r,i,o){const u=jh(e,r,i,o);let f;try{f=await n(t,Object.assign({},u))}catch(v){throw console.error(v),new Ma(wr(v),0)}if(f.ok||await jl(f),r?.noResolveJson)return f;try{return await f.json()}catch(v){await jl(v)}}function Un(n){var e;let t=null;Lh(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=hh(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Pl(n){const e=Un(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Jn(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Rh(n){return{data:n,error:null}}function Oh(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:o}=n,u=Th(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:t,hashed_token:r,redirect_to:i,verification_type:o},v=Object.assign({},u);return{data:{properties:f,user:v},error:null}}function Mh(n){return n}function Lh(n){return n.access_token&&n.refresh_token&&n.expires_in}const fa=["global","local","others"];var Dh=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t};class Fh{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=$u(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=fa[0]){if(fa.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fa.join(", ")}`);try{return await st(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await st(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Jn})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Dh(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=r?.newEmail,delete i.newEmail),await st(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Oh,redirectTo:t?.redirectTo})}catch(t){if(Ye(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await st(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Jn})}catch(t){if(Ye(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,i,o,u,f,v;try{const p={nextPage:null,lastPage:0,total:0},m=await st(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(o=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:Mh});if(m.error)throw m.error;const w=await m.json(),I=(u=m.headers.get("x-total-count"))!==null&&u!==void 0?u:0,_=(v=(f=m.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&v!==void 0?v:[];return _.length>0&&(_.forEach(k=>{const P=parseInt(k.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(k.split(";")[1].split("=")[1]);p[`${x}Page`]=P}),p.total=parseInt(I)),{data:Object.assign(Object.assign({},w),p),error:null}}catch(p){if(Ye(p))return{data:{users:[]},error:p};throw p}}async getUserById(e){Hr(e);try{return await st(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Jn})}catch(t){if(Ye(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Hr(e);try{return await st(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Jn})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Hr(e);try{return await st(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Jn})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Hr(e.userId);try{const{data:t,error:r}=await st(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:r}}catch(t){if(Ye(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Hr(e.userId),Hr(e.id);try{return{data:await st(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ye(t))return{data:null,error:t};throw t}}}function Rl(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function $h(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Kr={debug:!!(globalThis&&Fu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Uu extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Uh extends Uu{}async function Nh(n,e,t){Kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Kr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,i.name);try{return await t()}finally{Kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,i.name)}}else{if(e===0)throw Kr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Uh(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Kr.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}$h();const Bh={url:Xf,storageKey:Qf,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Zf,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ol(n,e,t){return await t()}const Yr={};class Mi{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mi.nextInstanceID,Mi.nextInstanceID+=1,this.instanceID>0&&yn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Bh),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Fh({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=$u(i.fetch),this.lock=i.lock||Ol,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:yn()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Nh:this.lock=Ol,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:Fu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Rl(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Rl(this.memoryStorage)),yn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Yr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Yr[this.storageKey]=Object.assign(Object.assign({},Yr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Yr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Yr[this.storageKey]=Object.assign(Object.assign({},Yr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ou}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ph(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),yn()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:o}=await this._getSessionFromURL(t,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),sh(o)){const v=(e=o.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:u,redirectType:f}=i;return this._debug("#_initialize()","detected session in URL",u,"redirect type",f),await this._saveSession(u),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ye(t)?{error:t}:{error:new Lu("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{const o=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e?.options)===null||i===void 0?void 0:i.captchaToken}},xform:Un}),{data:u,error:f}=o;if(f||!u)return{data:{user:null,session:null},error:f};const v=u.session,p=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:p,session:v},error:null}}catch(o){if(Ye(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,r,i;try{let o;if("email"in e){const{email:m,password:w,options:I}=e;let _=null,k=null;this.flowType==="pkce"&&([_,k]=await zr(this.storage,this.storageKey)),o=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:I?.emailRedirectTo,body:{email:m,password:w,data:(t=I?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:I?.captchaToken},code_challenge:_,code_challenge_method:k},xform:Un})}else if("phone"in e){const{phone:m,password:w,options:I}=e;o=await st(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:w,data:(r=I?.data)!==null&&r!==void 0?r:{},channel:(i=I?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:I?.captchaToken}},xform:Un})}else throw new hs("You must provide either an email or phone number and a password");const{data:u,error:f}=o;if(f||!u)return{data:{user:null,session:null},error:f};const v=u.session,p=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:p,session:v},error:null}}catch(o){if(Ye(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:u,options:f}=e;t=await st(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:u,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Pl})}else if("phone"in e){const{phone:o,password:u,options:f}=e;t=await st(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:u,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Pl})}else throw new hs("You must provide either an email or phone number and a password");const{data:r,error:i}=t;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new fs}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(t){if(Ye(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,i,o,u,f,v,p,m,w,I,_;let k,P;if("message"in e)k=e.message,P=e.signature;else{const{chain:x,wallet:$,statement:z,options:M}=e;let U;if(yn())if(typeof $=="object")U=$;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))U=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof $!="object"||!M?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=$}const F=new URL((t=M?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in U&&U.signIn){const C=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},M?.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),z?{statement:z}:null));let j;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")j=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)j=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)k=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),P=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");k=[`${F.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...z?["",z,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(i=(r=M?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((o=M?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${M.signInWithSolana.notBefore}`]:[],...!((u=M?.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${M.signInWithSolana.expirationTime}`]:[],...!((f=M?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${M.signInWithSolana.chainId}`]:[],...!((v=M?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${M.signInWithSolana.nonce}`]:[],...!((p=M?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${M.signInWithSolana.requestId}`]:[],...!((w=(m=M?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||w===void 0)&&w.length?["Resources",...M.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const C=await U.signMessage(new TextEncoder().encode(k),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");P=C}}try{const{data:x,error:$}=await st(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:k,signature:fh(P)},!((I=e.options)===null||I===void 0)&&I.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Un});if($)throw $;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new fs}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:$})}catch(x){if(Ye(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const t=await mr(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(t??"").split("/");try{const{data:o,error:u}=await st(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Un});if(await Hn(this.storage,`${this.storageKey}-code-verifier`),u)throw u;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new fs}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:u})}catch(o){if(Ye(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:r,token:i,access_token:o,nonce:u}=e,f=await st(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:o,nonce:u,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Un}),{data:v,error:p}=f;return p?{data:{user:null,session:null},error:p}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new fs}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:p})}catch(t){if(Ye(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,i,o,u;try{if("email"in e){const{email:f,options:v}=e;let p=null,m=null;this.flowType==="pkce"&&([p,m]=await zr(this.storage,this.storageKey));const{error:w}=await st(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(r=v?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:p,code_challenge_method:m},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:w}}if("phone"in e){const{phone:f,options:v}=e,{data:p,error:m}=await st(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(i=v?.data)!==null&&i!==void 0?i:{},create_user:(o=v?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(u=v?.channel)!==null&&u!==void 0?u:"sms"}});return{data:{user:null,session:null,messageId:p?.message_id},error:m}}throw new hs("You must provide either an email or phone number.")}catch(f){if(Ye(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(e){var t,r;try{let i,o;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:u,error:f}=await st(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:Un});if(f)throw f;if(!u)throw new Error("An error occurred on token verification.");const v=u.session,p=u.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:p,session:v},error:null}}catch(i){if(Ye(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,r,i;try{let o=null,u=null;return this.flowType==="pkce"&&([o,u]=await zr(this.storage,this.storageKey)),await st(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:u}),headers:this.headers,xform:Rh})}catch(o){if(Ye(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Kn;const{error:i}=await st(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Ye(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:o}=e,{error:u}=await st(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:u}}else if("phone"in e){const{phone:r,type:i,options:o}=e,{data:u,error:f}=await st(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:u?.message_id},error:f}}throw new hs("You must provide either an email or phone number and a type")}catch(t){if(Ye(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await mr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<la:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const u=await mr(this.userStorage,this.storageKey+"-user");u?.user?e.user=u.user:e.user=da()}if(this.storage.isServer&&e.user){let u=this.suppressGetSessionWarning;e=new Proxy(e,{get:(v,p,m)=>(!u&&p==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),u=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,p,m))})}return{data:{session:e},error:null}}const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await st(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Jn}):await this._useSession(async t=>{var r,i,o;const{data:u,error:f}=t;if(f)throw f;return!(!((r=u.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Kn}:await st(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=u.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:Jn})})}catch(t){if(Ye(t))return ih(t)&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:i,error:o}=r;if(o)throw o;if(!i.session)throw new Kn;const u=i.session;let f=null,v=null;this.flowType==="pkce"&&e.email!=null&&([f,v]=await zr(this.storage,this.storageKey));const{data:p,error:m}=await st(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:v}),jwt:u.access_token,xform:Jn});if(m)throw m;return u.user=p.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),{data:{user:u.user},error:null}})}catch(r){if(Ye(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Kn;const t=Date.now()/1e3;let r=t,i=!0,o=null;const{payload:u}=ca(e.access_token);if(u.exp&&(r=u.exp,i=r<=t),i){const{session:f,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!f)return{data:{user:null,session:null},error:null};o=f}else{const{data:f,error:v}=await this._getUser(e.access_token);if(v)throw v;o={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(Ye(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:u,error:f}=t;if(f)throw f;e=(r=u.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new Kn;const{session:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ye(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!yn())throw new vs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new vs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Sl("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new vs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Sl("No code detected.");const{data:z,error:M}=await this._exchangeCodeForSession(e.code);if(M)throw M;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:z.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:o,refresh_token:u,expires_in:f,expires_at:v,token_type:p}=e;if(!o||!f||!u||!p)throw new vs("No session defined in URL");const m=Math.round(Date.now()/1e3),w=parseInt(f);let I=m+w;v&&(I=parseInt(v));const _=I-m;_*1e3<=Xr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${w}s`);const k=I-w;m-k>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",k,I,m):m-k<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",k,I,m);const{data:P,error:x}=await this._getUser(o);if(x)throw x;const $={provider_token:r,provider_refresh_token:i,access_token:o,expires_in:w,expires_at:I,refresh_token:u,token_type:p,user:P.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:$,redirectType:e.type},error:null}}catch(r){if(Ye(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await mr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:i,error:o}=t;if(o)return{error:o};const u=(r=i.session)===null||r===void 0?void 0:r.access_token;if(u){const{error:f}=await this.admin.signOut(u,e);if(f&&!(rh(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return e!=="others"&&(await this._removeSession(),await Hn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=vh(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{const{data:{session:o},error:u}=t;if(u)throw u;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await zr(this.storage,this.storageKey,!0));try{return await st(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(Ye(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Ye(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:i}=await this._useSession(async o=>{var u,f,v,p,m;const{data:w,error:I}=o;if(I)throw I;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(u=e.options)===null||u===void 0?void 0:u.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await st(this.fetch,"GET",_,{headers:this.headers,jwt:(m=(p=w.session)===null||p===void 0?void 0:p.access_token)!==null&&m!==void 0?m:void 0})});if(i)throw i;return yn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(Ye(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;const{data:o,error:u}=t;if(u)throw u;return await st(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(Ye(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await _h(async i=>(i>0&&await mh(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await st(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Un})),(i,o)=>{const u=200*Math.pow(2,i);return o&&ua(o)&&Date.now()+u-r<Xr})}catch(r){if(this._debug(t,"error",r),Ye(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),yn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await mr(this.storage,this.storageKey);if(i&&this.userStorage){let u=await mr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:i.user},await Qr(this.userStorage,this.storageKey+"-user",u)),i.user=(e=u?.user)!==null&&e!==void 0?e:da()}else if(i&&!i.user&&!i.user){const u=await mr(this.storage,this.storageKey+"-user");u&&u?.user?(i.user=u.user,await Hn(this.storage,this.storageKey+"-user"),await Qr(this.storage,this.storageKey,i)):i.user=da()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const o=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<la;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${la}s`),o){if(this.autoRefreshToken&&i.refresh_token){const{error:u}=await this._callRefreshToken(i.refresh_token);u&&(console.error(u),ua(u)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:f}=await this._getUser(i.access_token);!f&&u?.user?(i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(r,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Kn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Fs;const{data:o,error:u}=await this._refreshAccessToken(e);if(u)throw u;if(!o.session)throw new Kn;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const f={session:o.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(o){if(this._debug(i,"error",o),Ye(o)){const u={session:null,error:o};return ua(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(u),u}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],u=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,t)}catch(v){o.push(v)}});if(await Promise.all(u),o.length>0){for(let f=0;f<o.length;f+=1)console.error(o[f]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Qr(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const o=xl(i);await Qr(this.storage,this.storageKey,o)}else{const i=xl(t);await Qr(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Hn(this.storage,this.storageKey),await Hn(this.storage,this.storageKey+"-code-verifier"),await Hn(this.storage,this.storageKey+"-user"),this.userStorage&&await Hn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&yn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/Xr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Xr}ms, refresh threshold is ${Ra} ticks`),i<=Ra&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Uu)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!yn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const i=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,u]=await zr(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(u)}`});i.push(f.toString())}if(r?.queryParams){const o=new URLSearchParams(r.queryParams);i.push(o.toString())}return r?.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:i,error:o}=t;return o?{data:null,error:o}:await st(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ye(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;const{data:o,error:u}=t;if(u)return{data:null,error:u};const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:v,error:p}=await st(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return p?{data:null,error:p}:(e.factorType==="totp"&&(!((i=v?.totp)===null||i===void 0)&&i.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(t){if(Ye(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:o}=t;if(o)return{data:null,error:o};const{data:u,error:f}=await st(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),{data:u,error:f})})}catch(t){if(Ye(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:i,error:o}=t;return o?{data:null,error:o}:await st(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ye(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],i=r.filter(u=>u.factor_type==="totp"&&u.status==="verified"),o=r.filter(u=>u.factor_type==="phone"&&u.status==="verified");return{data:{all:r,totp:i,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:i},error:o}=e;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:u}=ca(i.access_token);let f=null;u.aal&&(f=u.aal);let v=f;((r=(t=i.user.factors)===null||t===void 0?void 0:t.filter(w=>w.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(v="aal2");const m=u.amr||[];return{data:{currentLevel:f,nextLevel:v,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(f=>f.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(f=>f.kid===e),r&&this.jwks_cached_at+th>i)return r;const{data:o,error:u}=await st(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,r=o.keys.find(f=>f.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:_,error:k}=await this.getSession();if(k||!_.session)return{data:null,error:k};r=_.session.access_token}const{header:i,payload:o,signature:u,raw:{header:f,payload:v}}=ca(r);t?.allowExpired||Eh(o.exp);const p=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!p){const{error:_}=await this.getUser(r);if(_)throw _;return{data:{claims:o,header:i,signature:u},error:null}}const m=Ah(i.alg),w=await crypto.subtle.importKey("jwk",p,m,!0,["verify"]);if(!await crypto.subtle.verify(m,w,u,dh(`${f}.${v}`)))throw new La("Invalid JWT signature");return{data:{claims:o,header:i,signature:u},error:null}}catch(r){if(Ye(r))return{data:null,error:r};throw r}}}Mi.nextInstanceID=0;const Wh=Mi;class Vh extends Wh{constructor(e){super(e)}}var qh=function(n,e,t,r){function i(o){return o instanceof t?o:new t(function(u){u(o)})}return new(t||(t=Promise))(function(o,u){function f(m){try{p(r.next(m))}catch(w){u(w)}}function v(m){try{p(r.throw(m))}catch(w){u(w)}}function p(m){m.done?o(m.value):i(m.value).then(f,v)}p((r=r.apply(n,e||[])).next())})};class Gh{constructor(e,t,r){var i,o,u;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=Yf(e),v=new URL(f);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const p=`sb-${v.hostname.split(".")[0]}-auth-token`,m={db:Bf,realtime:Vf,auth:Object.assign(Object.assign({},Wf),{storageKey:p}),global:Nf},w=Jf(r??{},m);this.storageKey=(i=w.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=w.global.headers)!==null&&o!==void 0?o:{},w.accessToken?(this.accessToken=w.accessToken,this.auth=new Proxy({},{get:(I,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((u=w.auth)!==null&&u!==void 0?u:{},this.headers,w.global.fetch),this.fetch=Hf(t,this._getAccessToken.bind(this),w.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},w.realtime)),this.rest=new of(new URL("rest/v1",v).href,{headers:this.headers,schema:w.db.schema,fetch:this.fetch}),this.storage=new Ff(this.storageUrl.href,this.headers,this.fetch,r?.storage),w.accessToken||this._listenForAuthEvents()}get functions(){return new Kd(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return qh(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:o,flowType:u,lock:f,debug:v},p,m){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Vh({url:this.authUrl.href,headers:Object.assign(Object.assign({},w),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:u,lock:f,debug:v,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Sf(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zh=(n,e,t)=>new Gh(n,e,t);function Hh(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Hh()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Kh="https://vycjpmuyscfygstjjied.supabase.co",Yh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",xn=zh(Kh,Yh,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}}),tr={async loadStoriesList(){if(!B.selectedBucket){console.warn("[ResourceStore] No bucket selected");return}console.log(`[ResourceStore] Формирование имени файла для bucket: ${B.selectedBucket}`);const n=`${B.selectedBucket}_story.json`,{data:e,error:t}=await xn.storage.from(B.selectedBucket).list("",{search:n});console.log(`[ResourceStore] Проверка файла ${n}:`,{files:e,error:t}),!t&&e&&e.some(r=>r.name===n)?(B.storiesList=[n],console.log(`[ResourceStore] Найден файл: ${n}`)):(B.storiesList=[],console.warn(`[ResourceStore] Файл ${n} не найден`))},async loadStoredResources(){if(!B.selectedBucket){console.warn("No bucket selected");return}const{data:n}=await xn.storage.from(B.selectedBucket).list();n&&(B.storedFiles=n.filter(e=>e.name!==".emptyFolderPlaceholder"&&!e.name.endsWith(".json")))},async uploadNewFile(n){const e=n.target;if(!e.files||e.files.length===0)return;if(!B.selectedBucket){_t.setStatus("error","Не выбрана история");return}const t=e.files[0];_t.setStatus("loading","Загрузка файла...");const r=await t.arrayBuffer(),i=new Uint8Array(r),{error:o}=await xn.storage.from(B.selectedBucket).upload(t.name,i,{upsert:!0,contentType:t.type});o?_t.setStatus("error","Ошибка загрузки"):(_t.setStatus("success","Файл загружен"),await this.loadStoredResources())},async deleteFile(n){if(!B.selectedBucket){_t.setStatus("error","Не выбрана история");return}const{error:e}=await xn.storage.from(B.selectedBucket).remove([n]);e?_t.setStatus("error","Ошибка удаления файла"):(_t.setStatus("success","Файл удален"),await this.loadStoredResources())}};function Jh(n){return n.dialogues&&n.dialogues.forEach(e=>{e.options&&e.options.forEach(t=>{typeof t.miniGame=="boolean"&&(t.miniGame===!0?t.miniGame={id:"",onWinDialogueId:"",onLoseDialogueId:""}:delete t.miniGame),typeof t.enabled>"u"&&(t.enabled=!0),typeof t.visible>"u"&&(t.visible=!0),t.visibleIf&&!t.visibilityCondition&&(t.visibleIf.hasItem&&(t.visibilityCondition={type:"has_item",itemId:t.visibleIf.hasItem}),delete t.visibleIf),t.visibilityCondition||(t.visibilityCondition={type:"always"})})}),n.chapters||(n.chapters=[{id:"main",title:"Основная история",description:""}],n.dialogues&&n.dialogues.forEach(e=>{e.chapterId||(e.chapterId="main")})),n.chapters&&n.chapters.forEach(e=>{typeof e.description>"u"&&(e.description="")}),n.items||(n.items=[]),n.meta||(n.meta={version:"3.1",title:n.title||"Untitled"}),n.miniGames&&Array.isArray(n.miniGames)&&(n.miniGames=n.miniGames.map(e=>e.id&&!e.onWinDialogueId?{...e,onWinDialogueId:e.winTarget||"",onLoseDialogueId:e.loseTarget||""}:e)),n}function Xh(){return{text:"Новый вариант",enabled:!0,visible:!0,visibilityCondition:{type:"always"}}}const Ir={async createNewStory(){if(!B.selectedBucket){_t.setStatus("error","Не выбрана история (bucket)");return}const n=prompt("Введите имя файла истории:","new_story.json");if(!n)return;const t=JSON.stringify({meta:{version:"3.1",title:"New Story"},chapters:[{id:"ch1",title:"Глава 1",description:""}],dialogues:[{id:"start",chapterId:"ch1",text:"Начало...",options:[]}]},null,2),i=new TextEncoder().encode(t),{error:o}=await xn.storage.from(B.selectedBucket).upload(n,i,{contentType:"application/json"});o?_t.setStatus("error","Ошибка создания: "+o.message):(await tr.loadStoriesList(),await this.loadStory(n))},async loadStory(n){if(!B.selectedBucket){_t.setStatus("error","Не выбрана история (bucket)");return}console.log(`[StoryStore] Загрузка истории: ${n} из bucket: ${B.selectedBucket}`),_t.setStatus("loading","Загрузка..."),B.currentFileName=n;try{const{data:e,error:t}=await xn.storage.from(B.selectedBucket).download(n);console.log("[StoryStore] Результат загрузки (download):",{hasData:!!e,error:t});let r;if(t){console.warn("[StoryStore] Ошибка download, пробуем публичный URL:",t);const o=xn.storage.from(B.selectedBucket).getPublicUrl(n).data.publicUrl;console.log(`[StoryStore] Публичный URL: ${o}`);const u=await fetch(o);if(!u.ok)throw new Error(`Не удалось загрузить файл: ${u.statusText}`);r=await u.text(),console.log(`[StoryStore] Данные загружены через публичный URL, длина: ${r.length}`)}else r=await e.text(),console.log(`[StoryStore] Данные загружены через download, длина: ${r.length}`);let i=JSON.parse(r);console.log("[StoryStore] Данные распарсены:",{meta:i.meta,chaptersCount:i.chapters?.length,dialoguesCount:i.dialogues?.length,itemsCount:i.items?.length}),i=Jh(i),console.log("[StoryStore] Присваиваем данные в editor.data"),B.data=i,console.log("[StoryStore] editor.data обновлен:",{chapters:B.data.chapters?.length,dialogues:B.data.dialogues?.length}),B.data.chapters&&B.data.chapters.length>0&&(B.selectedChapterId=B.data.chapters[0].id,console.log(`[StoryStore] Выбрана глава: ${B.selectedChapterId}`)),B.data.dialogues&&B.data.dialogues.length>0&&(B.selectedDialogueId=B.data.dialogues[0].id,console.log(`[StoryStore] Выбран диалог: ${B.selectedDialogueId}`)),console.log("[StoryStore] Загрузка завершена успешно"),_t.setStatus("success","Загружено!")}catch(e){console.error("[StoryStore] Ошибка загрузки:",e),_t.setStatus("error","Ошибка загрузки: "+e.message)}},async saveCurrentStory(){if(!B.data)return;if(!B.selectedBucket){_t.setStatus("error","Не выбрана история (bucket)");return}_t.setStatus("loading","Сохранение...");const n=JSON.stringify(B.data,null,2);console.log(`[StoryStore] Сохранение файла: ${B.currentFileName}, размер: ${n.length} байт`);const t=new TextEncoder().encode(n),{error:r}=await xn.storage.from(B.selectedBucket).update(B.currentFileName,t,{contentType:"application/json"});if(r){console.error("[StoryStore] Ошибка сохранения (update):",r),console.log("[StoryStore] Пробуем upload вместо update");const i=await xn.storage.from(B.selectedBucket).upload(B.currentFileName,t,{contentType:"application/json"});i.error?(console.error("[StoryStore] Ошибка сохранения (upload):",i.error),_t.setStatus("error","Ошибка сохранения: "+i.error.message)):(console.log("[StoryStore] Файл успешно сохранен через upload"),_t.setStatus("success","Сохранено!"))}else console.log("[StoryStore] Файл успешно сохранен через update"),_t.setStatus("success","Сохранено!")},async saveStoryCopy(){if(!B.data)return;if(!B.selectedBucket){_t.setStatus("error","Не выбрана история (bucket)");return}const n=B.currentFileName.replace(".json",""),e=new Date().getTime();let t=`${n}_copy_${e}.json`.trim();const r=prompt("Введите имя для копии:",t);if(!r)return;t=r.trim(),t.endsWith(".json")||(t+=".json"),_t.setStatus("loading","Создание копии...");const i=JSON.stringify(B.data,null,2),u=new TextEncoder().encode(i),{error:f}=await xn.storage.from(B.selectedBucket).upload(t,u,{upsert:!0,contentType:"application/json"});f?_t.setStatus("error",`Ошибка копии: ${f.message}`):(await tr.loadStoriesList(),_t.setStatus("success","Копия сохранена!"))},addChapter(){if(!B.data||!B.data.chapters)return;const n="ch_"+Date.now();B.data.chapters.push({id:n,title:"Новая глава",description:""}),B.selectedChapterId=n,console.log(`[StoryStore] Создана новая глава: ${n}`)},addDialogue(){if(!B.data||!B.selectedChapterId)return;const n="d_"+Date.now();B.data.dialogues.push({id:n,chapterId:B.selectedChapterId,text:"Новый текст...",options:[]}),B.selectedDialogueId=n},deleteDialogue(n){confirm("Удалить диалог "+n+"?")&&B.data&&(B.data.dialogues=B.data.dialogues.filter(e=>e.id!==n),B.data.dialogues.forEach(e=>{e.nextDialogueId===n&&(e.nextDialogueId=""),e.options&&e.options.forEach(t=>{t.nextDialogueId===n&&(t.nextDialogueId="")})}),B.selectedDialogueId===n&&(B.selectedDialogueId=null))},jumpTo(n){const e=B.data?.dialogues.find(t=>t.id===n);e&&(B.selectedChapterId=e.chapterId,B.selectedDialogueId=n)},getLinkType(n,e){return n.nextDialogueId===e?"Auto":"Option"}};var nn=ir(()=>Kt);function Qh(){_t.selectEditingChapter(null)}var Zh=ee('<div class="chapter-form svelte-qdj6mq"><div class="form-header svelte-qdj6mq"><h4 class="svelte-qdj6mq">Редактирование главы</h4> <div class="header-actions svelte-qdj6mq"><button class="btn-icon danger svelte-qdj6mq" title="Удалить главу">×</button></div></div> <div class="form-group svelte-qdj6mq"><label for="chapter-title" class="svelte-qdj6mq">Название главы</label> <input type="text" id="chapter-title" class="input svelte-qdj6mq" placeholder="Название главы"/></div> <div class="form-group svelte-qdj6mq"><label for="chapter-description" class="svelte-qdj6mq">Описание главы</label> <textarea id="chapter-description" class="textarea svelte-qdj6mq" rows="4" placeholder="Описание главы..."></textarea></div> <div class="form-actions svelte-qdj6mq"><button class="btn svelte-qdj6mq">Отмена</button> <button class="btn primary svelte-qdj6mq">Сохранить</button></div></div>');function ev(n,e){Tt(e,!1);function t(){nn().currentEditingChapter&&(_t.updateChapter(nn().currentEditingChapter.id,{title:nn().currentEditingChapter.title,description:nn().currentEditingChapter.description}),_t.selectEditingChapter(null))}function r(){nn().currentEditingChapter&&confirm(`Удалить главу "${nn().currentEditingChapter.title}"?`)&&(_t.deleteChapter(nn().currentEditingChapter.id),_t.selectEditingChapter(null))}rr();var i=kt(),o=Je(i);{var u=f=>{var v=Zh(),p=A(v),m=T(A(p),2),w=A(m);w.__click=r;var I=T(p,2),_=T(A(I),2),k=T(I,2),P=T(A(k),2),x=T(k,2),$=A(x);$.__click=[Qh];var z=T($,2);z.__click=t,Bn(_,()=>nn().currentEditingChapter.title,M=>nn(nn().currentEditingChapter.title=M)),Bn(P,()=>nn().currentEditingChapter.description,M=>nn(nn().currentEditingChapter.description=M)),H(f,v)};De(o,f=>{nn().currentEditingChapter&&f(u)})}H(n,i),xt()}Lt(["click"]);var rn=ir(()=>B),tv=(n,e,t)=>e(h(t).id),nv=ee('<div class="chapter-form-container svelte-xp6igx"><!></div>'),rv=ee('<div class="chapter-row svelte-xp6igx"><button type="button"><span class="chapter-title svelte-xp6igx"> </span></button> <button type="button" class="edit-chapter-btn svelte-xp6igx" title="Редактировать главу">✏️</button></div> <!>',1),iv=ee('<button type="button"><span class="id-badge svelte-xp6igx"> </span> <span class="preview-text svelte-xp6igx"> </span></button>'),sv=ee("<div> </div>"),av=ee('<aside class="sidebar svelte-xp6igx"><div class="sidebar-section svelte-xp6igx"><div class="section-header"><h3>Главы</h3> <button class="btn-icon">+</button></div> <div class="chapter-list svelte-xp6igx"></div></div> <div class="sidebar-section flex-1 svelte-xp6igx"><div class="section-header"><h3> </h3> <button class="btn-icon">+</button></div> <div class="dialogue-list svelte-xp6igx"></div></div> <div class="status-box svelte-xp6igx"><!></div></aside>');function ov(n,e){Tt(e,!1);function t($){_t.selectEditingChapter($)}rr();var r=av(),i=A(r),o=A(i),u=T(A(o),2);u.__click=function(...$){Ir.addChapter?.apply(this,$)};var f=T(o,2);et(f,5,()=>rn().data?.chapters||[],$=>$.id,($,z)=>{var M=rv(),U=Je(M),F=A(U);let C;F.__click=()=>rn(rn().selectedChapterId=h(z).id);var j=A(F),ne=A(j),le=T(F,2);le.__click=[tv,t,z];var _e=T(U,2);{var he=ue=>{var J=nv(),Y=A(J);ev(Y,{}),H(ue,J)};De(_e,ue=>{rn().editingChapterId===h(z).id&&ue(he)})}Ee(ue=>{C=Ut(F,1,"chapter-item svelte-xp6igx",null,C,ue),Be(F,"aria-pressed",rn().selectedChapterId===h(z).id),Be(F,"title",h(z).description||"Без описания"),Se(ne,h(z).title)},[()=>({active:rn().selectedChapterId===h(z).id})]),H($,M)});var v=T(i,2),p=A(v),m=A(p),w=A(m),I=T(m,2);I.__click=function(...$){Ir.addDialogue?.apply(this,$)};var _=T(p,2);et(_,5,()=>Kt.chapterDialogues,$=>$.id,($,z)=>{var M=iv();let U;M.__click=()=>rn(rn().selectedDialogueId=h(z).id);var F=A(M),C=A(F),j=T(F,2),ne=A(j);Ee((le,_e)=>{U=Ut(M,1,"dialogue-item svelte-xp6igx",null,U,le),Be(M,"aria-pressed",rn().selectedDialogueId===h(z).id),Se(C,h(z).id),Se(ne,`${_e??""}...`)},[()=>({active:rn().selectedDialogueId===h(z).id}),()=>h(z).text.substring(0,25)]),H($,M)});var k=T(v,2),P=A(k);{var x=$=>{var z=sv(),M=A(z);Ee(()=>{Ut(z,1,`alert ${rn().statusMessage.type??""}`,"svelte-xp6igx"),Se(M,rn().statusMessage.text)}),H($,z)};De(P,$=>{rn().statusMessage.text&&$(x)})}Ee(()=>{Se(w,`Сцены (${Kt.chapterDialogues.length??""})`),I.disabled=!rn().selectedChapterId}),H(n,r),xt()}Lt(["click"]);var lv=ee("<option> </option>"),uv=(n,e)=>{const t=n.target;e(t.checked)},cv=(n,e)=>{const t=n.target;e("id",t.value)},dv=(n,e)=>{const t=n.target;e("onWinDialogueId",t.value)},fv=ee("<option> </option>"),hv=(n,e)=>{const t=n.target;e("onLoseDialogueId",t.value)},vv=ee("<option> </option>"),pv=(n,e)=>{const t=n.target;e("rewardItem",t.value)},gv=ee("<option> </option>"),mv=ee('<div class="minigame-details svelte-14qgggj"><div class="form-group svelte-14qgggj"><label>ID игры</label> <select class="input select"><option>-- Выберите игру --</option><option>Onet: Monsters (поиск пар)</option><option>Memo: Monsters (поиск пар)</option><option>LightOut: Свечи в склепе (Выключи свет)</option><option>Flood It: Мора Красной Смерти</option><option>Boken Mirror: Пятнашки</option><option>Evolution 2048</option><option>Проклятый Сапер</option><option>Три пика</option></select></div> <div class="form-row svelte-14qgggj"><div class="form-group svelte-14qgggj"><label>Диалог при победе</label> <select class="input select"><option>-- Выберите --</option><!></select></div> <div class="form-group svelte-14qgggj"><label>Диалог при поражении</label> <select class="input select"><option>-- Выберите --</option><!></select></div></div> <div class="form-group svelte-14qgggj"><label>Награда (предмет)</label> <select class="input select"><option>-- Без награды --</option><!></select></div></div>'),_v=(n,e)=>{const t=n.target;e(t.value)},yv=ee("<option> </option>"),wv=(n,e)=>{const t=n.target;e({itemId:t.value})},bv=ee("<option> </option>"),kv=ee('<div class="form-group full-width svelte-14qgggj"><label>Предмет</label> <select class="input select"><option>-- Выберите предмет --</option><!></select></div>'),Iv=(n,e)=>{const t=n.target;e({statName:t.value})},Sv=(n,e)=>{const t=n.target,r=parseInt(t.value);e({statValue:isNaN(r)?0:r})},Ev=ee('<div class="form-group svelte-14qgggj"><label>Стата</label> <input type="text" class="input" placeholder="knowledge"/></div> <div class="form-group svelte-14qgggj"><label>Значение ></label> <input type="number" class="input"/></div>',1),Av=(n,e)=>{const t=n.target;e({flagName:t.value})},Cv=ee('<div class="form-group full-width svelte-14qgggj"><label>Имя флага</label> <input type="text" class="input" placeholder="metDracula"/></div>'),Tv=ee('<div class="option-details svelte-14qgggj"><div class="form-group"><label>Текст кнопки</label> <input type="text" class="input"/></div> <div class="form-group"><label>Переход</label> <select class="input select"><option>-- Конец ветки --</option><!></select></div> <div class="minigame-section svelte-14qgggj"><div class="section-header svelte-14qgggj"><label class="checkbox-row svelte-14qgggj"><input type="checkbox"/> Запустить мини-игру</label></div> <!></div> <div class="options-settings-grid svelte-14qgggj"><div class="setting-col svelte-14qgggj"><label class="checkbox-row svelte-14qgggj"><input type="checkbox"/> Включено (Enable)</label> <p class="setting-desc svelte-14qgggj">Если выключено, кнопка серая и не кликабельна.</p></div> <div class="setting-col svelte-14qgggj"><label class="checkbox-row svelte-14qgggj"><input type="checkbox"/> Видимо (Visible)</label> <p class="setting-desc svelte-14qgggj">Если скрыто, кнопки нет в списке.</p></div></div> <div class="trigger-section svelte-14qgggj"><h5 class="svelte-14qgggj">Условие видимости</h5> <div class="form-row svelte-14qgggj"><div class="form-group svelte-14qgggj"><label>Тип условия</label> <select class="input select"></select></div> <!> <!> <!></div> <!></div></div>');function xv(n,e){Tt(e,!0);const t=Ge(e,"option",7);function r(){t().visibilityCondition||(t().visibilityCondition={type:"always"})}function i(){return r(),t().visibilityCondition}function o(q){r();const K=t().visibilityCondition;Object.assign(K,q),t().visibilityCondition={...K}}function u(q){r();const K={type:q};switch(q){case"has_item":K.itemId=i().itemId||"";break;case"stat_greater":K.statName=i().statName||"",K.statValue=i().statValue||0;break;case"flag_true":K.flagName=i().flagName||"";break}t().visibilityCondition=K}const f=Ot(()=>!!t().miniGame);function v(q){q?t().miniGame={id:"",onWinDialogueId:"",onLoseDialogueId:""}:delete t().miniGame}function p(){return!t().miniGame||typeof t().miniGame=="boolean"?null:t().miniGame}function m(q,K){const ve=p();ve&&(ve[q]=K)}var w=Tv(),I=A(w),_=A(I),k=T(_,2),P=T(I,2),x=A(P),$=T(x,2),z=A($);z.value=z.__value="";var M=T(z);et(M,17,()=>e.dialogues,q=>q.id,(q,K)=>{var ve=lv(),me=A(ve),$e={};Ee(Ne=>{Se(me,`${h(K).id??""}: ${Ne??""}...`),$e!==($e=h(K).id)&&(ve.value=(ve.__value=h(K).id)??"")},[()=>h(K).text.substring(0,30)]),H(q,ve)});var U=T(P,2),F=A(U),C=A(F),j=A(C);j.__change=[uv,v];var ne=T(F,2);{var le=q=>{var K=mv(),ve=A(K),me=A(ve),$e=T(me,2);$e.__change=[cv,m];var Ne=A($e);Ne.value=Ne.__value="";var Ue=T(Ne);Ue.value=Ue.__value="onet_monsters";var je=T(Ue);je.value=je.__value="memo_monsters";var ze=T(je);ze.value=ze.__value="light_out";var qe=T(ze);qe.value=qe.__value="flood_it";var gt=T(qe);gt.value=gt.__value="broken_mirror";var lt=T(gt);lt.value=lt.__value="evolution2048";var St=T(lt);St.value=St.__value="cursed_crypts";var wt=T(St);wt.value=wt.__value="tower_of_souls";var y;yr($e);var l=T(ve,2),d=A(l),S=A(d),O=T(S,2);O.__change=[dv,m];var X=A(O);X.value=X.__value="";var de=T(X);et(de,17,()=>e.dialogues,it=>it.id,(it,ut)=>{var Ce=fv(),He=A(Ce),Bt={};Ee(Mr=>{Se(He,`${h(ut).id??""}: ${Mr??""}...`),Bt!==(Bt=h(ut).id)&&(Ce.value=(Ce.__value=h(ut).id)??"")},[()=>h(ut).text.substring(0,30)]),H(it,Ce)});var Fe;yr(O);var We=T(d,2),Oe=A(We),Ve=T(Oe,2);Ve.__change=[hv,m];var rt=A(Ve);rt.value=rt.__value="";var Dt=T(rt);et(Dt,17,()=>e.dialogues,it=>it.id,(it,ut)=>{var Ce=vv(),He=A(Ce),Bt={};Ee(Mr=>{Se(He,`${h(ut).id??""}: ${Mr??""}...`),Bt!==(Bt=h(ut).id)&&(Ce.value=(Ce.__value=h(ut).id)??"")},[()=>h(ut).text.substring(0,30)]),H(it,Ce)});var bt;yr(Ve);var Zt=T(l,2),Yt=A(Zt),jt=T(Yt,2);jt.__change=[pv,m];var Ft=A(jt);Ft.value=Ft.__value="";var nt=T(Ft);et(nt,17,()=>e.availableItems,it=>it.id,(it,ut)=>{var Ce=gv(),He=A(Ce),Bt={};Ee(()=>{Se(He,h(ut).name),Bt!==(Bt=h(ut).id)&&(Ce.value=(Ce.__value=h(ut).id)??"")}),H(it,Ce)});var Mt;yr(jt),Ee((it,ut,Ce,He)=>{Be(me,"for",`option-mg-id-${e.index??""}`),Be($e,"id",`option-mg-id-${e.index??""}`),y!==(y=it)&&($e.value=($e.__value=it)??"",Yn($e,it)),Be(S,"for",`option-mg-win-${e.index??""}`),Be(O,"id",`option-mg-win-${e.index??""}`),Fe!==(Fe=ut)&&(O.value=(O.__value=ut)??"",Yn(O,ut)),Be(Oe,"for",`option-mg-lose-${e.index??""}`),Be(Ve,"id",`option-mg-lose-${e.index??""}`),bt!==(bt=Ce)&&(Ve.value=(Ve.__value=Ce)??"",Yn(Ve,Ce)),Be(Yt,"for",`option-mg-reward-${e.index??""}`),Be(jt,"id",`option-mg-reward-${e.index??""}`),Mt!==(Mt=He)&&(jt.value=(jt.__value=He)??"",Yn(jt,He))},[()=>p().id,()=>p().onWinDialogueId,()=>p().onLoseDialogueId,()=>p().rewardItem||""]),H(q,K)};De(ne,q=>{p()&&q(le)})}var _e=T(U,2),he=A(_e),ue=A(he),J=A(ue),Y=T(he,2),W=A(Y),Z=A(W),L=T(_e,2),V=T(A(L),2),se=A(V),oe=A(se),be=T(oe,2);be.__change=[_v,u],et(be,20,()=>e.conditionTypes,q=>q,(q,K)=>{var ve=yv(),me=A(ve),$e={};Ee(()=>{Se(me,K),$e!==($e=K)&&(ve.value=(ve.__value=K)??"")}),H(q,ve)});var Ae;yr(be);var ye=T(se,2);{var Pe=q=>{var K=kv(),ve=A(K),me=T(ve,2);me.__change=[wv,o];var $e=A(me);$e.value=$e.__value="";var Ne=T($e);et(Ne,17,()=>e.availableItems,je=>je.id,(je,ze)=>{var qe=bv(),gt=A(qe),lt={};Ee(()=>{Se(gt,h(ze).name),lt!==(lt=h(ze).id)&&(qe.value=(qe.__value=h(ze).id)??"")}),H(je,qe)});var Ue;yr(me),Ee(je=>{Be(ve,"for",`option-cond-item-${e.index??""}`),Be(me,"id",`option-cond-item-${e.index??""}`),Ue!==(Ue=je)&&(me.value=(me.__value=je)??"",Yn(me,je))},[()=>i().itemId||""]),H(q,K)};De(ye,q=>{i().type==="has_item"&&q(Pe)})}var ce=T(ye,2);{var re=q=>{var K=Ev(),ve=Je(K),me=A(ve),$e=T(me,2);$e.__input=[Iv,o];var Ne=T(ve,2),Ue=A(Ne),je=T(Ue,2);je.__input=[Sv,o],Ee((ze,qe)=>{Be(me,"for",`option-cond-stat-${e.index??""}`),Be($e,"id",`option-cond-stat-${e.index??""}`),ra($e,ze),Be(Ue,"for",`option-cond-stat-val-${e.index??""}`),Be(je,"id",`option-cond-stat-val-${e.index??""}`),ra(je,qe)},[()=>i().statName||"",()=>i().statValue||0]),H(q,K)};De(ce,q=>{i().type==="stat_greater"&&q(re)})}var te=T(ce,2);{var ae=q=>{var K=Cv(),ve=A(K),me=T(ve,2);me.__input=[Av,o],Ee($e=>{Be(ve,"for",`option-cond-flag-${e.index??""}`),Be(me,"id",`option-cond-flag-${e.index??""}`),ra(me,$e)},[()=>i().flagName||""]),H(q,K)};De(te,q=>{i().type==="flag_true"&&q(ae)})}var fe=T(V,2);De(fe,q=>{}),Ee(q=>{Be(_,"for",`option-text-${e.index??""}`),Be(k,"id",`option-text-${e.index??""}`),Be(x,"for",`option-next-${e.index??""}`),Be($,"id",`option-next-${e.index??""}`),$d(j,h(f)),Be(oe,"for",`option-cond-type-${e.index??""}`),Be(be,"id",`option-cond-type-${e.index??""}`),Ae!==(Ae=q)&&(be.value=(be.__value=q)??"",Yn(be,q))},[()=>i().type]),Bn(k,()=>t().text,q=>t().text=q),Zr($,()=>t().nextDialogueId,q=>t().nextDialogueId=q),al(J,()=>t().enabled,q=>t().enabled=q),al(Z,()=>t().visible,q=>t().visible=q),H(n,w),xt()}Lt(["change","input"]);var Et=ir(()=>B),vt=ir(()=>Kt),jv=ee("<option> <!></option>"),Pv=ee("<option> </option>"),Rv=ee("<option> </option>"),Ov=ee("<option> </option>"),Mv=ee("<option> </option>"),Lv=ee('<div class="option-content svelte-1de8com"><!></div>'),Dv=ee('<div><div class="option-header-row svelte-1de8com"><div class="option-header svelte-1de8com" role="button" tabindex="0"><span class="status-icons svelte-1de8com"><!></span> <span> </span></div> <button type="button" class="btn-icon danger" aria-label="Удалить вариант">×</button></div> <!></div>'),Fv=ee("<option> </option>"),$v=ee('<div class="dialogue-form svelte-1de8com"><div class="form-group svelte-1de8com"><label for="dialogue-id" class="svelte-1de8com">ID диалога</label> <input type="text" id="dialogue-id" class="input svelte-1de8com"/></div> <div class="form-group svelte-1de8com"><label for="dialogue-chapter" class="svelte-1de8com">Глава</label> <select id="dialogue-chapter" class="input select svelte-1de8com"><option>-- Не выбрано --</option><!></select></div> <div class="form-group svelte-1de8com"><label for="dialogue-text" class="svelte-1de8com">Текст</label> <textarea id="dialogue-text" class="textarea svelte-1de8com" rows="3"></textarea></div> <div class="media-section svelte-1de8com"><h4 class="svelte-1de8com">Медиа ресурсы</h4> <div class="form-group svelte-1de8com"><label for="dialogue-background" class="svelte-1de8com">Фон</label> <div class="input-group svelte-1de8com"><select id="dialogue-background" class="input select svelte-1de8com"><option>-- Нет --</option><!><!></select> <label class="btn-file svelte-1de8com">Загрузить <input type="file" accept="image/*,.riv" hidden/></label></div></div> <div class="form-group svelte-1de8com"><label for="dialogue-character" class="svelte-1de8com">Персонаж</label> <div class="input-group svelte-1de8com"><select id="dialogue-character" class="input select svelte-1de8com"><option>-- Нет --</option><!><!></select></div></div></div> <div class="options-section svelte-1de8com"><div class="section-header svelte-1de8com"><h4 class="svelte-1de8com">Варианты ответов</h4> <button class="btn small">+ Добавить</button></div> <!></div> <div class="links-section svelte-1de8com"><h4 class="svelte-1de8com">Авто-переход</h4> <select class="input select svelte-1de8com"><option>-- Нет --</option><!></select></div> <div class="form-actions svelte-1de8com"><button class="btn danger">Удалить сцену</button></div></div>'),Uv=ee('<div class="empty-state">Выберите сцену</div>');function Nv(n,e){Tt(e,!1);const t=["always","has_item","stat_greater","flag_true"];function r(m){m.options||(m.options=[]);const w=Xh();m.options.push(w),Et(Et().editingOptionIndex=m.options.length-1)}function i(m){if(Et().editingOptionIndex===m)Et(Et().editingOptionIndex=null);else{Et(Et().editingOptionIndex=m);const w=vt().currentDialogue?.options?.[m];w&&!w.visibilityCondition&&(w.visibilityCondition={type:"always"})}}function o(m,w){confirm("Удалить вариант ответа?")&&(m.options?.splice(w,1),Et().editingOptionIndex===w?Et(Et().editingOptionIndex=null):Et().editingOptionIndex&&Et().editingOptionIndex>w&&Et(Et().editingOptionIndex--))}rr();var u=kt(),f=Je(u);{var v=m=>{var w=$v(),I=A(w),_=T(A(I),2);_.__change=fe=>{const q=fe.target;Et(Et().selectedDialogueId=q.value)};var k=T(I,2),P=T(A(k),2);Ee(()=>{vt(),wn(()=>{Et()})}),P.__change=fe=>{const q=fe.target;Et(Et().selectedChapterId=q.value)};var x=A(P);x.value=x.__value="";var $=T(x);et($,1,()=>Et().data.chapters||[],Ct,(fe,q)=>{var K=jv(),ve=A(K),me=T(ve);{var $e=Ue=>{var je=ls();Ee(ze=>Se(je,`- ${ze??""}...`),[()=>h(q).description.substring(0,30)]),H(Ue,je)};De(me,Ue=>{h(q).description&&Ue($e)})}var Ne={};Ee(()=>{Se(ve,`${h(q).title??""} `),Ne!==(Ne=h(q).id)&&(K.value=(K.__value=h(q).id)??"")}),H(fe,K)});var z=T(k,2),M=T(A(z),2),U=T(z,2),F=T(A(U),2),C=T(A(F),2),j=A(C);Ee(()=>{vt(),wn(()=>{})});var ne=A(j);ne.value=ne.__value="";var le=T(ne);et(le,1,()=>vt().imageResources,Ct,(fe,q)=>{var K=Pv(),ve=A(K),me={};Ee(()=>{Se(ve,h(q).name),me!==(me=h(q).name)&&(K.value=(K.__value=h(q).name)??"")}),H(fe,K)});var _e=T(le);et(_e,1,()=>vt().riveResources,Ct,(fe,q)=>{var K=Rv(),ve=A(K),me={};Ee(()=>{Se(ve,`${h(q).name??""} (Rive)`),me!==(me=h(q).name)&&(K.value=(K.__value=h(q).name)??"")}),H(fe,K)});var he=T(j,2),ue=T(A(he));ue.__change=function(...fe){tr.uploadNewFile?.apply(this,fe)};var J=T(F,2),Y=T(A(J),2),W=A(Y);Ee(()=>{vt(),wn(()=>{})});var Z=A(W);Z.value=Z.__value="";var L=T(Z);et(L,1,()=>vt().imageResources,Ct,(fe,q)=>{var K=Ov(),ve=A(K),me={};Ee(()=>{Se(ve,h(q).name),me!==(me=h(q).name)&&(K.value=(K.__value=h(q).name)??"")}),H(fe,K)});var V=T(L);et(V,1,()=>vt().riveResources,Ct,(fe,q)=>{var K=Mv(),ve=A(K),me={};Ee(()=>{Se(ve,`${h(q).name??""} (Rive)`),me!==(me=h(q).name)&&(K.value=(K.__value=h(q).name)??"")}),H(fe,K)});var se=T(U,2),oe=A(se),be=T(A(oe),2);be.__click=()=>r(vt().currentDialogue);var Ae=T(oe,2);et(Ae,1,()=>vt().currentDialogue.options||[],Ct,(fe,q,K)=>{var ve=Dv();let me;var $e=A(ve),Ne=A($e);Ne.__click=()=>i(K),Ne.__keydown=l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),i(K))},Be(Ne,"aria-controls",`option-content-${K}`);var Ue=A(Ne),je=A(Ue);{var ze=l=>{var d=ls("👁️‍🗨️");H(l,d)},qe=l=>{var d=kt(),S=Je(d);{var O=de=>{var Fe=ls("🔒");H(de,Fe)},X=de=>{var Fe=ls("✅");H(de,Fe)};De(S,de=>{h(q).enabled?de(X,!1):de(O)},!0)}H(l,d)};De(je,l=>{h(q).visible?l(qe,!1):l(ze)})}var gt=T(Ue,2),lt=A(gt),St=T(Ne,2);St.__click=()=>o(vt().currentDialogue,K);var wt=T($e,2);{var y=l=>{var d=Lv();Be(d,"id",`option-content-${K}`);var S=A(d);xv(S,{get option(){return h(q)},index:K,get dialogues(){return Et().data.dialogues},get availableItems(){return vt().availableItems},get conditionTypes(){return t}}),H(l,d)};De(wt,l=>{Et().editingOptionIndex===K&&l(y)})}Ee(l=>{me=Ut(ve,1,"option-card svelte-1de8com",null,me,l),Be(Ne,"aria-expanded",Et().editingOptionIndex===K),Se(lt,`#${K+1} ${h(q).text??""}`)},[()=>({editing:Et().editingOptionIndex===K})]),H(fe,ve)});var ye=T(se,2),Pe=T(A(ye),2);Ee(()=>{vt(),wn(()=>{Et()})});var ce=A(Pe);ce.value=ce.__value="";var re=T(ce);et(re,1,()=>Et().data.dialogues,Ct,(fe,q)=>{var K=Fv(),ve=A(K),me={};Ee($e=>{Se(ve,`${h(q).id??""}: ${$e??""}...`),me!==(me=h(q).id)&&(K.value=(K.__value=h(q).id)??"")},[()=>h(q).text.substring(0,30)]),H(fe,K)});var te=T(ye,2),ae=A(te);ae.__click=()=>Ir.deleteDialogue(vt().currentDialogue.id),Bn(_,()=>vt().currentDialogue.id,fe=>vt(vt().currentDialogue.id=fe)),Zr(P,()=>vt().currentDialogue.chapterId,fe=>vt(vt().currentDialogue.chapterId=fe)),Bn(M,()=>vt().currentDialogue.text,fe=>vt(vt().currentDialogue.text=fe)),Zr(j,()=>vt().currentDialogue.backgroundImage,fe=>vt(vt().currentDialogue.backgroundImage=fe)),Zr(W,()=>vt().currentDialogue.characterImage,fe=>vt(vt().currentDialogue.characterImage=fe)),Zr(Pe,()=>vt().currentDialogue.nextDialogueId,fe=>vt(vt().currentDialogue.nextDialogueId=fe)),H(m,w)},p=m=>{var w=Uv();H(m,w)};De(f,m=>{vt().currentDialogue?m(v):m(p,!1)})}H(n,u),xt()}Lt(["change","click","keydown"]);var Ke=ir(()=>B),Bv=ee('<img class="icon-preview svelte-asgatj"/>'),Wv=ee('<div class="icon-placeholder svelte-asgatj">📦</div>'),Vv=ee("<option> </option>"),qv=ee('<div class="icon-preview-small svelte-asgatj"><img alt="Preview" class="preview-image svelte-asgatj"/> <span class="preview-name svelte-asgatj"> </span></div>'),Gv=ee("<option> </option>"),zv=ee('<div class="item-edit-form svelte-asgatj"><div class="edit-grid svelte-asgatj"><div class="form-group full-width-edit svelte-asgatj"><label class="svelte-asgatj">ID предмета</label> <input type="text" class="input svelte-asgatj" placeholder="item_unique_id"/></div> <div class="form-group full-width-edit svelte-asgatj"><label class="svelte-asgatj">Название</label> <input type="text" class="input svelte-asgatj" placeholder="Название предмета"/></div> <div class="form-group full-width-edit svelte-asgatj"><label class="svelte-asgatj">Описание</label> <textarea class="textarea svelte-asgatj" rows="2" placeholder="Описание предмета..."></textarea></div> <div class="form-group full-width-edit svelte-asgatj"><label class="svelte-asgatj">Иконка</label> <div class="input-group svelte-asgatj"><input type="text" class="input svelte-asgatj" placeholder="icon.png"/> <select class="input select svelte-asgatj"><option>-- Выбрать из загруженных --</option><!></select> <label class="btn-file svelte-asgatj">Загрузить <input type="file" accept="image/*" hidden/></label></div> <!></div> <div class="form-group svelte-asgatj"><label class="svelte-asgatj">Тип</label> <select class="item-type-select svelte-asgatj"></select></div></div></div>'),Hv=ee('<div><button type="button" class="item-info svelte-asgatj"><div class="item-header svelte-asgatj"><div class="item-icon svelte-asgatj"><!></div> <div class="item-details svelte-asgatj"><div class="item-name svelte-asgatj"> </div> <div class="item-meta svelte-asgatj"><span class="item-id svelte-asgatj"> </span> <span> </span></div></div></div> <div class="item-description svelte-asgatj"> <em>Нет описания</em></div></button> <div class="item-actions svelte-asgatj"><button class="btn-icon svelte-asgatj" title="Дублировать">⎘</button> <button class="btn-icon svelte-asgatj" title="Редактировать">✎️</button> <button class="btn-icon danger svelte-asgatj" title="Удалить">×</button></div> <!></div>'),Kv=ee('<div class="items-list svelte-asgatj"></div>'),Yv=ee('<div class="empty-items svelte-asgatj"><div class="empty-icon svelte-asgatj">📦</div> <div class="empty-text svelte-asgatj">Нет предметов</div> <div class="empty-subtext svelte-asgatj">Добавьте предметы для использования в условиях</div></div>'),Jv=ee('<div id="items-container" class="items-container svelte-asgatj"><!> <button class="btn primary full-width svelte-asgatj">+ Добавить предмет</button></div>'),Xv=ee('<div class="items-manager svelte-asgatj"><button type="button" class="section-header svelte-asgatj" aria-controls="items-container"><h4 class="svelte-asgatj"><span class="icon svelte-asgatj">📦</span> </h4> <span class="toggle-icon svelte-asgatj"> </span></button> <!></div>');function Qv(n,e){Tt(e,!1);const t=[{value:"tool",label:"Инструмент"},{value:"key",label:"Ключ"},{value:"consumable",label:"Расходуемый"},{value:"quest",label:"Квестовый"},{value:"misc",label:"Разное"}];function r(){if(!Ke().data)return;Ke().data.items||Ke(Ke().data.items=[]);const x={id:`item_${Date.now()}`,name:"Новый предмет",description:"Описание предмета",icon:"icon_default.png",type:"misc"};Ke().data.items.push(x),Ke(Ke().editingItemIndex=Ke().data.items.length-1)}function i(x){Ke().editingItemIndex===x?Ke(Ke().editingItemIndex=null):Ke(Ke().editingItemIndex=x)}function o(x){confirm("Удалить предмет?")&&Ke().data?.items&&(Ke().data.items.splice(x,1),Ke(Ke().editingItemIndex=null))}function u(x){if(!Ke().data?.items)return;const $=Ke().data.items[x],z={...$,id:`${$.id}_copy_${Date.now()}`,name:`${$.name} (копия)`};Ke().data.items.splice(x+1,0,z),Ke(Ke().editingItemIndex=x+1)}function f(x){return t.find($=>$.value===x)?.label||x}rr();var v=Xv(),p=A(v);p.__click=()=>Ke(Ke().showItems=!Ke().showItems);var m=A(p),w=T(A(m)),I=T(m,2),_=A(I),k=T(p,2);{var P=x=>{var $=Jv(),z=A($);{var M=C=>{var j=Kv();et(j,7,()=>Ke().data.items,ne=>ne.id,(ne,le,_e)=>{var he=Hv();let ue;var J=A(he);J.__click=()=>i(h(_e));var Y=A(J),W=A(Y),Z=A(W);{var L=Ue=>{var je=Bv();Ee(()=>{Be(je,"src",`https://vycjpmuyscfygstjjied.supabase.co/storage/v1/object/public/${Ke().selectedBucket}/${h(le).icon}`),Be(je,"alt",h(le).name)}),H(Ue,je)},V=Ue=>{var je=Wv();H(Ue,je)};De(Z,Ue=>{h(le).icon?Ue(L):Ue(V,!1)})}var se=T(W,2),oe=A(se),be=A(oe),Ae=T(oe,2),ye=A(Ae),Pe=A(ye),ce=T(ye,2);let re;var te=A(ce),ae=T(Y,2),fe=A(ae),q=T(J,2),K=A(q);K.__click=()=>u(h(_e));var ve=T(K,2);ve.__click=()=>i(h(_e));var me=T(ve,2);me.__click=()=>o(h(_e));var $e=T(q,2);{var Ne=Ue=>{var je=zv(),ze=A(je),qe=A(ze),gt=A(qe),lt=T(gt,2),St=T(qe,2),wt=A(St),y=T(wt,2),l=T(St,2),d=A(l),S=T(d,2),O=T(l,2),X=A(O),de=T(X,2),Fe=A(de),We=T(Fe,2);We.__change=nt=>{const Mt=nt.target;h(le).icon=Mt.value,wn(()=>Ke())};var Oe=A(We);Oe.value=Oe.__value="";var Ve=T(Oe);et(Ve,1,()=>Ke().storedFiles.filter(nt=>nt.name.match(/\.(png|jpg|jpeg|webp|gif|svg)$/i)),Ct,(nt,Mt)=>{var it=Vv(),ut=A(it),Ce={};Ee(()=>{Se(ut,h(Mt).name),Ce!==(Ce=h(Mt).name)&&(it.value=(it.__value=h(Mt).name)??"")}),H(nt,it)});var rt=T(We,2),Dt=T(A(rt));Dt.__change=function(...nt){tr.uploadNewFile?.apply(this,nt)};var bt=T(de,2);{var Zt=nt=>{var Mt=qv(),it=A(Mt),ut=T(it,2),Ce=A(ut);Ee(()=>{Be(it,"src",`https://vycjpmuyscfygstjjied.supabase.co/storage/v1/object/public/${Ke().selectedBucket}/${h(le).icon}`),Se(Ce,h(le).icon)}),H(nt,Mt)};De(bt,nt=>{h(le).icon&&nt(Zt)})}var Yt=T(O,2),jt=A(Yt),Ft=T(jt,2);Ee(()=>{h(le),wn(()=>{h(_e)})}),et(Ft,5,()=>t,Ct,(nt,Mt)=>{var it=Gv(),ut=A(it),Ce={};Ee(()=>{Se(ut,h(Mt).label),Ce!==(Ce=h(Mt).value)&&(it.value=(it.__value=h(Mt).value)??"")}),H(nt,it)}),Ee(()=>{Be(gt,"for",`item-id-${h(_e)??""}`),Be(lt,"id",`item-id-${h(_e)??""}`),Be(wt,"for",`item-name-${h(_e)??""}`),Be(y,"id",`item-name-${h(_e)??""}`),Be(d,"for",`item-desc-${h(_e)??""}`),Be(S,"id",`item-desc-${h(_e)??""}`),Be(X,"for",`item-icon-${h(_e)??""}`),Be(Fe,"id",`item-icon-${h(_e)??""}`),Be(jt,"for",`item-type-${h(_e)??""}`),Be(Ft,"id",`item-type-${h(_e)??""}`)}),Bn(lt,()=>h(le).id,nt=>(h(le).id=nt,wn(()=>Ke()))),Bn(y,()=>h(le).name,nt=>(h(le).name=nt,wn(()=>Ke()))),Bn(S,()=>h(le).description,nt=>(h(le).description=nt,wn(()=>Ke()))),Bn(Fe,()=>h(le).icon,nt=>(h(le).icon=nt,wn(()=>Ke()))),Zr(Ft,()=>h(le).type,nt=>(h(le).type=nt,wn(()=>Ke()))),H(Ue,je)};De($e,Ue=>{Ke().editingItemIndex===h(_e)&&Ue(Ne)})}Ee((Ue,je,ze)=>{ue=Ut(he,1,"item-row svelte-asgatj",null,ue,Ue),Be(J,"aria-label",`Редактировать предмет ${h(le).name??""}`),Se(be,h(le).name),Se(Pe,h(le).id),re=Ut(ce,1,"item-type-badge svelte-asgatj",null,re,je),Se(te,ze),Se(fe,`${h(le).description??""} || `)},[()=>({editing:Ke().editingItemIndex===h(_e)}),()=>({tool:h(le).type==="tool",key:h(le).type==="key",consumable:h(le).type==="consumable",quest:h(le).type==="quest",misc:h(le).type==="misc"}),()=>f(h(le).type)]),H(ne,he)}),H(C,j)},U=C=>{var j=Yv();H(C,j)};De(z,C=>{Ke().data?.items?.length?C(M):C(U,!1)})}var F=T(z,2);F.__click=r,H(x,$)};De(k,x=>{Ke().showItems&&x(P)})}Ee(()=>{Be(p,"title",Ke().showItems?"Скрыть предметы":"Показать предметы"),Be(p,"aria-expanded",Ke().showItems),Se(w,` Предметы (${(Ke().data?.items?.length||0)??""})`),Se(_,Ke().showItems?"▼":"▶")}),H(n,v),xt()}Lt(["click","change"]);Lt(["click"]);class Zv{#i=Re(ft({inventory:[],stats:{knowledge:0,courage:0,charisma:0}}));get player(){return h(this.#i)}set player(e){ie(this.#i,e,!0)}#n=Re(null);get storyData(){return h(this.#n)}set storyData(e){ie(this.#n,e,!0)}#e=Re("0");get currentDialogueId(){return h(this.#e)}set currentDialogueId(e){ie(this.#e,e,!0)}#s=Re(!0);get isLoading(){return h(this.#s)}set isLoading(e){ie(this.#s,e,!0)}#a=Re("");get error(){return h(this.#a)}set error(e){ie(this.#a,e,!0)}#t=Re(null);get selectedStory(){return h(this.#t)}set selectedStory(e){ie(this.#t,e,!0)}#r=Re(ft(["dracula","zombie","fairy_tale","minigames"]));get availableStories(){return h(this.#r)}set availableStories(e){ie(this.#r,e,!0)}get currentDialogue(){return this.findDialogue(this.currentDialogueId)}async loadStory(e){this.isLoading=!0,this.error="";try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();this.storyData=r,this.currentDialogueId=this.storyData?.dialogues?.[0]?.id||"0"}catch(t){const r=t instanceof Error?t.message:"Неизвестная ошибка";this.error=`Ошибка загрузки: ${r}`,console.error("Ошибка загрузки истории:",t)}finally{this.isLoading=!1}}findDialogue(e){return this.storyData?.dialogues.find(t=>t.id===e)}getItem(e){return this.storyData?.items.find(t=>t.id===e)}hasItem(e){return this.player.inventory.includes(e)}addItem(e){this.player.inventory.includes(e)||(this.player.inventory=[...this.player.inventory,e])}removeItem(e){this.player.inventory=this.player.inventory.filter(t=>t!==e)}changeStat(e,t){e in this.player.stats&&(this.player.stats[e]+=t)}getStat(e){return this.player.stats[e]??0}checkVisibilityCondition(e){if(e.visibleIf&&e.visibleIf.hasItem)return this.hasItem(e.visibleIf.hasItem);if(e.visibilityCondition)switch(e.visibilityCondition.type){case"always":return!0;case"has_item":return e.visibilityCondition.itemId?this.hasItem(e.visibilityCondition.itemId):!0;case"stat_greater":return e.visibilityCondition.statName&&e.visibilityCondition.statValue!==void 0?this.getStat(e.visibilityCondition.statName)>e.visibilityCondition.statValue:!0;case"flag_true":return!0;default:return!0}return!0}runActions(e){e&&e.forEach(t=>{switch(t.type){case"add_item":t.id&&this.addItem(t.id);break;case"remove_item":t.id&&this.removeItem(t.id);break;case"stat_change":t.stat&&t.value!==void 0&&this.changeStat(t.stat,t.value);break;case"set_flag":console.log(`Set flag: ${t.flagName} = ${t.value}`);break;default:console.warn("Неизвестный тип действия:",t.type)}})}goToDialogue(e){this.currentDialogueId=e}reset(){this.player.inventory=[],this.player.stats={knowledge:0,courage:0,charisma:0},this.currentDialogueId=this.storyData?.dialogues[0]?.id||"0",this.error=""}getInventoryItems(){return this.player.inventory.map(e=>this.getItem(e)).filter(e=>e!==void 0)}}const It=new Zv;var ms={exports:{}},ep=ms.exports,Ml;function tp(){return Ml||(Ml=1,(function(n,e){(function(r,i){n.exports=i()})(ep,()=>(()=>{var t=[,((u,f,v)=>{v.r(f),v.d(f,{default:()=>m});var p=(()=>{var w=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(I={}){var _=I,k,P;_.ready=new Promise((s,a)=>{k=s,P=a});function x(){function s(R){const G=g;c=a=0,g=new Map,G.forEach(Q=>{try{Q(R)}catch(N){console.error(N)}}),this.pb(),b&&b.Tb()}let a=0,c=0,g=new Map,b=null,E=null;this.requestAnimationFrame=function(R){a||(a=requestAnimationFrame(s.bind(this)));const G=++c;return g.set(G,R),G},this.cancelAnimationFrame=function(R){g.delete(R),a&&g.size==0&&(cancelAnimationFrame(a),a=0)},this.Rb=function(R){E&&(document.body.remove(E),E=null),R||(E=document.createElement("div"),E.style.backgroundColor="black",E.style.position="fixed",E.style.right=0,E.style.top=0,E.style.color="white",E.style.padding="4px",E.innerHTML="RIVE FPS",R=function(G){E.innerHTML="RIVE FPS "+G.toFixed(1)},document.body.appendChild(E)),b=new function(){let G=0,Q=0;this.Tb=function(){var N=performance.now();Q?(++G,N-=Q,1e3<N&&(R(1e3*G/N),G=Q=0)):(Q=N,G=0)}}},this.Ob=function(){E&&(document.body.remove(E),E=null),b=null},this.pb=function(){}}function $(s){console.assert(!0);const a=new Map;let c=-1/0;this.push=function(g){return g=g+((1<<s)-1)>>s,a.has(g)&&clearTimeout(a.get(g)),a.set(g,setTimeout(function(){a.delete(g),a.length==0?c=-1/0:g==c&&(c=Math.max(...a.keys()),console.assert(c<g))},1e3)),c=Math.max(g,c),c<<s}}const z=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){z&&z();let s=_.decodeAudio;_.decodeAudio=function(b,E){b=s(b),E(b)};let a=_.decodeFont;_.decodeFont=function(b,E){b=a(b),E(b)};const c=_.FileAssetLoader;_.ptrToAsset=b=>{let E=_.ptrToFileAsset(b);return E.isImage?_.ptrToImageAsset(b):E.isFont?_.ptrToFontAsset(b):E.isAudio?_.ptrToAudioAsset(b):E},_.CustomFileAssetLoader=c.extend("CustomFileAssetLoader",{__construct:function({loadContents:b}){this.__parent.__construct.call(this),this.Gb=b},loadContents:function(b,E){return b=_.ptrToAsset(b),this.Gb(b,E)}}),_.CDNFileAssetLoader=c.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(b){let E=_.ptrToAsset(b);return b=E.cdnUuid,b===""?!1:((function(R,G){var Q=new XMLHttpRequest;Q.responseType="arraybuffer",Q.onreadystatechange=function(){Q.readyState==4&&Q.status==200&&G(Q)},Q.open("GET",R,!0),Q.send(null)})(E.cdnBaseUrl+"/"+b,R=>{E.decode(new Uint8Array(R.response))}),!0)}}),_.FallbackFileAssetLoader=c.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(b){this.lb.push(b)},loadContents:function(b,E){for(let R of this.lb)if(R.loadContents(b,E))return!0;return!1}});let g=_.computeAlignment;_.computeAlignment=function(b,E,R,G,Q=1){return g.call(this,b,E,R,G,Q)}};const M="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),U=new function(){function s(){if(!a){let Qe=function(tt,Te,Pt){if(Te=ge.createShader(Te),ge.shaderSource(Te,Pt),ge.compileShader(Te),Pt=ge.getShaderInfoLog(Te),0<(Pt||"").length)throw Pt;ge.attachShader(tt,Te)};var D=document.createElement("canvas"),we={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let ge;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(ge=D.getContext("webgl",we),c=1,!ge)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(ge=D.getContext("webgl2",we))c=2;else if(ge=D.getContext("webgl",we))c=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(ge=new Proxy(ge,{get(tt,Te){if(tt.isContextLost()){if(Q||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",Te),Q=!0),typeof tt[Te]=="function")return function(){}}else return typeof tt[Te]=="function"?function(...Pt){return tt[Te].apply(tt,Pt)}:tt[Te]},set(tt,Te,Pt){if(tt.isContextLost())Q||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+Te),Q=!0);else return tt[Te]=Pt,!0}}),g=Math.min(ge.getParameter(ge.MAX_RENDERBUFFER_SIZE),ge.getParameter(ge.MAX_TEXTURE_SIZE)),D=ge.createProgram(),Qe(D,ge.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),Qe(D,ge.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),ge.bindAttribLocation(D,0,"vertex"),ge.bindAttribLocation(D,1,"uv"),ge.linkProgram(D),we=ge.getProgramInfoLog(D),0<(we||"").trim().length)throw we;b=ge.getUniformLocation(D,"mat"),E=ge.getUniformLocation(D,"translate"),ge.useProgram(D),ge.bindBuffer(ge.ARRAY_BUFFER,ge.createBuffer()),ge.enableVertexAttribArray(0),ge.enableVertexAttribArray(1),ge.bindBuffer(ge.ELEMENT_ARRAY_BUFFER,ge.createBuffer()),ge.uniform1i(ge.getUniformLocation(D,"image"),0),ge.pixelStorei(ge.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),a=ge}return!0}let a=null,c=0,g=0,b=null,E=null,R=0,G=0,Q=!1;s(),this.hc=function(){return s(),g},this.Mb=function(D){a.deleteTexture&&a.deleteTexture(D)},this.Lb=function(D){if(!s())return null;const we=a.createTexture();return we?(a.bindTexture(a.TEXTURE_2D,we),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,D),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),c==2?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR),a.generateMipmap(a.TEXTURE_2D)):a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),we):null};const N=new $(8),ke=new $(8),Ie=new $(10),Me=new $(10);this.Qb=function(D,we,ge,Qe,tt){if(s()){var Te=N.push(D),Pt=ke.push(we);if(a.canvas){(a.canvas.width!=Te||a.canvas.height!=Pt)&&(a.canvas.width=Te,a.canvas.height=Pt),a.viewport(0,Pt-we,D,we),a.disable(a.SCISSOR_TEST),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.enable(a.SCISSOR_TEST),ge.sort((ct,An)=>An.xb-ct.xb),Te=Ie.push(Qe),R!=Te&&(a.bufferData(a.ARRAY_BUFFER,8*Te,a.DYNAMIC_DRAW),R=Te),Te=0;for(var Jt of ge)a.bufferSubData(a.ARRAY_BUFFER,Te,Jt.Ua),Te+=4*Jt.Ua.length;console.assert(Te==4*Qe);for(var En of ge)a.bufferSubData(a.ARRAY_BUFFER,Te,En.Db),Te+=4*En.Db.length;console.assert(Te==8*Qe),Te=Me.push(tt),G!=Te&&(a.bufferData(a.ELEMENT_ARRAY_BUFFER,2*Te,a.DYNAMIC_DRAW),G=Te),Jt=0;for(var hr of ge)a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,Jt,hr.indices),Jt+=2*hr.indices.length;console.assert(Jt==2*tt),hr=0,En=!0,Te=Jt=0;for(const ct of ge){ct.image.Ka!=hr&&(a.bindTexture(a.TEXTURE_2D,ct.image.Ja||null),hr=ct.image.Ka),ct.mc?(a.scissor(ct.Za,Pt-ct.$a-ct.kb,ct.Ac,ct.kb),En=!0):En&&(a.scissor(0,Pt-we,D,we),En=!1),ge=2/D;const An=-2/we;a.uniform4f(b,ct.ha[0]*ge*ct.Ba,ct.ha[1]*An*ct.Ca,ct.ha[2]*ge*ct.Ba,ct.ha[3]*An*ct.Ca),a.uniform2f(E,ct.ha[4]*ge*ct.Ba+ge*(ct.Za-ct.ic*ct.Ba)-1,ct.ha[5]*An*ct.Ca+An*(ct.$a-ct.jc*ct.Ca)+1),a.vertexAttribPointer(0,2,a.FLOAT,!1,0,Te),a.vertexAttribPointer(1,2,a.FLOAT,!1,0,Te+4*Qe),a.drawElements(a.TRIANGLES,ct.indices.length,a.UNSIGNED_SHORT,Jt),Te+=4*ct.Ua.length,Jt+=2*ct.indices.length}console.assert(Te==4*Qe),console.assert(Jt==2*tt)}}},this.canvas=function(){return s()&&a.canvas}},F=_.onRuntimeInitialized;_.onRuntimeInitialized=function(){function s(pe){switch(pe){case N.srcOver:return"source-over";case N.screen:return"screen";case N.overlay:return"overlay";case N.darken:return"darken";case N.lighten:return"lighten";case N.colorDodge:return"color-dodge";case N.colorBurn:return"color-burn";case N.hardLight:return"hard-light";case N.softLight:return"soft-light";case N.difference:return"difference";case N.exclusion:return"exclusion";case N.multiply:return"multiply";case N.hue:return"hue";case N.saturation:return"saturation";case N.color:return"color";case N.luminosity:return"luminosity"}}function a(pe){return"rgba("+((16711680&pe)>>>16)+","+((65280&pe)>>>8)+","+((255&pe)>>>0)+","+((4278190080&pe)>>>24)/255+")"}function c(){0<Pt.length&&(U.Qb(Te.drawWidth(),Te.drawHeight(),Pt,Jt,En),Pt=[],En=Jt=0,Te.reset(512,512));for(const pe of tt){for(const xe of pe.H)xe();pe.H=[]}tt.clear()}F&&F();var g=_.RenderPaintStyle;const b=_.RenderPath,E=_.RenderPaint,R=_.Renderer,G=_.StrokeCap,Q=_.StrokeJoin,N=_.BlendMode,ke=g.fill,Ie=g.stroke,Me=_.FillRule.evenOdd;let D=1;var we=_.RenderImage.extend("CanvasRenderImage",{__construct:function({la:pe,xa:xe}={}){this.__parent.__construct.call(this),this.Ka=D,D=D+1&2147483647||1,this.la=pe,this.xa=xe},__destruct:function(){this.Ja&&(U.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(pe){var xe=this;xe.xa&&xe.xa(xe);var at=new Image;xe.Xa=URL.createObjectURL(new Blob([pe],{type:"image/png"})),at.onload=function(){xe.Fb=at,xe.Ja=U.Lb(at),xe.size(at.width,at.height),xe.la&&xe.la(xe)},at.src=xe.Xa}}),ge=b.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(pe,xe,at,dt,Ze,ot,mt){var yt=this.T,_n=yt.addPath;pe=pe.T;const qt=new DOMMatrix;qt.a=xe,qt.b=at,qt.c=dt,qt.d=Ze,qt.e=ot,qt.f=mt,_n.call(yt,pe,qt)},fillRule:function(pe){this.Wa=pe},moveTo:function(pe,xe){this.T.moveTo(pe,xe)},lineTo:function(pe,xe){this.T.lineTo(pe,xe)},cubicTo:function(pe,xe,at,dt,Ze,ot){this.T.bezierCurveTo(pe,xe,at,dt,Ze,ot)},close:function(){this.T.closePath()}}),Qe=E.extend("CanvasRenderPaint",{color:function(pe){this.Ya=a(pe)},thickness:function(pe){this.Ib=pe},join:function(pe){switch(pe){case Q.miter:this.Ia="miter";break;case Q.round:this.Ia="round";break;case Q.bevel:this.Ia="bevel"}},cap:function(pe){switch(pe){case G.butt:this.Ha="butt";break;case G.round:this.Ha="round";break;case G.square:this.Ha="square"}},style:function(pe){this.Hb=pe},blendMode:function(pe){this.Eb=s(pe)},clearGradient:function(){this.ja=null},linearGradient:function(pe,xe,at,dt){this.ja={zb:pe,Ab:xe,cb:at,eb:dt,Ra:[]}},radialGradient:function(pe,xe,at,dt){this.ja={zb:pe,Ab:xe,cb:at,eb:dt,Ra:[],ec:!0}},addStop:function(pe,xe){this.ja.Ra.push({color:pe,stop:xe})},completeGradient:function(){},draw:function(pe,xe,at){let dt=this.Hb;var Ze=this.Ya,ot=this.ja;if(pe.globalCompositeOperation=this.Eb,ot!=null){Ze=ot.zb;var mt=ot.Ab;const _n=ot.cb;var yt=ot.eb;const qt=ot.Ra;ot.ec?(ot=_n-Ze,yt-=mt,Ze=pe.createRadialGradient(Ze,mt,0,Ze,mt,Math.sqrt(ot*ot+yt*yt))):Ze=pe.createLinearGradient(Ze,mt,_n,yt);for(let dn=0,Gt=qt.length;dn<Gt;dn++)mt=qt[dn],Ze.addColorStop(mt.stop,a(mt.color));this.Ya=Ze,this.ja=null}switch(dt){case Ie:pe.strokeStyle=Ze,pe.lineWidth=this.Ib,pe.lineCap=this.Ha,pe.lineJoin=this.Ia,pe.stroke(xe);break;case ke:pe.fillStyle=Ze,pe.fill(xe,at)}}});const tt=new Set;let Te=null,Pt=[],Jt=0,En=0;var hr=_.CanvasRenderer=R.extend("Renderer",{__construct:function(pe){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=pe.getContext("2d"),this.Va=pe,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const pe=this.S.length-6;if(6>pe)throw"restore() called without matching save().";this.S.splice(pe),this.H.push(this.C.restore.bind(this.C))},transform:function(pe,xe,at,dt,Ze,ot){const mt=this.S,yt=mt.length-6;mt.splice(yt,6,mt[yt]*pe+mt[yt+2]*xe,mt[yt+1]*pe+mt[yt+3]*xe,mt[yt]*at+mt[yt+2]*dt,mt[yt+1]*at+mt[yt+3]*dt,mt[yt]*Ze+mt[yt+2]*ot+mt[yt+4],mt[yt+1]*Ze+mt[yt+3]*ot+mt[yt+5]),this.H.push(this.C.transform.bind(this.C,pe,xe,at,dt,Ze,ot))},rotate:function(pe){const xe=Math.sin(pe);pe=Math.cos(pe),this.transform(pe,xe,-xe,pe,0,0)},_drawPath:function(pe,xe){this.H.push(xe.draw.bind(xe,this.C,pe.T,pe.Wa===Me?"evenodd":"nonzero"))},_drawRiveImage:function(pe,xe,at,dt){var Ze=pe.Fb;if(Ze){var ot=this.C,mt=s(at);this.H.push(function(){ot.globalCompositeOperation=mt,ot.globalAlpha=dt,ot.drawImage(Ze,0,0),ot.globalAlpha=1})}},_getMatrix:function(pe){const xe=this.S,at=xe.length-6;for(let dt=0;6>dt;++dt)pe[dt]=xe[at+dt]},_drawImageMesh:function(pe,xe,at,dt,Ze,ot,mt,yt,_n,qt,dn){xe=this.C.canvas.width;var Gt=this.C.canvas.height;const Wo=qt-yt,Vo=dn-_n;yt=Math.max(yt,0),_n=Math.max(_n,0),qt=Math.min(qt,xe),dn=Math.min(dn,Gt);const Ii=qt-yt,Si=dn-_n;if(console.assert(Ii<=Math.min(Wo,xe)),console.assert(Si<=Math.min(Vo,Gt)),!(0>=Ii||0>=Si)){qt=Ii<Wo||Si<Vo,xe=dn=1;var vr=Math.ceil(Ii*dn),pr=Math.ceil(Si*xe);Gt=U.hc(),vr>Gt&&(dn*=Gt/vr,vr=Gt),pr>Gt&&(xe*=Gt/pr,pr=Gt),Te||(Te=new _.DynamicRectanizer(Gt),Te.reset(512,512)),Gt=Te.addRect(vr,pr),0>Gt&&(c(),tt.add(this),Gt=Te.addRect(vr,pr),console.assert(0<=Gt));var qo=Gt&65535,Go=Gt>>16;Pt.push({ha:this.S.slice(this.S.length-6),image:pe,Za:qo,$a:Go,ic:yt,jc:_n,Ac:vr,kb:pr,Ba:dn,Ca:xe,Ua:new Float32Array(Ze),Db:new Float32Array(ot),indices:new Uint16Array(mt),mc:qt,xb:pe.Ka<<1|(qt?1:0)}),Jt+=Ze.length,En+=mt.length;var $r=this.C,vc=s(at);this.H.push(function(){$r.save(),$r.resetTransform(),$r.globalCompositeOperation=vc,$r.globalAlpha=dt;const zo=U.canvas();zo&&$r.drawImage(zo,qo,Go,vr,pr,yt,_n,Ii,Si),$r.restore()})}},_clipPath:function(pe){this.H.push(this.C.clip.bind(this.C,pe.T,pe.Wa===Me?"evenodd":"nonzero"))},clear:function(){tt.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(pe,xe){this.transform(1,0,0,1,pe,xe)}});_.makeRenderer=function(pe){const xe=new hr(pe),at=xe.C;return new Proxy(xe,{get(dt,Ze){if(typeof dt[Ze]=="function")return function(...ot){return dt[Ze].apply(dt,ot)};if(typeof at[Ze]=="function"){if(-1<M.indexOf(Ze))throw Error("RiveException: Method call to '"+Ze+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(...ot){xe.H.push(at[Ze].bind(at,...ot))}}return dt[Ze]},set(dt,Ze,ot){if(Ze in at)return xe.H.push(()=>{at[Ze]=ot}),!0}})},_.decodeImage=function(pe,xe){new we({la:xe}).decode(pe)},_.renderFactory={makeRenderPaint:function(){return new Qe},makeRenderPath:function(){return new ge},makeRenderImage:function(){let pe=An;return new we({xa:()=>{pe.total++},la:()=>{if(pe.loaded++,pe.loaded===pe.total){const xe=pe.ready;xe&&(xe(),pe.ready=null)}}})}};let ct=_.load,An=null;_.load=function(pe,xe,at=!0){const dt=new _.FallbackFileAssetLoader;return xe!==void 0&&dt.addLoader(xe),at&&(xe=new _.CDNFileAssetLoader,dt.addLoader(xe)),new Promise(function(Ze){let ot=null;An={total:0,loaded:0,ready:function(){Ze(ot)}},ot=ct(pe,dt),An.total==0&&Ze(ot)})};let hc=_.RendererWrapper.prototype.align;_.RendererWrapper.prototype.align=function(pe,xe,at,dt,Ze=1){hc.call(this,pe,xe,at,dt,Ze)},g=new x,_.requestAnimationFrame=g.requestAnimationFrame.bind(g),_.cancelAnimationFrame=g.cancelAnimationFrame.bind(g),_.enableFPSCounter=g.Rb.bind(g),_.disableFPSCounter=g.Ob,g.pb=c,_.resolveAnimationFrame=c,_.cleanup=function(){Te&&Te.delete()}};var C=Object.assign({},_),j="./this.program",ne=typeof window=="object",le=typeof importScripts=="function",_e="",he,ue;(ne||le)&&(le?_e=self.location.href:typeof document<"u"&&document.currentScript&&(_e=document.currentScript.src),w&&(_e=w),_e.indexOf("blob:")!==0?_e=_e.substr(0,_e.replace(/[?#].*/,"").lastIndexOf("/")+1):_e="",le&&(ue=s=>{var a=new XMLHttpRequest;return a.open("GET",s,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),he=(s,a,c)=>{var g=new XMLHttpRequest;g.open("GET",s,!0),g.responseType="arraybuffer",g.onload=()=>{g.status==200||g.status==0&&g.response?a(g.response):c()},g.onerror=c,g.send(null)});var J=_.print||console.log.bind(console),Y=_.printErr||console.error.bind(console);Object.assign(_,C),C=null,_.thisProgram&&(j=_.thisProgram);var W;_.wasmBinary&&(W=_.wasmBinary),_.noExitRuntime,typeof WebAssembly!="object"&&Ne("no native wasm support detected");var Z,L,V=!1,se,oe,be,Ae,ye,Pe,ce,re;function te(){var s=Z.buffer;_.HEAP8=se=new Int8Array(s),_.HEAP16=be=new Int16Array(s),_.HEAP32=ye=new Int32Array(s),_.HEAPU8=oe=new Uint8Array(s),_.HEAPU16=Ae=new Uint16Array(s),_.HEAPU32=Pe=new Uint32Array(s),_.HEAPF32=ce=new Float32Array(s),_.HEAPF64=re=new Float64Array(s)}var ae,fe=[],q=[],K=[];function ve(){var s=_.preRun.shift();fe.unshift(s)}var me=0,$e=null;function Ne(s){throw _.onAbort&&_.onAbort(s),s="Aborted("+s+")",Y(s),V=!0,s=new WebAssembly.RuntimeError(s+". Build with -sASSERTIONS for more info."),P(s),s}function Ue(s){return s.startsWith("data:application/octet-stream;base64,")}var je;if(je="canvas_advanced.wasm",!Ue(je)){var ze=je;je=_.locateFile?_.locateFile(ze,_e):_e+ze}function qe(s){if(s==je&&W)return new Uint8Array(W);if(ue)return ue(s);throw"both async and sync fetching of the wasm failed"}function gt(s){if(!W&&(ne||le)){if(typeof fetch=="function"&&!s.startsWith("file://"))return fetch(s,{credentials:"same-origin"}).then(a=>{if(!a.ok)throw"failed to load wasm binary file at '"+s+"'";return a.arrayBuffer()}).catch(()=>qe(s));if(he)return new Promise((a,c)=>{he(s,g=>a(new Uint8Array(g)),c)})}return Promise.resolve().then(()=>qe(s))}function lt(s,a,c){return gt(s).then(g=>WebAssembly.instantiate(g,a)).then(g=>g).then(c,g=>{Y("failed to asynchronously prepare wasm: "+g),Ne(g)})}function St(s,a){var c=je;return W||typeof WebAssembly.instantiateStreaming!="function"||Ue(c)||c.startsWith("file://")||typeof fetch!="function"?lt(c,s,a):fetch(c,{credentials:"same-origin"}).then(g=>WebAssembly.instantiateStreaming(g,s).then(a,function(b){return Y("wasm streaming compile failed: "+b),Y("falling back to ArrayBuffer instantiation"),lt(c,s,a)}))}var wt,y,l={460492:(s,a,c,g,b)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=s,window.h.I.capture=a,window.h.I.La=c,window.h.ga={},window.h.ga.stopped=g,window.h.ga.yb=b;let E=window.h;E.D=[],E.yc=function(R){for(var G=0;G<E.D.length;++G)if(E.D[G]==null)return E.D[G]=R,G;return E.D.push(R),E.D.length-1},E.Cb=function(R){for(E.D[R]=null;0<E.D.length&&E.D[E.D.length-1]==null;)E.D.pop()},E.Sc=function(R){for(var G=0;G<E.D.length;++G)if(E.D[G]==R)return E.Cb(G)},E.ra=function(R){return E.D[R]},E.Ta=["touchend","click"],E.unlock=function(){for(var R=0;R<E.D.length;++R){var G=E.D[R];G!=null&&G.J!=null&&G.state===E.ga.yb&&G.J.resume().then(()=>{Fo(G.qb)},Q=>{console.error("Failed to resume audiocontext",Q)})}E.Ta.map(function(Q){document.removeEventListener(Q,E.unlock,!0)})},E.Ta.map(function(R){document.addEventListener(R,E.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(s){document.removeEventListener(s,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var s=new(window.AudioContext||window.webkitAudioContext),a=s.sampleRate;return s.close(),a}catch{return 0}},463249:(s,a,c,g,b,E)=>{if(typeof window.h>"u")return-1;var R={},G={};return s==window.h.I.ya&&c!=0&&(G.sampleRate=c),R.J=new(window.AudioContext||window.webkitAudioContext)(G),R.J.suspend(),R.state=window.h.ga.stopped,c=0,s!=window.h.I.ya&&(c=a),R.Z=R.J.createScriptProcessor(g,c,a),R.Z.onaudioprocess=function(Q){if((R.sa==null||R.sa.length==0)&&(R.sa=new Float32Array(ce.buffer,b,g*a)),s==window.h.I.capture||s==window.h.I.La){for(var N=0;N<a;N+=1)for(var ke=Q.inputBuffer.getChannelData(N),Ie=R.sa,Me=0;Me<g;Me+=1)Ie[Me*a+N]=ke[Me];$o(E,g,b)}if(s==window.h.I.ya||s==window.h.I.La)for(Uo(E,g,b),N=0;N<Q.outputBuffer.numberOfChannels;++N)for(ke=Q.outputBuffer.getChannelData(N),Ie=R.sa,Me=0;Me<g;Me+=1)ke[Me]=Ie[Me*a+N];else for(N=0;N<Q.outputBuffer.numberOfChannels;++N)Q.outputBuffer.getChannelData(N).fill(0)},s!=window.h.I.capture&&s!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(Q){R.Da=R.J.createMediaStreamSource(Q),R.Da.connect(R.Z),R.Z.connect(R.J.destination)}).catch(function(Q){console.log("Failed to get user media: "+Q)}),s==window.h.I.ya&&R.Z.connect(R.J.destination),R.qb=E,window.h.yc(R)},466126:s=>window.h.ra(s).J.sampleRate,466199:s=>{s=window.h.ra(s),s.Z!==void 0&&(s.Z.onaudioprocess=function(){},s.Z.disconnect(),s.Z=void 0),s.Da!==void 0&&(s.Da.disconnect(),s.Da=void 0),s.J.close(),s.J=void 0,s.qb=void 0},466599:s=>{window.h.Cb(s)},466649:s=>{s=window.h.ra(s),s.J.resume(),s.state=window.h.ga.yb},466788:s=>{s=window.h.ra(s),s.J.suspend(),s.state=window.h.ga.stopped}},d=s=>{for(;0<s.length;)s.shift()(_)},S=(s,a)=>{for(var c=0,g=s.length-1;0<=g;g--){var b=s[g];b==="."?s.splice(g,1):b===".."?(s.splice(g,1),c++):c&&(s.splice(g,1),c--)}if(a)for(;c;c--)s.unshift("..");return s},O=s=>{var a=s.charAt(0)==="/",c=s.substr(-1)==="/";return(s=S(s.split("/").filter(g=>!!g),!a).join("/"))||a||(s="."),s&&c&&(s+="/"),(a?"/":"")+s},X=s=>{var a=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(s).slice(1);return s=a[0],a=a[1],!s&&!a?".":(a&&(a=a.substr(0,a.length-1)),s+a)},de=s=>{if(s==="/")return"/";s=O(s),s=s.replace(/\/$/,"");var a=s.lastIndexOf("/");return a===-1?s:s.substr(a+1)},Fe=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return s=>crypto.getRandomValues(s);Ne("initRandomDevice")},We=s=>(We=Fe())(s);function Oe(){for(var s="",a=!1,c=arguments.length-1;-1<=c&&!a;c--){if(a=0<=c?arguments[c]:"/",typeof a!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!a)return"";s=a+"/"+s,a=a.charAt(0)==="/"}return s=S(s.split("/").filter(g=>!!g),!a).join("/"),(a?"/":"")+s||"."}var Ve=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,rt=(s,a,c)=>{var g=a+c;for(c=a;s[c]&&!(c>=g);)++c;if(16<c-a&&s.buffer&&Ve)return Ve.decode(s.subarray(a,c));for(g="";a<c;){var b=s[a++];if(b&128){var E=s[a++]&63;if((b&224)==192)g+=String.fromCharCode((b&31)<<6|E);else{var R=s[a++]&63;b=(b&240)==224?(b&15)<<12|E<<6|R:(b&7)<<18|E<<12|R<<6|s[a++]&63,65536>b?g+=String.fromCharCode(b):(b-=65536,g+=String.fromCharCode(55296|b>>10,56320|b&1023))}}else g+=String.fromCharCode(b)}return g},Dt=[],bt=s=>{for(var a=0,c=0;c<s.length;++c){var g=s.charCodeAt(c);127>=g?a++:2047>=g?a+=2:55296<=g&&57343>=g?(a+=4,++c):a+=3}return a},Zt=(s,a,c,g)=>{if(!(0<g))return 0;var b=c;g=c+g-1;for(var E=0;E<s.length;++E){var R=s.charCodeAt(E);if(55296<=R&&57343>=R){var G=s.charCodeAt(++E);R=65536+((R&1023)<<10)|G&1023}if(127>=R){if(c>=g)break;a[c++]=R}else{if(2047>=R){if(c+1>=g)break;a[c++]=192|R>>6}else{if(65535>=R){if(c+2>=g)break;a[c++]=224|R>>12}else{if(c+3>=g)break;a[c++]=240|R>>18,a[c++]=128|R>>12&63}a[c++]=128|R>>6&63}a[c++]=128|R&63}}return a[c]=0,c-b};function Yt(s,a){var c=Array(bt(s)+1);return s=Zt(s,c,0,c.length),a&&(c.length=s),c}var jt=[];function Ft(s,a){jt[s]={input:[],F:[],V:a},Us(s,nt)}var nt={open:function(s){var a=jt[s.node.za];if(!a)throw new Le(43);s.s=a,s.seekable=!1},close:function(s){s.s.V.qa(s.s)},qa:function(s){s.s.V.qa(s.s)},read:function(s,a,c,g){if(!s.s||!s.s.V.jb)throw new Le(60);for(var b=0,E=0;E<g;E++){try{var R=s.s.V.jb(s.s)}catch{throw new Le(29)}if(R===void 0&&b===0)throw new Le(6);if(R==null)break;b++,a[c+E]=R}return b&&(s.node.timestamp=Date.now()),b},write:function(s,a,c,g){if(!s.s||!s.s.V.Oa)throw new Le(60);try{for(var b=0;b<g;b++)s.s.V.Oa(s.s,a[c+b])}catch{throw new Le(29)}return g&&(s.node.timestamp=Date.now()),b}},Mt={jb:function(){e:{if(!Dt.length){var s=null;if(typeof window<"u"&&typeof window.prompt=="function"?(s=window.prompt("Input: "),s!==null&&(s+=`
`)):typeof readline=="function"&&(s=readline(),s!==null&&(s+=`
`)),!s){s=null;break e}Dt=Yt(s,!0)}s=Dt.shift()}return s},Oa:function(s,a){a===null||a===10?(J(rt(s.F,0)),s.F=[]):a!=0&&s.F.push(a)},qa:function(s){s.F&&0<s.F.length&&(J(rt(s.F,0)),s.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},it={Oa:function(s,a){a===null||a===10?(Y(rt(s.F,0)),s.F=[]):a!=0&&s.F.push(a)},qa:function(s){s.F&&0<s.F.length&&(Y(rt(s.F,0)),s.F=[])}};function ut(s,a){var c=s.j?s.j.length:0;c>=a||(a=Math.max(a,c*(1048576>c?2:1.125)>>>0),c!=0&&(a=Math.max(a,256)),c=s.j,s.j=new Uint8Array(a),0<s.v&&s.j.set(c.subarray(0,s.v),0))}var Ce={O:null,U(){return Ce.createNode(null,"/",16895,0)},createNode(s,a,c,g){if((c&61440)===24576||(c&61440)===4096)throw new Le(63);return Ce.O||(Ce.O={dir:{node:{Y:Ce.l.Y,P:Ce.l.P,ka:Ce.l.ka,va:Ce.l.va,vb:Ce.l.vb,Bb:Ce.l.Bb,wb:Ce.l.wb,tb:Ce.l.tb,Ea:Ce.l.Ea},stream:{ba:Ce.m.ba}},file:{node:{Y:Ce.l.Y,P:Ce.l.P},stream:{ba:Ce.m.ba,read:Ce.m.read,write:Ce.m.write,pa:Ce.m.pa,mb:Ce.m.mb,ob:Ce.m.ob}},link:{node:{Y:Ce.l.Y,P:Ce.l.P,ma:Ce.l.ma},stream:{}},ab:{node:{Y:Ce.l.Y,P:Ce.l.P},stream:Gu}}),c=so(s,a,c,g),(c.mode&61440)===16384?(c.l=Ce.O.dir.node,c.m=Ce.O.dir.stream,c.j={}):(c.mode&61440)===32768?(c.l=Ce.O.file.node,c.m=Ce.O.file.stream,c.v=0,c.j=null):(c.mode&61440)===40960?(c.l=Ce.O.link.node,c.m=Ce.O.link.stream):(c.mode&61440)===8192&&(c.l=Ce.O.ab.node,c.m=Ce.O.ab.stream),c.timestamp=Date.now(),s&&(s.j[a]=c,s.timestamp=c.timestamp),c},Kc(s){return s.j?s.j.subarray?s.j.subarray(0,s.v):new Uint8Array(s.j):new Uint8Array(0)},l:{Y(s){var a={};return a.Jc=(s.mode&61440)===8192?s.id:1,a.Mc=s.id,a.mode=s.mode,a.Oc=1,a.uid=0,a.Lc=0,a.za=s.za,(s.mode&61440)===16384?a.size=4096:(s.mode&61440)===32768?a.size=s.v:(s.mode&61440)===40960?a.size=s.link.length:a.size=0,a.Bc=new Date(s.timestamp),a.Nc=new Date(s.timestamp),a.Ic=new Date(s.timestamp),a.Jb=4096,a.Cc=Math.ceil(a.size/a.Jb),a},P(s,a){if(a.mode!==void 0&&(s.mode=a.mode),a.timestamp!==void 0&&(s.timestamp=a.timestamp),a.size!==void 0&&(a=a.size,s.v!=a))if(a==0)s.j=null,s.v=0;else{var c=s.j;s.j=new Uint8Array(a),c&&s.j.set(c.subarray(0,Math.min(a,s.v))),s.v=a}},ka(){throw $s[44]},va(s,a,c,g){return Ce.createNode(s,a,c,g)},vb(s,a,c){if((s.mode&61440)===16384){try{var g=Bi(a,c)}catch{}if(g)for(var b in g.j)throw new Le(55)}delete s.parent.j[s.name],s.parent.timestamp=Date.now(),s.name=c,a.j[c]=s,a.timestamp=s.parent.timestamp,s.parent=a},Bb(s,a){delete s.j[a],s.timestamp=Date.now()},wb(s,a){var c=Bi(s,a),g;for(g in c.j)throw new Le(55);delete s.j[a],s.timestamp=Date.now()},tb(s){var a=[".",".."],c;for(c in s.j)s.j.hasOwnProperty(c)&&a.push(c);return a},Ea(s,a,c){return s=Ce.createNode(s,a,41471,0),s.link=c,s},ma(s){if((s.mode&61440)!==40960)throw new Le(28);return s.link}},m:{read(s,a,c,g,b){var E=s.node.j;if(b>=s.node.v)return 0;if(s=Math.min(s.node.v-b,g),8<s&&E.subarray)a.set(E.subarray(b,b+s),c);else for(g=0;g<s;g++)a[c+g]=E[b+g];return s},write(s,a,c,g,b,E){if(a.buffer===se.buffer&&(E=!1),!g)return 0;if(s=s.node,s.timestamp=Date.now(),a.subarray&&(!s.j||s.j.subarray)){if(E)return s.j=a.subarray(c,c+g),s.v=g;if(s.v===0&&b===0)return s.j=a.slice(c,c+g),s.v=g;if(b+g<=s.v)return s.j.set(a.subarray(c,c+g),b),g}if(ut(s,b+g),s.j.subarray&&a.subarray)s.j.set(a.subarray(c,c+g),b);else for(E=0;E<g;E++)s.j[b+E]=a[c+E];return s.v=Math.max(s.v,b+g),g},ba(s,a,c){if(c===1?a+=s.position:c===2&&(s.node.mode&61440)===32768&&(a+=s.node.v),0>a)throw new Le(28);return a},pa(s,a,c){ut(s.node,a+c),s.node.v=Math.max(s.node.v,a+c)},mb(s,a,c,g,b){if((s.node.mode&61440)!==32768)throw new Le(43);if(s=s.node.j,b&2||s.buffer!==se.buffer){if((0<c||c+a<s.length)&&(s.subarray?s=s.subarray(c,c+a):s=Array.prototype.slice.call(s,c,c+a)),c=!0,Ne(),a=void 0,!a)throw new Le(48);se.set(s,a)}else c=!1,a=s.byteOffset;return{o:a,M:c}},ob(s,a,c,g){return Ce.m.write(s,a,0,g,c,!1),0}}};function He(s,a){var c=0;return s&&(c|=365),a&&(c|=146),c}var Bt=null,Mr={},Ni=[],Vu=1,vi=null,no=!0,Le=null,$s={},cr=(s,a={})=>{if(s=Oe(s),!s)return{path:"",node:null};if(a=Object.assign({hb:!0,Qa:0},a),8<a.Qa)throw new Le(32);s=s.split("/").filter(R=>!!R);for(var c=Bt,g="/",b=0;b<s.length;b++){var E=b===s.length-1;if(E&&a.parent)break;if(c=Bi(c,s[b]),g=O(g+"/"+s[b]),c.wa&&(!E||E&&a.hb)&&(c=c.wa.root),!E||a.gb){for(E=0;(c.mode&61440)===40960;)if(c=zu(g),g=Oe(X(g),c),c=cr(g,{Qa:a.Qa+1}).node,40<E++)throw new Le(32)}}return{path:g,node:c}},ro=s=>{for(var a;;){if(s===s.parent)return s=s.U.nb,a?s[s.length-1]!=="/"?`${s}/${a}`:s+a:s;a=a?`${s.name}/${a}`:s.name,s=s.parent}},io=(s,a)=>{for(var c=0,g=0;g<a.length;g++)c=(c<<5)-c+a.charCodeAt(g)|0;return(s+c>>>0)%vi.length},Bi=(s,a)=>{var c;if(c=(c=Wi(s,"x"))?c:s.l.ka?0:2)throw new Le(c,s);for(c=vi[io(s.id,a)];c;c=c.lc){var g=c.name;if(c.parent.id===s.id&&g===a)return c}return s.l.ka(s,a)},so=(s,a,c,g)=>(s=new Oo(s,a,c,g),a=io(s.parent.id,s.name),s.lc=vi[a],vi[a]=s),ao=s=>{var a=["r","w","rw"][s&3];return s&512&&(a+="w"),a},Wi=(s,a)=>{if(no)return 0;if(!a.includes("r")||s.mode&292){if(a.includes("w")&&!(s.mode&146)||a.includes("x")&&!(s.mode&73))return 2}else return 2;return 0},oo=(s,a)=>{try{return Bi(s,a),20}catch{}return Wi(s,"wx")},qu=()=>{for(var s=0;4096>=s;s++)if(!Ni[s])return s;throw new Le(33)},Gn=s=>{if(s=Ni[s],!s)throw new Le(8);return s},lo=(s,a=-1)=>(gi||(gi=function(){this.h={}},gi.prototype={},Object.defineProperties(gi.prototype,{object:{get(){return this.node},set(c){this.node=c}},flags:{get(){return this.h.flags},set(c){this.h.flags=c}},position:{get(){return this.h.position},set(c){this.h.position=c}}})),s=Object.assign(new gi,s),a==-1&&(a=qu()),s.X=a,Ni[a]=s),Gu={open:s=>{s.m=Mr[s.node.za].m,s.m.open&&s.m.open(s)},ba:()=>{throw new Le(70)}},Us=(s,a)=>{Mr[s]={m:a}},uo=(s,a)=>{var c=a==="/",g=!a;if(c&&Bt)throw new Le(10);if(!c&&!g){var b=cr(a,{hb:!1});if(a=b.path,b=b.node,b.wa)throw new Le(10);if((b.mode&61440)!==16384)throw new Le(54)}a={type:s,Qc:{},nb:a,kc:[]},s=s.U(a),s.U=a,a.root=s,c?Bt=s:b&&(b.wa=a,b.U&&b.U.kc.push(a))},pn=(s,a,c)=>{var g=cr(s,{parent:!0}).node;if(s=de(s),!s||s==="."||s==="..")throw new Le(28);var b=oo(g,s);if(b)throw new Le(b);if(!g.l.va)throw new Le(63);return g.l.va(g,s,a,c)},Vi=(s,a,c)=>{typeof c>"u"&&(c=a,a=438),pn(s,a|8192,c)},Ns=(s,a)=>{if(!Oe(s))throw new Le(44);var c=cr(a,{parent:!0}).node;if(!c)throw new Le(44);a=de(a);var g=oo(c,a);if(g)throw new Le(g);if(!c.l.Ea)throw new Le(63);c.l.Ea(c,a,s)},zu=s=>{if(s=cr(s).node,!s)throw new Le(44);if(!s.l.ma)throw new Le(28);return Oe(ro(s.parent),s.l.ma(s))},qi=(s,a,c)=>{if(s==="")throw new Le(44);if(typeof a=="string"){var g={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[a];if(typeof g>"u")throw Error(`Unknown file open mode: ${a}`);a=g}if(c=a&64?(typeof c>"u"?438:c)&4095|32768:0,typeof s=="object")var b=s;else{s=O(s);try{b=cr(s,{gb:!(a&131072)}).node}catch{}}if(g=!1,a&64)if(b){if(a&128)throw new Le(20)}else b=pn(s,c,0),g=!0;if(!b)throw new Le(44);if((b.mode&61440)===8192&&(a&=-513),a&65536&&(b.mode&61440)!==16384)throw new Le(54);if(!g&&(c=b?(b.mode&61440)===40960?32:(b.mode&61440)===16384&&(ao(a)!=="r"||a&512)?31:Wi(b,ao(a)):44))throw new Le(c);if(a&512&&!g){if(c=b,c=typeof c=="string"?cr(c,{gb:!0}).node:c,!c.l.P)throw new Le(63);if((c.mode&61440)===16384)throw new Le(31);if((c.mode&61440)!==32768)throw new Le(28);if(g=Wi(c,"w"))throw new Le(g);c.l.P(c,{size:0,timestamp:Date.now()})}return a&=-131713,b=lo({node:b,path:ro(b),flags:a,seekable:!0,position:0,m:b.m,zc:[],error:!1}),b.m.open&&b.m.open(b),!_.logReadFiles||a&1||(Gi||(Gi={}),s in Gi||(Gi[s]=1)),b},co=(s,a,c)=>{if(s.X===null)throw new Le(8);if(!s.seekable||!s.m.ba)throw new Le(70);if(c!=0&&c!=1&&c!=2)throw new Le(28);s.position=s.m.ba(s,a,c),s.zc=[]},fo=()=>{Le||(Le=function(s,a){this.name="ErrnoError",this.node=a,this.pc=function(c){this.aa=c},this.pc(s),this.message="FS error"},Le.prototype=Error(),Le.prototype.constructor=Le,[44].forEach(s=>{$s[s]=new Le(s),$s[s].stack="<generic error, no stack>"}))},ho,pi=(s,a,c)=>{s=O("/dev/"+s);var g=He(!!a,!!c);Bs||(Bs=64);var b=Bs++<<8|0;Us(b,{open:E=>{E.seekable=!1},close:()=>{c&&c.buffer&&c.buffer.length&&c(10)},read:(E,R,G,Q)=>{for(var N=0,ke=0;ke<Q;ke++){try{var Ie=a()}catch{throw new Le(29)}if(Ie===void 0&&N===0)throw new Le(6);if(Ie==null)break;N++,R[G+ke]=Ie}return N&&(E.node.timestamp=Date.now()),N},write:(E,R,G,Q)=>{for(var N=0;N<Q;N++)try{c(R[G+N])}catch{throw new Le(29)}return Q&&(E.node.timestamp=Date.now()),N}}),Vi(s,g,b)},Bs,dr={},gi,Gi,mi=void 0;function Mn(){return mi+=4,ye[mi-4>>2]}function vo(s){if(s===void 0)return"_unknown";s=s.replace(/[^a-zA-Z0-9_]/g,"$");var a=s.charCodeAt(0);return 48<=a&&57>=a?`_${s}`:s}function zi(s,a){return s=vo(s),{[s]:function(){return a.apply(this,arguments)}}[s]}function po(){this.M=[void 0],this.ib=[]}var cn=new po,Lr=void 0;function Xe(s){throw new Lr(s)}var gn=s=>(s||Xe("Cannot use deleted val. handle = "+s),cn.get(s).value),mn=s=>{switch(s){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return cn.pa({ub:1,value:s})}};function go(s){var a=Error,c=zi(s,function(g){this.name=s,this.message=g,g=Error(g).stack,g!==void 0&&(this.stack=this.toString()+`
`+g.replace(/^Error(:[^\n]*)?\n/,""))});return c.prototype=Object.create(a.prototype),c.prototype.constructor=c,c.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},c}var mo=void 0,_o=void 0;function $t(s){for(var a="";oe[s];)a+=_o[oe[s++]];return a}var _i=[];function Ws(){for(;_i.length;){var s=_i.pop();s.g.fa=!1,s.delete()}}var yi=void 0,Ln={};function Vs(s,a){for(a===void 0&&Xe("ptr should not be undefined");s.A;)a=s.na(a),s=s.A;return a}var fr={};function yo(s){s=No(s);var a=$t(s);return $n(s),a}function wi(s,a){var c=fr[s];return c===void 0&&Xe(a+" has unknown type "+yo(s)),c}function Hi(){}var qs=!1;function wo(s){--s.count.value,s.count.value===0&&(s.G?s.L.W(s.G):s.u.i.W(s.o))}function bo(s,a,c){return a===c?s:c.A===void 0?null:(s=bo(s,a,c.A),s===null?null:c.Pb(s))}var ko={};function Hu(s,a){return a=Vs(s,a),Ln[a]}var Io=void 0;function Ki(s){throw new Io(s)}function Yi(s,a){return a.u&&a.o||Ki("makeClassHandle requires ptr and ptrType"),!!a.L!=!!a.G&&Ki("Both smartPtrType and smartPtr must be specified"),a.count={value:1},Dr(Object.create(s,{g:{value:a}}))}function Dr(s){return typeof FinalizationRegistry>"u"?(Dr=a=>a,s):(qs=new FinalizationRegistry(a=>{wo(a.g)}),Dr=a=>{var c=a.g;return c.G&&qs.register(a,{g:c},a),a},Hi=a=>{qs.unregister(a)},Dr(s))}var Ji={};function bi(s){for(;s.length;){var a=s.pop();s.pop()(a)}}function ki(s){return this.fromWireType(ye[s>>2])}var Fr={},Xi={};function on(s,a,c){function g(G){G=c(G),G.length!==s.length&&Ki("Mismatched type converter count");for(var Q=0;Q<s.length;++Q)Sn(s[Q],G[Q])}s.forEach(function(G){Xi[G]=a});var b=Array(a.length),E=[],R=0;a.forEach((G,Q)=>{fr.hasOwnProperty(G)?b[Q]=fr[G]:(E.push(G),Fr.hasOwnProperty(G)||(Fr[G]=[]),Fr[G].push(()=>{b[Q]=fr[G],++R,R===E.length&&g(b)}))}),E.length===0&&g(b)}function Qi(s){switch(s){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${s}`)}}function Ku(s,a,c={}){var g=a.name;if(s||Xe(`type "${g}" must have a positive integer typeid pointer`),fr.hasOwnProperty(s)){if(c.$b)return;Xe(`Cannot register type '${g}' twice`)}fr[s]=a,delete Xi[s],Fr.hasOwnProperty(s)&&(a=Fr[s],delete Fr[s],a.forEach(b=>b()))}function Sn(s,a,c={}){if(!("argPackAdvance"in a))throw new TypeError("registerType registeredInstance requires argPackAdvance");Ku(s,a,c)}function Gs(s){Xe(s.g.u.i.name+" instance already deleted")}function zn(){}function zs(s,a,c){if(s[a].B===void 0){var g=s[a];s[a]=function(){return s[a].B.hasOwnProperty(arguments.length)||Xe(`Function '${c}' called with an invalid number of arguments (${arguments.length}) - expects one of (${s[a].B})!`),s[a].B[arguments.length].apply(this,arguments)},s[a].B=[],s[a].B[g.ea]=g}}function Hs(s,a,c){_.hasOwnProperty(s)?((c===void 0||_[s].B!==void 0&&_[s].B[c]!==void 0)&&Xe(`Cannot register public name '${s}' twice`),zs(_,s,s),_.hasOwnProperty(c)&&Xe(`Cannot register multiple overloads of a function with the same number of arguments (${c})!`),_[s].B[c]=a):(_[s]=a,c!==void 0&&(_[s].Pc=c))}function Yu(s,a,c,g,b,E,R,G){this.name=s,this.constructor=a,this.N=c,this.W=g,this.A=b,this.Ub=E,this.na=R,this.Pb=G,this.rb=[]}function Zi(s,a,c){for(;a!==c;)a.na||Xe(`Expected null or instance of ${c.name}, got an instance of ${a.name}`),s=a.na(s),a=a.A;return s}function Ju(s,a){return a===null?(this.Na&&Xe(`null is not a valid ${this.name}`),0):(a.g||Xe(`Cannot pass "${Ys(a)}" as a ${this.name}`),a.g.o||Xe(`Cannot pass deleted object as a pointer of type ${this.name}`),Zi(a.g.o,a.g.u.i,this.i))}function Xu(s,a){if(a===null){if(this.Na&&Xe(`null is not a valid ${this.name}`),this.ua){var c=this.Pa();return s!==null&&s.push(this.W,c),c}return 0}if(a.g||Xe(`Cannot pass "${Ys(a)}" as a ${this.name}`),a.g.o||Xe(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&a.g.u.ta&&Xe(`Cannot convert argument of type ${a.g.L?a.g.L.name:a.g.u.name} to parameter type ${this.name}`),c=Zi(a.g.o,a.g.u.i,this.i),this.ua)switch(a.g.G===void 0&&Xe("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:a.g.L===this?c=a.g.G:Xe(`Cannot convert argument of type ${a.g.L?a.g.L.name:a.g.u.name} to parameter type ${this.name}`);break;case 1:c=a.g.G;break;case 2:if(a.g.L===this)c=a.g.G;else{var g=a.clone();c=this.oc(c,mn(function(){g.delete()})),s!==null&&s.push(this.W,c)}break;default:Xe("Unsupporting sharing policy")}return c}function Qu(s,a){return a===null?(this.Na&&Xe(`null is not a valid ${this.name}`),0):(a.g||Xe(`Cannot pass "${Ys(a)}" as a ${this.name}`),a.g.o||Xe(`Cannot pass deleted object as a pointer of type ${this.name}`),a.g.u.ta&&Xe(`Cannot convert argument of type ${a.g.u.name} to parameter type ${this.name}`),Zi(a.g.o,a.g.u.i,this.i))}function Dn(s,a,c,g){this.name=s,this.i=a,this.Na=c,this.ta=g,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,a.A!==void 0?this.toWireType=Xu:(this.toWireType=g?Ju:Qu,this.K=null)}function So(s,a,c){_.hasOwnProperty(s)||Ki("Replacing nonexistant public symbol"),_[s].B!==void 0&&c!==void 0?_[s].B[c]=a:(_[s]=a,_[s].ea=c)}var es=[],Eo=s=>{var a=es[s];return a||(s>=es.length&&(es.length=s+1),es[s]=a=ae.get(s)),a},Zu=(s,a)=>{var c=[];return function(){if(c.length=0,Object.assign(c,arguments),s.includes("j")){var g=_["dynCall_"+s];g=c&&c.length?g.apply(null,[a].concat(c)):g.call(null,a)}else g=Eo(a).apply(null,c);return g}};function Xt(s,a){s=$t(s);var c=s.includes("j")?Zu(s,a):Eo(a);return typeof c!="function"&&Xe(`unknown function pointer with signature ${s}: ${a}`),c}var Ao=void 0;function Fn(s,a){function c(E){b[E]||fr[E]||(Xi[E]?Xi[E].forEach(c):(g.push(E),b[E]=!0))}var g=[],b={};throw a.forEach(c),new Ao(`${s}: `+g.map(yo).join([", "]))}function ts(s,a,c,g,b){var E=a.length;2>E&&Xe("argTypes array size mismatch! Must at least get return value and 'this' types!");var R=a[1]!==null&&c!==null,G=!1;for(c=1;c<a.length;++c)if(a[c]!==null&&a[c].K===void 0){G=!0;break}var Q=a[0].name!=="void",N=E-2,ke=Array(N),Ie=[],Me=[];return function(){if(arguments.length!==N&&Xe(`function ${s} called with ${arguments.length} arguments, expected ${N} args!`),Me.length=0,Ie.length=R?2:1,Ie[0]=b,R){var D=a[1].toWireType(Me,this);Ie[1]=D}for(var we=0;we<N;++we)ke[we]=a[we+2].toWireType(Me,arguments[we]),Ie.push(ke[we]);if(we=g.apply(null,Ie),G)bi(Me);else for(var ge=R?1:2;ge<a.length;ge++){var Qe=ge===1?D:ke[ge-2];a[ge].K!==null&&a[ge].K(Qe)}return D=Q?a[0].fromWireType(we):void 0,D}}function ns(s,a){for(var c=[],g=0;g<s;g++)c.push(Pe[a+4*g>>2]);return c}function Co(s,a,c){return s instanceof Object||Xe(`${c} with invalid "this": ${s}`),s instanceof a.i.constructor||Xe(`${c} incompatible with "this" of type ${s.constructor.name}`),s.g.o||Xe(`cannot call emscripten binding method ${c} on deleted object`),Zi(s.g.o,s.g.u.i,a.i)}function Ks(s){s>=cn.h&&--cn.get(s).ub===0&&cn.Zb(s)}function ec(s,a,c){switch(a){case 0:return function(g){return this.fromWireType((c?se:oe)[g])};case 1:return function(g){return this.fromWireType((c?be:Ae)[g>>1])};case 2:return function(g){return this.fromWireType((c?ye:Pe)[g>>2])};default:throw new TypeError("Unknown integer type: "+s)}}function Ys(s){if(s===null)return"null";var a=typeof s;return a==="object"||a==="array"||a==="function"?s.toString():""+s}function tc(s,a){switch(a){case 2:return function(c){return this.fromWireType(ce[c>>2])};case 3:return function(c){return this.fromWireType(re[c>>3])};default:throw new TypeError("Unknown float type: "+s)}}function nc(s,a,c){switch(a){case 0:return c?function(g){return se[g]}:function(g){return oe[g]};case 1:return c?function(g){return be[g>>1]}:function(g){return Ae[g>>1]};case 2:return c?function(g){return ye[g>>2]}:function(g){return Pe[g>>2]};default:throw new TypeError("Unknown integer type: "+s)}}var To=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,rc=(s,a)=>{for(var c=s>>1,g=c+a/2;!(c>=g)&&Ae[c];)++c;if(c<<=1,32<c-s&&To)return To.decode(oe.subarray(s,c));for(c="",g=0;!(g>=a/2);++g){var b=be[s+2*g>>1];if(b==0)break;c+=String.fromCharCode(b)}return c},ic=(s,a,c)=>{if(c===void 0&&(c=2147483647),2>c)return 0;c-=2;var g=a;c=c<2*s.length?c/2:s.length;for(var b=0;b<c;++b)be[a>>1]=s.charCodeAt(b),a+=2;return be[a>>1]=0,a-g},sc=s=>2*s.length,ac=(s,a)=>{for(var c=0,g="";!(c>=a/4);){var b=ye[s+4*c>>2];if(b==0)break;++c,65536<=b?(b-=65536,g+=String.fromCharCode(55296|b>>10,56320|b&1023)):g+=String.fromCharCode(b)}return g},oc=(s,a,c)=>{if(c===void 0&&(c=2147483647),4>c)return 0;var g=a;c=g+c-4;for(var b=0;b<s.length;++b){var E=s.charCodeAt(b);if(55296<=E&&57343>=E){var R=s.charCodeAt(++b);E=65536+((E&1023)<<10)|R&1023}if(ye[a>>2]=E,a+=4,a+4>c)break}return ye[a>>2]=0,a-g},lc=s=>{for(var a=0,c=0;c<s.length;++c){var g=s.charCodeAt(c);55296<=g&&57343>=g&&++c,a+=4}return a},uc={};function rs(s){var a=uc[s];return a===void 0?$t(s):a}var is=[];function cc(s){var a=is.length;return is.push(s),a}function dc(s,a){for(var c=Array(s),g=0;g<s;++g)c[g]=wi(Pe[a+4*g>>2],"parameter "+g);return c}var xo=[],Js=[],Xs={},jo=()=>{if(!Qs){var s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:j||"./this.program"},a;for(a in Xs)Xs[a]===void 0?delete s[a]:s[a]=Xs[a];var c=[];for(a in s)c.push(`${a}=${s[a]}`);Qs=c}return Qs},Qs,ss=s=>s%4===0&&(s%100!==0||s%400===0),Po=[31,29,31,30,31,30,31,31,30,31,30,31],Ro=[31,28,31,30,31,30,31,31,30,31,30,31],fc=(s,a,c,g)=>{function b(D,we,ge){for(D=typeof D=="number"?D.toString():D||"";D.length<we;)D=ge[0]+D;return D}function E(D,we){return b(D,we,"0")}function R(D,we){function ge(tt){return 0>tt?-1:0<tt?1:0}var Qe;return(Qe=ge(D.getFullYear()-we.getFullYear()))===0&&(Qe=ge(D.getMonth()-we.getMonth()))===0&&(Qe=ge(D.getDate()-we.getDate())),Qe}function G(D){switch(D.getDay()){case 0:return new Date(D.getFullYear()-1,11,29);case 1:return D;case 2:return new Date(D.getFullYear(),0,3);case 3:return new Date(D.getFullYear(),0,2);case 4:return new Date(D.getFullYear(),0,1);case 5:return new Date(D.getFullYear()-1,11,31);case 6:return new Date(D.getFullYear()-1,11,30)}}function Q(D){var we=D.ca;for(D=new Date(new Date(D.da+1900,0,1).getTime());0<we;){var ge=D.getMonth(),Qe=(ss(D.getFullYear())?Po:Ro)[ge];if(we>Qe-D.getDate())we-=Qe-D.getDate()+1,D.setDate(1),11>ge?D.setMonth(ge+1):(D.setMonth(0),D.setFullYear(D.getFullYear()+1));else{D.setDate(D.getDate()+we);break}}return ge=new Date(D.getFullYear()+1,0,4),we=G(new Date(D.getFullYear(),0,4)),ge=G(ge),0>=R(we,D)?0>=R(ge,D)?D.getFullYear()+1:D.getFullYear():D.getFullYear()-1}var N=ye[g+40>>2];g={wc:ye[g>>2],vc:ye[g+4>>2],Fa:ye[g+8>>2],Sa:ye[g+12>>2],Ga:ye[g+16>>2],da:ye[g+20>>2],R:ye[g+24>>2],ca:ye[g+28>>2],Rc:ye[g+32>>2],uc:ye[g+36>>2],xc:N&&N?rt(oe,N):""},c=c?rt(oe,c):"",N={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ke in N)c=c.replace(new RegExp(ke,"g"),N[ke]);var Ie="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Me="January February March April May June July August September October November December".split(" ");N={"%a":D=>Ie[D.R].substring(0,3),"%A":D=>Ie[D.R],"%b":D=>Me[D.Ga].substring(0,3),"%B":D=>Me[D.Ga],"%C":D=>E((D.da+1900)/100|0,2),"%d":D=>E(D.Sa,2),"%e":D=>b(D.Sa,2," "),"%g":D=>Q(D).toString().substring(2),"%G":D=>Q(D),"%H":D=>E(D.Fa,2),"%I":D=>(D=D.Fa,D==0?D=12:12<D&&(D-=12),E(D,2)),"%j":D=>{for(var we=0,ge=0;ge<=D.Ga-1;we+=(ss(D.da+1900)?Po:Ro)[ge++]);return E(D.Sa+we,3)},"%m":D=>E(D.Ga+1,2),"%M":D=>E(D.vc,2),"%n":()=>`
`,"%p":D=>0<=D.Fa&&12>D.Fa?"AM":"PM","%S":D=>E(D.wc,2),"%t":()=>"	","%u":D=>D.R||7,"%U":D=>E(Math.floor((D.ca+7-D.R)/7),2),"%V":D=>{var we=Math.floor((D.ca+7-(D.R+6)%7)/7);if(2>=(D.R+371-D.ca-2)%7&&we++,we)we==53&&(ge=(D.R+371-D.ca)%7,ge==4||ge==3&&ss(D.da)||(we=1));else{we=52;var ge=(D.R+7-D.ca-1)%7;(ge==4||ge==5&&ss(D.da%400-1))&&we++}return E(we,2)},"%w":D=>D.R,"%W":D=>E(Math.floor((D.ca+7-(D.R+6)%7)/7),2),"%y":D=>(D.da+1900).toString().substring(2),"%Y":D=>D.da+1900,"%z":D=>{D=D.uc;var we=0<=D;return D=Math.abs(D)/60,(we?"+":"-")+("0000"+(D/60*100+D%60)).slice(-4)},"%Z":D=>D.xc,"%%":()=>"%"},c=c.replace(/%%/g,"\0\0");for(ke in N)c.includes(ke)&&(c=c.replace(new RegExp(ke,"g"),N[ke](g)));return c=c.replace(/\0\0/g,"%"),ke=Yt(c,!1),ke.length>a?0:(se.set(ke,s),ke.length-1)};function Oo(s,a,c,g){s||(s=this),this.parent=s,this.U=s.U,this.wa=null,this.id=Vu++,this.name=a,this.mode=c,this.l={},this.m={},this.za=g}Object.defineProperties(Oo.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(s){s?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(s){s?this.mode|=146:this.mode&=-147}}}),fo(),vi=Array(4096),uo(Ce,"/"),pn("/tmp",16895,0),pn("/home",16895,0),pn("/home/web_user",16895,0),(()=>{pn("/dev",16895,0),Us(259,{read:()=>0,write:(g,b,E,R)=>R}),Vi("/dev/null",259),Ft(1280,Mt),Ft(1536,it),Vi("/dev/tty",1280),Vi("/dev/tty1",1536);var s=new Uint8Array(1024),a=0,c=()=>(a===0&&(a=We(s).byteLength),s[--a]);pi("random",c),pi("urandom",c),pn("/dev/shm",16895,0),pn("/dev/shm/tmp",16895,0)})(),(()=>{pn("/proc",16895,0);var s=pn("/proc/self",16895,0);pn("/proc/self/fd",16895,0),uo({U:()=>{var a=so(s,"fd",16895,73);return a.l={ka:(c,g)=>{var b=Gn(+g);return c={parent:null,U:{nb:"fake"},l:{ma:()=>b.path}},c.parent=c}},a}},"/proc/self/fd")})(),Object.assign(po.prototype,{get(s){return this.M[s]},has(s){return this.M[s]!==void 0},pa(s){var a=this.ib.pop()||this.M.length;return this.M[a]=s,a},Zb(s){this.M[s]=void 0,this.ib.push(s)}}),Lr=_.BindingError=class extends Error{constructor(s){super(s),this.name="BindingError"}},cn.M.push({value:void 0},{value:null},{value:!0},{value:!1}),cn.h=cn.M.length,_.count_emval_handles=function(){for(var s=0,a=cn.h;a<cn.M.length;++a)cn.M[a]!==void 0&&++s;return s},mo=_.PureVirtualError=go("PureVirtualError");for(var Mo=Array(256),as=0;256>as;++as)Mo[as]=String.fromCharCode(as);_o=Mo,_.getInheritedInstanceCount=function(){return Object.keys(Ln).length},_.getLiveInheritedInstances=function(){var s=[],a;for(a in Ln)Ln.hasOwnProperty(a)&&s.push(Ln[a]);return s},_.flushPendingDeletes=Ws,_.setDelayFunction=function(s){yi=s,_i.length&&yi&&yi(Ws)},Io=_.InternalError=class extends Error{constructor(s){super(s),this.name="InternalError"}},zn.prototype.isAliasOf=function(s){if(!(this instanceof zn&&s instanceof zn))return!1;var a=this.g.u.i,c=this.g.o,g=s.g.u.i;for(s=s.g.o;a.A;)c=a.na(c),a=a.A;for(;g.A;)s=g.na(s),g=g.A;return a===g&&c===s},zn.prototype.clone=function(){if(this.g.o||Gs(this),this.g.ia)return this.g.count.value+=1,this;var s=Dr,a=Object,c=a.create,g=Object.getPrototypeOf(this),b=this.g;return s=s(c.call(a,g,{g:{value:{count:b.count,fa:b.fa,ia:b.ia,o:b.o,u:b.u,G:b.G,L:b.L}}})),s.g.count.value+=1,s.g.fa=!1,s},zn.prototype.delete=function(){this.g.o||Gs(this),this.g.fa&&!this.g.ia&&Xe("Object already scheduled for deletion"),Hi(this),wo(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},zn.prototype.isDeleted=function(){return!this.g.o},zn.prototype.deleteLater=function(){return this.g.o||Gs(this),this.g.fa&&!this.g.ia&&Xe("Object already scheduled for deletion"),_i.push(this),_i.length===1&&yi&&yi(Ws),this.g.fa=!0,this},Dn.prototype.Vb=function(s){return this.sb&&(s=this.sb(s)),s},Dn.prototype.bb=function(s){this.W&&this.W(s)},Dn.prototype.argPackAdvance=8,Dn.prototype.readValueFromPointer=ki,Dn.prototype.deleteObject=function(s){s!==null&&s.delete()},Dn.prototype.fromWireType=function(s){function a(){return this.ua?Yi(this.i.N,{u:this.nc,o:c,L:this,G:s}):Yi(this.i.N,{u:this,o:s})}var c=this.Vb(s);if(!c)return this.bb(s),null;var g=Hu(this.i,c);if(g!==void 0)return g.g.count.value===0?(g.g.o=c,g.g.G=s,g.clone()):(g=g.clone(),this.bb(s),g);if(g=this.i.Ub(c),g=ko[g],!g)return a.call(this);g=this.ta?g.Kb:g.pointerType;var b=bo(c,this.i,g.i);return b===null?a.call(this):this.ua?Yi(g.i.N,{u:g,o:b,L:this,G:s}):Yi(g.i.N,{u:g,o:b})},Ao=_.UnboundTypeError=go("UnboundTypeError");var Lo={__syscall_fcntl64:function(s,a,c){mi=c;try{var g=Gn(s);switch(a){case 0:var b=Mn();return 0>b?-28:lo(g,b).X;case 1:case 2:return 0;case 3:return g.flags;case 4:return b=Mn(),g.flags|=b,0;case 5:return b=Mn(),be[b+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return ye[Do()>>2]=28,-1;default:return-28}}catch(E){if(typeof dr>"u"||E.name!=="ErrnoError")throw E;return-E.aa}},__syscall_ioctl:function(s,a,c){mi=c;try{var g=Gn(s);switch(a){case 21509:return g.s?0:-59;case 21505:if(!g.s)return-59;if(g.s.V.bc){a=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var b=Mn();ye[b>>2]=25856,ye[b+4>>2]=5,ye[b+8>>2]=191,ye[b+12>>2]=35387;for(var E=0;32>E;E++)se[b+E+17>>0]=a[E]||0}return 0;case 21510:case 21511:case 21512:return g.s?0:-59;case 21506:case 21507:case 21508:if(!g.s)return-59;if(g.s.V.cc)for(b=Mn(),a=[],E=0;32>E;E++)a.push(se[b+E+17>>0]);return 0;case 21519:return g.s?(b=Mn(),ye[b>>2]=0):-59;case 21520:return g.s?-28:-59;case 21531:if(b=Mn(),!g.m.ac)throw new Le(59);return g.m.ac(g,a,b);case 21523:return g.s?(g.s.V.dc&&(E=[24,80],b=Mn(),be[b>>1]=E[0],be[b+2>>1]=E[1]),0):-59;case 21524:return g.s?0:-59;case 21515:return g.s?0:-59;default:return-28}}catch(R){if(typeof dr>"u"||R.name!=="ErrnoError")throw R;return-R.aa}},__syscall_openat:function(s,a,c,g){mi=g;try{a=a?rt(oe,a):"";var b=a;if(b.charAt(0)==="/")a=b;else{var E=s===-100?"/":Gn(s).path;if(b.length==0)throw new Le(44);a=O(E+"/"+b)}var R=g?Mn():0;return qi(a,c,R).X}catch(G){if(typeof dr>"u"||G.name!=="ErrnoError")throw G;return-G.aa}},_embind_create_inheriting_constructor:function(s,a,c){s=$t(s),a=wi(a,"wrapper"),c=gn(c);var g=[].slice,b=a.i,E=b.N,R=b.A.N,G=b.A.constructor;s=zi(s,function(){b.A.rb.forEach((function(N){if(this[N]===R[N])throw new mo(`Pure virtual function ${N} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:E}),this.__construct.apply(this,g.call(arguments))}),E.__construct=function(){this===E&&Xe("Pass correct 'this' to __construct");var N=G.implement.apply(void 0,[this].concat(g.call(arguments)));Hi(N);var ke=N.g;N.notifyOnDestruction(),ke.ia=!0,Object.defineProperties(this,{g:{value:ke}}),Dr(this),N=ke.o,N=Vs(b,N),Ln.hasOwnProperty(N)?Xe(`Tried to register registered instance: ${N}`):Ln[N]=this},E.__destruct=function(){this===E&&Xe("Pass correct 'this' to __destruct"),Hi(this);var N=this.g.o;N=Vs(b,N),Ln.hasOwnProperty(N)?delete Ln[N]:Xe(`Tried to unregister unregistered instance: ${N}`)},s.prototype=Object.create(E);for(var Q in c)s.prototype[Q]=c[Q];return mn(s)},_embind_finalize_value_object:function(s){var a=Ji[s];delete Ji[s];var c=a.Pa,g=a.W,b=a.fb,E=b.map(R=>R.Yb).concat(b.map(R=>R.rc));on([s],E,R=>{var G={};return b.forEach((Q,N)=>{var ke=R[N],Ie=Q.Wb,Me=Q.Xb,D=R[N+b.length],we=Q.qc,ge=Q.sc;G[Q.Sb]={read:Qe=>ke.fromWireType(Ie(Me,Qe)),write:(Qe,tt)=>{var Te=[];we(ge,Qe,D.toWireType(Te,tt)),bi(Te)}}}),[{name:a.name,fromWireType:function(Q){var N={},ke;for(ke in G)N[ke]=G[ke].read(Q);return g(Q),N},toWireType:function(Q,N){for(var ke in G)if(!(ke in N))throw new TypeError(`Missing field: "${ke}"`);var Ie=c();for(ke in G)G[ke].write(Ie,N[ke]);return Q!==null&&Q.push(g,Ie),Ie},argPackAdvance:8,readValueFromPointer:ki,K:g}]})},_embind_register_bigint:function(){},_embind_register_bool:function(s,a,c,g,b){var E=Qi(c);a=$t(a),Sn(s,{name:a,fromWireType:function(R){return!!R},toWireType:function(R,G){return G?g:b},argPackAdvance:8,readValueFromPointer:function(R){if(c===1)var G=se;else if(c===2)G=be;else if(c===4)G=ye;else throw new TypeError("Unknown boolean type size: "+a);return this.fromWireType(G[R>>E])},K:null})},_embind_register_class:function(s,a,c,g,b,E,R,G,Q,N,ke,Ie,Me){ke=$t(ke),E=Xt(b,E),G&&(G=Xt(R,G)),N&&(N=Xt(Q,N)),Me=Xt(Ie,Me);var D=vo(ke);Hs(D,function(){Fn(`Cannot construct ${ke} due to unbound types`,[g])}),on([s,a,c],g?[g]:[],function(we){if(we=we[0],g)var ge=we.i,Qe=ge.N;else Qe=zn.prototype;we=zi(D,function(){if(Object.getPrototypeOf(this)!==tt)throw new Lr("Use 'new' to construct "+ke);if(Te.$===void 0)throw new Lr(ke+" has no accessible constructor");var Jt=Te.$[arguments.length];if(Jt===void 0)throw new Lr(`Tried to invoke ctor of ${ke} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(Te.$).toString()}) parameters instead!`);return Jt.apply(this,arguments)});var tt=Object.create(Qe,{constructor:{value:we}});we.prototype=tt;var Te=new Yu(ke,we,tt,Me,ge,E,G,N);Te.A&&(Te.A.oa===void 0&&(Te.A.oa=[]),Te.A.oa.push(Te)),ge=new Dn(ke,Te,!0,!1),Qe=new Dn(ke+"*",Te,!1,!1);var Pt=new Dn(ke+" const*",Te,!1,!0);return ko[s]={pointerType:Qe,Kb:Pt},So(D,we),[ge,Qe,Pt]})},_embind_register_class_class_function:function(s,a,c,g,b,E,R){var G=ns(c,g);a=$t(a),E=Xt(b,E),on([],[s],function(Q){function N(){Fn(`Cannot call ${ke} due to unbound types`,G)}Q=Q[0];var ke=`${Q.name}.${a}`;a.startsWith("@@")&&(a=Symbol[a.substring(2)]);var Ie=Q.i.constructor;return Ie[a]===void 0?(N.ea=c-1,Ie[a]=N):(zs(Ie,a,ke),Ie[a].B[c-1]=N),on([],G,function(Me){if(Me=ts(ke,[Me[0],null].concat(Me.slice(1)),null,E,R),Ie[a].B===void 0?(Me.ea=c-1,Ie[a]=Me):Ie[a].B[c-1]=Me,Q.i.oa)for(const D of Q.i.oa)D.constructor.hasOwnProperty(a)||(D.constructor[a]=Me);return[]}),[]})},_embind_register_class_class_property:function(s,a,c,g,b,E,R,G){a=$t(a),E=Xt(b,E),on([],[s],function(Q){Q=Q[0];var N=`${Q.name}.${a}`,ke={get(){Fn(`Cannot access ${N} due to unbound types`,[c])},enumerable:!0,configurable:!0};return ke.set=G?()=>{Fn(`Cannot access ${N} due to unbound types`,[c])}:()=>{Xe(`${N} is a read-only property`)},Object.defineProperty(Q.i.constructor,a,ke),on([],[c],function(Ie){Ie=Ie[0];var Me={get(){return Ie.fromWireType(E(g))},enumerable:!0};return G&&(G=Xt(R,G),Me.set=D=>{var we=[];G(g,Ie.toWireType(we,D)),bi(we)}),Object.defineProperty(Q.i.constructor,a,Me),[]}),[]})},_embind_register_class_constructor:function(s,a,c,g,b,E){var R=ns(a,c);b=Xt(g,b),on([],[s],function(G){G=G[0];var Q=`constructor ${G.name}`;if(G.i.$===void 0&&(G.i.$=[]),G.i.$[a-1]!==void 0)throw new Lr(`Cannot register multiple constructors with identical number of parameters (${a-1}) for class '${G.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return G.i.$[a-1]=()=>{Fn(`Cannot construct ${G.name} due to unbound types`,R)},on([],R,function(N){return N.splice(1,0,null),G.i.$[a-1]=ts(Q,N,null,b,E),[]}),[]})},_embind_register_class_function:function(s,a,c,g,b,E,R,G){var Q=ns(c,g);a=$t(a),E=Xt(b,E),on([],[s],function(N){function ke(){Fn(`Cannot call ${Ie} due to unbound types`,Q)}N=N[0];var Ie=`${N.name}.${a}`;a.startsWith("@@")&&(a=Symbol[a.substring(2)]),G&&N.i.rb.push(a);var Me=N.i.N,D=Me[a];return D===void 0||D.B===void 0&&D.className!==N.name&&D.ea===c-2?(ke.ea=c-2,ke.className=N.name,Me[a]=ke):(zs(Me,a,Ie),Me[a].B[c-2]=ke),on([],Q,function(we){return we=ts(Ie,we,N,E,R),Me[a].B===void 0?(we.ea=c-2,Me[a]=we):Me[a].B[c-2]=we,[]}),[]})},_embind_register_class_property:function(s,a,c,g,b,E,R,G,Q,N){a=$t(a),b=Xt(g,b),on([],[s],function(ke){ke=ke[0];var Ie=`${ke.name}.${a}`,Me={get(){Fn(`Cannot access ${Ie} due to unbound types`,[c,R])},enumerable:!0,configurable:!0};return Me.set=Q?()=>{Fn(`Cannot access ${Ie} due to unbound types`,[c,R])}:()=>{Xe(Ie+" is a read-only property")},Object.defineProperty(ke.i.N,a,Me),on([],Q?[c,R]:[c],function(D){var we=D[0],ge={get(){var tt=Co(this,ke,Ie+" getter");return we.fromWireType(b(E,tt))},enumerable:!0};if(Q){Q=Xt(G,Q);var Qe=D[1];ge.set=function(tt){var Te=Co(this,ke,Ie+" setter"),Pt=[];Q(N,Te,Qe.toWireType(Pt,tt)),bi(Pt)}}return Object.defineProperty(ke.i.N,a,ge),[]}),[]})},_embind_register_emval:function(s,a){a=$t(a),Sn(s,{name:a,fromWireType:function(c){var g=gn(c);return Ks(c),g},toWireType:function(c,g){return mn(g)},argPackAdvance:8,readValueFromPointer:ki,K:null})},_embind_register_enum:function(s,a,c,g){function b(){}c=Qi(c),a=$t(a),b.values={},Sn(s,{name:a,constructor:b,fromWireType:function(E){return this.constructor.values[E]},toWireType:function(E,R){return R.value},argPackAdvance:8,readValueFromPointer:ec(a,c,g),K:null}),Hs(a,b)},_embind_register_enum_value:function(s,a,c){var g=wi(s,"enum");a=$t(a),s=g.constructor,g=Object.create(g.constructor.prototype,{value:{value:c},constructor:{value:zi(`${g.name}_${a}`,function(){})}}),s.values[c]=g,s[a]=g},_embind_register_float:function(s,a,c){c=Qi(c),a=$t(a),Sn(s,{name:a,fromWireType:function(g){return g},toWireType:function(g,b){return b},argPackAdvance:8,readValueFromPointer:tc(a,c),K:null})},_embind_register_function:function(s,a,c,g,b,E){var R=ns(a,c);s=$t(s),b=Xt(g,b),Hs(s,function(){Fn(`Cannot call ${s} due to unbound types`,R)},a-1),on([],R,function(G){return So(s,ts(s,[G[0],null].concat(G.slice(1)),null,b,E),a-1),[]})},_embind_register_integer:function(s,a,c,g,b){a=$t(a),b===-1&&(b=4294967295),b=Qi(c);var E=G=>G;if(g===0){var R=32-8*c;E=G=>G<<R>>>R}c=a.includes("unsigned")?function(G,Q){return Q>>>0}:function(G,Q){return Q},Sn(s,{name:a,fromWireType:E,toWireType:c,argPackAdvance:8,readValueFromPointer:nc(a,b,g!==0),K:null})},_embind_register_memory_view:function(s,a,c){function g(E){E>>=2;var R=Pe;return new b(R.buffer,R[E+1],R[E])}var b=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][a];c=$t(c),Sn(s,{name:c,fromWireType:g,argPackAdvance:8,readValueFromPointer:g},{$b:!0})},_embind_register_std_string:function(s,a){a=$t(a);var c=a==="std::string";Sn(s,{name:a,fromWireType:function(g){var b=Pe[g>>2],E=g+4;if(c)for(var R=E,G=0;G<=b;++G){var Q=E+G;if(G==b||oe[Q]==0){if(R=R?rt(oe,R,Q-R):"",N===void 0)var N=R;else N+="\0",N+=R;R=Q+1}}else{for(N=Array(b),G=0;G<b;++G)N[G]=String.fromCharCode(oe[E+G]);N=N.join("")}return $n(g),N},toWireType:function(g,b){b instanceof ArrayBuffer&&(b=new Uint8Array(b));var E=typeof b=="string";E||b instanceof Uint8Array||b instanceof Uint8ClampedArray||b instanceof Int8Array||Xe("Cannot pass non-string to std::string");var R=c&&E?bt(b):b.length,G=Zs(4+R+1),Q=G+4;if(Pe[G>>2]=R,c&&E)Zt(b,oe,Q,R+1);else if(E)for(E=0;E<R;++E){var N=b.charCodeAt(E);255<N&&($n(Q),Xe("String has UTF-16 code units that do not fit in 8 bits")),oe[Q+E]=N}else for(E=0;E<R;++E)oe[Q+E]=b[E];return g!==null&&g.push($n,G),G},argPackAdvance:8,readValueFromPointer:ki,K:function(g){$n(g)}})},_embind_register_std_wstring:function(s,a,c){if(c=$t(c),a===2)var g=rc,b=ic,E=sc,R=()=>Ae,G=1;else a===4&&(g=ac,b=oc,E=lc,R=()=>Pe,G=2);Sn(s,{name:c,fromWireType:function(Q){for(var N=Pe[Q>>2],ke=R(),Ie,Me=Q+4,D=0;D<=N;++D){var we=Q+4+D*a;(D==N||ke[we>>G]==0)&&(Me=g(Me,we-Me),Ie===void 0?Ie=Me:(Ie+="\0",Ie+=Me),Me=we+a)}return $n(Q),Ie},toWireType:function(Q,N){typeof N!="string"&&Xe(`Cannot pass non-string to C++ string type ${c}`);var ke=E(N),Ie=Zs(4+ke+a);return Pe[Ie>>2]=ke>>G,b(N,Ie+4,ke+a),Q!==null&&Q.push($n,Ie),Ie},argPackAdvance:8,readValueFromPointer:ki,K:function(Q){$n(Q)}})},_embind_register_value_object:function(s,a,c,g,b,E){Ji[s]={name:$t(a),Pa:Xt(c,g),W:Xt(b,E),fb:[]}},_embind_register_value_object_field:function(s,a,c,g,b,E,R,G,Q,N){Ji[s].fb.push({Sb:$t(a),Yb:c,Wb:Xt(g,b),Xb:E,rc:R,qc:Xt(G,Q),sc:N})},_embind_register_void:function(s,a){a=$t(a),Sn(s,{fc:!0,name:a,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(s,a,c){s=gn(s),a=wi(a,"emval::as");var g=[],b=mn(g);return Pe[c>>2]=b,a.toWireType(g,s)},_emval_call_method:function(s,a,c,g,b){s=is[s],a=gn(a),c=rs(c);var E=[];return Pe[g>>2]=mn(E),s(a,c,E,b)},_emval_call_void_method:function(s,a,c,g){s=is[s],a=gn(a),c=rs(c),s(a,c,null,g)},_emval_decref:Ks,_emval_get_method_caller:function(s,a){var c=dc(s,a),g=c[0];a=g.name+"_$"+c.slice(1).map(function(R){return R.name}).join("_")+"$";var b=xo[a];if(b!==void 0)return b;var E=Array(s-1);return b=cc((R,G,Q,N)=>{for(var ke=0,Ie=0;Ie<s-1;++Ie)E[Ie]=c[Ie+1].readValueFromPointer(N+ke),ke+=c[Ie+1].argPackAdvance;for(R=R[G].apply(R,E),Ie=0;Ie<s-1;++Ie)c[Ie+1].Nb&&c[Ie+1].Nb(E[Ie]);if(!g.fc)return g.toWireType(Q,R)}),xo[a]=b},_emval_get_module_property:function(s){return s=rs(s),mn(_[s])},_emval_get_property:function(s,a){return s=gn(s),a=gn(a),mn(s[a])},_emval_incref:function(s){4<s&&(cn.get(s).ub+=1)},_emval_new_array:function(){return mn([])},_emval_new_cstring:function(s){return mn(rs(s))},_emval_new_object:function(){return mn({})},_emval_run_destructors:function(s){var a=gn(s);bi(a),Ks(s)},_emval_set_property:function(s,a,c){s=gn(s),a=gn(a),c=gn(c),s[a]=c},_emval_take_value:function(s,a){return s=wi(s,"_emval_take_value"),s=s.readValueFromPointer(a),mn(s)},abort:()=>{Ne("")},emscripten_asm_const_int:(s,a,c)=>{Js.length=0;var g;for(c>>=2;g=oe[a++];)c+=g!=105&c,Js.push(g==105?ye[c]:re[c++>>1]),++c;return l[s].apply(null,Js)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(s,a,c)=>oe.copyWithin(s,a,a+c),emscripten_resize_heap:s=>{var a=oe.length;if(s>>>=0,2147483648<s)return!1;for(var c=1;4>=c;c*=2){var g=a*(1+.2/c);g=Math.min(g,s+100663296);var b=Math;g=Math.max(s,g);e:{b=b.min.call(b,2147483648,g+(65536-g%65536)%65536)-Z.buffer.byteLength+65535>>>16;try{Z.grow(b),te();var E=1;break e}catch{}E=void 0}if(E)return!0}return!1},environ_get:(s,a)=>{var c=0;return jo().forEach(function(g,b){var E=a+c;for(b=Pe[s+4*b>>2]=E,E=0;E<g.length;++E)se[b++>>0]=g.charCodeAt(E);se[b>>0]=0,c+=g.length+1}),0},environ_sizes_get:(s,a)=>{var c=jo();Pe[s>>2]=c.length;var g=0;return c.forEach(function(b){g+=b.length+1}),Pe[a>>2]=g,0},fd_close:function(s){try{var a=Gn(s);if(a.X===null)throw new Le(8);a.Ma&&(a.Ma=null);try{a.m.close&&a.m.close(a)}catch(c){throw c}finally{Ni[a.X]=null}return a.X=null,0}catch(c){if(typeof dr>"u"||c.name!=="ErrnoError")throw c;return c.aa}},fd_read:function(s,a,c,g){try{e:{var b=Gn(s);s=a;for(var E,R=a=0;R<c;R++){var G=Pe[s>>2],Q=Pe[s+4>>2];s+=8;var N=b,ke=G,Ie=Q,Me=E,D=se;if(0>Ie||0>Me)throw new Le(28);if(N.X===null)throw new Le(8);if((N.flags&2097155)===1)throw new Le(8);if((N.node.mode&61440)===16384)throw new Le(31);if(!N.m.read)throw new Le(28);var we=typeof Me<"u";if(!we)Me=N.position;else if(!N.seekable)throw new Le(70);var ge=N.m.read(N,D,ke,Ie,Me);we||(N.position+=ge);var Qe=ge;if(0>Qe){var tt=-1;break e}if(a+=Qe,Qe<Q)break;typeof E<"u"&&(E+=Qe)}tt=a}return Pe[g>>2]=tt,0}catch(Te){if(typeof dr>"u"||Te.name!=="ErrnoError")throw Te;return Te.aa}},fd_seek:function(s,a,c,g,b){a=c+2097152>>>0<4194305-!!a?(a>>>0)+4294967296*c:NaN;try{if(isNaN(a))return 61;var E=Gn(s);return co(E,a,g),y=[E.position>>>0,(wt=E.position,1<=+Math.abs(wt)?0<wt?+Math.floor(wt/4294967296)>>>0:~~+Math.ceil((wt-+(~~wt>>>0))/4294967296)>>>0:0)],ye[b>>2]=y[0],ye[b+4>>2]=y[1],E.Ma&&a===0&&g===0&&(E.Ma=null),0}catch(R){if(typeof dr>"u"||R.name!=="ErrnoError")throw R;return R.aa}},fd_write:function(s,a,c,g){try{e:{var b=Gn(s);s=a;for(var E,R=a=0;R<c;R++){var G=Pe[s>>2],Q=Pe[s+4>>2];s+=8;var N=b,ke=G,Ie=Q,Me=E,D=se;if(0>Ie||0>Me)throw new Le(28);if(N.X===null)throw new Le(8);if((N.flags&2097155)===0)throw new Le(8);if((N.node.mode&61440)===16384)throw new Le(31);if(!N.m.write)throw new Le(28);N.seekable&&N.flags&1024&&co(N,0,2);var we=typeof Me<"u";if(!we)Me=N.position;else if(!N.seekable)throw new Le(70);var ge=N.m.write(N,D,ke,Ie,Me,void 0);we||(N.position+=ge);var Qe=ge;if(0>Qe){var tt=-1;break e}a+=Qe,typeof E<"u"&&(E+=Qe)}tt=a}return Pe[g>>2]=tt,0}catch(Te){if(typeof dr>"u"||Te.name!=="ErrnoError")throw Te;return Te.aa}},strftime_l:(s,a,c,g)=>fc(s,a,c,g)};(function(){function s(c){if(L=c=c.exports,Z=L.memory,te(),ae=L.__indirect_function_table,q.unshift(L.__wasm_call_ctors),me--,_.monitorRunDependencies&&_.monitorRunDependencies(me),me==0&&$e){var g=$e;$e=null,g()}return c}var a={env:Lo,wasi_snapshot_preview1:Lo};if(me++,_.monitorRunDependencies&&_.monitorRunDependencies(me),_.instantiateWasm)try{return _.instantiateWasm(a,s)}catch(c){Y("Module.instantiateWasm callback failed with error: "+c),P(c)}return St(a,function(c){s(c.instance)}).catch(P),{}})();var $n=s=>($n=L.free)(s),Zs=s=>(Zs=L.malloc)(s),Do=()=>(Do=L.__errno_location)(),Fo=_._ma_device__on_notification_unlocked=s=>(Fo=_._ma_device__on_notification_unlocked=L.ma_device__on_notification_unlocked)(s);_._ma_malloc_emscripten=(s,a)=>(_._ma_malloc_emscripten=L.ma_malloc_emscripten)(s,a),_._ma_free_emscripten=(s,a)=>(_._ma_free_emscripten=L.ma_free_emscripten)(s,a);var $o=_._ma_device_process_pcm_frames_capture__webaudio=(s,a,c)=>($o=_._ma_device_process_pcm_frames_capture__webaudio=L.ma_device_process_pcm_frames_capture__webaudio)(s,a,c),Uo=_._ma_device_process_pcm_frames_playback__webaudio=(s,a,c)=>(Uo=_._ma_device_process_pcm_frames_playback__webaudio=L.ma_device_process_pcm_frames_playback__webaudio)(s,a,c),No=s=>(No=L.__getTypeName)(s);_.__embind_initialize_bindings=()=>(_.__embind_initialize_bindings=L._embind_initialize_bindings)(),_.dynCall_iiji=(s,a,c,g,b)=>(_.dynCall_iiji=L.dynCall_iiji)(s,a,c,g,b),_.dynCall_jiji=(s,a,c,g,b)=>(_.dynCall_jiji=L.dynCall_jiji)(s,a,c,g,b),_.dynCall_iiiji=(s,a,c,g,b,E)=>(_.dynCall_iiiji=L.dynCall_iiiji)(s,a,c,g,b,E),_.dynCall_iij=(s,a,c,g)=>(_.dynCall_iij=L.dynCall_iij)(s,a,c,g),_.dynCall_jii=(s,a,c)=>(_.dynCall_jii=L.dynCall_jii)(s,a,c),_.dynCall_viijii=(s,a,c,g,b,E,R)=>(_.dynCall_viijii=L.dynCall_viijii)(s,a,c,g,b,E,R),_.dynCall_iiiiij=(s,a,c,g,b,E,R)=>(_.dynCall_iiiiij=L.dynCall_iiiiij)(s,a,c,g,b,E,R),_.dynCall_iiiiijj=(s,a,c,g,b,E,R,G,Q)=>(_.dynCall_iiiiijj=L.dynCall_iiiiijj)(s,a,c,g,b,E,R,G,Q),_.dynCall_iiiiiijj=(s,a,c,g,b,E,R,G,Q,N)=>(_.dynCall_iiiiiijj=L.dynCall_iiiiiijj)(s,a,c,g,b,E,R,G,Q,N);var os;$e=function s(){os||Bo(),os||($e=s)};function Bo(){function s(){if(!os&&(os=!0,_.calledRun=!0,!V)){if(_.noFSInit||ho||(ho=!0,fo(),_.stdin=_.stdin,_.stdout=_.stdout,_.stderr=_.stderr,_.stdin?pi("stdin",_.stdin):Ns("/dev/tty","/dev/stdin"),_.stdout?pi("stdout",null,_.stdout):Ns("/dev/tty","/dev/stdout"),_.stderr?pi("stderr",null,_.stderr):Ns("/dev/tty1","/dev/stderr"),qi("/dev/stdin",0),qi("/dev/stdout",1),qi("/dev/stderr",1)),no=!1,d(q),k(_),_.onRuntimeInitialized&&_.onRuntimeInitialized(),_.postRun)for(typeof _.postRun=="function"&&(_.postRun=[_.postRun]);_.postRun.length;){var a=_.postRun.shift();K.unshift(a)}d(K)}}if(!(0<me)){if(_.preRun)for(typeof _.preRun=="function"&&(_.preRun=[_.preRun]);_.preRun.length;)ve();d(fe),0<me||(_.setStatus?(_.setStatus("Running..."),setTimeout(function(){setTimeout(function(){_.setStatus("")},1),s()},1)):s())}}if(_.preInit)for(typeof _.preInit=="function"&&(_.preInit=[_.preInit]);0<_.preInit.length;)_.preInit.pop()();return Bo(),I.ready})})();const m=p}),(u=>{u.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((u,f,v)=>{v.r(f),v.d(f,{Animation:()=>p.Animation});var p=v(4)}),((u,f,v)=>{v.r(f),v.d(f,{Animation:()=>p});var p=(function(){function m(w,I,_,k){this.animation=w,this.artboard=I,this.playing=k,this.loopCount=0,this.scrubTo=null,this.instance=new _.LinearAnimationInstance(w,I)}return Object.defineProperty(m.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"time",{get:function(){return this.instance.time},set:function(w){this.instance.time=w},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),m.prototype.advance=function(w){this.scrubTo===null?this.instance.advance(w):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},m.prototype.apply=function(w){this.instance.apply(w)},m.prototype.cleanup=function(){this.instance.delete()},m})()}),((u,f,v)=>{v.r(f),v.d(f,{AudioAssetWrapper:()=>w.AudioAssetWrapper,AudioWrapper:()=>w.AudioWrapper,BLANK_URL:()=>m.BLANK_URL,CustomFileAssetLoaderWrapper:()=>w.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>w.FileAssetWrapper,Finalizable:()=>w.Finalizable,FontAssetWrapper:()=>w.FontAssetWrapper,FontWrapper:()=>w.FontWrapper,ImageAssetWrapper:()=>w.ImageAssetWrapper,ImageWrapper:()=>w.ImageWrapper,finalizationRegistry:()=>w.finalizationRegistry,registerTouchInteractions:()=>p.registerTouchInteractions,sanitizeUrl:()=>m.sanitizeUrl});var p=v(6),m=v(7),w=v(8)}),((u,f,v)=>{v.r(f),v.d(f,{registerTouchInteractions:()=>w});var p=void 0,m=function(I,_){var k,P;return["touchstart","touchmove"].indexOf(I.type)>-1&&(!((k=I.touches)===null||k===void 0)&&k.length)?(_||I.preventDefault(),{clientX:I.touches[0].clientX,clientY:I.touches[0].clientY}):I.type==="touchend"&&(!((P=I.changedTouches)===null||P===void 0)&&P.length)?{clientX:I.changedTouches[0].clientX,clientY:I.changedTouches[0].clientY}:{clientX:I.clientX,clientY:I.clientY}},w=function(I){var _=I.canvas,k=I.artboard,P=I.stateMachines,x=P===void 0?[]:P,$=I.renderer,z=I.rive,M=I.fit,U=I.alignment,F=I.isTouchScrollEnabled,C=F===void 0?!1:F,j=I.layoutScaleFactor,ne=j===void 0?1:j;if(!_||!x.length||!$||!z||!k||typeof window>"u")return null;var le=null,_e=!1,he=function(J){if(_e&&J instanceof MouseEvent){J.type=="mouseup"&&(_e=!1);return}_e=C&&J.type==="touchend"&&le==="touchstart",le=J.type;var Y=J.currentTarget.getBoundingClientRect(),W=m(J,C),Z=W.clientX,L=W.clientY;if(!(!Z&&!L)){var V=Z-Y.left,se=L-Y.top,oe=z.computeAlignment(M,U,{minX:0,minY:0,maxX:Y.width,maxY:Y.height},k.bounds,ne),be=new z.Mat2D;oe.invert(be);var Ae=new z.Vec2D(V,se),ye=z.mapXY(be,Ae),Pe=ye.x(),ce=ye.y();switch(ye.delete(),be.delete(),Ae.delete(),oe.delete(),J.type){case"mouseout":for(var re=0,te=x;re<te.length;re++){var ae=te[re];ae.pointerMove(Pe,ce)}break;case"touchmove":case"mouseover":case"mousemove":{for(var fe=0,q=x;fe<q.length;fe++){var ae=q[fe];ae.pointerMove(Pe,ce)}break}case"touchstart":case"mousedown":{for(var K=0,ve=x;K<ve.length;K++){var ae=ve[K];ae.pointerDown(Pe,ce)}break}case"touchend":case"mouseup":{for(var me=0,$e=x;me<$e.length;me++){var ae=$e[me];ae.pointerUp(Pe,ce)}break}}}},ue=he.bind(p);return _.addEventListener("mouseover",ue),_.addEventListener("mouseout",ue),_.addEventListener("mousemove",ue),_.addEventListener("mousedown",ue),_.addEventListener("mouseup",ue),_.addEventListener("touchmove",ue,{passive:C}),_.addEventListener("touchstart",ue,{passive:C}),_.addEventListener("touchend",ue),function(){_.removeEventListener("mouseover",ue),_.removeEventListener("mouseout",ue),_.removeEventListener("mousemove",ue),_.removeEventListener("mousedown",ue),_.removeEventListener("mouseup",ue),_.removeEventListener("touchmove",ue),_.removeEventListener("touchstart",ue),_.removeEventListener("touchend",ue)}}}),((u,f,v)=>{v.r(f),v.d(f,{BLANK_URL:()=>P,sanitizeUrl:()=>z});var p=/^([^\w]*)(javascript|data|vbscript)/im,m=/&#(\w+)(^\w|;)?/g,w=/&(newline|tab);/gi,I=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,_=/^.+(:|&colon;)/gim,k=[".","/"],P="about:blank";function x(M){return k.indexOf(M[0])>-1}function $(M){var U=M.replace(I,"");return U.replace(m,function(F,C){return String.fromCharCode(C)})}function z(M){if(!M)return P;var U=$(M).replace(w,"").replace(I,"").trim();if(!U)return P;if(x(U))return U;var F=U.match(_);if(!F)return U;var C=F[0];return p.test(C)?P:U}}),((u,f,v)=>{v.r(f),v.d(f,{AudioAssetWrapper:()=>$,AudioWrapper:()=>I,CustomFileAssetLoaderWrapper:()=>k,FileAssetWrapper:()=>P,Finalizable:()=>m,FontAssetWrapper:()=>z,FontWrapper:()=>_,ImageAssetWrapper:()=>x,ImageWrapper:()=>w,finalizationRegistry:()=>F});var p=(function(){var C=function(j,ne){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(le,_e){le.__proto__=_e}||function(le,_e){for(var he in _e)Object.prototype.hasOwnProperty.call(_e,he)&&(le[he]=_e[he])},C(j,ne)};return function(j,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Class extends value "+String(ne)+" is not a constructor or null");C(j,ne);function le(){this.constructor=j}j.prototype=ne===null?Object.create(ne):(le.prototype=ne.prototype,new le)}})(),m=(function(){function C(){this.selfUnref=!1}return C})(),w=(function(C){p(j,C);function j(ne){var le=C.call(this)||this;return le._nativeImage=ne,le}return Object.defineProperty(j.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),j.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},j})(m),I=(function(C){p(j,C);function j(ne){var le=C.call(this)||this;return le._nativeAudio=ne,le}return Object.defineProperty(j.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),j.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},j})(m),_=(function(C){p(j,C);function j(ne){var le=C.call(this)||this;return le._nativeFont=ne,le}return Object.defineProperty(j.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),j.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},j})(m),k=(function(){function C(j,ne){this._assetLoaderCallback=ne,this.assetLoader=new j.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return C.prototype.loadContents=function(j,ne){var le;return j.isImage?le=new x(j):j.isAudio?le=new $(j):j.isFont&&(le=new z(j)),this._assetLoaderCallback(le,ne)},C})(),P=(function(){function C(j){this._nativeFileAsset=j}return C.prototype.decode=function(j){this._nativeFileAsset.decode(j)},Object.defineProperty(C.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),C})(),x=(function(C){p(j,C);function j(){return C!==null&&C.apply(this,arguments)||this}return j.prototype.setRenderImage=function(ne){this._nativeFileAsset.setRenderImage(ne.nativeImage)},j})(P),$=(function(C){p(j,C);function j(){return C!==null&&C.apply(this,arguments)||this}return j.prototype.setAudioSource=function(ne){this._nativeFileAsset.setAudioSource(ne.nativeAudio)},j})(P),z=(function(C){p(j,C);function j(){return C!==null&&C.apply(this,arguments)||this}return j.prototype.setFont=function(ne){this._nativeFileAsset.setFont(ne.nativeFont)},j})(P),M=(function(){function C(j){}return C.prototype.register=function(j){j.selfUnref=!0},C.prototype.unregister=function(j){},C})(),U=typeof FinalizationRegistry<"u"?FinalizationRegistry:M,F=new U(function(C){C.unref()})})],r={};function i(u){var f=r[u];if(f!==void 0)return f.exports;var v=r[u]={exports:{}};return t[u](v,v.exports,i),v.exports}i.d=(u,f)=>{for(var v in f)i.o(f,v)&&!i.o(u,v)&&Object.defineProperty(u,v,{enumerable:!0,get:f[v]})},i.o=(u,f)=>Object.prototype.hasOwnProperty.call(u,f),i.r=u=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})};var o={};return(()=>{i.r(o),i.d(o,{Alignment:()=>z,DataEnum:()=>ce,EventType:()=>he,Fit:()=>$,Layout:()=>M,LoopType:()=>ue,Rive:()=>ye,RiveEventType:()=>j,RiveFile:()=>Ae,RuntimeLoader:()=>U,StateMachineInput:()=>C,StateMachineInputType:()=>F,Testing:()=>gt,ViewModel:()=>Pe,ViewModelInstance:()=>te,ViewModelInstanceArtboard:()=>je,ViewModelInstanceAssetImage:()=>Ue,ViewModelInstanceBoolean:()=>K,ViewModelInstanceColor:()=>Ne,ViewModelInstanceEnum:()=>me,ViewModelInstanceList:()=>$e,ViewModelInstanceNumber:()=>q,ViewModelInstanceString:()=>fe,ViewModelInstanceTrigger:()=>ve,ViewModelInstanceValue:()=>ae,decodeAudio:()=>lt,decodeFont:()=>wt,decodeImage:()=>St});var u=i(1),f=i(2),v=i(3),p=i(5),m=(function(){var y=function(l,d){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,O){S.__proto__=O}||function(S,O){for(var X in O)Object.prototype.hasOwnProperty.call(O,X)&&(S[X]=O[X])},y(l,d)};return function(l,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");y(l,d);function S(){this.constructor=l}l.prototype=d===null?Object.create(d):(S.prototype=d.prototype,new S)}})(),w=function(){return w=Object.assign||function(y){for(var l,d=1,S=arguments.length;d<S;d++){l=arguments[d];for(var O in l)Object.prototype.hasOwnProperty.call(l,O)&&(y[O]=l[O])}return y},w.apply(this,arguments)},I=function(y,l,d,S){function O(X){return X instanceof d?X:new d(function(de){de(X)})}return new(d||(d=Promise))(function(X,de){function Fe(Ve){try{Oe(S.next(Ve))}catch(rt){de(rt)}}function We(Ve){try{Oe(S.throw(Ve))}catch(rt){de(rt)}}function Oe(Ve){Ve.done?X(Ve.value):O(Ve.value).then(Fe,We)}Oe((S=S.apply(y,l||[])).next())})},_=function(y,l){var d={label:0,sent:function(){if(X[0]&1)throw X[1];return X[1]},trys:[],ops:[]},S,O,X,de=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return de.next=Fe(0),de.throw=Fe(1),de.return=Fe(2),typeof Symbol=="function"&&(de[Symbol.iterator]=function(){return this}),de;function Fe(Oe){return function(Ve){return We([Oe,Ve])}}function We(Oe){if(S)throw new TypeError("Generator is already executing.");for(;de&&(de=0,Oe[0]&&(d=0)),d;)try{if(S=1,O&&(X=Oe[0]&2?O.return:Oe[0]?O.throw||((X=O.return)&&X.call(O),0):O.next)&&!(X=X.call(O,Oe[1])).done)return X;switch(O=0,X&&(Oe=[Oe[0]&2,X.value]),Oe[0]){case 0:case 1:X=Oe;break;case 4:return d.label++,{value:Oe[1],done:!1};case 5:d.label++,O=Oe[1],Oe=[0];continue;case 7:Oe=d.ops.pop(),d.trys.pop();continue;default:if(X=d.trys,!(X=X.length>0&&X[X.length-1])&&(Oe[0]===6||Oe[0]===2)){d=0;continue}if(Oe[0]===3&&(!X||Oe[1]>X[0]&&Oe[1]<X[3])){d.label=Oe[1];break}if(Oe[0]===6&&d.label<X[1]){d.label=X[1],X=Oe;break}if(X&&d.label<X[2]){d.label=X[2],d.ops.push(Oe);break}X[2]&&d.ops.pop(),d.trys.pop();continue}Oe=l.call(y,d)}catch(Ve){Oe=[6,Ve],O=0}finally{S=X=0}if(Oe[0]&5)throw Oe[1];return{value:Oe[0]?Oe[1]:void 0,done:!0}}},k=function(y,l,d){if(d||arguments.length===2)for(var S=0,O=l.length,X;S<O;S++)(X||!(S in l))&&(X||(X=Array.prototype.slice.call(l,0,S)),X[S]=l[S]);return y.concat(X||Array.prototype.slice.call(l))},P=(function(y){m(l,y);function l(){var d=y!==null&&y.apply(this,arguments)||this;return d.isHandledError=!0,d}return l})(Error),x=function(y){return y&&y.isHandledError?y.message:"Problem loading file; may be corrupt!"},$;(function(y){y.Cover="cover",y.Contain="contain",y.Fill="fill",y.FitWidth="fitWidth",y.FitHeight="fitHeight",y.None="none",y.ScaleDown="scaleDown",y.Layout="layout"})($||($={}));var z;(function(y){y.Center="center",y.TopLeft="topLeft",y.TopCenter="topCenter",y.TopRight="topRight",y.CenterLeft="centerLeft",y.CenterRight="centerRight",y.BottomLeft="bottomLeft",y.BottomCenter="bottomCenter",y.BottomRight="bottomRight"})(z||(z={}));var M=(function(){function y(l){var d,S,O,X,de,Fe,We;this.fit=(d=l?.fit)!==null&&d!==void 0?d:$.Contain,this.alignment=(S=l?.alignment)!==null&&S!==void 0?S:z.Center,this.layoutScaleFactor=(O=l?.layoutScaleFactor)!==null&&O!==void 0?O:1,this.minX=(X=l?.minX)!==null&&X!==void 0?X:0,this.minY=(de=l?.minY)!==null&&de!==void 0?de:0,this.maxX=(Fe=l?.maxX)!==null&&Fe!==void 0?Fe:0,this.maxY=(We=l?.maxY)!==null&&We!==void 0?We:0}return y.new=function(l){var d=l.fit,S=l.alignment,O=l.minX,X=l.minY,de=l.maxX,Fe=l.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new y({fit:d,alignment:S,minX:O,minY:X,maxX:de,maxY:Fe})},y.prototype.copyWith=function(l){var d=l.fit,S=l.alignment,O=l.layoutScaleFactor,X=l.minX,de=l.minY,Fe=l.maxX,We=l.maxY;return new y({fit:d??this.fit,alignment:S??this.alignment,layoutScaleFactor:O??this.layoutScaleFactor,minX:X??this.minX,minY:de??this.minY,maxX:Fe??this.maxX,maxY:We??this.maxY})},y.prototype.runtimeFit=function(l){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var d;return this.fit===$.Cover?d=l.Fit.cover:this.fit===$.Contain?d=l.Fit.contain:this.fit===$.Fill?d=l.Fit.fill:this.fit===$.FitWidth?d=l.Fit.fitWidth:this.fit===$.FitHeight?d=l.Fit.fitHeight:this.fit===$.ScaleDown?d=l.Fit.scaleDown:this.fit===$.Layout?d=l.Fit.layout:d=l.Fit.none,this.cachedRuntimeFit=d,d},y.prototype.runtimeAlignment=function(l){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var d;return this.alignment===z.TopLeft?d=l.Alignment.topLeft:this.alignment===z.TopCenter?d=l.Alignment.topCenter:this.alignment===z.TopRight?d=l.Alignment.topRight:this.alignment===z.CenterLeft?d=l.Alignment.centerLeft:this.alignment===z.CenterRight?d=l.Alignment.centerRight:this.alignment===z.BottomLeft?d=l.Alignment.bottomLeft:this.alignment===z.BottomCenter?d=l.Alignment.bottomCenter:this.alignment===z.BottomRight?d=l.Alignment.bottomRight:d=l.Alignment.center,this.cachedRuntimeAlignment=d,d},y})(),U=(function(){function y(){}return y.loadRuntime=function(){u.default({locateFile:function(){return y.wasmURL}}).then(function(l){var d;for(y.runtime=l;y.callBackQueue.length>0;)(d=y.callBackQueue.shift())===null||d===void 0||d(y.runtime)}).catch(function(l){var d={message:l?.message||"Unknown error",type:l?.name||"Error",wasmError:l instanceof WebAssembly.CompileError||l instanceof WebAssembly.RuntimeError,originalError:l};console.debug("Rive WASM load error details:",d);var S="https://cdn.jsdelivr.net/npm/".concat(f.name,"@").concat(f.version,"/rive_fallback.wasm");if(y.wasmURL.toLowerCase()!==S)console.warn("Failed to load WASM from ".concat(y.wasmURL," (").concat(d.message,"), trying jsdelivr as a backup")),y.setWasmUrl(S),y.loadRuntime();else{var O=["Could not load Rive WASM file from ".concat(y.wasmURL," or ").concat(S,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(d.type),"- Message: ".concat(d.message),"- WebAssembly-specific error: ".concat(d.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(O)}})},y.getInstance=function(l){y.isLoading||(y.isLoading=!0,y.loadRuntime()),y.runtime?l(y.runtime):y.callBackQueue.push(l)},y.awaitInstance=function(){return new Promise(function(l){return y.getInstance(function(d){return l(d)})})},y.setWasmUrl=function(l){y.wasmURL=l},y.getWasmUrl=function(){return y.wasmURL},y.isLoading=!1,y.callBackQueue=[],y.wasmURL="https://unpkg.com/".concat(f.name,"@").concat(f.version,"/rive.wasm"),y})(),F;(function(y){y[y.Number=56]="Number",y[y.Trigger=58]="Trigger",y[y.Boolean=59]="Boolean"})(F||(F={}));var C=(function(){function y(l,d){this.type=l,this.runtimeInput=d}return Object.defineProperty(y.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(l){this.runtimeInput.value=l},enumerable:!1,configurable:!0}),y.prototype.fire=function(){this.type===F.Trigger&&this.runtimeInput.fire()},y.prototype.delete=function(){this.runtimeInput=null},y})(),j;(function(y){y[y.General=128]="General",y[y.OpenUrl=131]="OpenUrl"})(j||(j={}));var ne=(function(){function y(l){this.nativeArtboard=l}return y})(),le=(function(){function y(l,d,S,O){this.stateMachine=l,this.playing=S,this.artboard=O,this.inputs=[],this.instance=new d.StateMachineInstance(l,O),this.initInputs(d)}return Object.defineProperty(y.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"statesChanged",{get:function(){for(var l=[],d=0;d<this.instance.stateChangedCount();d++)l.push(this.instance.stateChangedNameByIndex(d));return l},enumerable:!1,configurable:!0}),y.prototype.advance=function(l){this.instance.advance(l)},y.prototype.advanceAndApply=function(l){this.instance.advanceAndApply(l)},y.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},y.prototype.reportedEventAt=function(l){return this.instance.reportedEventAt(l)},y.prototype.initInputs=function(l){for(var d=0;d<this.instance.inputCount();d++){var S=this.instance.input(d);this.inputs.push(this.mapRuntimeInput(S,l))}},y.prototype.mapRuntimeInput=function(l,d){if(l.type===d.SMIInput.bool)return new C(F.Boolean,l.asBool());if(l.type===d.SMIInput.number)return new C(F.Number,l.asNumber());if(l.type===d.SMIInput.trigger)return new C(F.Trigger,l.asTrigger())},y.prototype.cleanup=function(){this.inputs.forEach(function(l){l.delete()}),this.inputs.length=0,this.instance.delete()},y.prototype.bindViewModelInstance=function(l){l.runtimeInstance!=null&&this.instance.bindViewModelInstance(l.runtimeInstance)},y})(),_e=(function(){function y(l,d,S,O,X){O===void 0&&(O=[]),X===void 0&&(X=[]),this.runtime=l,this.artboard=d,this.eventManager=S,this.animations=O,this.stateMachines=X}return y.prototype.add=function(l,d,S){if(S===void 0&&(S=!0),l=qe(l),l.length===0)this.animations.forEach(function(bt){return bt.playing=d}),this.stateMachines.forEach(function(bt){return bt.playing=d});else for(var O=this.animations.map(function(bt){return bt.name}),X=this.stateMachines.map(function(bt){return bt.name}),de=0;de<l.length;de++){var Fe=O.indexOf(l[de]),We=X.indexOf(l[de]);if(Fe>=0||We>=0)Fe>=0?this.animations[Fe].playing=d:this.stateMachines[We].playing=d;else{var Oe=this.artboard.animationByName(l[de]);if(Oe){var Ve=new v.Animation(Oe,this.artboard,this.runtime,d);Ve.advance(0),Ve.apply(1),this.animations.push(Ve)}else{var rt=this.artboard.stateMachineByName(l[de]);if(rt){var Dt=new le(rt,this.runtime,d,this.artboard);this.stateMachines.push(Dt)}}}}return S&&(d?this.eventManager.fire({type:he.Play,data:this.playing}):this.eventManager.fire({type:he.Pause,data:this.paused})),d?this.playing:this.paused},y.prototype.initLinearAnimations=function(l,d){for(var S=this.animations.map(function(We){return We.name}),O=0;O<l.length;O++){var X=S.indexOf(l[O]);if(X>=0)this.animations[X].playing=d;else{var de=this.artboard.animationByName(l[O]);if(de){var Fe=new v.Animation(de,this.artboard,this.runtime,d);Fe.advance(0),Fe.apply(1),this.animations.push(Fe)}else console.error("Animation with name ".concat(l[O]," not found."))}}},y.prototype.initStateMachines=function(l,d){for(var S=this.stateMachines.map(function(We){return We.name}),O=0;O<l.length;O++){var X=S.indexOf(l[O]);if(X>=0)this.stateMachines[X].playing=d;else{var de=this.artboard.stateMachineByName(l[O]);if(de){var Fe=new le(de,this.runtime,d,this.artboard);this.stateMachines.push(Fe),d||Fe.advanceAndApply(0)}else console.warn("State Machine with name ".concat(l[O]," not found.")),this.initLinearAnimations([l[O]],d)}}},y.prototype.play=function(l){return this.add(l,!0)},y.prototype.pause=function(l){return this.add(l,!1)},y.prototype.scrub=function(l,d){var S=this.animations.filter(function(O){return l.includes(O.name)});return S.forEach(function(O){return O.scrubTo=d}),S.map(function(O){return O.name})},Object.defineProperty(y.prototype,"playing",{get:function(){return this.animations.filter(function(l){return l.playing}).map(function(l){return l.name}).concat(this.stateMachines.filter(function(l){return l.playing}).map(function(l){return l.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"paused",{get:function(){return this.animations.filter(function(l){return!l.playing}).map(function(l){return l.name}).concat(this.stateMachines.filter(function(l){return!l.playing}).map(function(l){return l.name}))},enumerable:!1,configurable:!0}),y.prototype.stop=function(l){var d=this;l=qe(l);var S=[];if(l.length===0)S=this.animations.map(function(de){return de.name}).concat(this.stateMachines.map(function(de){return de.name})),this.animations.forEach(function(de){return de.cleanup()}),this.stateMachines.forEach(function(de){return de.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var O=this.animations.filter(function(de){return l.includes(de.name)});O.forEach(function(de){de.cleanup(),d.animations.splice(d.animations.indexOf(de),1)});var X=this.stateMachines.filter(function(de){return l.includes(de.name)});X.forEach(function(de){de.cleanup(),d.stateMachines.splice(d.stateMachines.indexOf(de),1)}),S=O.map(function(de){return de.name}).concat(X.map(function(de){return de.name}))}return this.eventManager.fire({type:he.Stop,data:S}),S},Object.defineProperty(y.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(l,d){return l||d.playing},!1)||this.stateMachines.reduce(function(l,d){return l||d.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),y.prototype.atLeastOne=function(l,d){d===void 0&&(d=!0);var S;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([S=this.artboard.animationByIndex(0).name],l,d):this.artboard.stateMachineCount()>0&&this.add([S=this.artboard.stateMachineByIndex(0).name],l,d)),S},y.prototype.handleLooping=function(){for(var l=0,d=this.animations.filter(function(O){return O.playing});l<d.length;l++){var S=d[l];S.loopValue===0&&S.loopCount?(S.loopCount=0,this.stop(S.name)):S.loopValue===1&&S.loopCount?(this.eventManager.fire({type:he.Loop,data:{animation:S.name,type:ue.Loop}}),S.loopCount=0):S.loopValue===2&&S.loopCount>1&&(this.eventManager.fire({type:he.Loop,data:{animation:S.name,type:ue.PingPong}}),S.loopCount=0)}},y.prototype.handleStateChanges=function(){for(var l=[],d=0,S=this.stateMachines.filter(function(X){return X.playing});d<S.length;d++){var O=S[d];l.push.apply(l,O.statesChanged)}l.length>0&&this.eventManager.fire({type:he.StateChange,data:l})},y.prototype.handleAdvancing=function(l){this.eventManager.fire({type:he.Advance,data:l})},y})(),he;(function(y){y.Load="load",y.LoadError="loaderror",y.Play="play",y.Pause="pause",y.Stop="stop",y.Loop="loop",y.Draw="draw",y.Advance="advance",y.StateChange="statechange",y.RiveEvent="riveevent",y.AudioStatusChange="audiostatuschange"})(he||(he={}));var ue;(function(y){y.OneShot="oneshot",y.Loop="loop",y.PingPong="pingpong"})(ue||(ue={}));var J=(function(){function y(l){l===void 0&&(l=[]),this.listeners=l}return y.prototype.getListeners=function(l){return this.listeners.filter(function(d){return d.type===l})},y.prototype.add=function(l){this.listeners.includes(l)||this.listeners.push(l)},y.prototype.remove=function(l){for(var d=0;d<this.listeners.length;d++){var S=this.listeners[d];if(S.type===l.type&&S.callback===l.callback){this.listeners.splice(d,1);break}}},y.prototype.removeAll=function(l){var d=this;l?this.listeners.filter(function(S){return S.type===l}).forEach(function(S){return d.remove(S)}):this.listeners.splice(0,this.listeners.length)},y.prototype.fire=function(l){var d=this.getListeners(l.type);d.forEach(function(S){return S.callback(l)})},y})(),Y=(function(){function y(l){this.eventManager=l,this.queue=[]}return y.prototype.add=function(l){this.queue.push(l)},y.prototype.process=function(){for(;this.queue.length>0;){var l=this.queue.shift();l?.action&&l.action(),l?.event&&this.eventManager.fire(l.event)}},y})(),W;(function(y){y[y.AVAILABLE=0]="AVAILABLE",y[y.UNAVAILABLE=1]="UNAVAILABLE"})(W||(W={}));var Z=(function(y){m(l,y);function l(){var d=y!==null&&y.apply(this,arguments)||this;return d._started=!1,d._enabled=!1,d._status=W.UNAVAILABLE,d}return l.prototype.delay=function(d){return I(this,void 0,void 0,function(){return _(this,function(S){return[2,new Promise(function(O){return setTimeout(O,d)})]})})},l.prototype.timeout=function(){return I(this,void 0,void 0,function(){return _(this,function(d){return[2,new Promise(function(S,O){return setTimeout(O,50)})]})})},l.prototype.reportToListeners=function(){this.fire({type:he.AudioStatusChange}),this.removeAll()},l.prototype.enableAudio=function(){return I(this,void 0,void 0,function(){return _(this,function(d){return this._enabled||(this._enabled=!0,this._status=W.AVAILABLE,this.reportToListeners()),[2]})})},l.prototype.testAudio=function(){return I(this,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:if(!(this._status===W.UNAVAILABLE&&this._audioContext!==null))return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return d.sent(),this.enableAudio(),[3,4];case 3:return d.sent(),[3,4];case 4:return[2]}})})},l.prototype._establishAudio=function(){return I(this,void 0,void 0,function(){return _(this,function(d){switch(d.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),d.label=2;case 2:return this._status!==W.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return d.sent(),[4,this.delay(1e3)];case 4:return d.sent(),[3,2];case 5:return[2]}})})},l.prototype.listenForUserAction=function(){var d=this,S=function(){return I(d,void 0,void 0,function(){return _(this,function(O){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",S,{once:!0})},l.prototype.establishAudio=function(){return I(this,void 0,void 0,function(){return _(this,function(d){return this._establishAudio(),[2]})})},Object.defineProperty(l.prototype,"systemVolume",{get:function(){return this._status===W.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),l})(J),L=new Z,V=(function(){function y(){}return y.prototype.observe=function(){},y.prototype.unobserve=function(){},y.prototype.disconnect=function(){},y})(),se=globalThis.ResizeObserver||V,oe=(function(){function y(){var l=this;this._elementsMap=new Map,this._onObservedEntry=function(d){var S=l._elementsMap.get(d.target);S!==null?S.onResize(d.target.clientWidth==0||d.target.clientHeight==0):l._resizeObserver.unobserve(d.target)},this._onObserved=function(d){d.forEach(l._onObservedEntry)},this._resizeObserver=new se(this._onObserved)}return y.prototype.add=function(l,d){var S={onResize:d,element:l};return this._elementsMap.set(l,S),this._resizeObserver.observe(l),S},y.prototype.remove=function(l){this._resizeObserver.unobserve(l.element),this._elementsMap.delete(l.element)},y})(),be=new oe,Ae=(function(){function y(l){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=l.src,this.buffer=l.buffer,l.assetLoader&&(this.assetLoader=l.assetLoader),this.enableRiveAssetCDN=typeof l.enableRiveAssetCDN=="boolean"?l.enableRiveAssetCDN:!0,this.eventManager=new J,l.onLoad&&this.on(he.Load,l.onLoad),l.onLoadError&&this.on(he.LoadError,l.onLoadError)}return y.prototype.initData=function(){return I(this,void 0,void 0,function(){var l,d,S,O,X;return _(this,function(de){switch(de.label){case 0:return this.src?(l=this,[4,ze(this.src)]):[3,2];case 1:l.buffer=de.sent(),de.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(S=new p.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),d=S.assetLoader),O=this,[4,this.runtime.load(new Uint8Array(this.buffer),d,this.enableRiveAssetCDN)]);case 3:return O.file=de.sent(),this.destroyed?((X=this.file)===null||X===void 0||X.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:he.Load,data:this}):this.fireLoadError(y.fileLoadErrorMessage),[2])}})})},y.prototype.init=function(){return I(this,void 0,void 0,function(){var l,d;return _(this,function(S){switch(S.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(y.missingErrorMessage),[2];S.label=1;case 1:return S.trys.push([1,4,,5]),l=this,[4,U.awaitInstance()];case 2:return l.runtime=S.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return S.sent(),[3,5];case 4:return d=S.sent(),this.fireLoadError(d instanceof Error?d.message:y.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},y.prototype.fireLoadError=function(l){throw this.eventManager.fire({type:he.LoadError,data:l}),new Error(l)},y.prototype.on=function(l,d){this.eventManager.add({type:l,callback:d})},y.prototype.off=function(l,d){this.eventManager.remove({type:l,callback:d})},y.prototype.cleanup=function(){var l;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(l=this.file)===null||l===void 0||l.delete(),this.file=null,this.destroyed=!0)},y.prototype.removeAllRiveEventListeners=function(l){this.eventManager.removeAll(l)},y.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},y.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},y.prototype.getArtboard=function(l){var d=this.file.artboardByName(l);return d!=null?new ne(d):null},y.missingErrorMessage="Rive source file or data buffer required",y.fileLoadErrorMessage="The file failed to load",y})(),ye=(function(){function y(l){var d=this,S;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(O){var X=d._hasZeroSize!==O;d._hasZeroSize=O,O?(!d._layout.maxX||!d._layout.maxY)&&d.resizeToCanvas():X&&d.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=l.canvas,l.canvas.constructor===HTMLCanvasElement&&(this._observed=be.add(this.canvas,this.onCanvasResize)),this.src=l.src,this.buffer=l.buffer,this.riveFile=l.riveFile,this.layout=(S=l.layout)!==null&&S!==void 0?S:new M,this.shouldDisableRiveListeners=!!l.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!l.isTouchScrollEnabled,this.automaticallyHandleEvents=!!l.automaticallyHandleEvents,this.enableRiveAssetCDN=l.enableRiveAssetCDN===void 0?!0:l.enableRiveAssetCDN,this.eventManager=new J,l.onLoad&&this.on(he.Load,l.onLoad),l.onLoadError&&this.on(he.LoadError,l.onLoadError),l.onPlay&&this.on(he.Play,l.onPlay),l.onPause&&this.on(he.Pause,l.onPause),l.onStop&&this.on(he.Stop,l.onStop),l.onLoop&&this.on(he.Loop,l.onLoop),l.onStateChange&&this.on(he.StateChange,l.onStateChange),l.onAdvance&&this.on(he.Advance,l.onAdvance),l.onload&&!l.onLoad&&this.on(he.Load,l.onload),l.onloaderror&&!l.onLoadError&&this.on(he.LoadError,l.onloaderror),l.onplay&&!l.onPlay&&this.on(he.Play,l.onplay),l.onpause&&!l.onPause&&this.on(he.Pause,l.onpause),l.onstop&&!l.onStop&&this.on(he.Stop,l.onstop),l.onloop&&!l.onLoop&&this.on(he.Loop,l.onloop),l.onstatechange&&!l.onStateChange&&this.on(he.StateChange,l.onstatechange),l.assetLoader&&(this.assetLoader=l.assetLoader),this.taskQueue=new Y(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:l.autoplay,autoBind:l.autoBind,animations:l.animations,stateMachines:l.stateMachines,artboard:l.artboard,useOffscreenRenderer:l.useOffscreenRenderer})}return Object.defineProperty(y.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),y.new=function(l){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new y(l)},y.prototype.onSystemAudioChanged=function(){this.volume=this._volume},y.prototype.init=function(l){var d=this,S=l.src,O=l.buffer,X=l.riveFile,de=l.animations,Fe=l.stateMachines,We=l.artboard,Oe=l.autoplay,Ve=Oe===void 0?!1:Oe,rt=l.useOffscreenRenderer,Dt=rt===void 0?!1:rt,bt=l.autoBind,Zt=bt===void 0?!1:bt;if(!this.destroyed){if(this.src=S,this.buffer=O,this.riveFile=X,!this.src&&!this.buffer&&!this.riveFile)throw new P(y.missingErrorMessage);var Yt=qe(de),jt=qe(Fe);this.loaded=!1,this.readyForPlaying=!1,U.awaitInstance().then(function(Ft){d.destroyed||(d.runtime=Ft,d.removeRiveListeners(),d.deleteRiveRenderer(),d.renderer=d.runtime.makeRenderer(d.canvas,Dt),d.canvas.width||d.canvas.height||d.resizeDrawingSurfaceToCanvas(),d.initData(We,Yt,jt,Ve,Zt).then(function(nt){if(nt)return d.setupRiveListeners()}).catch(function(nt){console.error(nt)}))}).catch(function(Ft){console.error(Ft)})}},y.prototype.setupRiveListeners=function(l){var d=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var S=(this.animator.stateMachines||[]).filter(function(X){return X.playing&&d.runtime.hasListeners(X.instance)}).map(function(X){return X.instance}),O=this.isTouchScrollEnabled;l&&"isTouchScrollEnabled"in l&&(O=l.isTouchScrollEnabled),this.eventCleanup=(0,p.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:S,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:O,layoutScaleFactor:this._layout.layoutScaleFactor})}},y.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},y.prototype.initializeAudio=function(){var l=this,d;L.status==W.UNAVAILABLE&&!((d=this.artboard)===null||d===void 0)&&d.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:he.AudioStatusChange,callback:function(){return l.onSystemAudioChanged()}},L.add(this._audioEventListener),L.establishAudio())},y.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},y.prototype.initData=function(l,d,S,O,X){return I(this,void 0,void 0,function(){var de,Fe,We,Oe;return _(this,function(Ve){switch(Ve.label){case 0:return Ve.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(de=new Ae({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=de,[4,de.init()]);case 1:if(Ve.sent(),this.destroyed)return de.destroyIfUnused(),[2,!1];Ve.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(l,d,S,O,X),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:he.Load,data:(Oe=this.src)!==null&&Oe!==void 0?Oe:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return Fe=Ve.sent(),We=x(Fe),console.warn(We),this.eventManager.fire({type:he.LoadError,data:We}),[2,Promise.reject(We)];case 4:return[2]}})})},y.prototype.initArtboard=function(l,d,S,O,X){if(this.file){var de=l?this.file.artboardByName(l):this.file.defaultArtboard();if(!de){var Fe="Invalid artboard name or no default artboard";console.warn(Fe),this.eventManager.fire({type:he.LoadError,data:Fe});return}if(this.artboard=de,de.volume=this._volume*L.systemVolume,this.artboard.animationCount()<1){var Fe="Artboard has no animations";throw this.eventManager.fire({type:he.LoadError,data:Fe}),Fe}this.animator=new _e(this.runtime,this.artboard,this.eventManager);var We;if(d.length>0||S.length>0?(We=d.concat(S),this.animator.initLinearAnimations(d,O),this.animator.initStateMachines(S,O)):We=[this.animator.atLeastOne(O,!1)],this.taskQueue.add({event:{type:O?he.Play:he.Pause,data:We}}),X){var Oe=this.file.defaultArtboardViewModel(de);if(Oe!==null){var Ve=Oe.defaultInstance();if(Ve!==null){var rt=new te(Ve,null);this.bindViewModelInstance(rt)}}}}},y.prototype.drawFrame=function(){var l,d;!((l=document?.timeline)===null||l===void 0)&&l.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(d=this.runtime)===null||d===void 0||d.resolveAnimationFrame()):this.startRendering()},y.prototype.draw=function(l,d){var S;this.frameRequestId=null;var O=performance.now();this.lastRenderTime||(this.lastRenderTime=l),this.renderSecondTimer+=l-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,d?.());var X=(l-this.lastRenderTime)/1e3;this.lastRenderTime=l;for(var de=this.animator.animations.filter(function(Bt){return Bt.playing||Bt.needsScrub}).sort(function(Bt){return Bt.needsScrub?-1:1}),Fe=0,We=de;Fe<We.length;Fe++){var Oe=We[Fe];Oe.advance(X),Oe.instance.didLoop&&(Oe.loopCount+=1),Oe.apply(1)}for(var Ve=this.animator.stateMachines.filter(function(Bt){return Bt.playing}),rt=0,Dt=Ve;rt<Dt.length;rt++){var bt=Dt[rt],Zt=bt.reportedEventCount();if(Zt)for(var Yt=0;Yt<Zt;Yt++){var jt=bt.reportedEventAt(Yt);if(jt)if(jt.type===j.OpenUrl){if(this.eventManager.fire({type:he.RiveEvent,data:jt}),this.automaticallyHandleEvents){var Ft=document.createElement("a"),nt=jt,Mt=nt.url,it=nt.target,ut=(0,p.sanitizeUrl)(Mt);Mt&&Ft.setAttribute("href",ut),it&&Ft.setAttribute("target",it),ut&&ut!==p.BLANK_URL&&Ft.click()}}else this.eventManager.fire({type:he.RiveEvent,data:jt})}bt.advanceAndApply(X)}this.animator.stateMachines.length==0&&this.artboard.advance(X);var Ce=this.renderer;Ce.clear(),Ce.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(Ce),Ce.restore(),Ce.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(X),this.frameCount++;var He=performance.now();for(this.frameTimes.push(He),this.durations.push(He-O);this.frameTimes[0]<=He-1e3;)this.frameTimes.shift(),this.durations.shift();(S=this._viewModelInstance)===null||S===void 0||S.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},y.prototype.alignRenderer=function(){var l=this,d=l.renderer,S=l.runtime,O=l._layout,X=l.artboard;d.align(O.runtimeFit(S),O.runtimeAlignment(S),{minX:O.minX,minY:O.minY,maxX:O.maxX,maxY:O.maxY},X.bounds,this._devicePixelRatioUsed*O.layoutScaleFactor)},Object.defineProperty(y.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(l,d){return l+d},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),y.prototype.cleanup=function(){var l,d;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&be.remove(this._observed),this.removeRiveListeners(),this.file&&((l=this.riveFile)===null||l===void 0||l.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(L.remove(this._audioEventListener),this._audioEventListener=null),(d=this._viewModelInstance)===null||d===void 0||d.cleanup(),this._viewModelInstance=null,this._dataEnums=null},y.prototype.deleteRiveRenderer=function(){var l;(l=this.renderer)===null||l===void 0||l.delete(),this.renderer=null},y.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},y.prototype.retrieveTextRun=function(l){var d;if(!l){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var S=this.artboard.textRun(l);if(!S){console.warn("Could not access a text run with name '".concat(l,"' in the '").concat((d=this.artboard)===null||d===void 0?void 0:d.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return S},y.prototype.getTextRunValue=function(l){var d=this.retrieveTextRun(l);return d?d.text:void 0},y.prototype.setTextRunValue=function(l,d){var S=this.retrieveTextRun(l);S&&(S.text=d)},y.prototype.play=function(l,d){var S=this;if(l=qe(l),!this.readyForPlaying){this.taskQueue.add({action:function(){return S.play(l,d)}});return}this.animator.play(l),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},y.prototype.pause=function(l){var d=this;if(l=qe(l),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.pause(l)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(l)},y.prototype.scrub=function(l,d){var S=this;if(l=qe(l),!this.readyForPlaying){this.taskQueue.add({action:function(){return S.scrub(l,d)}});return}this.animator.scrub(l,d||0),this.drawFrame()},y.prototype.stop=function(l){var d=this;if(l=qe(l),!this.readyForPlaying){this.taskQueue.add({action:function(){return d.stop(l)}});return}this.animator&&this.animator.stop(l),this.eventCleanup&&this.eventCleanup()},y.prototype.reset=function(l){var d,S,O=l?.artboard,X=qe(l?.animations),de=qe(l?.stateMachines),Fe=(d=l?.autoplay)!==null&&d!==void 0?d:!1,We=(S=l?.autoBind)!==null&&S!==void 0?S:!1;this.cleanupInstances(),this.initArtboard(O,X,de,Fe,We),this.taskQueue.process()},y.prototype.load=function(l){this.file=null,this.stop(),this.init(l)},Object.defineProperty(y.prototype,"layout",{get:function(){return this._layout},set:function(l){this._layout=l,(!l.maxX||!l.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),y.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},y.prototype.resizeDrawingSurfaceToCanvas=function(l){if(this.canvas instanceof HTMLCanvasElement&&window){var d=this.canvas.getBoundingClientRect(),S=d.width,O=d.height,X=l||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=X,this.canvas.width=X*S,this.canvas.height=X*O,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===$.Layout){var de=this._layout.layoutScaleFactor;this.artboard.width=S/de,this.artboard.height=O/de}}},Object.defineProperty(y.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var l=[],d=0;d<this.artboard.animationCount();d++)l.push(this.artboard.animationByIndex(d).name);return l},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var l=[],d=0;d<this.artboard.stateMachineCount();d++)l.push(this.artboard.stateMachineByIndex(d).name);return l},enumerable:!1,configurable:!0}),y.prototype.stateMachineInputs=function(l){if(this.loaded){var d=this.animator.stateMachines.find(function(S){return S.name===l});return d?.inputs}},y.prototype.retrieveInputAtPath=function(l,d){if(!l){console.warn("No input name provided for path '".concat(d,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(l,"', at path: '").concat(d,"', but the Artboard is null"));return}var S=this.artboard.inputByPath(l,d);if(!S){console.warn("Could not access an input with name: '".concat(l,"', at path:'").concat(d,"'"));return}return S},y.prototype.setBooleanStateAtPath=function(l,d,S){var O=this.retrieveInputAtPath(l,S);O&&(O.type===F.Boolean?O.asBool().value=d:console.warn("Input with name: '".concat(l,"', at path:'").concat(S,"' is not a boolean")))},y.prototype.setNumberStateAtPath=function(l,d,S){var O=this.retrieveInputAtPath(l,S);O&&(O.type===F.Number?O.asNumber().value=d:console.warn("Input with name: '".concat(l,"', at path:'").concat(S,"' is not a number")))},y.prototype.fireStateAtPath=function(l,d){var S=this.retrieveInputAtPath(l,d);S&&(S.type===F.Trigger?S.asTrigger().fire():console.warn("Input with name: '".concat(l,"', at path:'").concat(d,"' is not a trigger")))},y.prototype.retrieveTextAtPath=function(l,d){if(!l){console.warn("No text name provided for path '".concat(d,"'"));return}if(!d){console.warn("No path provided for text '".concat(l,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(l,"', at path: '").concat(d,"', but the Artboard is null"));return}var S=this.artboard.textByPath(l,d);if(!S){console.warn("Could not access text with name: '".concat(l,"', at path:'").concat(d,"'"));return}return S},y.prototype.getTextRunValueAtPath=function(l,d){var S=this.retrieveTextAtPath(l,d);if(!S){console.warn("Could not get text with name: '".concat(l,"', at path:'").concat(d,"'"));return}return S.text},y.prototype.setTextRunValueAtPath=function(l,d,S){var O=this.retrieveTextAtPath(l,S);if(!O){console.warn("Could not set text with name: '".concat(l,"', at path:'").concat(S,"'"));return}O.text=d},Object.defineProperty(y.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(l){return l.playing}).map(function(l){return l.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(l){return l.playing}).map(function(l){return l.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(l){return!l.playing}).map(function(l){return l.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(l){return!l.playing}).map(function(l){return l.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),y.prototype.on=function(l,d){this.eventManager.add({type:l,callback:d})},y.prototype.off=function(l,d){this.eventManager.remove({type:l,callback:d})},y.prototype.unsubscribe=function(l,d){console.warn("This function is deprecated: please use `off()` instead."),this.off(l,d)},y.prototype.removeAllRiveEventListeners=function(l){this.eventManager.removeAll(l)},y.prototype.unsubscribeAll=function(l){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(l)},y.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},y.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},y.prototype.enableFPSCounter=function(l){this.runtime.enableFPSCounter(l)},y.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(y.prototype,"contents",{get:function(){if(this.loaded){for(var l={artboards:[]},d=0;d<this.file.artboardCount();d++){for(var S=this.file.artboardByIndex(d),O={name:S.name,animations:[],stateMachines:[]},X=0;X<S.animationCount();X++){var de=S.animationByIndex(X);O.animations.push(de.name)}for(var Fe=0;Fe<S.stateMachineCount();Fe++){for(var We=S.stateMachineByIndex(Fe),Oe=We.name,Ve=new this.runtime.StateMachineInstance(We,S),rt=[],Dt=0;Dt<Ve.inputCount();Dt++){var bt=Ve.input(Dt);rt.push({name:bt.name,type:bt.type})}O.stateMachines.push({name:Oe,inputs:rt})}l.artboards.push(O)}return l}},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(l){this._volume=l,this.artboard&&(this.artboard.volume=l*L.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"artboardWidth",{get:function(){var l;return this.artboard?this.artboard.width:(l=this._artboardWidth)!==null&&l!==void 0?l:0},set:function(l){this._artboardWidth=l,this.artboard&&(this.artboard.width=l)},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"artboardHeight",{get:function(){var l;return this.artboard?this.artboard.height:(l=this._artboardHeight)!==null&&l!==void 0?l:0},set:function(l){this._artboardHeight=l,this.artboard&&(this.artboard.height=l)},enumerable:!1,configurable:!0}),y.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(y.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(l){this._devicePixelRatioUsed=l},enumerable:!1,configurable:!0}),y.prototype.bindViewModelInstance=function(l){var d;this.artboard&&!this.destroyed&&l&&l.runtimeInstance&&(l.internalIncrementReferenceCount(),(d=this._viewModelInstance)===null||d===void 0||d.cleanup(),this._viewModelInstance=l,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(S){return S.bindViewModelInstance(l)}):this.artboard.bindViewModelInstance(l.runtimeInstance))},Object.defineProperty(y.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),y.prototype.viewModelByIndex=function(l){var d=this.file.viewModelByIndex(l);return d!==null?new Pe(d):null},y.prototype.viewModelByName=function(l){var d=this.file.viewModelByName(l);return d!==null?new Pe(d):null},y.prototype.enums=function(){if(this._dataEnums===null){var l=this.file.enums();this._dataEnums=l.map(function(d){return new ce(d)})}return this._dataEnums},y.prototype.defaultViewModel=function(){if(this.artboard){var l=this.file.defaultArtboardViewModel(this.artboard);if(l)return new Pe(l)}return null},y.prototype.getArtboard=function(l){var d,S;return(S=(d=this.riveFile)===null||d===void 0?void 0:d.getArtboard(l))!==null&&S!==void 0?S:null},y.missingErrorMessage="Rive source file or data buffer required",y.cleanupErrorMessage="Attempt to use file after calling cleanup.",y})(),Pe=(function(){function y(l){this._viewModel=l}return Object.defineProperty(y.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),y.prototype.instanceByIndex=function(l){var d=this._viewModel.instanceByIndex(l);return d!==null?new te(d,null):null},y.prototype.instanceByName=function(l){var d=this._viewModel.instanceByName(l);return d!==null?new te(d,null):null},y.prototype.defaultInstance=function(){var l=this._viewModel.defaultInstance();return l!==null?new te(l,null):null},y.prototype.instance=function(){var l=this._viewModel.instance();return l!==null?new te(l,null):null},Object.defineProperty(y.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),y})(),ce=(function(){function y(l){this._dataEnum=l}return Object.defineProperty(y.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),y})(),re;(function(y){y.Number="number",y.String="string",y.Boolean="boolean",y.Color="color",y.Trigger="trigger",y.Enum="enum",y.List="list",y.Image="image",y.Artboard="artboard"})(re||(re={}));var te=(function(){function y(l,d){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=l,d!==null&&this._parents.push(d)}return Object.defineProperty(y.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),y.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(l){l.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(l){l.clearChanges()})),this._children.forEach(function(l){return l.handleCallbacks()})},y.prototype.addParent=function(l){this._parents.includes(l)||(this._parents.push(l),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&l.addToViewModelCallbacks(this))},y.prototype.removeParent=function(l){var d=this._parents.indexOf(l);if(d!==-1){var S=this._parents[d];S.removeFromViewModelCallbacks(this),this._parents.splice(d,1)}},y.prototype.addToPropertyCallbacks=function(l){var d=this;this._propertiesWithCallbacks.includes(l)||(this._propertiesWithCallbacks.push(l),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(S){S.addToViewModelCallbacks(d)}))},y.prototype.removeFromPropertyCallbacks=function(l){var d=this;this._propertiesWithCallbacks.includes(l)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(S){return S!==l}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(S){S.removeFromViewModelCallbacks(d)}))},y.prototype.addToViewModelCallbacks=function(l){var d=this;this._children.includes(l)||(this._children.push(l),this._parents.forEach(function(S){S.addToViewModelCallbacks(d)}))},y.prototype.removeFromViewModelCallbacks=function(l){var d=this;this._children.includes(l)&&(this._children=this._children.filter(function(S){return S!==l}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(S){S.removeFromViewModelCallbacks(d)}))},y.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(l){l.clearCallbacks()})},y.prototype.propertyFromPath=function(l,d){var S=l.split("/");return this.propertyFromPathSegments(S,0,d)},y.prototype.viewModelFromPathSegments=function(l,d){var S=this.internalViewModelInstance(l[d]);return S!==null?d==l.length-1?S:S.viewModelFromPathSegments(l,d++):null},y.prototype.propertyFromPathSegments=function(l,d,S){var O,X,de,Fe,We,Oe,Ve,rt,Dt,bt,Zt,Yt,jt,Ft,nt,Mt,it,ut;if(d<l.length-1){var Ce=this.internalViewModelInstance(l[d]);return Ce!==null?Ce.propertyFromPathSegments(l,d+1,S):null}var He=null;switch(S){case re.Number:if(He=(X=(O=this._runtimeInstance)===null||O===void 0?void 0:O.number(l[d]))!==null&&X!==void 0?X:null,He!==null)return new q(He,this);break;case re.String:if(He=(Fe=(de=this._runtimeInstance)===null||de===void 0?void 0:de.string(l[d]))!==null&&Fe!==void 0?Fe:null,He!==null)return new fe(He,this);break;case re.Boolean:if(He=(Oe=(We=this._runtimeInstance)===null||We===void 0?void 0:We.boolean(l[d]))!==null&&Oe!==void 0?Oe:null,He!==null)return new K(He,this);break;case re.Color:if(He=(rt=(Ve=this._runtimeInstance)===null||Ve===void 0?void 0:Ve.color(l[d]))!==null&&rt!==void 0?rt:null,He!==null)return new Ne(He,this);break;case re.Trigger:if(He=(bt=(Dt=this._runtimeInstance)===null||Dt===void 0?void 0:Dt.trigger(l[d]))!==null&&bt!==void 0?bt:null,He!==null)return new ve(He,this);break;case re.Enum:if(He=(Yt=(Zt=this._runtimeInstance)===null||Zt===void 0?void 0:Zt.enum(l[d]))!==null&&Yt!==void 0?Yt:null,He!==null)return new me(He,this);break;case re.List:if(He=(Ft=(jt=this._runtimeInstance)===null||jt===void 0?void 0:jt.list(l[d]))!==null&&Ft!==void 0?Ft:null,He!==null)return new $e(He,this);break;case re.Image:if(He=(Mt=(nt=this._runtimeInstance)===null||nt===void 0?void 0:nt.image(l[d]))!==null&&Mt!==void 0?Mt:null,He!==null)return new Ue(He,this);break;case re.Artboard:if(He=(ut=(it=this._runtimeInstance)===null||it===void 0?void 0:it.artboard(l[d]))!==null&&ut!==void 0?ut:null,He!==null)return new je(He,this);break}return null},y.prototype.internalViewModelInstance=function(l){var d;if(this._viewModelInstances.has(l))return this._viewModelInstances.get(l);var S=(d=this._runtimeInstance)===null||d===void 0?void 0:d.viewModel(l);if(S!==null){var O=new y(S,this);return O.internalIncrementReferenceCount(),this._viewModelInstances.set(l,O),O}return null},y.prototype.number=function(l){var d=this.propertyFromPath(l,re.Number);return d},y.prototype.string=function(l){var d=this.propertyFromPath(l,re.String);return d},y.prototype.boolean=function(l){var d=this.propertyFromPath(l,re.Boolean);return d},y.prototype.color=function(l){var d=this.propertyFromPath(l,re.Color);return d},y.prototype.trigger=function(l){var d=this.propertyFromPath(l,re.Trigger);return d},y.prototype.enum=function(l){var d=this.propertyFromPath(l,re.Enum);return d},y.prototype.list=function(l){var d=this.propertyFromPath(l,re.List);return d},y.prototype.image=function(l){var d=this.propertyFromPath(l,re.Image);return d},y.prototype.artboard=function(l){var d=this.propertyFromPath(l,re.Artboard);return d},y.prototype.viewModel=function(l){var d=l.split("/"),S=d.length>1?this.viewModelFromPathSegments(d.slice(0,d.length-1),0):this;return S!=null?S.internalViewModelInstance(d[d.length-1]):null},y.prototype.internalReplaceViewModel=function(l,d){var S;if(d.runtimeInstance!==null){var O=((S=this._runtimeInstance)===null||S===void 0?void 0:S.replaceViewModel(l,d.runtimeInstance))||!1;if(O){d.internalIncrementReferenceCount();var X=this.internalViewModelInstance(l);X!==null&&(X.removeParent(this),this._children.includes(X)&&(this._children=this._children.filter(function(de){return de!==X})),X.cleanup()),this._viewModelInstances.set(l,d),d.addParent(this)}return O}return!1},y.prototype.replaceViewModel=function(l,d){var S,O=l.split("/"),X=O.length>1?this.viewModelFromPathSegments(O.slice(0,O.length-1),0):this;return(S=X?.internalReplaceViewModel(O[O.length-1],d))!==null&&S!==void 0?S:!1},y.prototype.incrementReferenceCount=function(){var l;this._referenceCount++,(l=this._runtimeInstance)===null||l===void 0||l.incrementReferenceCount()},y.prototype.decrementReferenceCount=function(){var l;this._referenceCount--,(l=this._runtimeInstance)===null||l===void 0||l.decrementReferenceCount()},Object.defineProperty(y.prototype,"properties",{get:function(){var l;return((l=this._runtimeInstance)===null||l===void 0?void 0:l.getProperties().map(function(d){return w({},d)}))||[]},enumerable:!1,configurable:!0}),y.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},y.prototype.cleanup=function(){var l=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(O){O.cleanup()}),this._viewModelInstances.clear();var d=k([],this._children,!0);this._children.length=0;var S=k([],this._parents,!0);this._parents.length=0,d.forEach(function(O){O.removeParent(l)}),S.forEach(function(O){O.removeFromViewModelCallbacks(l)})}},y})(),ae=(function(){function y(l,d){this.callbacks=[],this._viewModelInstanceValue=l,this._parentViewModel=d}return y.prototype.on=function(l){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(l)||(this.callbacks.push(l),this._parentViewModel.addToPropertyCallbacks(this))},y.prototype.off=function(l){l?this.callbacks=this.callbacks.filter(function(d){return d!==l}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},y.prototype.internalHandleCallback=function(l){},y.prototype.handleCallbacks=function(){var l=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(d){l.internalHandleCallback(d)})},y.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},y.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(y.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),y})(),fe=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),l.prototype.internalHandleCallback=function(d){d(this.value)},l})(ae),q=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),l.prototype.internalHandleCallback=function(d){d(this.value)},l})(ae),K=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),l.prototype.internalHandleCallback=function(d){d(this.value)},l})(ae),ve=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return l.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},l.prototype.internalHandleCallback=function(d){d()},l})(ae),me=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(d){this._viewModelInstanceValue.valueIndex=d},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),l.prototype.internalHandleCallback=function(d){d(this.value)},l})(ae),$e=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),l.prototype.addInstance=function(d){d.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(d.runtimeInstance),d.addParent(this._parentViewModel))},l.prototype.addInstanceAt=function(d,S){return d.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(d.runtimeInstance,S)?(d.addParent(this._parentViewModel),!0):!1},l.prototype.removeInstance=function(d){d.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(d.runtimeInstance),d.removeParent(this._parentViewModel))},l.prototype.removeInstanceAt=function(d){this._viewModelInstanceValue.removeInstanceAt(d)},l.prototype.instanceAt=function(d){var S=this._viewModelInstanceValue.instanceAt(d);if(S!=null){var O=new te(S,this._parentViewModel);return O}return null},l.prototype.swap=function(d,S){this._viewModelInstanceValue.swap(d,S)},l.prototype.internalHandleCallback=function(d){d()},l})(ae),Ne=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(d){this._viewModelInstanceValue.value=d},enumerable:!1,configurable:!0}),l.prototype.rgb=function(d,S,O){this._viewModelInstanceValue.rgb(d,S,O)},l.prototype.rgba=function(d,S,O,X){this._viewModelInstanceValue.argb(X,d,S,O)},l.prototype.argb=function(d,S,O,X){this._viewModelInstanceValue.argb(d,S,O,X)},l.prototype.alpha=function(d){this._viewModelInstanceValue.alpha(d)},l.prototype.opacity=function(d){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,d))*255))},l.prototype.internalHandleCallback=function(d){d(this.value)},l})(ae),Ue=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{set:function(d){var S;this._viewModelInstanceValue.value((S=d?.nativeImage)!==null&&S!==void 0?S:null)},enumerable:!1,configurable:!0}),l.prototype.internalHandleCallback=function(d){d()},l})(ae),je=(function(y){m(l,y);function l(d,S){return y.call(this,d,S)||this}return Object.defineProperty(l.prototype,"value",{set:function(d){var S;this._viewModelInstanceValue.value((S=d?.nativeArtboard)!==null&&S!==void 0?S:null)},enumerable:!1,configurable:!0}),l.prototype.internalHandleCallback=function(d){d()},l})(ae),ze=function(y){return I(void 0,void 0,void 0,function(){var l,d,S;return _(this,function(O){switch(O.label){case 0:return l=new Request(y),[4,fetch(l)];case 1:return d=O.sent(),[4,d.arrayBuffer()];case 2:return S=O.sent(),[2,S]}})})},qe=function(y){return typeof y=="string"?[y]:y instanceof Array?y:[]},gt={EventManager:J,TaskQueueManager:Y},lt=function(y){return I(void 0,void 0,void 0,function(){var l,d,S;return _(this,function(O){switch(O.label){case 0:return l=new Promise(function(X){return U.getInstance(function(de){de.decodeAudio(y,X)})}),[4,l];case 1:return d=O.sent(),S=new p.AudioWrapper(d),p.finalizationRegistry.register(S,d),[2,S]}})})},St=function(y){return I(void 0,void 0,void 0,function(){var l,d,S;return _(this,function(O){switch(O.label){case 0:return l=new Promise(function(X){return U.getInstance(function(de){de.decodeImage(y,X)})}),[4,l];case 1:return d=O.sent(),S=new p.ImageWrapper(d),p.finalizationRegistry.register(S,d),[2,S]}})})},wt=function(y){return I(void 0,void 0,void 0,function(){var l,d,S;return _(this,function(O){switch(O.label){case 0:return l=new Promise(function(X){return U.getInstance(function(de){de.decodeFont(y,X)})}),[4,l];case 1:return d=O.sent(),S=new p.FontWrapper(d),p.finalizationRegistry.register(S,d),[2,S]}})})}})(),o})())})(ms)),ms.exports}var np=tp();const Nu="dracula",Es="https://vycjpmuyscfygstjjied.supabase.co";var rp=ee('<div class="rive-wrapper svelte-nkuq4r"><canvas width="250" height="500" class="svelte-nkuq4r"></canvas></div>');function Ll(n,e){Tt(e,!0);let t=Ge(e,"bucketName",3,Nu),r=Re(null);In(()=>{if(!h(r))return;const u=new np.Rive({src:`${Es}/storage/v1/object/public/${t()}/${e.fileName}`,canvas:h(r),autoplay:!0,stateMachines:"SM1"});return()=>{u.cleanup()}});var i=rp(),o=A(i);Sa(o,u=>ie(r,u),()=>h(r)),H(n,i),xt()}var ip=ee('<div class="body-wrapper svelte-njwbfg"><!></div>');function ar(n,e){var t=ip(),r=A(t);bu(r,()=>e.children),H(n,t)}var sp=ee('<button class="btn btn-secondary svelte-19gwkd1">🔄 Заново</button>'),ap=ee('<button class="btn btn-danger svelte-19gwkd1">🏳️ Сдаться</button>'),op=ee('<div id="game-header" class="svelte-19gwkd1"><!> <!> <!></div>');function or(n,e){let t=Ge(e,"showGiveUp",3,!1),r=Ge(e,"extraContent",3,null);var i=op(),o=A(i);{var u=w=>{var I=sp();I.__click=function(..._){e.onRestart?.apply(this,_)},H(w,I)};De(o,w=>{e.onRestart&&w(u)})}var f=T(o,2);{var v=w=>{var I=kt(),_=Je(I);bu(_,r),H(w,I)};De(f,w=>{r()&&w(v)})}var p=T(f,2);{var m=w=>{var I=ap();I.__click=function(..._){e.onGiveUp?.apply(this,_)},H(w,I)};De(p,w=>{t()&&e.onGiveUp&&w(m)})}H(n,i)}Lt(["click"]);var lp=ee('<div class="item-icon reward-glow svelte-1g9s15m"><img class="icon-preview svelte-1g9s15m" height="64px"/></div>'),up=ee('<div id="reward-panel" class="svelte-1g9s15m"><!> <div class="reward-info svelte-1g9s15m"><div class="reward-label svelte-1g9s15m"> </div> <div class="reward-name svelte-1g9s15m"> </div></div></div>');function cp(n,e){Tt(e,!0);let t=Ge(e,"rewardItem",3,null),r=Ge(e,"items",19,()=>[]),i=Ge(e,"bucketName",3,"dracula"),o=Ge(e,"label",3,"Награда");function u(){if(!t()||!r()||r().length===0)return null;const _=typeof t()=="string"?t():t().id;return r().find(k=>k.id===_)||null}let f=Ot(u),v=Ot(()=>typeof t()=="object"&&t().name?t().name:null);function p(_){const k=_.target;k.style.display="none"}var m=kt(),w=Je(m);{var I=_=>{var k=up(),P=A(k);{var x=C=>{var j=lp(),ne=A(j);Ee(()=>{Be(ne,"src",`https://vycjpmuyscfygstjjied.supabase.co/storage/v1/object/public/${i()}/${h(f)?.icon||(typeof t()=="object"?t().icon:"")}`),Be(ne,"alt",h(f)?.name||h(v)||"Награда")}),ka("error",ne,p),H(C,j)};De(P,C=>{(h(f)?.icon||typeof t()=="object"&&t().icon)&&C(x)})}var $=T(P,2),z=A($),M=A(z),U=T(z,2),F=A(U);Ee(()=>{Se(M,`${o()??""}:`),Se(F,h(f)?.name||h(v)||"Неизвестный предмет")}),H(_,k)};De(w,_=>{(h(f)||h(v))&&_(I)})}H(n,m),xt()}var dp=ee('<div id="game-footer" class="svelte-1izvgt7"><!> <!></div>');function lr(n,e){let t=Ge(e,"rewardItem",3,null),r=Ge(e,"items",19,()=>[]),i=Ge(e,"bucketName",3,"dracula");var o=dp(),u=A(o);cp(u,{get rewardItem(){return t()},get items(){return r()},get bucketName(){return i()}});var f=T(u,2);Od(f,e,"default",{}),H(n,o)}var fp=ee("<button> </button>"),hp=ee('<div id="modal-overlay"><div class="modal-content svelte-s62q14"><div class="modal-title svelte-s62q14"> </div> <div class="modal-text svelte-s62q14"> </div> <div class="modal-buttons svelte-s62q14"></div></div></div>');function ur(n,e){Tt(e,!0);let t=Ge(e,"modal",7);var r=kt(),i=Je(r);{var o=u=>{var f=hp();let v;var p=A(f),m=A(p),w=A(m),I=T(m,2),_=A(I),k=T(I,2);et(k,21,()=>t().actions,P=>P.text,(P,x)=>{var $=fp();let z;$.__click=function(...U){h(x).action?.apply(this,U)};var M=A($);Ee(U=>{z=Ut($,1,"btn",null,z,U),Se(M,h(x).text)},[()=>({"btn-secondary":h(x).class==="btn-secondary"})]),H(P,$)}),Ee(P=>{v=Ut(f,1,"svelte-s62q14",null,v,P),Se(w,t().title),Se(_,t().text)},[()=>({active:t().show})]),H(u,f)};De(i,u=>{t().show&&u(o)})}H(n,r),xt()}Lt(["click"]);var vp=ee('<div role="button" tabindex="0"> </div>'),pp=Cd('<polyline class="connection-line svelte-d67gs4" vector-effect="non-scaling-stroke"></polyline>'),gp=ee('<span class="cooldown-timer svelte-d67gs4"> </span>'),mp=ee('<div class="footer-stats svelte-d67gs4"><span class="tiles-counter svelte-d67gs4">Осталось: <strong class="svelte-d67gs4"> </strong></span> <button>💡 <!></button></div>'),_p=ee('<!> <div id="game-container" class="svelte-d67gs4"><div id="grid" class="svelte-d67gs4"></div> <svg id="line-layer" class="svelte-d67gs4"><!></svg></div> <!> <!>',1);function yp(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=8,f=6,v=5,p=["🦄","🧙","👻","💀","🔥","🕷️","🕸️","🧟","🧟‍♀️","⚰️","🐸","🦴","🔮","🧪","👹","🌜","🍭","💗","🌛","🖤","🗡️","🧛‍♀️","🗝️","🕯️","🌑","☠️","🧿","🌞"];let m=Re(ft([])),w=Re(ft([])),I=Re(ft({})),_=Re(ft([])),k=Re(null),P=Re(!1),x=Re(!1),$=Re(""),z=Re(0),M=Re(0),U=Re(ft({show:!1,title:"",text:"",actions:[]})),F,C;In(()=>{_e()});function j(){if(!h(w)||h(w).length===0)return 0;let ce=0;for(let re=0;re<u;re++)for(let te=0;te<f;te++)h(w)[re]&&!h(w)[re][te]&&ce++;return ce}let ne=Ot(j),le=Ot(()=>h(M)<1);function _e(){ie(m,[],!0),ie(w,[],!0),ie(k,null),ie(P,!1),ie(x,!1),ie(I,{},!0),ie(_,[],!0),ie($,""),ie(M,0),ye();let ce=[...new Set(p)];for(;ce.length<u*f/2;)ce=[...ce,...ce];let re=ce.sort(()=>.5-Math.random()).slice(0,u*f/2),te=[];re.forEach(fe=>te.push(fe,fe)),te.sort(()=>Math.random()-.5);let ae=0;for(let fe=0;fe<u;fe++){let q=[],K=[];for(let ve=0;ve<f;ve++)q.push(te[ae++]),K.push(!1);h(m).push(q),h(w).push(K)}setTimeout(W,500)}async function he(ce,re){if(h(P)||h(w)[ce][re]||h(x))return;if(h(_).length>0&&ie(_,[],!0),!h(k)){ie(k,{r:ce,c:re},!0);return}if(h(k).r===ce&&h(k).c===re){ie(k,null);return}const te=h(m)[h(k).r][h(k).c],ae=h(m)[ce][re];if(te===ae){const fe=oe(h(k).r,h(k).c,ce,re);if(fe){ie(P,!0),await be(fe),h(w)[h(k).r][h(k).c]=!0,h(w)[ce][re]=!0,ie(k,null),ie(P,!1),J(),W();return}}ie(k,{r:ce,c:re},!0)}async function ue(ce,re,te){(te.key==="Enter"||te.key===" ")&&(te.preventDefault(),await he(ce,re))}function J(){ie(M,v);const ce=setInterval(()=>{Zn(M,-1),h(M)<=0&&clearInterval(ce)},1e3)}function Y(){if(h(P)||h(x)||!h(le))return;let ce=[];for(let te=0;te<u;te++)for(let ae=0;ae<f;ae++)h(w)[te][ae]||ce.push({r:te,c:ae,icon:h(m)[te][ae]});let re={};ce.forEach(te=>{re[te.icon]||(re[te.icon]=[]),re[te.icon].push(te)});for(const te in re){const ae=re[te];if(!(ae.length<2))for(let fe=0;fe<ae.length;fe++)for(let q=fe+1;q<ae.length;q++){const K=ae[fe],ve=ae[q];if(oe(K.r,K.c,ve.r,ve.c)){ie(_,[K,ve],!0),setTimeout(()=>ie(_,[],!0),1500);return}}}}function W(){if(h(ne)===0){ie(x,!0),t()?(Ae("🎉 Победа!","Все монстры пойманы!",[]),setTimeout(()=>{ye(),e.onWin?.()},3e3)):Ae("🎉 Победа!","Все монстры пойманы!",[{text:"Играть снова",action:_e}]);return}Z()||(t()?setTimeout(()=>L(),1e3):Ae("😨 Тупик!","Ходов больше нет. Перемешать?",[{text:"Перемешать",action:()=>{ye(),L()}},{text:"Сдаться",action:()=>{Ae("Конец","Попытайте удачу снова!",[{text:"ОК",action:_e}])}}]))}function Z(){let ce=[];for(let te=0;te<u;te++)for(let ae=0;ae<f;ae++)h(w)[te][ae]||ce.push({r:te,c:ae,icon:h(m)[te][ae]});let re={};ce.forEach(te=>{re[te.icon]||(re[te.icon]=[]),re[te.icon].push(te)});for(const te in re){const ae=re[te];if(!(ae.length<2)){for(let fe=0;fe<ae.length;fe++)for(let q=fe+1;q<ae.length;q++)if(oe(ae[fe].r,ae[fe].c,ae[q].r,ae[q].c))return!0}}return!1}function L(){let ce=[],re=[];for(let te=0;te<u;te++)for(let ae=0;ae<f;ae++)h(w)[te][ae]||(ce.push(h(m)[te][ae]),re.push({r:te,c:ae}));ce.length!==0&&(ce.sort(()=>Math.random()-.5),re.forEach((te,ae)=>{h(m)[te.r][te.c]=ce[ae],h(I)[`${te.r},${te.c}`]=!0}),setTimeout(()=>{ie(I,{},!0),Z()?ie(x,!1):L()},500))}function V(ce,re){return ce<0||ce>=u||re<0||re>=f?!0:h(w)[ce][re]}function se(ce,re,te,ae){if(ce!==te&&re!==ae)return!1;if(ce===te){const fe=Math.min(re,ae),q=Math.max(re,ae);for(let K=fe+1;K<q;K++)if(!V(ce,K))return!1}else{const fe=Math.min(ce,te),q=Math.max(ce,te);for(let K=fe+1;K<q;K++)if(!V(K,re))return!1}return!0}function oe(ce,re,te,ae){if(se(ce,re,te,ae))return[{r:ce,c:re},{r:te,c:ae}];const fe={r:ce,c:ae};if(V(fe.r,fe.c)&&se(ce,re,fe.r,fe.c)&&se(fe.r,fe.c,te,ae))return[{r:ce,c:re},fe,{r:te,c:ae}];const q={r:te,c:re};if(V(q.r,q.c)&&se(ce,re,q.r,q.c)&&se(q.r,q.c,te,ae))return[{r:ce,c:re},q,{r:te,c:ae}];for(let K=-1;K<=u;K++){if(K===ce||K===te)continue;const ve={r:K,c:re},me={r:K,c:ae};if(V(ve.r,ve.c)&&V(me.r,me.c)&&se(ce,re,ve.r,ve.c)&&se(ve.r,ve.c,me.r,me.c)&&se(me.r,me.c,te,ae))return[{r:ce,c:re},ve,me,{r:te,c:ae}]}for(let K=-1;K<=f;K++){if(K===re||K===ae)continue;const ve={r:ce,c:K},me={r:te,c:K};if(V(ve.r,ve.c)&&V(me.r,me.c)&&se(ce,re,ve.r,ve.c)&&se(ve.r,ve.c,me.r,me.c)&&se(me.r,me.c,te,ae))return[{r:ce,c:re},ve,me,{r:te,c:ae}]}return null}async function be(ce){if(await pu(),!F||!C)return;const re=F.getBoundingClientRect(),te=C.getBoundingClientRect(),ae=C.querySelector(".cell:not(.matched)");if(!ae)return;const fe=ae.offsetWidth,q=ae.offsetHeight,K=window.getComputedStyle(C),ve=parseFloat(K.gap)||4,me=te.left-re.left,$e=te.top-re.top,Ne=ce.map(Ue=>{let je,ze;if(Ue.r>=0&&Ue.r<u&&Ue.c>=0&&Ue.c<f){const gt=C.children[Ue.r*f+Ue.c].getBoundingClientRect();je=gt.left-re.left+gt.width/2,ze=gt.top-re.top+gt.height/2}else{const qe=Ue.c*(fe+ve)+fe/2,gt=Ue.r*(q+ve)+q/2;je=me+qe,ze=$e+gt}return`${je.toFixed(1)},${ze.toFixed(1)}`}).join(" ");return ie($,Ne,!0),Zn(z),new Promise(Ue=>{setTimeout(()=>{ie($,""),Ue()},350)})}function Ae(ce,re,te){ie(U,{show:!0,title:ce,text:re,actions:te},!0)}function ye(){h(U).show=!1}function Pe(){t()?(Ae("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{ye(),e.onLose?.()},3e3)):Ae("Конец","Попытайте удачу снова!",[{text:"ОК",action:_e}])}ar(n,{children:(ce,re)=>{var te=_p(),ae=Je(te);{let Ne=Ot(()=>t()?Pe:void 0);or(ae,{onRestart:_e,get onGiveUp(){return h(Ne)},get showGiveUp(){return t()}})}var fe=T(ae,2),q=A(fe);sn(q,"grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(8, 1fr);"),et(q,21,()=>h(m),Ct,(Ne,Ue,je)=>{var ze=kt(),qe=Je(ze);et(qe,17,()=>h(Ue),Ct,(gt,lt,St)=>{var wt=vp();let y;wt.__click=()=>he(je,St),wt.__keydown=d=>ue(je,St,d);var l=A(wt);Ee(d=>{y=Ut(wt,1,"cell svelte-d67gs4",null,y,d),Se(l,h(lt))},[()=>({selected:h(k)?.r===je&&h(k)?.c===St,matched:h(w)[je][St],shuffling:h(I)[`${je},${St}`],"hint-glow":h(_).some(d=>d.r===je&&d.c===St)})]),H(gt,wt)}),H(Ne,ze)}),Sa(q,Ne=>C=Ne,()=>C);var K=T(q,2),ve=A(K);Ia(ve,()=>h(z),Ne=>{var Ue=kt(),je=Je(Ue);{var ze=qe=>{var gt=pp();Ee(()=>Be(gt,"points",h($))),H(qe,gt)};De(je,qe=>{h($)&&qe(ze)})}H(Ne,Ue)}),Sa(fe,Ne=>F=Ne,()=>F);var me=T(fe,2);lr(me,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(Ne,Ue)=>{var je=mp(),ze=A(je),qe=T(A(ze)),gt=A(qe),lt=T(ze,2);let St;lt.__click=Y;var wt=T(A(lt));{var y=l=>{var d=gp(),S=A(d);Ee(()=>Se(S,`(${h(M)??""})`)),H(l,d)};De(wt,l=>{h(M)>0&&l(y)})}Ee(l=>{Se(gt,h(ne)),St=Ut(lt,1,"btn btn-secondary svelte-d67gs4",null,St,l),lt.disabled=!h(le)},[()=>({disabled:!h(le),"cooldown-active":h(M)>0})]),H(Ne,je)},$$slots:{default:!0}});var $e=T(me,2);ur($e,{get modal(){return h(U)}}),H(ce,te)}}),xt()}Lt(["click","keydown"]);function wp(n,e,t,r,i,o,u,f,v,p){if(!(h(e)||h(t)||!h(r)))for(let m=0;m<i;m++)for(let w=0;w<o;w++){if(h(u)[m]?.[w]||h(f)[m]?.[w])continue;let I=h(v)[m][w];for(let _=0;_<i;_++)for(let k=0;k<o;k++)if(!(m===_&&w===k)&&!(h(u)[_]?.[k]||h(f)[_]?.[k])&&h(v)[_][k]===I){ie(p,[{r:m,c:w},{r:_,c:k}],!0),setTimeout(()=>ie(p,[],!0),1500);return}}}var bp=ee('<div role="button" tabindex="0"><div class="card-inner svelte-9apm24"><div class="card-front svelte-9apm24"> </div> <div class="card-back svelte-9apm24">?</div></div></div>'),kp=ee('<span class="cooldown-timer svelte-9apm24"> </span>'),Ip=ee('<div class="footer-stats svelte-9apm24"><span class="tiles-counter svelte-9apm24">Осталось: <strong class="svelte-9apm24"> </strong></span> <button>💡 <!></button></div>'),Sp=ee('<!> <div id="game-container" class="svelte-9apm24"><div id="grid" class="svelte-9apm24"></div></div> <!> <!>',1);function Ep(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=6,f=6,v=5,p=["🦄","🧙","👻","💀","🔥","🕷️","🕸️","🧟","‍♀️","⚰️","🐸","🦴","🔮","🧪","👹","🌜","🍭","💗"];let m=Re(ft([])),w=Re(ft([])),I=Re(ft([])),_=Re(ft([])),k=Re(null),P=Re(!1),x=Re(!1),$=Re(0),z=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>{C()});function M(){let J=0;for(let Y=0;Y<u;Y++)for(let W=0;W<f;W++)h(w)[Y]?.[W]||J++;return J}let U=Ot(M),F=Ot(()=>h($)<1);function C(){ie(m,[],!0),ie(w,[],!0),ie(I,[],!0),ie(k,null),ie(P,!1),ie(x,!1),ie(_,[],!0),ie($,0),ue();let J=[...new Set(p)];for(;J.length<u*f/2;)J=[...J,...J];let Y=J.sort(()=>.5-Math.random()).slice(0,u*f/2),W=[];Y.forEach(L=>W.push(L,L)),W.sort(()=>Math.random()-.5);let Z=0;for(let L=0;L<u;L++){let V=[],se=[],oe=[];for(let be=0;be<f;be++)V.push(W[Z++]),se.push(!1),oe.push(!1);h(m).push(V),h(w).push(se),h(I).push(oe)}}async function j(J,Y){if(!(h(P)||h(w)[J]?.[Y]||h(x))){if(h(k)&&h(k).r===J&&h(k).c===Y){h(I)[J][Y]=!1,ie(k,null);return}if(!h(I)[J]?.[Y])if(h(_).length>0&&ie(_,[],!0),h(I)[J][Y]=!0,!h(k))ie(k,{r:J,c:Y},!0);else{ie(P,!0);const W={r:J,c:Y},Z=h(m)[h(k).r][h(k).c],L=h(m)[W.r][W.c];Z===L?setTimeout(()=>{h(w)[h(k).r][h(k).c]=!0,h(w)[W.r][W.c]=!0,h(I)[h(k).r][h(k).c]=!1,h(I)[W.r][W.c]=!1,ie(k,null),ie(P,!1),ne(),le()},600):setTimeout(()=>{h(I)[h(k).r][h(k).c]=!1,h(I)[W.r][W.c]=!1,ie(k,null),ie(P,!1)},1e3)}}}function ne(){ie($,v);const J=setInterval(()=>{Zn($,-1),h($)<=0&&clearInterval(J)},1e3)}function le(){h(U)===0&&(ie(x,!0),t()?(he("🎉 Победа!","Все монстры пойманы!",[]),setTimeout(()=>{ue(),e.onWin?.()},3e3)):he("🎉 Победа!","Все монстры пойманы!",[{text:"Играть снова",action:C}]))}function _e(){t()?(he("💀 Сдаюсь","Вы сдаюсь...",[]),setTimeout(()=>{ue(),e.onLose?.()},3e3)):he("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:C}])}function he(J,Y,W){t()||ie(z,{show:!0,title:J,text:Y,actions:W},!0)}function ue(){h(z).show=!1}ar(n,{children:(J,Y)=>{var W=Sp(),Z=Je(W);{let be=Ot(()=>t()?_e:void 0);or(Z,{onRestart:C,get onGiveUp(){return h(be)},get showGiveUp(){return t()}})}var L=T(Z,2),V=A(L);sn(V,"grid-template-columns: repeat(6, 1fr); grid-template-rows: repeat(6, 1fr);"),et(V,21,()=>h(m),Ct,(be,Ae,ye)=>{var Pe=kt(),ce=Je(Pe);et(ce,17,()=>h(Ae),Ct,(re,te,ae)=>{var fe=bp();let q;fe.__click=()=>j(ye,ae);var K=A(fe),ve=A(K),me=A(ve);Ee($e=>{q=Ut(fe,1,"cell svelte-9apm24",null,q,$e),Se(me,h(te))},[()=>({flipped:h(I)[ye]?.[ae],matched:h(w)[ye]?.[ae],selected:h(k)?.r===ye&&h(k)?.c===ae,"hint-glow":h(_).some($e=>$e.r===ye&&$e.c===ae)})]),H(re,fe)}),H(be,Pe)});var se=T(L,2);lr(se,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(be,Ae)=>{var ye=Ip(),Pe=A(ye),ce=T(A(Pe)),re=A(ce),te=T(Pe,2);let ae;te.__click=[wp,P,x,F,u,f,w,I,m,_];var fe=T(A(te));{var q=K=>{var ve=kp(),me=A(ve);Ee(()=>Se(me,`(${h($)??""})`)),H(K,ve)};De(fe,K=>{h($)>0&&K(q)})}Ee(K=>{Se(re,h(U)),ae=Ut(te,1,"btn btn-secondary svelte-9apm24",null,ae,K),te.disabled=!h(F)},[()=>({disabled:!h(F),"cooldown-active":h($)>0})]),H(be,ye)},$$slots:{default:!0}});var oe=T(se,2);ur(oe,{get modal(){return h(z)}}),H(J,W)}}),xt()}Lt(["click"]);var Ap=ee('<div class="flame svelte-jtqql5"></div>'),Cp=ee('<div role="button" tabindex="0"><div class="candle svelte-jtqql5"><!></div></div>'),Tp=ee('<div class="footer-stats svelte-jtqql5"><span class="moves-counter svelte-jtqql5">Ходов: <strong class="svelte-jtqql5"> </strong></span></div>'),xp=ee('<!> <div id="game-container" class="svelte-jtqql5"><div id="grid" class="svelte-jtqql5"></div></div> <!> <!>',1);function jp(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=5,f=5,v=15;let p=Re(ft([])),m=Re(0),w=Re(!1),I=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>k());let _=Ot(()=>h(p).flat().every(F=>!F));function k(){ie(p,Array(u).fill(null).map(()=>Array(f).fill(!1)),!0),ie(m,0),ie(w,!1),U();for(let F=0;F<v;F++){const C=Math.floor(Math.random()*u),j=Math.floor(Math.random()*f);P(C,j,!0)}}function P(F,C,j=!1){h(p)[F][C]=!h(p)[F][C],F>0&&(h(p)[F-1][C]=!h(p)[F-1][C]),F<u-1&&(h(p)[F+1][C]=!h(p)[F+1][C]),C>0&&(h(p)[F][C-1]=!h(p)[F][C-1]),C<f-1&&(h(p)[F][C+1]=!h(p)[F][C+1]),j||(Zn(m),$())}function x(F,C){h(w)||P(F,C)}function $(){h(_)&&(ie(w,!0),t()?(M("🕯️ Тьма наступила",`Вы погасили все свечи за ${h(m)} ходов!`,[]),setTimeout(()=>{U(),e.onWin?.()},3e3)):M("🕯️ Тьма наступила",`Вы погасили все свечи за ${h(m)} ходов!`,[{text:"Играть снова",action:k}]))}function z(){t()?(M("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{U(),e.onLose?.()},3e3)):M("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:k}])}function M(F,C,j){t()||ie(I,{show:!0,title:F,text:C,actions:j},!0)}function U(){h(I).show=!1}ar(n,{children:(F,C)=>{var j=xp(),ne=Je(j);{let J=Ot(()=>t()?z:void 0);or(ne,{onRestart:k,get onGiveUp(){return h(J)},get showGiveUp(){return t()}})}var le=T(ne,2),_e=A(le);sn(_e,"grid-template-columns: repeat(5, 1fr); grid-template-rows: repeat(5, 1fr);"),et(_e,21,()=>h(p),Ct,(J,Y,W)=>{var Z=kt(),L=Je(Z);et(L,17,()=>h(Y),Ct,(V,se,oe)=>{var be=Cp();let Ae;be.__click=()=>x(W,oe);var ye=A(be),Pe=A(ye);{var ce=re=>{var te=Ap();H(re,te)};De(Pe,re=>{h(se)&&re(ce)})}Ee(re=>Ae=Ut(be,1,"cell svelte-jtqql5",null,Ae,re),[()=>({lit:h(se)})]),H(V,be)}),H(J,Z)});var he=T(le,2);lr(he,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(J,Y)=>{var W=Tp(),Z=A(W),L=T(A(Z)),V=A(L);Ee(()=>Se(V,h(m))),H(J,W)},$$slots:{default:!0}});var ue=T(he,2);ur(ue,{get modal(){return h(I)}}),H(F,j)}}),xt()}Lt(["click"]);var Pp=ee('<div class="cell svelte-53kujm"> </div>'),Rp=ee('<button class="color-btn svelte-53kujm"> </button>'),Op=ee('<div class="footer-stats svelte-53kujm"><span class="moves-counter svelte-53kujm">Ходов: <strong class="svelte-53kujm"> </strong> </span></div>'),Mp=ee('<!> <div id="game-container" class="svelte-53kujm"><div id="grid" class="svelte-53kujm"></div></div> <div class="color-picker svelte-53kujm"></div> <!> <!>',1);function Lp(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=12,f=25,v=[{name:"unicorn",value:"#e94560",icon:"🦄"},{name:"wizard",value:"#6c5ce7",icon:"🧙"},{name:"ghost",value:"#0984e3",icon:"👻"},{name:"skull",value:"#00b894",icon:"💀"},{name:"fire",value:"#fdcb6e",icon:"🔥"},{name:"spider",value:"#ffeaa7",icon:"🕷️"}];let p=Re(ft([])),m=Re(0),w=Re(!1),I=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>k());let _=Ot(()=>()=>{const F=h(p)[0][0];return h(p).every(C=>C.every(j=>j===F))});function k(){ie(p,[],!0),ie(m,0),ie(w,!1),U();for(let F=0;F<u;F++){let C=[];for(let j=0;j<u;j++)C.push(Math.floor(Math.random()*v.length));h(p).push(C)}}function P(F,C,j,ne){F<0||F>=u||C<0||C>=u||h(p)[F][C]===j&&(h(p)[F][C]=ne,P(F-1,C,j,ne),P(F+1,C,j,ne),P(F,C-1,j,ne),P(F,C+1,j,ne))}function x(F){if(h(w)||h(m)>=f)return;const C=h(p)[0][0];F!==C&&(P(0,0,C,F),Zn(m),$())}function $(){h(_)()?(ie(w,!0),t()?(M("🎉 Победа!",`Вы захватили мир за ${h(m)} ходов!`,[]),setTimeout(()=>{U(),e.onWin?.()},3e3)):M("🎉 Победа!",`Вы захватили мир за ${h(m)} ходов!`,[{text:"Играть снова",action:k}])):h(m)>=f&&(ie(w,!0),t()?(M("💀 Поражение","Ходы закончились!",[]),setTimeout(()=>{U(),e.onLose?.()},3e3)):M("💀 Поражение","Ходы закончились!",[{text:"Заново",action:k}]))}function z(){t()?(M("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{U(),e.onLose?.()},3e3)):M("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:k}])}function M(F,C,j){ie(I,{show:!0,title:F,text:C,actions:j},!0)}function U(){h(I).show=!1}ar(n,{children:(F,C)=>{var j=Mp(),ne=Je(j);{let Y=Ot(()=>t()?z:void 0);or(ne,{onRestart:k,get onGiveUp(){return h(Y)},get showGiveUp(){return t()}})}var le=T(ne,2),_e=A(le);sn(_e,"grid-template-columns: repeat(12, 1fr);"),et(_e,21,()=>h(p),Ct,(Y,W)=>{var Z=kt(),L=Je(Z);et(L,17,()=>h(W),Ct,(V,se)=>{var oe=Pp(),be=A(oe);Ee(()=>{sn(oe,`background-color: ${v[h(se)].value??""};`),Se(be,v[h(se)].icon)}),H(V,oe)}),H(Y,Z)});var he=T(le,2);et(he,21,()=>v,Ct,(Y,W,Z)=>{var L=Rp();L.__click=()=>x(Z);var V=A(L);Ee(()=>{sn(L,`background-color: ${h(W).value??""};`),L.disabled=h(w)||h(m)>=f,Se(V,h(W).icon)}),H(Y,L)});var ue=T(he,2);lr(ue,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(Y,W)=>{var Z=Op(),L=A(Z),V=T(A(L)),se=A(V),oe=T(V);oe.nodeValue=" / 25",Ee(()=>Se(se,h(m))),H(Y,Z)},$$slots:{default:!0}});var J=T(ue,2);ur(J,{get modal(){return h(I)}}),H(F,j)}}),xt()}Lt(["click"]);var Dp=ee('<div role="button" tabindex="0"> </div>'),Fp=ee('<div class="footer-stats svelte-1f92ac8"><span class="moves-counter svelte-1f92ac8">Ходов: <strong class="svelte-1f92ac8"> </strong></span></div>'),$p=ee('<!> <div id="game-container" class="svelte-1f92ac8"><div id="grid" class="svelte-1f92ac8"></div></div> <!> <!>',1);function Up(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=4;let f=Re(ft([])),v=Re(0),p=Re(!1),m=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>I());let w=Ot(()=>()=>{let U=1;for(let F=0;F<u;F++)for(let C=0;C<u;C++)if(F===u-1&&C===u-1){if(h(f)[F][C]!==null)return!1}else{if(h(f)[F][C]!==U)return!1;U++}return!0});function I(){ie(f,[],!0),ie(v,0),ie(p,!1),M();let U=[];for(let C=1;C<u*u;C++)U.push(C);U.push(null);do U=U.sort(()=>Math.random()-.5);while(!_(U));let F=0;for(let C=0;C<u;C++){let j=[];for(let ne=0;ne<u;ne++)j.push(U[F++]);h(f).push(j)}}function _(U){let F=0;for(let j=0;j<U.length;j++)for(let ne=j+1;ne<U.length;ne++)U[j]&&U[ne]&&U[j]>U[ne]&&F++;let C=0;for(let j=0;j<U.length;j++)if(U[j]===null){C=Math.floor(j/u);break}return F%2===(u-C)%2}function k(){for(let U=0;U<u;U++)for(let F=0;F<u;F++)if(h(f)[U][F]===null)return{r:U,c:F};return null}function P(U,F){if(h(p))return;const C=k();if(!C)return;const j=Math.abs(U-C.r),ne=Math.abs(F-C.c);(j===1&&ne===0||j===0&&ne===1)&&(h(f)[C.r][C.c]=h(f)[U][F],h(f)[U][F]=null,Zn(v),x())}function x(){h(w)()&&(ie(p,!0),t()?(z("🪞 Зеркало восстановлено!",`Вы собрали осколки за ${h(v)} ходов!`,[]),setTimeout(()=>{M(),e.onWin?.()},3e3)):z("🪞 Зеркало восстановлено!",`Вы собрали осколки за ${h(v)} ходов!`,[{text:"Играть снова",action:I}]))}function $(){t()?(z("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{M(),e.onLose?.()},3e3)):z("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:I}])}function z(U,F,C){t()||ie(m,{show:!0,title:U,text:F,actions:C},!0)}function M(){h(m).show=!1}ar(n,{children:(U,F)=>{var C=$p(),j=Je(C);{let ue=Ot(()=>t()?$:void 0);or(j,{onRestart:I,get onGiveUp(){return h(ue)},get showGiveUp(){return t()}})}var ne=T(j,2),le=A(ne);sn(le,"grid-template-columns: repeat(4, 1fr);"),et(le,21,()=>h(f),Ct,(ue,J,Y)=>{var W=kt(),Z=Je(W);et(Z,17,()=>h(J),Ct,(L,V,se)=>{var oe=Dp();let be;oe.__click=()=>P(Y,se);var Ae=A(oe);Ee(ye=>{be=Ut(oe,1,"cell svelte-1f92ac8",null,be,ye),Se(Ae,h(V))},[()=>({empty:h(V)===null})]),H(L,oe)}),H(ue,W)});var _e=T(ne,2);lr(_e,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(ue,J)=>{var Y=Fp(),W=A(Y),Z=T(A(W)),L=A(Z);Ee(()=>Se(L,h(v))),H(ue,Y)},$$slots:{default:!0}});var he=T(_e,2);ur(he,{get modal(){return h(m)}}),H(U,C)}}),xt()}Lt(["click"]);var Np=ee("<div> </div>"),Bp=ee('<div class="footer-stats svelte-1w5hynb"><span class="score-counter svelte-1w5hynb">Очки: <strong class="svelte-1w5hynb"> </strong></span></div>'),Wp=ee('<!> <div id="game-container" class="svelte-1w5hynb"><div id="grid" class="svelte-1w5hynb"></div></div> <!> <!>',1);function Vp(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=4,f=2048,v={2:"🦇",4:"👻",8:"💀",16:"🧟",32:"🧛",64:"🧙",128:"👹",256:"🐉",512:"🔥",1024:"⚡",2048:"👑"},p={2:"#3d3b5c",4:"#4e4c75",8:"#e94560",16:"#6c5ce7",32:"#a29bfe",64:"#fdcb6e",128:"#00b894",256:"#e17055",512:"#fd79a8",1024:"#00cec9",2048:"#ffd700"};let m=Re(ft([])),w=Re(0),I=Re(!1),_=Re(!1),k=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>(P(),window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)));function P(){ie(m,Array(u).fill(null).map(()=>Array(u).fill(0)),!0),ie(w,0),ie(I,!1),ie(_,!1),Z(),x(),x()}function x(){let L=[];for(let V=0;V<u;V++)for(let se=0;se<u;se++)h(m)[V][se]===0&&L.push({r:V,c:se});if(L.length>0){const{r:V,c:se}=L[Math.floor(Math.random()*L.length)];h(m)[V][se]=Math.random()<.9?2:4}}function $(L){if(h(I))return;let V=!1;switch(L.key){case"ArrowUp":V=F();break;case"ArrowDown":V=C();break;case"ArrowLeft":V=M();break;case"ArrowRight":V=U();break}V&&(L.preventDefault(),x(),he())}function z(L){let V=L.filter(oe=>oe!==0),se=!1;for(let oe=0;oe<V.length-1;oe++)V[oe]===V[oe+1]&&(V[oe]*=2,ie(w,h(w)+V[oe]),V.splice(oe+1,1),se=!0);for(;V.length<u;)V.push(0);return{newRow:V,moved:se||L.join(",")!==V.join(",")}}function M(){let L=!1;for(let V=0;V<u;V++){const{newRow:se,moved:oe}=z(h(m)[V]);h(m)[V]=se,oe&&(L=!0)}return L}function U(){let L=!1;for(let V=0;V<u;V++){const{newRow:se,moved:oe}=z([...h(m)[V]].reverse());h(m)[V]=se.reverse(),oe&&(L=!0)}return L}function F(){let L=!1;for(let V=0;V<u;V++){let se=[];for(let Ae=0;Ae<u;Ae++)se.push(h(m)[Ae][V]);const{newRow:oe,moved:be}=z(se);for(let Ae=0;Ae<u;Ae++)h(m)[Ae][V]=oe[Ae];be&&(L=!0)}return L}function C(){let L=!1;for(let V=0;V<u;V++){let se=[];for(let Ae=0;Ae<u;Ae++)se.push(h(m)[Ae][V]);const{newRow:oe,moved:be}=z(se.reverse());se=oe.reverse();for(let Ae=0;Ae<u;Ae++)h(m)[Ae][V]=se[Ae];be&&(L=!0)}return L}let j=Re(0),ne=Re(0);function le(L){ie(j,L.touches[0].clientX,!0),ie(ne,L.touches[0].clientY,!0)}function _e(L){if(h(I))return;const V=L.changedTouches[0].clientX,se=L.changedTouches[0].clientY,oe=V-h(j),be=se-h(ne);if(Math.abs(oe)<30&&Math.abs(be)<30)return;let Ae=!1;Math.abs(oe)>Math.abs(be)?Ae=oe>0?U():M():Ae=be>0?C():F(),Ae&&(L.preventDefault(),x(),he())}function he(){if(!h(_)){for(let L=0;L<u;L++)for(let V=0;V<u;V++)if(h(m)[L][V]>=f){ie(_,!0),t()?(W("👑 Победа!","Вы создали короля монстров!",[]),setTimeout(()=>{Z(),e.onWin?.()},3e3)):W("👑 Победа!","Вы создали короля монстров!",[{text:"Продолжить",action:Z},{text:"Новая игра",action:P,class:"btn-secondary"}]);return}}ue()&&!J()&&(ie(I,!0),t()?(W("💀 Конец",`Игра окончена. Очки: ${h(w)}`,[]),setTimeout(()=>{Z(),e.onLose?.()},3e3)):W("💀 Конец",`Игра окончена. Очки: ${h(w)}`,[{text:"Новая игра",action:P}]))}function ue(){for(let L=0;L<u;L++)for(let V=0;V<u;V++)if(h(m)[L][V]===0)return!1;return!0}function J(){for(let L=0;L<u;L++)for(let V=0;V<u;V++)if(V<u-1&&h(m)[L][V]===h(m)[L][V+1]||L<u-1&&h(m)[L][V]===h(m)[L+1][V])return!0;return!1}function Y(){t()?(W("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{Z(),e.onLose?.()},3e3)):W("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:P}])}function W(L,V,se){t()||ie(k,{show:!0,title:L,text:V,actions:se},!0)}function Z(){h(k).show=!1}ar(n,{children:(L,V)=>{var se=Wp(),oe=Je(se);{let ce=Ot(()=>t()?Y:void 0);or(oe,{onRestart:P,get onGiveUp(){return h(ce)},get showGiveUp(){return t()}})}var be=T(oe,2),Ae=A(be);et(Ae,21,()=>h(m),Ct,(ce,re)=>{var te=kt(),ae=Je(te);et(ae,17,()=>h(re),Ct,(fe,q)=>{var K=Np();Ut(K,1,"cell svelte-1w5hynb",null,{},{"cell-{cell}":q-{}});var ve=A(K);Ee(()=>{sn(K,`background-color: ${p[h(q)]||"#2a2a40"};`),Se(ve,h(q)>0?v[h(q)]||h(q):"")}),H(fe,K)}),H(ce,te)});var ye=T(be,2);lr(ye,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(ce,re)=>{var te=Bp(),ae=A(te),fe=T(A(ae)),q=A(fe);Ee(()=>Se(q,h(w))),H(ce,te)},$$slots:{default:!0}});var Pe=T(ye,2);ur(Pe,{get modal(){return h(k)}}),ka("touchstart",be,le),ka("touchend",be,_e),H(L,se)}}),xt()}var qp=ee('<div role="button" tabindex="0"><span class="cell-content svelte-1ydctpx"> </span></div>'),Gp=ee('<div class="footer-stats svelte-1ydctpx"><span class="mines-counter svelte-1ydctpx"></span> <span class="flag-counter svelte-1ydctpx"> </span></div>'),zp=ee('<!> <div id="game-container" class="svelte-1ydctpx"><div id="grid" class="svelte-1ydctpx"></div></div> <!> <!>',1);function Hp(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=8,f=8,v=10;let p=Re(ft([])),m=Re(!1),w=Re(!1),I=Re(!0),_=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>$());let k=Ot(()=>h(p).filter(Y=>Y.revealed).length),P=u*f,x=Ot(()=>h(w)||h(k)===P-v);function $(){ie(p,Array(P).fill(null).map(()=>({isMine:!1,revealed:!1,flagged:!1,adjacentMines:0})),!0),ie(m,!1),ie(w,!1),ie(I,!0),he()}function z(Y){let W=0;for(;W<v;){const Z=Math.floor(Math.random()*P);Z!==Y&&!h(p)[Z].isMine&&(h(p)[Z].isMine=!0,W++)}for(let Z=0;Z<P;Z++)h(p)[Z].isMine||(h(p)[Z].adjacentMines=M(Z))}function M(Y){const W=Math.floor(Y/f),Z=Y%f;let L=0;for(let V=-1;V<=1;V++)for(let se=-1;se<=1;se++){if(V===0&&se===0)continue;const oe=W+V,be=Z+se;if(oe>=0&&oe<u&&be>=0&&be<f){const Ae=oe*f+be;h(p)[Ae].isMine&&L++}}return L}function U(Y){if(!(h(m)||h(p)[Y].revealed||h(p)[Y].flagged)){if(h(I)&&(z(Y),ie(I,!1)),h(p)[Y].isMine){j(),ie(m,!0),ie(w,!1),t()?(_e("💥 БУМ!","Вы наткнулись на проклятую мину!",[]),setTimeout(()=>{he(),e.onLose?.()},3e3)):_e("💥 БУМ!","Вы наткнулись на проклятую мину!",[{text:"Попробовать снова",action:$}]);return}C(Y),ne()}}function F(Y,W){W.preventDefault(),!(h(m)||h(p)[Y].revealed)&&(h(p)[Y].flagged=!h(p)[Y].flagged)}function C(Y){if(!(Y<0||Y>=P)&&!(h(p)[Y].revealed||h(p)[Y].flagged)&&(h(p)[Y].revealed=!0,h(p)[Y].adjacentMines===0&&!h(p)[Y].isMine)){const W=Math.floor(Y/f),Z=Y%f;for(let L=-1;L<=1;L++)for(let V=-1;V<=1;V++){if(L===0&&V===0)continue;const se=W+L,oe=Z+V;se>=0&&se<u&&oe>=0&&oe<f&&C(se*f+oe)}}}function j(){for(let Y=0;Y<P;Y++)h(p)[Y].isMine&&(h(p)[Y].revealed=!0)}function ne(){h(x)()&&(ie(w,!0),ie(m,!0),t()?(_e("🎉 Победа!","Вы нашли все проклятые мины!",[]),setTimeout(()=>{he(),e.onWin?.()},3e3)):_e("🎉 Победа!","Вы нашли все проклятые мины!",[{text:"Играть снова",action:$}]))}function le(){t()?(_e("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{he(),e.onLose?.()},3e3)):_e("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:$}])}function _e(Y,W,Z){t()||ie(_,{show:!0,title:Y,text:W,actions:Z},!0)}function he(){h(_).show=!1}function ue(Y){return Y.revealed?Y.isMine?"💀":Y.adjacentMines===0?"":Y.adjacentMines.toString():Y.flagged?"🚩":""}function J(Y){return["","#00b894","#0984e3","#e94560","#6c5ce7","#fdcb6e","#00cec9","#d63031","#2d3436"][Y]||"#ececec"}ar(n,{children:(Y,W)=>{var Z=zp(),L=Je(Z);{let Ae=Ot(()=>t()?le:void 0);or(L,{onRestart:$,get onGiveUp(){return h(Ae)},get showGiveUp(){return t()}})}var V=T(L,2),se=A(V);sn(se,"grid-template-columns: repeat(8, 1fr);"),et(se,21,()=>h(p),Ct,(Ae,ye,Pe)=>{var ce=qp();let re;ce.__click=()=>U(Pe),ce.__contextmenu=fe=>F(Pe,fe);var te=A(ce),ae=A(te);Ee((fe,q,K)=>{re=Ut(ce,1,"cell svelte-1ydctpx",null,re,fe),sn(te,`color: ${q??""}`),Se(ae,K)},[()=>({revealed:h(ye).revealed,mine:h(ye).isMine&&h(ye).revealed,flagged:h(ye).flagged}),()=>h(ye).revealed&&!h(ye).isMine?J(h(ye).adjacentMines):"",()=>ue(h(ye))]),H(Ae,ce)});var oe=T(V,2);lr(oe,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(Ae,ye)=>{var Pe=Gp(),ce=A(Pe);ce.textContent="💀 10";var re=T(ce,2),te=A(re);Ee(ae=>Se(te,`🚩 ${ae??""}`),[()=>h(p).filter(ae=>ae.flagged).length]),H(Ae,Pe)},$$slots:{default:!0}});var be=T(oe,2);ur(be,{get modal(){return h(_)}}),H(Y,Z)}}),xt()}Lt(["click","contextmenu"]);function Kp(n,e,t,r){if(h(e).length>0){const i=h(e).pop();i.faceUp=!0,h(t).push(i)}else h(t).length>0&&(ie(e,h(t).reverse().map(i=>({...i,faceUp:!1})),!0),ie(t,[],!0));Zn(r)}function Yp(n,e,t){h(e).length!==0&&ie(t,{pile:-2,index:h(e).length-1},!0)}var Jp=ee('<div class="card back svelte-nzeewv"></div>'),Xp=ee('<div class="card empty svelte-nzeewv">🔄</div>'),Qp=ee('<div><span class="rank svelte-nzeewv"> </span> <span class="suit svelte-nzeewv"> </span></div>'),Zp=ee('<div class="card front svelte-nzeewv"><span class="rank svelte-nzeewv"> </span> <span class="suit svelte-nzeewv"> </span></div>'),eg=ee('<div class="card empty svelte-nzeewv">👻</div>'),tg=ee('<div class="pile foundation svelte-nzeewv"><!></div>'),ng=ee('<span class="rank svelte-nzeewv"> </span> <span class="suit svelte-nzeewv"> </span>',1),rg=ee("<div><!></div>"),ig=ee('<div class="tableau svelte-nzeewv"></div>'),sg=ee('<div class="footer-stats svelte-nzeewv"><span class="moves-counter svelte-nzeewv">Ходов: <strong class="svelte-nzeewv"> </strong></span></div>'),ag=ee('<!> <div id="game-container" class="svelte-nzeewv"><div class="top-row svelte-nzeewv"><div class="pile stock svelte-nzeewv"><!></div> <div class="pile waste svelte-nzeewv"><!></div> <div class="foundations svelte-nzeewv"></div></div> <div class="tableaus svelte-nzeewv"></div></div> <!> <!>',1);function og(n,e){Tt(e,!0);let t=Ge(e,"integrated",3,!1),r=Ge(e,"rewardItem",3,null),i=Ge(e,"items",19,()=>[]),o=Ge(e,"bucketName",3,"dracula");const u=["hearts","diamonds","clubs","spades"],f={hearts:"♥",diamonds:"♦",clubs:"♣",spades:"♠"},v=[1,2,3,4,5,6,7,8,9,10,11,12,13],p={1:"A",11:"J",12:"Q",13:"K"};let m=Re(ft([])),w=Re(ft([])),I=Re(ft([[],[],[],[]])),_=Re(ft([[],[],[],[],[],[],[]])),k=Re(null),P=Re(!1),x=Re(0),$=Re(ft({show:!1,title:"",text:"",actions:[]}));In(()=>M());let z=Ot(()=>h(I).every(J=>J.length===13));function M(){let J=[];for(const W of u)for(const Z of v)J.push({suit:W,rank:Z,faceUp:!1});J=J.sort(()=>Math.random()-.5),ie(m,[],!0),ie(w,[],!0),ie(I,[[],[],[],[]],!0),ie(_,[[],[],[],[],[],[],[]],!0);let Y=0;for(let W=0;W<7;W++)for(let Z=W;Z<7;Z++){const L=J[Y++];L.faceUp=W===Z,h(_)[Z].push(L)}for(;Y<J.length;)h(m).push(J[Y++]);ie(k,null),ie(x,0),ie(P,!1),_e()}function U(J,Y){const W=h(_)[J];if(h(k)){const{pile:Z,index:L}=h(k);let V;Z===-2?V=[h(w)[L]]:V=h(_)[Z].slice(L);const se=V[0];if(W.length===0){if(se.rank===13){C(Z,L,J,-1),ie(k,null);return}}else{const oe=W[W.length-1];if((se.suit==="hearts"||se.suit==="diamonds")!=(oe.suit==="hearts"||oe.suit==="diamonds")&&se.rank===oe.rank-1){C(Z,L,J,-1),ie(k,null);return}}if(V.length===1)for(let oe=0;oe<4;oe++){const be=h(I)[oe];if(be.length===0){if(se.rank===1){C(Z,L,-1,oe),ie(k,null);return}}else{const Ae=be[be.length-1];if(se.suit===Ae.suit&&se.rank===Ae.rank+1){C(Z,L,-1,oe),ie(k,null);return}}}ie(k,null)}else Y>=0&&W[Y]?.faceUp&&ie(k,{pile:J,index:Y},!0)}function F(J){if(!h(k))return;const{pile:Y,index:W}=h(k);let Z;Y===-2?Z=h(w)[W]:Z=h(_)[Y][W];const L=h(I)[J];if(L.length===0)Z.rank===1&&Y>=-1&&(Y===-2?[h(w)[W]]:h(_)[Y].slice(W)).length===1&&C(Y,W,-1,J);else{const V=L[L.length-1];Z.suit===V.suit&&Z.rank===V.rank+1&&(Y===-2?[h(w)[W]]:h(_)[Y].slice(W)).length===1&&C(Y,W,-1,J)}ie(k,null)}function C(J,Y,W,Z){let L;J===-2?L=[h(w).pop()]:(L=h(_)[J].splice(Y),h(_)[J].length>0&&(h(_)[J][h(_)[J].length-1].faceUp=!0)),W>=0?h(_)[W].push(...L):Z>=0&&h(I)[Z].push(...L),Zn(x),j()}function j(){h(z)&&(ie(P,!0),t()?(le("🎉 Победа!",`Вы собрали все души за ${h(x)} ходов!`,[]),setTimeout(()=>{_e(),e.onWin?.()},3e3)):le("🎉 Победа!",`Вы собрали все души за ${h(x)} ходов!`,[{text:"Играть снова",action:M}]))}function ne(){t()?(le("💀 Сдаюсь","Вы сдались...",[]),setTimeout(()=>{_e(),e.onLose?.()},3e3)):le("Конец","Попробуйте ещё раз!",[{text:"Новая игра",action:M}])}function le(J,Y,W){t()||ie($,{show:!0,title:J,text:Y,actions:W},!0)}function _e(){h($).show=!1}function he(J){return p[J]||J.toString()}function ue(J){return J==="hearts"||J==="diamonds"?"#e94560":"#ececec"}ar(n,{children:(J,Y)=>{var W=ag(),Z=Je(W);{let q=Ot(()=>t()?ne:void 0);or(Z,{onRestart:M,get onGiveUp(){return h(q)},get showGiveUp(){return t()}})}var L=T(Z,2),V=A(L),se=A(V);se.__click=[Kp,m,w,x];var oe=A(se);{var be=q=>{var K=Jp();H(q,K)},Ae=q=>{var K=Xp();H(q,K)};De(oe,q=>{h(m).length>0?q(be):q(Ae,!1)})}var ye=T(se,2);ye.__click=[Yp,w,k];var Pe=A(ye);{var ce=q=>{var K=Qp();let ve;var me=A(K),$e=A(me),Ne=T(me,2),Ue=A(Ne);Ee((je,ze,qe)=>{ve=Ut(K,1,"card front svelte-nzeewv",null,ve,je),Se($e,ze),sn(Ne,`color: ${qe??""}`),Se(Ue,f[h(w)[h(w).length-1].suit])},[()=>({selected:h(k)?.pile===-2}),()=>he(h(w)[h(w).length-1].rank),()=>ue(h(w)[h(w).length-1].suit)]),H(q,K)};De(Pe,q=>{h(w).length>0&&q(ce)})}var re=T(ye,2);et(re,21,()=>h(I),Ct,(q,K,ve)=>{var me=tg();me.__click=()=>F(ve);var $e=A(me);{var Ne=je=>{var ze=Zp(),qe=A(ze),gt=A(qe),lt=T(qe,2),St=A(lt);Ee((wt,y)=>{Se(gt,wt),sn(lt,`color: ${y??""}`),Se(St,f[h(K)[h(K).length-1].suit])},[()=>he(h(K)[h(K).length-1].rank),()=>ue(h(K)[h(K).length-1].suit)]),H(je,ze)},Ue=je=>{var ze=eg();H(je,ze)};De($e,je=>{h(K).length>0?je(Ne):je(Ue,!1)})}H(q,me)});var te=T(V,2);et(te,21,()=>h(_),Ct,(q,K,ve)=>{var me=ig();me.__click=()=>U(ve,-1),et(me,21,()=>h(K),Ct,($e,Ne,Ue)=>{var je=rg();let ze;je.__click=lt=>{lt.stopPropagation(),U(ve,Ue)},sn(je,`margin-top: ${Ue>0?"-80%":"0"}; z-index: ${Ue};`);var qe=A(je);{var gt=lt=>{var St=ng(),wt=Je(St),y=A(wt),l=T(wt,2),d=A(l);Ee((S,O)=>{Se(y,S),sn(l,`color: ${O??""}`),Se(d,f[h(Ne).suit])},[()=>he(h(Ne).rank),()=>ue(h(Ne).suit)]),H(lt,St)};De(qe,lt=>{h(Ne).faceUp&&lt(gt)})}Ee(lt=>ze=Ut(je,1,"card svelte-nzeewv",null,ze,lt),[()=>({front:h(Ne).faceUp,back:!h(Ne).faceUp,selected:h(k)?.pile===ve&&h(k)?.index===Ue})]),H($e,je)}),H(q,me)});var ae=T(L,2);lr(ae,{get rewardItem(){return r()},get items(){return i()},get bucketName(){return o()},children:(q,K)=>{var ve=sg(),me=A(ve),$e=T(A(me)),Ne=A($e);Ee(()=>Se(Ne,h(x))),H(q,ve)},$$slots:{default:!0}});var fe=T(ae,2);ur(fe,{get modal(){return h($)}}),H(J,W)}}),xt()}Lt(["click"]);var lg=ee('<div class="loading svelte-15dde84">Загрузка игры...</div>'),ug=ee('<div class="minigame-container svelte-15dde84"><!></div>');function cg(n,e){Tt(e,!0);let t=Ge(e,"bucketName",3,"dracula");function r(){console.log("[MinigameLauncher] Game won!"),e.onWin()}function i(){console.log("[MinigameLauncher] Game lost!"),e.onLose()}var o=ug(),u=A(o);{var f=p=>{yp(p,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},v=p=>{var m=kt(),w=Je(m);{var I=k=>{Ep(k,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},_=k=>{var P=kt(),x=Je(P);{var $=M=>{jp(M,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},z=M=>{var U=kt(),F=Je(U);{var C=ne=>{Lp(ne,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},j=ne=>{var le=kt(),_e=Je(le);{var he=J=>{Up(J,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},ue=J=>{var Y=kt(),W=Je(Y);{var Z=V=>{Vp(V,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},L=V=>{var se=kt(),oe=Je(se);{var be=ye=>{Hp(ye,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},Ae=ye=>{var Pe=kt(),ce=Je(Pe);{var re=ae=>{og(ae,{onWin:r,onLose:i,integrated:!0,get rewardItem(){return e.rewardItem},get items(){return e.items},get bucketName(){return t()}})},te=ae=>{var fe=lg();H(ae,fe)};De(ce,ae=>{e.gameId==="tower_of_souls"?ae(re):ae(te,!1)},!0)}H(ye,Pe)};De(oe,ye=>{e.gameId==="cursed_crypts"?ye(be):ye(Ae,!1)},!0)}H(V,se)};De(W,V=>{e.gameId==="evolution2048"?V(Z):V(L,!1)},!0)}H(J,Y)};De(_e,J=>{e.gameId==="broken_mirror"?J(he):J(ue,!1)},!0)}H(ne,le)};De(F,ne=>{e.gameId==="flood_it"?ne(C):ne(j,!1)},!0)}H(M,U)};De(x,M=>{e.gameId==="light_out"?M($):M(z,!1)},!0)}H(k,P)};De(w,k=>{e.gameId==="memo_monsters"?k(I):k(_,!1)},!0)}H(p,m)};De(u,p=>{e.gameId==="onet_monsters"?p(f):p(v,!1)})}H(n,o),xt()}function dg(n,e){h(e)?.nextDialogueId&&It.goToDialogue(h(e).nextDialogueId)}var fg=ee('<img alt="BG" class="background-image svelte-fl90wm"/>'),hg=ee('<div class="background-media svelte-fl90wm"><!></div>'),vg=ee('<img alt="Char" class="character-image svelte-fl90wm"/>'),pg=ee('<div class="character-media svelte-fl90wm"><!></div>'),gg=(n,e,t)=>e(h(t)),mg=ee("<button> </button>"),_g=ee('<div class="options-container svelte-fl90wm"></div>'),yg=ee('<div class="next-container svelte-fl90wm"><button class="next-button svelte-fl90wm">Далее...</button></div>'),wg=ee('<div class="dialogue-container svelte-fl90wm"><!> <!> <!> <div class="dialogue-content svelte-fl90wm"><div class="dialogue-text svelte-fl90wm"> </div> <!></div></div>'),bg=ee("<p> </p>");function Bu(n,e){Tt(e,!0);let t=Ge(e,"bucketName",3,Nu);console.log(t());const r=Ot(()=>e.dialogue||It.findDialogue(It.currentDialogueId));let i=Re(null);li(()=>{h(r)?.onEnter&&It.runActions(h(r).onEnter)});function o(k){if(k.actions&&It.runActions(k.actions),k.miniGame){console.log("Запуск мини-игры:",k.miniGame.id),ie(i,{gameId:k.miniGame.id,onWinDialogueId:k.miniGame.onWinDialogueId,onLoseDialogueId:k.miniGame.onLoseDialogueId,rewardItem:k.miniGame.rewardItem},!0);return}k.nextDialogueId&&It.goToDialogue(k.nextDialogueId)}function u(){console.log("[DialogueCard] Mini-game won!"),h(i)?.rewardItem&&It.addItem(h(i).rewardItem),h(i)?.onWinDialogueId&&It.goToDialogue(h(i).onWinDialogueId),ie(i,null)}function f(){console.log("[DialogueCard] Mini-game lost!"),h(i)?.onLoseDialogueId&&It.goToDialogue(h(i).onLoseDialogueId),ie(i,null)}function v(k){return k.visible===!1?!1:It.checkVisibilityCondition(k)}function p(k){return k.enabled!==!1}var m=kt(),w=Je(m);{var I=k=>{var P=wg(),x=A(P);{var $=ue=>{{let J=Ot(()=>It.storyData?.items);cg(ue,{get gameId(){return h(i).gameId},onWin:u,onLose:f,get rewardItem(){return h(i).rewardItem},get items(){return h(J)},get bucketName(){return t()}})}};De(x,ue=>{h(i)&&ue($)})}var z=T(x,2);{var M=ue=>{var J=hg(),Y=A(J);{var W=L=>{var V=kt(),se=Je(V);Ia(se,()=>h(r).backgroundImage,oe=>{Ll(oe,{get fileName(){return h(r).backgroundImage},get bucketName(){return t()}})}),H(L,V)},Z=L=>{var V=fg();Ee(()=>Be(V,"src",`${Es}/storage/v1/object/public/${t()}/${h(r).backgroundImage}`)),H(L,V)};De(Y,L=>{h(r).backgroundImage.endsWith(".riv")?L(W):L(Z,!1)})}H(ue,J)};De(z,ue=>{h(r).backgroundImage&&ue(M)})}var U=T(z,2);{var F=ue=>{var J=pg(),Y=A(J);{var W=L=>{var V=kt(),se=Je(V);Ia(se,()=>h(r).characterImage,oe=>{Ll(oe,{get fileName(){return h(r).characterImage},get bucketName(){return t()}})}),H(L,V)},Z=L=>{var V=vg();Ee(()=>Be(V,"src",`${Es}/storage/v1/object/public/${t()}/${h(r).characterImage}`)),H(L,V)};De(Y,L=>{h(r).characterImage.endsWith(".riv")?L(W):L(Z,!1)})}H(ue,J)};De(U,ue=>{h(r).characterImage&&ue(F)})}var C=T(U,2),j=A(C),ne=A(j),le=T(j,2);{var _e=ue=>{var J=_g();et(J,21,()=>h(r).options,Y=>Y.text,(Y,W)=>{var Z=kt(),L=Je(Z);{var V=se=>{var oe=mg();let be;oe.__click=[gg,o,W];var Ae=A(oe);Ee((ye,Pe)=>{be=Ut(oe,1,"option-button svelte-fl90wm",null,be,ye),oe.disabled=Pe,Se(Ae,h(W).text)},[()=>({disabled:!p(h(W))}),()=>!p(h(W))]),H(se,oe)};De(L,se=>{v(h(W))&&se(V)})}H(Y,Z)}),H(ue,J)},he=ue=>{var J=kt(),Y=Je(J);{var W=Z=>{var L=yg(),V=A(L);V.__click=[dg,r],H(Z,L)};De(Y,Z=>{h(r).nextDialogueId&&Z(W)},!0)}H(ue,J)};De(le,ue=>{h(r).options&&h(r).options.length>0?ue(_e):ue(he,!1)})}Ee(()=>Se(ne,h(r).text)),H(k,P)},_=k=>{var P=bg(),x=A(P);Ee(()=>Se(x,`Диалог не найден (ID: ${It.currentDialogueId??""})`)),H(k,P)};De(w,k=>{h(r)?k(I):k(_,!1)})}H(n,m),xt()}Lt(["click"]);var ha=ir(()=>B),kg=ee('<div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Фон:</span> <span class="info-value svelte-1u0yr0g"> </span></div>'),Ig=ee('<div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Персонаж:</span> <span class="info-value svelte-1u0yr0g"> </span></div>'),Sg=ee('<div class="preview-warning svelte-1u0yr0g">⚠️ Нет вариантов ответов</div>'),Eg=ee('<div class="preview-warning svelte-1u0yr0g">⚠️ Некоторые варианты не ведут дальше</div>'),Ag=ee('<div class="preview-container svelte-1u0yr0g"><!> <div class="preview-info svelte-1u0yr0g"><div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">ID:</span> <span class="info-value svelte-1u0yr0g"> </span></div> <div class="info-row svelte-1u0yr0g"><span class="info-label svelte-1u0yr0g">Глава:</span> <span class="info-value svelte-1u0yr0g"> </span></div> <!> <!></div> <!> <!></div>'),Cg=ee('<div class="empty-preview svelte-1u0yr0g"><div class="empty-icon svelte-1u0yr0g">👈</div> <div class="empty-text svelte-1u0yr0g">Выберите сцену для предпросмотра</div></div>'),Tg=ee('<aside class="preview-panel svelte-1u0yr0g"><div class="preview-header svelte-1u0yr0g"><h3 class="svelte-1u0yr0g">Предпросмотр</h3> <button class="btn-link small svelte-1u0yr0g">Сбросить редакт. опций</button></div> <div class="preview-wrapper svelte-1u0yr0g"><!></div></aside>');function xg(n,e){Tt(e,!1);function t(){ha(ha().editingOptionIndex=null)}rr();var r=Tg(),i=A(r),o=T(A(i),2);o.__click=t;var u=T(i,2),f=A(u);{var v=m=>{var w=Ag(),I=A(w);Bu(I,{get dialogue(){return Kt.currentDialogue},index:0,get bucketName(){return ha().selectedBucket}});var _=T(I,2),k=A(_),P=T(A(k),2),x=A(P),$=T(k,2),z=T(A($),2),M=A(z),U=T($,2);{var F=ue=>{var J=kg(),Y=T(A(J),2),W=A(Y);Ee(()=>Se(W,Kt.currentDialogue.backgroundImage)),H(ue,J)};De(U,ue=>{Kt.currentDialogue.backgroundImage&&ue(F)})}var C=T(U,2);{var j=ue=>{var J=Ig(),Y=T(A(J),2),W=A(Y);Ee(()=>Se(W,Kt.currentDialogue.characterImage)),H(ue,J)};De(C,ue=>{Kt.currentDialogue.characterImage&&ue(j)})}var ne=T(_,2);{var le=ue=>{var J=Sg();H(ue,J)};De(ne,ue=>{(!Kt.currentDialogue.options||Kt.currentDialogue.options.length===0)&&ue(le)})}var _e=T(ne,2);{var he=ue=>{var J=Eg();H(ue,J)};De(_e,ue=>{Kt.currentDialogue.options?.some(J=>!J.nextDialogueId)&&ue(he)})}Ee(()=>{Se(x,Kt.currentDialogue.id),Se(M,Kt.currentChapter?.title||"Без главы")}),H(m,w)},p=m=>{var w=Cg();H(m,w)};De(f,m=>{Kt.currentDialogue?m(v):m(p,!1)})}H(n,r),xt()}Lt(["click"]);const jg=["dracula","zombie","fairy_tale","minigames"];function Wu(){const n=jg.map(e=>({id:e,name:e,public:!1,file_count:0,created_at:new Date().toISOString()}));return _t.updateBucketsList(n),n}var _r=ir(()=>B),Pg=ee('<span class="selected-badge svelte-1cmn6ru">Выбрано</span>'),Rg=(n,e,t)=>e(h(t).name),Og=ee('<button class="btn small svelte-1cmn6ru">Выбрать</button>'),Mg=ee('<div><div class="bucket-info svelte-1cmn6ru"><div class="story-icon svelte-1cmn6ru"> </div> <div class="story-content"><h3 class="story-title"> </h3> <p class="story-description"> </p></div> <div class="story-arrow">→</div></div> <div class="bucket-actions svelte-1cmn6ru"><!></div></div>'),Lg=ee('<div class="story-selector svelte-1cmn6ru"><div class="selector-header svelte-1cmn6ru"><h2 class="svelte-1cmn6ru">Выберите историю</h2></div> <div class="buckets-list svelte-1cmn6ru"></div></div>');function Dg(n,e){Tt(e,!1);const t={dracula:{title:"Дракула",description:"Тёмная готическая история о вампире и его жертве",icon:"🧛"},zombie:{title:"Выживание",description:"Постапокалиптическая история о зомби",icon:"🧟"},fairy_tale:{title:"Сказка",description:"Волшебная история с феями и драконами",icon:"🧚"},minigames:{title:"Мини-игры",description:"Демонстрация мини-игр в визуальной новелле",icon:"🎮"}};In(()=>{r()});function r(){Wu()}async function i(f){_r(_r().selectedBucket=f),_r(_r().data={meta:{version:"3.1",title:"Новая история"},dialogues:[],chapters:[],items:[],miniGames:[]}),await tr.loadStoriesList(),await tr.loadStoredResources()}rr();var o=Lg(),u=T(A(o),2);et(u,5,()=>_r().availableBuckets,f=>f,(f,v)=>{const p=Fi(()=>t[h(v).id]||{title:h(v),description:"Интерактивная история",icon:"📖"});var m=Mg();let w;var I=A(m),_=A(I),k=A(_),P=T(_,2),x=A(P),$=A(x),z=T(x,2),M=A(z),U=T(I,2),F=A(U);{var C=ne=>{var le=Pg();H(ne,le)},j=ne=>{var le=Og();le.__click=[Rg,i,v],H(ne,le)};De(F,ne=>{_r().selectedBucket===h(v).name?ne(C):ne(j,!1)})}Ee(ne=>{w=Ut(m,1,"bucket-card svelte-1cmn6ru",null,w,ne),Se(k,h(p).icon),Se($,h(p).title),Se(M,h(p).description)},[()=>({selected:_r().selectedBucket===h(v).name})]),H(f,m)}),H(n,o),xt()}Lt(["click"]);var Fg=ee("<span> </span>"),$g=ee('<div class="debug-info svelte-1k4krym"><small> </small></div>'),Ug=ee('<div class="debug-info warning svelte-1k4krym"><small>⚠️ Данные не загружены</small></div>'),Ng=ee('<div class="empty-state svelte-1k4krym">Выберите сцену</div>'),Bg=ee('<div class="editor-container svelte-1k4krym"><header class="toolbar svelte-1k4krym"><div class="logo svelte-1k4krym"><button class="btn-link svelte-1k4krym">← Сменить историю</button> <h2 class="svelte-1k4krym"> </h2></div> <div class="stories-control svelte-1k4krym"><span class="story-file-name svelte-1k4krym"> </span> <!> <button class="btn success small svelte-1k4krym">💾 Сохранить</button> <button class="btn small svelte-1k4krym">📋 Копия</button></div></header> <div class="main-workspace svelte-1k4krym"><!> <main class="editor-area svelte-1k4krym"><!> <!> <!></main> <!></div></div>');function Wg(n,e){Tt(e,!0),In(async()=>{Wu(),B.availableBuckets.length>0&&!B.selectedBucket&&(B.selectedBucket=B.availableBuckets[0].name)}),li(()=>{B.selectedBucket&&(console.log(`[Editor] Bucket выбран: ${B.selectedBucket}`),tr.loadStoredResources().then(()=>{const u=`${B.selectedBucket}_story.json`;return B.currentFileName=u,Ir.loadStory(u)}).catch(u=>{console.error("[Editor] Ошибка загрузки истории:",u)}))});var t=kt(),r=Je(t);{var i=u=>{Dg(u,{})},o=u=>{var f=Bg(),v=A(f),p=A(v),m=A(p);m.__click=()=>B.selectedBucket=null;var w=T(m,2),I=A(w),_=T(p,2),k=A(_),P=A(k),x=T(k,2);{var $=W=>{var Z=Fg(),L=A(Z);Ee(()=>{Ut(Z,1,`status-message ${B.statusMessage.type??""}`,"svelte-1k4krym"),Se(L,B.statusMessage.text)}),H(W,Z)};De(x,W=>{B.statusMessage.text&&W($)})}var z=T(x,2);z.__click=function(...W){Ir.saveCurrentStory?.apply(this,W)};var M=T(z,2);M.__click=function(...W){Ir.saveStoryCopy?.apply(this,W)};var U=T(v,2),F=A(U);ov(F,{});var C=T(F,2),j=A(C);{var ne=W=>{var Z=$g(),L=A(Z),V=A(L);Ee(()=>Se(V,`Загружено: ${B.data.meta?.title??""} |
              Глав: ${(B.data.chapters?.length||0)??""} |
              Диалогов: ${(B.data.dialogues?.length||0)??""} |
              Предметов: ${(B.data.items?.length||0)??""}`)),H(W,Z)},le=W=>{var Z=Ug();H(W,Z)};De(j,W=>{B.data?W(ne):W(le,!1)})}var _e=T(j,2);Qv(_e,{});var he=T(_e,2);{var ue=W=>{Nv(W,{get editor(){return B},get storyActions(){return Ir},get resourceActions(){return tr}})},J=W=>{var Z=Ng();H(W,Z)};De(he,W=>{Kt.currentDialogue?W(ue):W(J,!1)})}var Y=T(C,2);xg(Y,{}),Ee(()=>{Se(I,`Story Editor v3.1 - ${B.selectedBucket??""}`),Se(P,B.currentFileName||"Нет файла")}),H(u,f)};De(r,u=>{B.selectedBucket?u(o,!1):u(i)})}H(n,t),xt()}Lt(["click"]);var va=ir(()=>It),Vg=(n,e,t)=>e(h(t)),qg=(n,e,t)=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),e(h(t)))},Gg=ee('<div class="story-card svelte-b9w39k" role="button" tabindex="0"><div class="story-icon svelte-b9w39k"> </div> <div class="story-content svelte-b9w39k"><h3 class="story-title svelte-b9w39k"> </h3> <p class="story-description svelte-b9w39k"> </p></div> <div class="story-arrow svelte-b9w39k">→</div></div>'),zg=ee('<div class="story-selector svelte-b9w39k"><div class="selector-header svelte-b9w39k"><h1 class="svelte-b9w39k">🎭 Визуальные новеллы</h1> <p class="svelte-b9w39k">Выберите историю для прохождения</p></div> <div class="stories-grid svelte-b9w39k"></div> <div class="selector-footer svelte-b9w39k"><p class="hint svelte-b9w39k">💡 Совет: Вы можете создать свою историю в редакторе</p></div></div>');function Hg(n,e){Tt(e,!1);const t={dracula:{title:"Дракула",description:"Тёмная готическая история о вампире и его жертве",icon:"🧛"},zombie:{title:"Выживание",description:"Постапокалиптическая история о зомби",icon:"🧟"},fairy_tale:{title:"Сказка",description:"Волшебная история с феями и драконами",icon:"🧚"},minigames:{title:"Мини-игры",description:"Демонстрация мини-игр в визуальной новелле",icon:"🎮"}};function r(u){va(va().selectedStory=u)}rr();var i=zg(),o=T(A(i),2);et(o,5,()=>va().availableStories,u=>u,(u,f)=>{const v=Fi(()=>t[h(f)]||{title:h(f),description:"Интерактивная история",icon:"📖"});var p=Gg();p.__click=[Vg,r,f],p.__keydown=[qg,r,f];var m=A(p),w=A(m),I=T(m,2),_=A(I),k=A(_),P=T(_,2),x=A(P);Ee(()=>{Se(w,h(v).icon),Se(k,h(v).title),Se(x,h(v).description)}),H(u,p)}),H(n,i),xt()}Lt(["click","keydown"]);function pa(n,e){ie(e,!h(e))}var Kg=ee('<span class="inventory-badge svelte-1nth01l"> </span>'),Yg=(n=>n.stopPropagation()),Jg=(n,e,t)=>e(h(t)),Xg=ee('<div class="item-card svelte-1nth01l"><div class="item-icon svelte-1nth01l"><img class="icon-preview" height="64px"/></div> <div class="item-info svelte-1nth01l"><span class="item-name svelte-1nth01l"> </span> <span class="item-type svelte-1nth01l"> </span></div></div>'),Qg=ee('<div class="items-grid svelte-1nth01l"></div>'),Zg=ee('<div class="empty-inventory svelte-1nth01l"><span class="empty-icon svelte-1nth01l">🎒</span> <p class="svelte-1nth01l">Инвентарь пуст</p> <p class="empty-hint svelte-1nth01l">Получайте предметы в ходе игры</p></div>'),em=ee('<div class="inventory-overlay svelte-1nth01l"><div class="inventory-modal svelte-1nth01l"><div class="inventory-header svelte-1nth01l"><h2 class="svelte-1nth01l">Инвентарь</h2> <button class="close-button svelte-1nth01l">✕</button></div> <div class="stats-section svelte-1nth01l"><h3 class="svelte-1nth01l">Характеристики</h3> <div class="stats-grid svelte-1nth01l"><div class="stat-item svelte-1nth01l"><span class="stat-icon svelte-1nth01l">📚</span> <div class="stat-info svelte-1nth01l"><span class="stat-name svelte-1nth01l">Знания</span> <span class="stat-value svelte-1nth01l"> </span></div></div> <div class="stat-item svelte-1nth01l"><span class="stat-icon svelte-1nth01l">💪</span> <div class="stat-info svelte-1nth01l"><span class="stat-name svelte-1nth01l">Смелость</span> <span class="stat-value svelte-1nth01l"> </span></div></div> <div class="stat-item svelte-1nth01l"><span class="stat-icon svelte-1nth01l">✨</span> <div class="stat-info svelte-1nth01l"><span class="stat-name svelte-1nth01l">Харизма</span> <span class="stat-value svelte-1nth01l"> </span></div></div></div></div> <div class="items-section svelte-1nth01l"><h3 class="svelte-1nth01l"> </h3> <!></div></div></div>'),tm=ee('<div class="inventory-wrapper svelte-1nth01l"><button class="inventory-button svelte-1nth01l">🎒 <!></button> <!></div>');function nm(n,e){Tt(e,!0);let t=Re(!1);const r=Ot(()=>It.getInventoryItems()),i=Ot(()=>It.player.stats);function o(I){console.log("Выбран предмет:",I.name)}var u=tm(),f=A(u);f.__click=[pa,t];var v=T(A(f));{var p=I=>{var _=Kg(),k=A(_);Ee(()=>Se(k,h(r).length)),H(I,_)};De(v,I=>{h(r).length>0&&I(p)})}var m=T(f,2);{var w=I=>{var _=em();_.__click=[pa,t];var k=A(_);k.__click=[Yg];var P=A(k),x=T(A(P),2);x.__click=[pa,t];var $=T(P,2),z=T(A($),2),M=A(z),U=T(A(M),2),F=T(A(U),2),C=A(F),j=T(M,2),ne=T(A(j),2),le=T(A(ne),2),_e=A(le),he=T(j,2),ue=T(A(he),2),J=T(A(ue),2),Y=A(J),W=T($,2),Z=A(W),L=A(Z),V=T(Z,2);{var se=be=>{var Ae=Qg();et(Ae,21,()=>h(r),ye=>ye.id,(ye,Pe)=>{var ce=Xg();ce.__click=[Jg,o,Pe];var re=A(ce),te=A(re),ae=T(re,2),fe=A(ae),q=A(fe),K=T(fe,2),ve=A(K);Ee(()=>{Be(te,"src",`https://vycjpmuyscfygstjjied.supabase.co/storage/v1/object/public/${It.selectedStory}/${h(Pe).icon}`),Be(te,"alt",h(Pe).icon),Se(q,h(Pe).name),Se(ve,h(Pe).type)}),H(ye,ce)}),H(be,Ae)},oe=be=>{var Ae=Zg();H(be,Ae)};De(V,be=>{h(r).length>0?be(se):be(oe,!1)})}Ee(()=>{Se(C,h(i).knowledge),Se(_e,h(i).courage),Se(Y,h(i).charisma),Se(L,`Предметы (${h(r).length??""})`)}),H(I,_)};De(m,I=>{h(t)&&I(w)})}Ee(()=>Be(f,"title",`Инвентарь (${h(r).length??""})`)),H(n,u),xt()}Lt(["click"]);var rm=ee('<div class="loading svelte-14svm27"><p>🔄 Загрузка истории...</p></div>'),im=ee('<div class="error svelte-14svm27"> <button class="btn-back svelte-14svm27">← Вернуться к выбору</button></div>'),sm=ee('<div class="game-container svelte-14svm27"><!> <button class="btn-change-story svelte-14svm27" title="Сменить историю">📚</button> <div class="dialogues-container svelte-14svm27"><!></div></div>'),am=ee('<div class="app svelte-14svm27"><!></div>');function om(n,e){Tt(e,!0),li(async()=>{if(It.selectedStory){const u=`${It.selectedStory}_story.json`,f=`${Es}/storage/v1/object/public/${It.selectedStory}/${u}`;console.log("Загружаем историю из:",f),await It.loadStory(f)}});var t=am(),r=A(t);{var i=u=>{Hg(u,{})},o=u=>{var f=kt(),v=Je(f);{var p=w=>{var I=rm();H(w,I)},m=w=>{var I=kt(),_=Je(I);{var k=x=>{var $=im(),z=A($),M=T(z);M.__click=()=>It.selectedStory=null,Ee(()=>Se(z,`⚠️ ${It.error??""} `)),H(x,$)},P=x=>{var $=sm(),z=A($);nm(z,{});var M=T(z,2);M.__click=()=>It.selectedStory=null;var U=T(M,2),F=A(U);{var C=j=>{Bu(j,{get bucketName(){return It.selectedStory}})};De(F,j=>{It.storyData&&j(C)})}H(x,$)};De(_,x=>{It.error?x(k):x(P,!1)},!0)}H(w,I)};De(v,w=>{It.isLoading?w(p):w(m,!1)},!0)}H(u,f)};De(r,u=>{It.selectedStory?u(o,!1):u(i)})}H(n,t),xt()}Lt(["click"]);var lm=ee('<button style="position:fixed; top:10px; right:500px; z-index:9999;">Закрыть редактор</button> <!>',1),um=ee('<button id="content" style="position:fixed; bottom:10px; right:10px; z-index:9999;" class="svelte-1s2gs9v">Редактор</button> <!>',1);function cm(n,e){Tt(e,!1),rr();var t=kt(),r=Je(t);{var i=u=>{var f=lm(),v=Je(f);v.__click=function(...m){_t.toggleEditor?.apply(this,m)};var p=T(v,2);Wg(p,{}),H(u,f)},o=u=>{var f=um(),v=Je(f);v.__click=function(...m){_t.toggleEditor?.apply(this,m)};var p=T(v,2);om(p,{}),H(u,f)};De(r,u=>{B.showEditor?u(i):u(o,!1)})}H(n,t),xt()}Lt(["click"]);Td(cm,{target:document.getElementById("app")});
