(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();const al=!1;var ms=Array.isArray,Mu=Array.prototype.indexOf,mo=Array.from,Qs=Object.defineProperty,fi=Object.getOwnPropertyDescriptor,ll=Object.getOwnPropertyDescriptors,Lu=Object.prototype,$u=Array.prototype,_o=Object.getPrototypeOf,ga=Object.isExtensible;function Fu(n){return n()}function os(n){for(var e=0;e<n.length;e++)n[e]()}function Du(){var n,e,t=new Promise((r,o)=>{n=r,e=o});return{promise:t,resolve:n,reject:e}}const Bt=2,yo=4,_s=8,Gr=16,Nn=32,mr=64,ul=128,Yt=256,as=512,bt=1024,Jt=2048,Yn=4096,ln=8192,Kr=16384,wo=32768,bo=65536,ma=1<<17,Uu=1<<18,Ei=1<<19,cl=1<<20,Zs=1<<21,ko=1<<22,vr=1<<23,zn=Symbol("$state"),Eo=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Nu(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Bu(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Wu(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Vu(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function qu(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Hu(n){throw new Error("https://svelte.dev/e/effect_orphan")}function zu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Gu(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ku(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Yu(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const ys=1,ws=2,hl=4,Ju=8,Xu=16,Qu=1,Zu=2,dt=Symbol(),ec="http://www.w3.org/1999/xhtml";function tc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let nc=!1;function dl(n){return n===this.v}function fl(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function rc(n,e){return n!==e}function vl(n){return!fl(n,this.v)}let Ai=!1,ic=!1;function sc(){Ai=!0}let st=null;function ls(n){st=n}function Si(n,e=!1,t){st={p:st,c:null,e:null,s:n,x:null,l:Ai&&!e?{s:null,u:null,$:[]}:null}}function Ci(n){var e=st,t=e.e;if(t!==null){e.e=null;for(var r of t)Pl(r)}return st=e.p,{}}function Yr(){return!Ai||st!==null&&st.l===null}const oc=new WeakMap;function ac(n){var e=$e;if(e===null)return Le.f|=vr,n;if((e.f&wo)===0){if((e.f&ul)===0)throw!e.parent&&n instanceof Error&&pl(n),n;e.b.error(n)}else Ao(n,e)}function Ao(n,e){for(;e!==null;){if((e.f&ul)!==0)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n instanceof Error&&pl(n),n}function pl(n){const e=oc.get(n);e&&(Qs(n,"message",{value:e.message}),Qs(n,"stack",{value:e.stack}))}let _i=[],eo=[];function gl(){var n=_i;_i=[],os(n)}function lc(){var n=eo;eo=[],os(n)}function So(n){_i.length===0&&queueMicrotask(gl),_i.push(n)}function uc(){_i.length>0&&gl(),eo.length>0&&lc()}function cc(){for(var n=$e.b;n!==null&&!n.has_pending_snippet();)n=n.parent;return n===null&&Nu(),n}function bs(n){var e=Bt|Jt,t=Le!==null&&(Le.f&Bt)!==0?Le:null;return $e===null||t!==null&&(t.f&Yt)!==0?e|=Yt:$e.f|=Ei,{ctx:st,deps:null,effects:null,equals:dl,f:e,fn:n,reactions:null,rv:0,v:dt,wv:0,parent:t??$e,ac:null}}function hc(n,e){let t=$e;t===null&&Wu();var r=t.b,o=void 0,l=yi(dt),c=null,d=!Le;return Sc(()=>{try{var v=n();c&&Promise.resolve(v).catch(()=>{})}catch(m){v=Promise.reject(m)}var g=()=>v;o=c?.then(g,g)??Promise.resolve(v),c=o;var y=Ge,k=r.pending;d&&(r.update_pending_count(1),k||y.increment());const E=(m,I=void 0)=>{c=null,k||y.activate(),I?I!==Eo&&(l.f|=vr,wi(l,I)):((l.f&vr)!==0&&(l.f^=vr),wi(l,m)),d&&(r.update_pending_count(-1),k||y.decrement()),wl()};if(o.then(E,m=>E(null,m||"unknown")),y)return()=>{queueMicrotask(()=>y.neuter())}}),new Promise(v=>{function g(y){function k(){y===o?v(l):g(o)}y.then(k,k)}g(o)})}function Dr(n){const e=bs(n);return $l(e),e}function ml(n){const e=bs(n);return e.equals=vl,e}function _l(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Un(e[t])}}function dc(n){for(var e=n.parent;e!==null;){if((e.f&Bt)===0)return e;e=e.parent}return null}function Co(n){var e,t=$e;Kn(dc(n));try{_l(n),e=Nl(n)}finally{Kn(t)}return e}function yl(n){var e=Co(n);if(n.equals(e)||(n.v=e,n.wv=Dl()),!Xr){var t=(Hn||(n.f&Yt)!==0)&&n.deps!==null?Yn:bt;Mt(n,t)}}function fc(n,e,t){const r=Yr()?bs:ml;if(e.length===0){t(n.map(r));return}var o=Ge,l=$e,c=vc(),d=cc();Promise.all(e.map(v=>hc(v))).then(v=>{o?.activate(),c();try{t([...n.map(r),...v])}catch(g){(l.f&Kr)===0&&Ao(g,l)}o?.deactivate(),wl()}).catch(v=>{d.error(v)})}function vc(){var n=$e,e=Le,t=st,r=Ge;return function(){Kn(n),Sn(e),ls(t),r?.activate()}}function wl(){Kn(null),Sn(null),ls(null)}const Ns=new Set;let Ge=null,rs=null,_a=new Set,us=[];function bl(){const n=us.shift();us.length>0&&queueMicrotask(bl),n()}let gr=[],ks=null,to=!1,is=!1;class Vr{current=new Map;#n=new Map;#t=new Set;#e=0;#r=null;#i=!1;#o=[];#l=[];#a=[];#s=[];#u=[];#h=[];#d=[];skipped_effects=new Set;process(e){gr=[],rs=null;for(const o of e)this.#v(o);if(this.#o.length===0&&this.#e===0){this.#f();var t=this.#a,r=this.#s;this.#a=[],this.#s=[],this.#u=[],rs=Ge,Ge=null,ya(t),ya(r),Ge===null?Ge=this:Ns.delete(this),this.#r?.resolve()}else this.#c(this.#a),this.#c(this.#s),this.#c(this.#u);for(const o of this.#o)Wr(o);for(const o of this.#l)Wr(o);this.#o=[],this.#l=[]}#v(e){e.f^=bt;for(var t=e.first;t!==null;){var r=t.f,o=(r&(Nn|mr))!==0,l=o&&(r&bt)!==0,c=l||(r&ln)!==0||this.skipped_effects.has(t);if(!c&&t.fn!==null){if(o)t.f^=bt;else if((r&yo)!==0)this.#s.push(t);else if((r&bt)===0)if((r&ko)!==0){var d=t.b?.pending?this.#l:this.#o;d.push(t)}else Cs(t)&&((t.f&Gr)!==0&&this.#u.push(t),Wr(t));var v=t.first;if(v!==null){t=v;continue}}var g=t.parent;for(t=t.next;t===null&&g!==null;)t=g.next,g=g.parent}}#c(e){for(const t of e)((t.f&Jt)!==0?this.#h:this.#d).push(t),Mt(t,bt);e.length=0}capture(e,t){this.#n.has(e)||this.#n.set(e,t),this.current.set(e,e.v)}activate(){Ge=this}deactivate(){Ge=null,rs=null;for(const e of _a)if(_a.delete(e),e(),Ge!==null)break}neuter(){this.#i=!0}flush(){gr.length>0?kl():this.#f(),Ge===this&&(this.#e===0&&Ns.delete(this),this.deactivate())}#f(){if(!this.#i)for(const e of this.#t)e();this.#t.clear()}increment(){this.#e+=1}decrement(){if(this.#e-=1,this.#e===0){for(const e of this.#h)Mt(e,Jt),qr(e);for(const e of this.#d)Mt(e,Yn),qr(e);this.#a=[],this.#s=[],this.flush()}else this.deactivate()}add_callback(e){this.#t.add(e)}settled(){return(this.#r??=Du()).promise}static ensure(){if(Ge===null){const e=Ge=new Vr;Ns.add(Ge),is||Vr.enqueue(()=>{Ge===e&&e.flush()})}return Ge}static enqueue(e){us.length===0&&queueMicrotask(bl),us.unshift(e)}}function pc(n){var e=is;is=!0;try{for(var t;;){if(uc(),gr.length===0&&(Ge?.flush(),gr.length===0))return ks=null,t;kl()}}finally{is=e}}function kl(){var n=Br;to=!0;try{var e=0;for(Ea(!0);gr.length>0;){var t=Vr.ensure();if(e++>1e3){var r,o;gc()}t.process(gr),Gn.clear()}}finally{to=!1,Ea(n),ks=null}}function gc(){try{zu()}catch(n){Ao(n,ks)}}let cr=null;function ya(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if((r.f&(Kr|ln))===0&&Cs(r)&&(cr=[],Wr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?xl(r):r.fn=null),cr?.length>0)){Gn.clear();for(const o of cr)Wr(o);cr=[]}}cr=null}}function qr(n){for(var e=ks=n;e.parent!==null;){e=e.parent;var t=e.f;if(to&&e===$e&&(t&Gr)!==0)return;if((t&(mr|Nn))!==0){if((t&bt)===0)return;e.f^=bt}}gr.push(e)}const Gn=new Map;function yi(n,e){var t={f:0,v:n,reactions:null,equals:dl,rv:0,wv:0};return t}function Xe(n,e){const t=yi(n);return $l(t),t}function mc(n,e=!1,t=!0){const r=yi(n);return e||(r.equals=vl),Ai&&t&&st!==null&&st.l!==null&&(st.l.s??=[]).push(r),r}function fe(n,e,t=!1){Le!==null&&(!En||(Le.f&ma)!==0)&&Yr()&&(Le.f&(Bt|Gr|ko|ma))!==0&&!Dn?.includes(n)&&Yu();let r=t?An(e):e;return wi(n,r)}function wi(n,e){if(!n.equals(e)){var t=n.v;Xr?Gn.set(n,e):Gn.set(n,t),n.v=e;var r=Vr.ensure();r.capture(n,t),(n.f&Bt)!==0&&((n.f&Jt)!==0&&Co(n),Mt(n,(n.f&Yt)===0?bt:Yn)),n.wv=Dl(),El(n,Jt),Yr()&&$e!==null&&($e.f&bt)!==0&&($e.f&(Nn|mr))===0&&(Kt===null?Ic([n]):Kt.push(n))}return e}function Bs(n){fe(n,n.v+1)}function El(n,e){var t=n.reactions;if(t!==null)for(var r=Yr(),o=t.length,l=0;l<o;l++){var c=t[l],d=c.f;if(!(!r&&c===$e)){var v=(d&Jt)===0;v&&Mt(c,e),(d&Bt)!==0?El(c,Yn):v&&((d&Gr)!==0&&cr!==null&&cr.push(c),qr(c))}}}function An(n){if(typeof n!="object"||n===null||zn in n)return n;const e=_o(n);if(e!==Lu&&e!==$u)return n;var t=new Map,r=ms(n),o=Xe(0),l=pr,c=d=>{if(pr===l)return d();var v=Le,g=pr;Sn(null),Sa(l);var y=d();return Sn(v),Sa(g),y};return r&&t.set("length",Xe(n.length)),new Proxy(n,{defineProperty(d,v,g){(!("value"in g)||g.configurable===!1||g.enumerable===!1||g.writable===!1)&&Gu();var y=t.get(v);return y===void 0?y=c(()=>{var k=Xe(g.value);return t.set(v,k),k}):fe(y,g.value,!0),!0},deleteProperty(d,v){var g=t.get(v);if(g===void 0){if(v in d){const y=c(()=>Xe(dt));t.set(v,y),Bs(o)}}else fe(g,dt),Bs(o);return!0},get(d,v,g){if(v===zn)return n;var y=t.get(v),k=v in d;if(y===void 0&&(!k||fi(d,v)?.writable)&&(y=c(()=>{var m=An(k?d[v]:dt),I=Xe(m);return I}),t.set(v,y)),y!==void 0){var E=T(y);return E===dt?void 0:E}return Reflect.get(d,v,g)},getOwnPropertyDescriptor(d,v){var g=Reflect.getOwnPropertyDescriptor(d,v);if(g&&"value"in g){var y=t.get(v);y&&(g.value=T(y))}else if(g===void 0){var k=t.get(v),E=k?.v;if(k!==void 0&&E!==dt)return{enumerable:!0,configurable:!0,value:E,writable:!0}}return g},has(d,v){if(v===zn)return!0;var g=t.get(v),y=g!==void 0&&g.v!==dt||Reflect.has(d,v);if(g!==void 0||$e!==null&&(!y||fi(d,v)?.writable)){g===void 0&&(g=c(()=>{var E=y?An(d[v]):dt,m=Xe(E);return m}),t.set(v,g));var k=T(g);if(k===dt)return!1}return y},set(d,v,g,y){var k=t.get(v),E=v in d;if(r&&v==="length")for(var m=g;m<k.v;m+=1){var I=t.get(m+"");I!==void 0?fe(I,dt):m in d&&(I=c(()=>Xe(dt)),t.set(m+"",I))}if(k===void 0)(!E||fi(d,v)?.writable)&&(k=c(()=>Xe(void 0)),fe(k,An(g)),t.set(v,k));else{E=k.v!==dt;var $=c(()=>An(g));fe(k,$)}var O=Reflect.getOwnPropertyDescriptor(d,v);if(O?.set&&O.set.call(y,g),!E){if(r&&typeof v=="string"){var q=t.get("length"),H=Number(v);Number.isInteger(H)&&H>=q.v&&fe(q,H+1)}Bs(o)}return!0},ownKeys(d){T(o);var v=Reflect.ownKeys(d).filter(k=>{var E=t.get(k);return E===void 0||E.v!==dt});for(var[g,y]of t)y.v!==dt&&!(g in d)&&v.push(g);return v},setPrototypeOf(){Ku()}})}function wa(n){try{if(n!==null&&typeof n=="object"&&zn in n)return n[zn]}catch{}return n}function _c(n,e){return Object.is(wa(n),wa(e))}var ba,Al,Sl,Cl;function yc(){if(ba===void 0){ba=window,Al=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;Sl=fi(e,"firstChild").get,Cl=fi(e,"nextSibling").get,ga(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),ga(t)&&(t.__t=void 0)}}function Jr(n=""){return document.createTextNode(n)}function cs(n){return Sl.call(n)}function Es(n){return Cl.call(n)}function z(n,e){return cs(n)}function an(n,e){{var t=cs(n);return t instanceof Comment&&t.data===""?Es(t):t}}function te(n,e=1,t=!1){let r=n;for(;e--;)r=Es(r);return r}function wc(n){n.textContent=""}function To(){return!1}let ka=!1;function bc(){ka||(ka=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const e of n.target.elements)e.__on_r?.()})},{capture:!0}))}function As(n){var e=Le,t=$e;Sn(null),Kn(null);try{return n()}finally{Sn(e),Kn(t)}}function Io(n,e,t,r=t){n.addEventListener(e,()=>As(t));const o=n.__on_r;o?n.__on_r=()=>{o(),r(!0)}:n.__on_r=()=>r(!0),bc()}function Tl(n){$e===null&&Le===null&&Hu(),Le!==null&&(Le.f&Yt)!==0&&$e===null&&qu(),Xr&&Vu()}function kc(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Cn(n,e,t,r=!0){var o=$e;o!==null&&(o.f&ln)!==0&&(n|=ln);var l={ctx:st,deps:null,nodes_start:null,nodes_end:null,f:n|Jt,first:null,fn:e,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Wr(l),l.f|=wo}catch(v){throw Un(l),v}else e!==null&&qr(l);if(r){var c=l;if(t&&c.deps===null&&c.teardown===null&&c.nodes_start===null&&c.first===c.last&&(c.f&Ei)===0&&(c=c.first),c!==null&&(c.parent=o,o!==null&&kc(c,o),Le!==null&&(Le.f&Bt)!==0&&(n&mr)===0)){var d=Le;(d.effects??=[]).push(c)}}return l}function Il(n){const e=Cn(_s,null,!1);return Mt(e,bt),e.teardown=n,e}function hs(n){Tl();var e=$e.f,t=!Le&&(e&Nn)!==0&&(e&wo)===0;if(t){var r=st;(r.e??=[]).push(n)}else return Pl(n)}function Pl(n){return Cn(yo|cl,n,!1)}function Ec(n){return Tl(),Cn(_s|cl,n,!0)}function Ac(n){Vr.ensure();const e=Cn(mr|Ei,n,!0);return(t={})=>new Promise(r=>{t.outro?Ss(e,()=>{Un(e),r(void 0)}):(Un(e),r(void 0))})}function Rl(n){return Cn(yo,n,!1)}function Sc(n){return Cn(ko|Ei,n,!0)}function Po(n,e=0){return Cn(_s|e,n,!0)}function et(n,e=[],t=[]){fc(e,t,r=>{Cn(_s,()=>n(...r.map(T)),!0)})}function Ro(n,e=0){var t=Cn(Gr|e,n,!0);return t}function Hr(n,e=!0){return Cn(Nn|Ei,n,!0,e)}function jl(n){var e=n.teardown;if(e!==null){const t=Xr,r=Le;Aa(!0),Sn(null);try{e.call(null)}finally{Aa(t),Sn(r)}}}function Ol(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const o=t.ac;o!==null&&As(()=>{o.abort(Eo)});var r=t.next;(t.f&mr)!==0?t.parent=null:Un(t,e),t=r}}function Cc(n){for(var e=n.first;e!==null;){var t=e.next;(e.f&Nn)===0&&Un(e),e=t}}function Un(n,e=!0){var t=!1;(e||(n.f&Uu)!==0)&&n.nodes_start!==null&&n.nodes_end!==null&&(Tc(n.nodes_start,n.nodes_end),t=!0),Ol(n,e&&!t),ds(n,0),Mt(n,Kr);var r=n.transitions;if(r!==null)for(const l of r)l.stop();jl(n);var o=n.parent;o!==null&&o.first!==null&&xl(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Tc(n,e){for(;n!==null;){var t=n===e?null:Es(n);n.remove(),n=t}}function xl(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function Ss(n,e){var t=[];jo(n,t,!0),Ml(t,()=>{Un(n),e&&e()})}function Ml(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var o of n)o.out(r)}else e()}function jo(n,e,t){if((n.f&ln)===0){if(n.f^=ln,n.transitions!==null)for(const c of n.transitions)(c.is_global||t)&&e.push(c);for(var r=n.first;r!==null;){var o=r.next,l=(r.f&bo)!==0||(r.f&Nn)!==0;jo(r,e,l?t:!1),r=o}}}function Oo(n){Ll(n,!0)}function Ll(n,e){if((n.f&ln)!==0){n.f^=ln,(n.f&bt)===0&&(Mt(n,Jt),qr(n));for(var t=n.first;t!==null;){var r=t.next,o=(t.f&bo)!==0||(t.f&Nn)!==0;Ll(t,o?e:!1),t=r}if(n.transitions!==null)for(const l of n.transitions)(l.is_global||e)&&l.in()}}let Br=!1;function Ea(n){Br=n}let Xr=!1;function Aa(n){Xr=n}let Le=null,En=!1;function Sn(n){Le=n}let $e=null;function Kn(n){$e=n}let Dn=null;function $l(n){Le!==null&&(Dn===null?Dn=[n]:Dn.push(n))}let It=null,Nt=0,Kt=null;function Ic(n){Kt=n}let Fl=1,bi=0,pr=bi;function Sa(n){pr=n}let Hn=!1;function Dl(){return++Fl}function Cs(n){var e=n.f;if((e&Jt)!==0)return!0;if((e&Yn)!==0){var t=n.deps,r=(e&Yt)!==0;if(t!==null){var o,l,c=(e&as)!==0,d=r&&$e!==null&&!Hn,v=t.length;if((c||d)&&($e===null||($e.f&Kr)===0)){var g=n,y=g.parent;for(o=0;o<v;o++)l=t[o],(c||!l?.reactions?.includes(g))&&(l.reactions??=[]).push(g);c&&(g.f^=as),d&&y!==null&&(y.f&Yt)===0&&(g.f^=Yt)}for(o=0;o<v;o++)if(l=t[o],Cs(l)&&yl(l),l.wv>n.wv)return!0}(!r||$e!==null&&!Hn)&&Mt(n,bt)}return!1}function Ul(n,e,t=!0){var r=n.reactions;if(r!==null&&!Dn?.includes(n))for(var o=0;o<r.length;o++){var l=r[o];(l.f&Bt)!==0?Ul(l,e,!1):e===l&&(t?Mt(l,Jt):(l.f&bt)!==0&&Mt(l,Yn),qr(l))}}function Nl(n){var e=It,t=Nt,r=Kt,o=Le,l=Hn,c=Dn,d=st,v=En,g=pr,y=n.f;It=null,Nt=0,Kt=null,Hn=(y&Yt)!==0&&(En||!Br||Le===null),Le=(y&(Nn|mr))===0?n:null,Dn=null,ls(n.ctx),En=!1,pr=++bi,n.ac!==null&&(As(()=>{n.ac.abort(Eo)}),n.ac=null);try{n.f|=Zs;var k=n.fn,E=k(),m=n.deps;if(It!==null){var I;if(ds(n,Nt),m!==null&&Nt>0)for(m.length=Nt+It.length,I=0;I<It.length;I++)m[Nt+I]=It[I];else n.deps=m=It;if(!Hn||(y&Bt)!==0&&n.reactions!==null)for(I=Nt;I<m.length;I++)(m[I].reactions??=[]).push(n)}else m!==null&&Nt<m.length&&(ds(n,Nt),m.length=Nt);if(Yr()&&Kt!==null&&!En&&m!==null&&(n.f&(Bt|Yn|Jt))===0)for(I=0;I<Kt.length;I++)Ul(Kt[I],n);return o!==null&&o!==n&&(bi++,Kt!==null&&(r===null?r=Kt:r.push(...Kt))),(n.f&vr)!==0&&(n.f^=vr),E}catch($){return ac($)}finally{n.f^=Zs,It=e,Nt=t,Kt=r,Le=o,Hn=l,Dn=c,ls(d),En=v,pr=g}}function Pc(n,e){let t=e.reactions;if(t!==null){var r=Mu.call(t,n);if(r!==-1){var o=t.length-1;o===0?t=e.reactions=null:(t[r]=t[o],t.pop())}}t===null&&(e.f&Bt)!==0&&(It===null||!It.includes(e))&&(Mt(e,Yn),(e.f&(Yt|as))===0&&(e.f^=as),_l(e),ds(e,0))}function ds(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Pc(n,t[r])}function Wr(n){var e=n.f;if((e&Kr)===0){Mt(n,bt);var t=$e,r=Br;$e=n,Br=!0;try{(e&Gr)!==0?Cc(n):Ol(n),jl(n);var o=Nl(n);n.teardown=typeof o=="function"?o:null,n.wv=Fl;var l;al&&ic&&(n.f&Jt)!==0&&n.deps}finally{Br=r,$e=t}}}async function Rc(){await Promise.resolve(),pc()}function T(n){var e=n.f,t=(e&Bt)!==0;if(Le!==null&&!En){var r=$e!==null&&($e.f&Kr)!==0;if(!r&&!Dn?.includes(n)){var o=Le.deps;if((Le.f&Zs)!==0)n.rv<bi&&(n.rv=bi,It===null&&o!==null&&o[Nt]===n?Nt++:It===null?It=[n]:(!Hn||!It.includes(n))&&It.push(n));else{(Le.deps??=[]).push(n);var l=n.reactions;l===null?n.reactions=[Le]:l.includes(Le)||l.push(Le)}}}else if(t&&n.deps===null&&n.effects===null){var c=n,d=c.parent;d!==null&&(d.f&Yt)===0&&(c.f^=Yt)}if(Xr){if(Gn.has(n))return Gn.get(n);if(t){c=n;var v=c.v;return((c.f&bt)===0&&c.reactions!==null||Bl(c))&&(v=Co(c)),Gn.set(c,v),v}}else t&&(c=n,Cs(c)&&yl(c));if((n.f&vr)!==0)throw n.v;return n.v}function Bl(n){if(n.v===dt)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Gn.has(e)||(e.f&Bt)!==0&&Bl(e))return!0;return!1}function Ti(n){var e=En;try{return En=!0,n()}finally{En=e}}const jc=-7169;function Mt(n,e){n.f=n.f&jc|e}function Oc(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(zn in n)no(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&zn in t&&no(t)}}}function no(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{no(n[r],e)}catch{}const t=_o(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=ll(t);for(let o in r){const l=r[o].get;if(l)try{l.call(n)}catch{}}}}}const xc=["touchstart","touchmove"];function Mc(n){return xc.includes(n)}const Wl=new Set,ro=new Set;function Lc(n,e,t,r={}){function o(l){if(r.capture||hi.call(e,l),!l.cancelBubble)return As(()=>t?.call(this,l))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?So(()=>{e.addEventListener(n,o,r)}):e.addEventListener(n,o,r),o}function Ca(n,e,t,r,o){var l={capture:r,passive:o},c=Lc(n,e,t,l);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Il(()=>{e.removeEventListener(n,c,l)})}function Vl(n){for(var e=0;e<n.length;e++)Wl.add(n[e]);for(var t of ro)t(n)}let Ta=null;function hi(n){var e=this,t=e.ownerDocument,r=n.type,o=n.composedPath?.()||[],l=o[0]||n.target;Ta=n;var c=0,d=Ta===n&&n.__root;if(d){var v=o.indexOf(d);if(v!==-1&&(e===document||e===window)){n.__root=e;return}var g=o.indexOf(e);if(g===-1)return;v<=g&&(c=v)}if(l=o[c]||n.target,l!==e){Qs(n,"currentTarget",{configurable:!0,get(){return l||t}});var y=Le,k=$e;Sn(null),Kn(null);try{for(var E,m=[];l!==null;){var I=l.assignedSlot||l.parentNode||l.host||null;try{var $=l["__"+r];if($!=null&&(!l.disabled||n.target===l))if(ms($)){var[O,...q]=$;O.apply(l,[n,...q])}else $.call(l,n)}catch(H){E?m.push(H):E=H}if(n.cancelBubble||I===e||I===null)break;l=I}if(E){for(let H of m)queueMicrotask(()=>{throw H});throw E}}finally{n.__root=e,delete n.currentTarget,Sn(y),Kn(k)}}}function $c(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function io(n,e){var t=$e;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function Ae(n,e){var t=(e&Qu)!==0,r=(e&Zu)!==0,o,l=!n.startsWith("<!>");return()=>{o===void 0&&(o=$c(l?n:"<!>"+n),t||(o=cs(o)));var c=r||Al?document.importNode(o,!0):o.cloneNode(!0);if(t){var d=cs(c),v=c.lastChild;io(d,v)}else io(c,c);return c}}function Fn(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Jr();return n.append(e,t),io(e,t),n}function ce(n,e){n!==null&&n.before(e)}function Je(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??=n.nodeValue)&&(n.__t=t,n.nodeValue=t+"")}function Fc(n,e){return Dc(n,e)}const Cr=new Map;function Dc(n,{target:e,anchor:t,props:r={},events:o,context:l,intro:c=!0}){yc();var d=new Set,v=k=>{for(var E=0;E<k.length;E++){var m=k[E];if(!d.has(m)){d.add(m);var I=Mc(m);e.addEventListener(m,hi,{passive:I});var $=Cr.get(m);$===void 0?(document.addEventListener(m,hi,{passive:I}),Cr.set(m,1)):Cr.set(m,$+1)}}};v(mo(Wl)),ro.add(v);var g=void 0,y=Ac(()=>{var k=t??e.appendChild(Jr());return Hr(()=>{if(l){Si({});var E=st;E.c=l}o&&(r.$$events=o),g=n(k,r)||{},l&&Ci()}),()=>{for(var E of d){e.removeEventListener(E,hi);var m=Cr.get(E);--m===0?(document.removeEventListener(E,hi),Cr.delete(E)):Cr.set(E,m)}ro.delete(v),k!==t&&k.parentNode?.removeChild(k)}});return Uc.set(g,y),g}let Uc=new WeakMap;function it(n,e,t=!1){var r=n,o=null,l=null,c=dt,d=t?bo:0,v=!1;const g=(m,I=!0)=>{v=!0,E(I,m)};var y=null;function k(){y!==null&&(y.lastChild.remove(),r.before(y),y=null);var m=c?o:l,I=c?l:o;m&&Oo(m),I&&Ss(I,()=>{c?l=null:o=null})}const E=(m,I)=>{if(c!==(c=m)){var $=To(),O=r;if($&&(y=document.createDocumentFragment(),y.append(O=Jr())),c?o??=I&&Hr(()=>I(O)):l??=I&&Hr(()=>I(O)),$){var q=Ge,H=c?o:l,N=c?l:o;H&&q.skipped_effects.delete(H),N&&q.skipped_effects.add(N),q.add_callback(k)}else k()}};Ro(()=>{v=!1,e(g),v||E(null,null)},d)}function Ia(n,e,t){var r=n,o=dt,l,c,d=null,v=Yr()?rc:fl;function g(){l&&Ss(l),d!==null&&(d.lastChild.remove(),r.before(d),d=null),l=c}Ro(()=>{if(v(o,o=e())){var y=r,k=To();k&&(d=document.createDocumentFragment(),d.append(y=Jr())),c=Hr(()=>t(y)),k?Ge.add_callback(g):g()}})}function wn(n,e){return e}function Nc(n,e,t){for(var r=n.items,o=[],l=e.length,c=0;c<l;c++)jo(e[c].e,o,!0);var d=l>0&&o.length===0&&t!==null;if(d){var v=t.parentNode;wc(v),v.append(t),r.clear(),bn(n,e[0].prev,e[l-1].next)}Ml(o,()=>{for(var g=0;g<l;g++){var y=e[g];d||(r.delete(y.k),bn(n,y.prev,y.next)),Un(y.e,!d)}})}function Ut(n,e,t,r,o,l=null){var c=n,d={flags:e,items:new Map,first:null},v=(e&hl)!==0;if(v){var g=n;c=g.appendChild(Jr())}var y=null,k=!1,E=new Map,m=ml(()=>{var q=t();return ms(q)?q:q==null?[]:mo(q)}),I,$;function O(){Bc($,I,d,E,c,o,e,r,t),l!==null&&(I.length===0?y?Oo(y):y=Hr(()=>l(c)):y!==null&&Ss(y,()=>{y=null}))}Ro(()=>{$??=$e,I=T(m);var q=I.length;if(!(k&&q===0)){k=q===0;var H,N,G,K;if(To()){var j=new Set,L=Ge;for(N=0;N<q;N+=1){G=I[N],K=r(G,N);var ie=d.items.get(K)??E.get(K);ie?(e&(ys|ws))!==0&&ql(ie,G,N,e):(H=Hl(null,d,null,null,G,K,N,o,e,t,!0),E.set(K,H)),j.add(K)}for(const[ue,ae]of d.items)j.has(ue)||L.skipped_effects.add(ae.e);L.add_callback(O)}else O();T(m)}})}function Bc(n,e,t,r,o,l,c,d,v){var g=(c&Ju)!==0,y=(c&(ys|ws))!==0,k=e.length,E=t.items,m=t.first,I=m,$,O=null,q,H=[],N=[],G,K,j,L;if(g)for(L=0;L<k;L+=1)G=e[L],K=d(G,L),j=E.get(K),j!==void 0&&(j.a?.measure(),(q??=new Set).add(j));for(L=0;L<k;L+=1){if(G=e[L],K=d(G,L),j=E.get(K),j===void 0){var ie=r.get(K);if(ie!==void 0){r.delete(K),E.set(K,ie);var ue=O?O.next:I;bn(t,O,ie),bn(t,ie,ue),Ws(ie,ue,o),O=ie}else{var ae=I?I.e.nodes_start:o;O=Hl(ae,t,O,O===null?t.first:O.next,G,K,L,l,c,v)}E.set(K,O),H=[],N=[],I=O.next;continue}if(y&&ql(j,G,L,c),(j.e.f&ln)!==0&&(Oo(j.e),g&&(j.a?.unfix(),(q??=new Set).delete(j))),j!==I){if($!==void 0&&$.has(j)){if(H.length<N.length){var X=N[0],he;O=X.prev;var Ne=H[0],Ke=H[H.length-1];for(he=0;he<H.length;he+=1)Ws(H[he],X,o);for(he=0;he<N.length;he+=1)$.delete(N[he]);bn(t,Ne.prev,Ke.next),bn(t,O,Ne),bn(t,Ke,X),I=X,O=Ke,L-=1,H=[],N=[]}else $.delete(j),Ws(j,I,o),bn(t,j.prev,j.next),bn(t,j,O===null?t.first:O.next),bn(t,O,j),O=j;continue}for(H=[],N=[];I!==null&&I.k!==K;)(I.e.f&ln)===0&&($??=new Set).add(I),N.push(I),I=I.next;if(I===null)continue;j=I}H.push(j),O=j,I=j.next}if(I!==null||$!==void 0){for(var Ve=$===void 0?[]:mo($);I!==null;)(I.e.f&ln)===0&&Ve.push(I),I=I.next;var gt=Ve.length;if(gt>0){var Ee=(c&hl)!==0&&k===0?o:null;if(g){for(L=0;L<gt;L+=1)Ve[L].a?.measure();for(L=0;L<gt;L+=1)Ve[L].a?.fix()}Nc(t,Ve,Ee)}}g&&So(()=>{if(q!==void 0)for(j of q)j.a?.apply()}),n.first=t.first&&t.first.e,n.last=O&&O.e;for(var un of r.values())Un(un.e);r.clear()}function ql(n,e,t,r){(r&ys)!==0&&wi(n.v,e),(r&ws)!==0?wi(n.i,t):n.i=t}function Hl(n,e,t,r,o,l,c,d,v,g,y){var k=(v&ys)!==0,E=(v&Xu)===0,m=k?E?mc(o,!1,!1):yi(o):o,I=(v&ws)===0?c:yi(c),$={i:I,v:m,k:l,a:null,e:null,prev:t,next:r};try{if(n===null){var O=document.createDocumentFragment();O.append(n=Jr())}return $.e=Hr(()=>d(n,m,I,g),nc),$.e.prev=t&&t.e,$.e.next=r&&r.e,t===null?y||(e.first=$):(t.next=$,t.e.next=$.e),r!==null&&(r.prev=$,r.e.prev=$.e),$}finally{}}function Ws(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,o=e?e.e.nodes_start:t,l=n.e.nodes_start;l!==null&&l!==r;){var c=Es(l);o.before(l),l=c}}function bn(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}const Pa=[...` 	
\r\f \v\uFEFF`];function Wc(n,e,t){var r=n==null?"":""+n;if(e&&(r=r?r+" "+e:e),t){for(var o in t)if(t[o])r=r?r+" "+o:o;else if(r.length)for(var l=o.length,c=0;(c=r.indexOf(o,c))>=0;){var d=c+l;(c===0||Pa.includes(r[c-1]))&&(d===r.length||Pa.includes(r[d]))?r=(c===0?"":r.substring(0,c))+r.substring(d+1):c=d}}return r===""?null:r}function Tr(n,e,t,r,o,l){var c=n.__className;if(c!==t||c===void 0){var d=Wc(t,r,l);d==null?n.removeAttribute("class"):n.className=d,n.__className=t}else if(l&&o!==l)for(var v in l){var g=!!l[v];(o==null||g!==!!o[v])&&n.classList.toggle(v,g)}return l}function zl(n,e,t=!1){if(n.multiple){if(e==null)return;if(!ms(e))return tc();for(var r of n.options)r.selected=e.includes(vi(r));return}for(r of n.options){var o=vi(r);if(_c(o,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function Vc(n){var e=new MutationObserver(()=>{zl(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Il(()=>{e.disconnect()})}function ci(n,e,t=e){var r=!0;Io(n,"change",o=>{var l=o?"[selected]":":checked",c;if(n.multiple)c=[].map.call(n.querySelectorAll(l),vi);else{var d=n.querySelector(l)??n.querySelector("option:not([disabled])");c=d&&vi(d)}t(c)}),Rl(()=>{var o=e();if(zl(n,o,r),r&&o===void 0){var l=n.querySelector(":checked");l!==null&&(o=vi(l),t(o))}n.__value=o,r=!1}),Vc(n)}function vi(n){return"__value"in n?n.__value:n.value}const qc=Symbol("is custom element"),Hc=Symbol("is html");function Ra(n,e,t,r){var o=zc(n);o[e]!==(o[e]=t)&&(t==null?n.removeAttribute(e):typeof t!="string"&&Gc(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function zc(n){return n.__attributes??={[qc]:n.nodeName.includes("-"),[Hc]:n.namespaceURI===ec}}var ja=new Map;function Gc(n){var e=n.getAttribute("is")||n.nodeName,t=ja.get(e);if(t)return t;ja.set(e,t=[]);for(var r,o=n,l=Element.prototype;l!==o;){r=ll(o);for(var c in r)r[c].set&&t.push(c);o=_o(o)}return t}function Xi(n,e,t=e){var r=new WeakSet;Io(n,"input",async o=>{var l=o?n.defaultValue:n.value;if(l=Vs(n)?qs(l):l,t(l),Ge!==null&&r.add(Ge),await Rc(),l!==(l=e())){var c=n.selectionStart,d=n.selectionEnd;n.value=l??"",d!==null&&(n.selectionStart=c,n.selectionEnd=Math.min(d,n.value.length))}}),Ti(e)==null&&n.value&&(t(Vs(n)?qs(n.value):n.value),Ge!==null&&r.add(Ge)),Po(()=>{var o=e();if(n===document.activeElement){var l=rs??Ge;if(r.has(l))return}Vs(n)&&o===qs(n.value)||n.type==="date"&&!o&&!n.value||o!==n.value&&(n.value=o??"")})}function Kc(n,e,t=e){Io(n,"change",r=>{var o=r?n.defaultChecked:n.checked;t(o)}),Ti(e)==null&&t(n.checked),Po(()=>{var r=e();n.checked=!!r})}function Vs(n){var e=n.type;return e==="number"||e==="range"}function qs(n){return n===""?null:+n}function Oa(n,e){return n===e||n?.[zn]===e}function Yc(n={},e,t,r){return Rl(()=>{var o,l;return Po(()=>{o=l,l=[],Ti(()=>{n!==t(...l)&&(e(n,...l),o&&Oa(t(...o),n)&&e(null,...o))})}),()=>{So(()=>{l&&Oa(t(...l),n)&&e(null,...l)})}}),n}function Jc(n=!1){const e=st,t=e.l.u;if(!t)return;let r=()=>Oc(e.s);if(n){let o=0,l={};const c=bs(()=>{let d=!1;const v=e.s;for(const g in v)v[g]!==l[g]&&(l[g]=v[g],d=!0);return d&&o++,o});r=()=>T(c)}t.b.length&&Ec(()=>{xa(e,r),os(t.b)}),hs(()=>{const o=Ti(()=>t.m.map(Fu));return()=>{for(const l of o)typeof l=="function"&&l()}}),t.a.length&&hs(()=>{xa(e,r),os(t.a)})}function xa(n,e){if(n.l.s)for(const t of n.l.s)T(t);e()}function xo(n){st===null&&Bu(),Ai&&st.l!==null?Xc(st).m.push(n):hs(()=>{const e=Ti(n);if(typeof e=="function")return e})}function Xc(n){var e=n.l;return e.u??={a:[],b:[],m:[]}}const Qc="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Qc);sc();class Zc{#n=Xe(An({inventory:[],stats:{knowledge:0,courage:0,charisma:0}}));get player(){return T(this.#n)}set player(e){fe(this.#n,e,!0)}#t=Xe(null);get storyData(){return T(this.#t)}set storyData(e){fe(this.#t,e,!0)}#e=Xe("0");get currentDialogueId(){return T(this.#e)}set currentDialogueId(e){fe(this.#e,e,!0)}#r=Xe(!0);get isLoading(){return T(this.#r)}set isLoading(e){fe(this.#r,e,!0)}#i=Xe("");get error(){return T(this.#i)}set error(e){fe(this.#i,e,!0)}async loadStory(e){this.isLoading=!0;try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);this.storyData=await t.json(),this.currentDialogueId=this.storyData.dialogues[0]?.id||"0"}catch(t){this.error="Ошибка загрузки: "+t.message,console.error(t)}finally{this.isLoading=!1}}findDialogue(e){return this.storyData?.dialogues.find(t=>t.id===e)}getItem(e){return this.storyData?.items.find(t=>t.id===e)}hasItem(e){return this.player.inventory.includes(e)}addItem(e){this.player.inventory.includes(e)||(this.player.inventory=[...this.player.inventory,e])}runActions(e){e&&e.forEach(t=>{t.type==="add_item"&&t.id&&this.addItem(t.id),t.type==="stat_change"&&t.stat&&t.value!==void 0&&(this.player.stats[t.stat]+=t.value)})}goToDialogue(e){this.currentDialogueId=e}}const xt=new Zc;function eh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function th(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var o=!1;try{o=this instanceof r}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var ss={exports:{}},nh=ss.exports,Ma;function rh(){return Ma||(Ma=1,(function(n,e){(function(r,o){n.exports=o()})(nh,()=>(()=>{var t=[,((c,d,v)=>{v.r(d),v.d(d,{default:()=>y});var g=(()=>{var k=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return(function(E={}){var m=E,I,$;m.ready=new Promise((i,s)=>{I=i,$=s});function O(){function i(A){const R=f;u=s=0,f=new Map,R.forEach(M=>{try{M(A)}catch(P){console.error(P)}}),this.pb(),_&&_.Tb()}let s=0,u=0,f=new Map,_=null,b=null;this.requestAnimationFrame=function(A){s||(s=requestAnimationFrame(i.bind(this)));const R=++u;return f.set(R,A),R},this.cancelAnimationFrame=function(A){f.delete(A),s&&f.size==0&&(cancelAnimationFrame(s),s=0)},this.Rb=function(A){b&&(document.body.remove(b),b=null),A||(b=document.createElement("div"),b.style.backgroundColor="black",b.style.position="fixed",b.style.right=0,b.style.top=0,b.style.color="white",b.style.padding="4px",b.innerHTML="RIVE FPS",A=function(R){b.innerHTML="RIVE FPS "+R.toFixed(1)},document.body.appendChild(b)),_=new function(){let R=0,M=0;this.Tb=function(){var P=performance.now();M?(++R,P-=M,1e3<P&&(A(1e3*R/P),R=M=0)):(M=P,R=0)}}},this.Ob=function(){b&&(document.body.remove(b),b=null),_=null},this.pb=function(){}}function q(i){console.assert(!0);const s=new Map;let u=-1/0;this.push=function(f){return f=f+((1<<i)-1)>>i,s.has(f)&&clearTimeout(s.get(f)),s.set(f,setTimeout(function(){s.delete(f),s.length==0?u=-1/0:f==u&&(u=Math.max(...s.keys()),console.assert(u<f))},1e3)),u=Math.max(f,u),u<<i}}const H=m.onRuntimeInitialized;m.onRuntimeInitialized=function(){H&&H();let i=m.decodeAudio;m.decodeAudio=function(_,b){_=i(_),b(_)};let s=m.decodeFont;m.decodeFont=function(_,b){_=s(_),b(_)};const u=m.FileAssetLoader;m.ptrToAsset=_=>{let b=m.ptrToFileAsset(_);return b.isImage?m.ptrToImageAsset(_):b.isFont?m.ptrToFontAsset(_):b.isAudio?m.ptrToAudioAsset(_):b},m.CustomFileAssetLoader=u.extend("CustomFileAssetLoader",{__construct:function({loadContents:_}){this.__parent.__construct.call(this),this.Gb=_},loadContents:function(_,b){return _=m.ptrToAsset(_),this.Gb(_,b)}}),m.CDNFileAssetLoader=u.extend("CDNFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this)},loadContents:function(_){let b=m.ptrToAsset(_);return _=b.cdnUuid,_===""?!1:((function(A,R){var M=new XMLHttpRequest;M.responseType="arraybuffer",M.onreadystatechange=function(){M.readyState==4&&M.status==200&&R(M)},M.open("GET",A,!0),M.send(null)})(b.cdnBaseUrl+"/"+_,A=>{b.decode(new Uint8Array(A.response))}),!0)}}),m.FallbackFileAssetLoader=u.extend("FallbackFileAssetLoader",{__construct:function(){this.__parent.__construct.call(this),this.lb=[]},addLoader:function(_){this.lb.push(_)},loadContents:function(_,b){for(let A of this.lb)if(A.loadContents(_,b))return!0;return!1}});let f=m.computeAlignment;m.computeAlignment=function(_,b,A,R,M=1){return f.call(this,_,b,A,R,M)}};const N="createConicGradient createImageData createLinearGradient createPattern createRadialGradient getContextAttributes getImageData getLineDash getTransform isContextLost isPointInPath isPointInStroke measureText".split(" "),G=new function(){function i(){if(!s){let _e=function(ke,J,ze){if(J=U.createShader(J),U.shaderSource(J,ze),U.compileShader(J),ze=U.getShaderInfoLog(J),0<(ze||"").length)throw ze;U.attachShader(ke,J)};var S=document.createElement("canvas"),B={alpha:1,depth:0,stencil:0,antialias:0,premultipliedAlpha:1,preserveDrawingBuffer:0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:0,enableExtensionsByDefault:1,explicitSwapControl:1,renderViaOffscreenBackBuffer:1};let U;if(/iPhone|iPad|iPod/i.test(navigator.userAgent)){if(U=S.getContext("webgl",B),u=1,!U)return console.log("No WebGL support. Image mesh will not be drawn."),!1}else if(U=S.getContext("webgl2",B))u=2;else if(U=S.getContext("webgl",B))u=1;else return console.log("No WebGL support. Image mesh will not be drawn."),!1;if(U=new Proxy(U,{get(ke,J){if(ke.isContextLost()){if(M||(console.error("Cannot render the mesh because the GL Context was lost. Tried to invoke ",J),M=!0),typeof ke[J]=="function")return function(){}}else return typeof ke[J]=="function"?function(...ze){return ke[J].apply(ke,ze)}:ke[J]},set(ke,J,ze){if(ke.isContextLost())M||(console.error("Cannot render the mesh because the GL Context was lost. Tried to set property "+J),M=!0);else return ke[J]=ze,!0}}),f=Math.min(U.getParameter(U.MAX_RENDERBUFFER_SIZE),U.getParameter(U.MAX_TEXTURE_SIZE)),S=U.createProgram(),_e(S,U.VERTEX_SHADER,`attribute vec2 vertex;
                attribute vec2 uv;
                uniform vec4 mat;
                uniform vec2 translate;
                varying vec2 st;
                void main() {
                    st = uv;
                    gl_Position = vec4(mat2(mat) * vertex + translate, 0, 1);
                }`),_e(S,U.FRAGMENT_SHADER,`precision highp float;
                uniform sampler2D image;
                varying vec2 st;
                void main() {
                    gl_FragColor = texture2D(image, st);
                }`),U.bindAttribLocation(S,0,"vertex"),U.bindAttribLocation(S,1,"uv"),U.linkProgram(S),B=U.getProgramInfoLog(S),0<(B||"").trim().length)throw B;_=U.getUniformLocation(S,"mat"),b=U.getUniformLocation(S,"translate"),U.useProgram(S),U.bindBuffer(U.ARRAY_BUFFER,U.createBuffer()),U.enableVertexAttribArray(0),U.enableVertexAttribArray(1),U.bindBuffer(U.ELEMENT_ARRAY_BUFFER,U.createBuffer()),U.uniform1i(U.getUniformLocation(S,"image"),0),U.pixelStorei(U.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),s=U}return!0}let s=null,u=0,f=0,_=null,b=null,A=0,R=0,M=!1;i(),this.hc=function(){return i(),f},this.Mb=function(S){s.deleteTexture&&s.deleteTexture(S)},this.Lb=function(S){if(!i())return null;const B=s.createTexture();return B?(s.bindTexture(s.TEXTURE_2D,B),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,S),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),u==2?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.generateMipmap(s.TEXTURE_2D)):s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),B):null};const P=new q(8),W=new q(8),V=new q(10),ee=new q(10);this.Qb=function(S,B,U,_e,ke){if(i()){var J=P.push(S),ze=W.push(B);if(s.canvas){(s.canvas.width!=J||s.canvas.height!=ze)&&(s.canvas.width=J,s.canvas.height=ze),s.viewport(0,ze-B,S,B),s.disable(s.SCISSOR_TEST),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT),s.enable(s.SCISSOR_TEST),U.sort((Oe,yn)=>yn.xb-Oe.xb),J=V.push(_e),A!=J&&(s.bufferData(s.ARRAY_BUFFER,8*J,s.DYNAMIC_DRAW),A=J),J=0;for(var pt of U)s.bufferSubData(s.ARRAY_BUFFER,J,pt.Ua),J+=4*pt.Ua.length;console.assert(J==4*_e);for(var _n of U)s.bufferSubData(s.ARRAY_BUFFER,J,_n.Db),J+=4*_n.Db.length;console.assert(J==8*_e),J=ee.push(ke),R!=J&&(s.bufferData(s.ELEMENT_ARRAY_BUFFER,2*J,s.DYNAMIC_DRAW),R=J),pt=0;for(var ir of U)s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,pt,ir.indices),pt+=2*ir.indices.length;console.assert(pt==2*ke),ir=0,_n=!0,J=pt=0;for(const Oe of U){Oe.image.Ka!=ir&&(s.bindTexture(s.TEXTURE_2D,Oe.image.Ja||null),ir=Oe.image.Ka),Oe.mc?(s.scissor(Oe.Za,ze-Oe.$a-Oe.kb,Oe.Ac,Oe.kb),_n=!0):_n&&(s.scissor(0,ze-B,S,B),_n=!1),U=2/S;const yn=-2/B;s.uniform4f(_,Oe.ha[0]*U*Oe.Ba,Oe.ha[1]*yn*Oe.Ca,Oe.ha[2]*U*Oe.Ba,Oe.ha[3]*yn*Oe.Ca),s.uniform2f(b,Oe.ha[4]*U*Oe.Ba+U*(Oe.Za-Oe.ic*Oe.Ba)-1,Oe.ha[5]*yn*Oe.Ca+yn*(Oe.$a-Oe.jc*Oe.Ca)+1),s.vertexAttribPointer(0,2,s.FLOAT,!1,0,J),s.vertexAttribPointer(1,2,s.FLOAT,!1,0,J+4*_e),s.drawElements(s.TRIANGLES,Oe.indices.length,s.UNSIGNED_SHORT,pt),J+=4*Oe.Ua.length,pt+=2*Oe.indices.length}console.assert(J==4*_e),console.assert(pt==2*ke)}}},this.canvas=function(){return i()&&s.canvas}},K=m.onRuntimeInitialized;m.onRuntimeInitialized=function(){function i(D){switch(D){case P.srcOver:return"source-over";case P.screen:return"screen";case P.overlay:return"overlay";case P.darken:return"darken";case P.lighten:return"lighten";case P.colorDodge:return"color-dodge";case P.colorBurn:return"color-burn";case P.hardLight:return"hard-light";case P.softLight:return"soft-light";case P.difference:return"difference";case P.exclusion:return"exclusion";case P.multiply:return"multiply";case P.hue:return"hue";case P.saturation:return"saturation";case P.color:return"color";case P.luminosity:return"luminosity"}}function s(D){return"rgba("+((16711680&D)>>>16)+","+((65280&D)>>>8)+","+((255&D)>>>0)+","+((4278190080&D)>>>24)/255+")"}function u(){0<ze.length&&(G.Qb(J.drawWidth(),J.drawHeight(),ze,pt,_n),ze=[],_n=pt=0,J.reset(512,512));for(const D of ke){for(const Q of D.H)Q();D.H=[]}ke.clear()}K&&K();var f=m.RenderPaintStyle;const _=m.RenderPath,b=m.RenderPaint,A=m.Renderer,R=m.StrokeCap,M=m.StrokeJoin,P=m.BlendMode,W=f.fill,V=f.stroke,ee=m.FillRule.evenOdd;let S=1;var B=m.RenderImage.extend("CanvasRenderImage",{__construct:function({la:D,xa:Q}={}){this.__parent.__construct.call(this),this.Ka=S,S=S+1&2147483647||1,this.la=D,this.xa=Q},__destruct:function(){this.Ja&&(G.Mb(this.Ja),URL.revokeObjectURL(this.Xa)),this.__parent.__destruct.call(this)},decode:function(D){var Q=this;Q.xa&&Q.xa(Q);var Ie=new Image;Q.Xa=URL.createObjectURL(new Blob([D],{type:"image/png"})),Ie.onload=function(){Q.Fb=Ie,Q.Ja=G.Lb(Ie),Q.size(Ie.width,Ie.height),Q.la&&Q.la(Q)},Ie.src=Q.Xa}}),U=_.extend("CanvasRenderPath",{__construct:function(){this.__parent.__construct.call(this),this.T=new Path2D},rewind:function(){this.T=new Path2D},addPath:function(D,Q,Ie,xe,ye,je,Fe){var Ue=this.T,rn=Ue.addPath;D=D.T;const ut=new DOMMatrix;ut.a=Q,ut.b=Ie,ut.c=xe,ut.d=ye,ut.e=je,ut.f=Fe,rn.call(Ue,D,ut)},fillRule:function(D){this.Wa=D},moveTo:function(D,Q){this.T.moveTo(D,Q)},lineTo:function(D,Q){this.T.lineTo(D,Q)},cubicTo:function(D,Q,Ie,xe,ye,je){this.T.bezierCurveTo(D,Q,Ie,xe,ye,je)},close:function(){this.T.closePath()}}),_e=b.extend("CanvasRenderPaint",{color:function(D){this.Ya=s(D)},thickness:function(D){this.Ib=D},join:function(D){switch(D){case M.miter:this.Ia="miter";break;case M.round:this.Ia="round";break;case M.bevel:this.Ia="bevel"}},cap:function(D){switch(D){case R.butt:this.Ha="butt";break;case R.round:this.Ha="round";break;case R.square:this.Ha="square"}},style:function(D){this.Hb=D},blendMode:function(D){this.Eb=i(D)},clearGradient:function(){this.ja=null},linearGradient:function(D,Q,Ie,xe){this.ja={zb:D,Ab:Q,cb:Ie,eb:xe,Ra:[]}},radialGradient:function(D,Q,Ie,xe){this.ja={zb:D,Ab:Q,cb:Ie,eb:xe,Ra:[],ec:!0}},addStop:function(D,Q){this.ja.Ra.push({color:D,stop:Q})},completeGradient:function(){},draw:function(D,Q,Ie){let xe=this.Hb;var ye=this.Ya,je=this.ja;if(D.globalCompositeOperation=this.Eb,je!=null){ye=je.zb;var Fe=je.Ab;const rn=je.cb;var Ue=je.eb;const ut=je.Ra;je.ec?(je=rn-ye,Ue-=Fe,ye=D.createRadialGradient(ye,Fe,0,ye,Fe,Math.sqrt(je*je+Ue*Ue))):ye=D.createLinearGradient(ye,Fe,rn,Ue);for(let Gt=0,ct=ut.length;Gt<ct;Gt++)Fe=ut[Gt],ye.addColorStop(Fe.stop,s(Fe.color));this.Ya=ye,this.ja=null}switch(xe){case V:D.strokeStyle=ye,D.lineWidth=this.Ib,D.lineCap=this.Ha,D.lineJoin=this.Ia,D.stroke(Q);break;case W:D.fillStyle=ye,D.fill(Q,Ie)}}});const ke=new Set;let J=null,ze=[],pt=0,_n=0;var ir=m.CanvasRenderer=A.extend("Renderer",{__construct:function(D){this.__parent.__construct.call(this),this.S=[1,0,0,1,0,0],this.C=D.getContext("2d"),this.Va=D,this.H=[]},save:function(){this.S.push(...this.S.slice(this.S.length-6)),this.H.push(this.C.save.bind(this.C))},restore:function(){const D=this.S.length-6;if(6>D)throw"restore() called without matching save().";this.S.splice(D),this.H.push(this.C.restore.bind(this.C))},transform:function(D,Q,Ie,xe,ye,je){const Fe=this.S,Ue=Fe.length-6;Fe.splice(Ue,6,Fe[Ue]*D+Fe[Ue+2]*Q,Fe[Ue+1]*D+Fe[Ue+3]*Q,Fe[Ue]*Ie+Fe[Ue+2]*xe,Fe[Ue+1]*Ie+Fe[Ue+3]*xe,Fe[Ue]*ye+Fe[Ue+2]*je+Fe[Ue+4],Fe[Ue+1]*ye+Fe[Ue+3]*je+Fe[Ue+5]),this.H.push(this.C.transform.bind(this.C,D,Q,Ie,xe,ye,je))},rotate:function(D){const Q=Math.sin(D);D=Math.cos(D),this.transform(D,Q,-Q,D,0,0)},_drawPath:function(D,Q){this.H.push(Q.draw.bind(Q,this.C,D.T,D.Wa===ee?"evenodd":"nonzero"))},_drawRiveImage:function(D,Q,Ie,xe){var ye=D.Fb;if(ye){var je=this.C,Fe=i(Ie);this.H.push(function(){je.globalCompositeOperation=Fe,je.globalAlpha=xe,je.drawImage(ye,0,0),je.globalAlpha=1})}},_getMatrix:function(D){const Q=this.S,Ie=Q.length-6;for(let xe=0;6>xe;++xe)D[xe]=Q[Ie+xe]},_drawImageMesh:function(D,Q,Ie,xe,ye,je,Fe,Ue,rn,ut,Gt){Q=this.C.canvas.width;var ct=this.C.canvas.height;const ha=ut-Ue,da=Gt-rn;Ue=Math.max(Ue,0),rn=Math.max(rn,0),ut=Math.min(ut,Q),Gt=Math.min(Gt,ct);const li=ut-Ue,ui=Gt-rn;if(console.assert(li<=Math.min(ha,Q)),console.assert(ui<=Math.min(da,ct)),!(0>=li||0>=ui)){ut=li<ha||ui<da,Q=Gt=1;var sr=Math.ceil(li*Gt),or=Math.ceil(ui*Q);ct=G.hc(),sr>ct&&(Gt*=ct/sr,sr=ct),or>ct&&(Q*=ct/or,or=ct),J||(J=new m.DynamicRectanizer(ct),J.reset(512,512)),ct=J.addRect(sr,or),0>ct&&(u(),ke.add(this),ct=J.addRect(sr,or),console.assert(0<=ct));var fa=ct&65535,va=ct>>16;ze.push({ha:this.S.slice(this.S.length-6),image:D,Za:fa,$a:va,ic:Ue,jc:rn,Ac:sr,kb:or,Ba:Gt,Ca:Q,Ua:new Float32Array(ye),Db:new Float32Array(je),indices:new Uint16Array(Fe),mc:ut,xb:D.Ka<<1|(ut?1:0)}),pt+=ye.length,_n+=Fe.length;var Sr=this.C,xu=i(Ie);this.H.push(function(){Sr.save(),Sr.resetTransform(),Sr.globalCompositeOperation=xu,Sr.globalAlpha=xe;const pa=G.canvas();pa&&Sr.drawImage(pa,fa,va,sr,or,Ue,rn,li,ui),Sr.restore()})}},_clipPath:function(D){this.H.push(this.C.clip.bind(this.C,D.T,D.Wa===ee?"evenodd":"nonzero"))},clear:function(){ke.add(this),this.H.push(this.C.clearRect.bind(this.C,0,0,this.Va.width,this.Va.height))},flush:function(){},translate:function(D,Q){this.transform(1,0,0,1,D,Q)}});m.makeRenderer=function(D){const Q=new ir(D),Ie=Q.C;return new Proxy(Q,{get(xe,ye){if(typeof xe[ye]=="function")return function(...je){return xe[ye].apply(xe,je)};if(typeof Ie[ye]=="function"){if(-1<N.indexOf(ye))throw Error("RiveException: Method call to '"+ye+"()' is not allowed, as the renderer cannot immediately pass through the return                 values of any canvas 2d context methods.");return function(...je){Q.H.push(Ie[ye].bind(Ie,...je))}}return xe[ye]},set(xe,ye,je){if(ye in Ie)return Q.H.push(()=>{Ie[ye]=je}),!0}})},m.decodeImage=function(D,Q){new B({la:Q}).decode(D)},m.renderFactory={makeRenderPaint:function(){return new _e},makeRenderPath:function(){return new U},makeRenderImage:function(){let D=yn;return new B({xa:()=>{D.total++},la:()=>{if(D.loaded++,D.loaded===D.total){const Q=D.ready;Q&&(Q(),D.ready=null)}}})}};let Oe=m.load,yn=null;m.load=function(D,Q,Ie=!0){const xe=new m.FallbackFileAssetLoader;return Q!==void 0&&xe.addLoader(Q),Ie&&(Q=new m.CDNFileAssetLoader,xe.addLoader(Q)),new Promise(function(ye){let je=null;yn={total:0,loaded:0,ready:function(){ye(je)}},je=Oe(D,xe),yn.total==0&&ye(je)})};let Ou=m.RendererWrapper.prototype.align;m.RendererWrapper.prototype.align=function(D,Q,Ie,xe,ye=1){Ou.call(this,D,Q,Ie,xe,ye)},f=new O,m.requestAnimationFrame=f.requestAnimationFrame.bind(f),m.cancelAnimationFrame=f.cancelAnimationFrame.bind(f),m.enableFPSCounter=f.Rb.bind(f),m.disableFPSCounter=f.Ob,f.pb=u,m.resolveAnimationFrame=u,m.cleanup=function(){J&&J.delete()}};var j=Object.assign({},m),L="./this.program",ie=typeof window=="object",ue=typeof importScripts=="function",ae="",X,he;(ie||ue)&&(ue?ae=self.location.href:typeof document<"u"&&document.currentScript&&(ae=document.currentScript.src),k&&(ae=k),ae.indexOf("blob:")!==0?ae=ae.substr(0,ae.replace(/[?#].*/,"").lastIndexOf("/")+1):ae="",ue&&(he=i=>{var s=new XMLHttpRequest;return s.open("GET",i,!1),s.responseType="arraybuffer",s.send(null),new Uint8Array(s.response)}),X=(i,s,u)=>{var f=new XMLHttpRequest;f.open("GET",i,!0),f.responseType="arraybuffer",f.onload=()=>{f.status==200||f.status==0&&f.response?s(f.response):u()},f.onerror=u,f.send(null)});var Ne=m.print||console.log.bind(console),Ke=m.printErr||console.error.bind(console);Object.assign(m,j),j=null,m.thisProgram&&(L=m.thisProgram);var Ve;m.wasmBinary&&(Ve=m.wasmBinary),m.noExitRuntime,typeof WebAssembly!="object"&&hn("no native wasm support detected");var gt,Ee,un=!1,tt,qe,nt,Pt,Se,Pe,Lt,De;function kt(){var i=gt.buffer;m.HEAP8=tt=new Int8Array(i),m.HEAP16=nt=new Int16Array(i),m.HEAP32=Se=new Int32Array(i),m.HEAPU8=qe=new Uint8Array(i),m.HEAPU16=Pt=new Uint16Array(i),m.HEAPU32=Pe=new Uint32Array(i),m.HEAPF32=Lt=new Float32Array(i),m.HEAPF64=De=new Float64Array(i)}var Ye,Wt=[],cn=[],Xt=[];function Tn(){var i=m.preRun.shift();Wt.unshift(i)}var mt=0,Rt=null;function hn(i){throw m.onAbort&&m.onAbort(i),i="Aborted("+i+")",Ke(i),un=!0,i=new WebAssembly.RuntimeError(i+". Build with -sASSERTIONS for more info."),$(i),i}function Xn(i){return i.startsWith("data:application/octet-stream;base64,")}var Qt;if(Qt="canvas_advanced.wasm",!Xn(Qt)){var yr=Qt;Qt=m.locateFile?m.locateFile(yr,ae):ae+yr}function Et(i){if(i==Qt&&Ve)return new Uint8Array(Ve);if(he)return he(i);throw"both async and sync fetching of the wasm failed"}function Y(i){if(!Ve&&(ie||ue)){if(typeof fetch=="function"&&!i.startsWith("file://"))return fetch(i,{credentials:"same-origin"}).then(s=>{if(!s.ok)throw"failed to load wasm binary file at '"+i+"'";return s.arrayBuffer()}).catch(()=>Et(i));if(X)return new Promise((s,u)=>{X(i,f=>s(new Uint8Array(f)),u)})}return Promise.resolve().then(()=>Et(i))}function se(i,s,u){return Y(i).then(f=>WebAssembly.instantiate(f,s)).then(f=>f).then(u,f=>{Ke("failed to asynchronously prepare wasm: "+f),hn(f)})}function ve(i,s){var u=Qt;return Ve||typeof WebAssembly.instantiateStreaming!="function"||Xn(u)||u.startsWith("file://")||typeof fetch!="function"?se(u,i,s):fetch(u,{credentials:"same-origin"}).then(f=>WebAssembly.instantiateStreaming(f,i).then(s,function(_){return Ke("wasm streaming compile failed: "+_),Ke("falling back to ArrayBuffer instantiation"),se(u,i,s)}))}var Be,p,a={460492:(i,s,u,f,_)=>{if(typeof window>"u"||(window.AudioContext||window.webkitAudioContext)===void 0)return 0;if(typeof window.h>"u"){window.h={Aa:0},window.h.I={},window.h.I.ya=i,window.h.I.capture=s,window.h.I.La=u,window.h.ga={},window.h.ga.stopped=f,window.h.ga.yb=_;let b=window.h;b.D=[],b.yc=function(A){for(var R=0;R<b.D.length;++R)if(b.D[R]==null)return b.D[R]=A,R;return b.D.push(A),b.D.length-1},b.Cb=function(A){for(b.D[A]=null;0<b.D.length&&b.D[b.D.length-1]==null;)b.D.pop()},b.Sc=function(A){for(var R=0;R<b.D.length;++R)if(b.D[R]==A)return b.Cb(R)},b.ra=function(A){return b.D[A]},b.Ta=["touchend","click"],b.unlock=function(){for(var A=0;A<b.D.length;++A){var R=b.D[A];R!=null&&R.J!=null&&R.state===b.ga.yb&&R.J.resume().then(()=>{oa(R.qb)},M=>{console.error("Failed to resume audiocontext",M)})}b.Ta.map(function(M){document.removeEventListener(M,b.unlock,!0)})},b.Ta.map(function(A){document.addEventListener(A,b.unlock,!0)})}return window.h.Aa+=1,1},462670:()=>{typeof window.h<"u"&&(window.h.Ta.map(function(i){document.removeEventListener(i,window.h.unlock,!0)}),--window.h.Aa,window.h.Aa===0&&delete window.h)},462974:()=>navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!==void 0,463078:()=>{try{var i=new(window.AudioContext||window.webkitAudioContext),s=i.sampleRate;return i.close(),s}catch{return 0}},463249:(i,s,u,f,_,b)=>{if(typeof window.h>"u")return-1;var A={},R={};return i==window.h.I.ya&&u!=0&&(R.sampleRate=u),A.J=new(window.AudioContext||window.webkitAudioContext)(R),A.J.suspend(),A.state=window.h.ga.stopped,u=0,i!=window.h.I.ya&&(u=s),A.Z=A.J.createScriptProcessor(f,u,s),A.Z.onaudioprocess=function(M){if((A.sa==null||A.sa.length==0)&&(A.sa=new Float32Array(Lt.buffer,_,f*s)),i==window.h.I.capture||i==window.h.I.La){for(var P=0;P<s;P+=1)for(var W=M.inputBuffer.getChannelData(P),V=A.sa,ee=0;ee<f;ee+=1)V[ee*s+P]=W[ee];aa(b,f,_)}if(i==window.h.I.ya||i==window.h.I.La)for(la(b,f,_),P=0;P<M.outputBuffer.numberOfChannels;++P)for(W=M.outputBuffer.getChannelData(P),V=A.sa,ee=0;ee<f;ee+=1)W[ee]=V[ee*s+P];else for(P=0;P<M.outputBuffer.numberOfChannels;++P)M.outputBuffer.getChannelData(P).fill(0)},i!=window.h.I.capture&&i!=window.h.I.La||navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(M){A.Da=A.J.createMediaStreamSource(M),A.Da.connect(A.Z),A.Z.connect(A.J.destination)}).catch(function(M){console.log("Failed to get user media: "+M)}),i==window.h.I.ya&&A.Z.connect(A.J.destination),A.qb=b,window.h.yc(A)},466126:i=>window.h.ra(i).J.sampleRate,466199:i=>{i=window.h.ra(i),i.Z!==void 0&&(i.Z.onaudioprocess=function(){},i.Z.disconnect(),i.Z=void 0),i.Da!==void 0&&(i.Da.disconnect(),i.Da=void 0),i.J.close(),i.J=void 0,i.qb=void 0},466599:i=>{window.h.Cb(i)},466649:i=>{i=window.h.ra(i),i.J.resume(),i.state=window.h.ga.yb},466788:i=>{i=window.h.ra(i),i.J.suspend(),i.state=window.h.ga.stopped}},h=i=>{for(;0<i.length;)i.shift()(m)},w=(i,s)=>{for(var u=0,f=i.length-1;0<=f;f--){var _=i[f];_==="."?i.splice(f,1):_===".."?(i.splice(f,1),u++):u&&(i.splice(f,1),u--)}if(s)for(;u;u--)i.unshift("..");return i},C=i=>{var s=i.charAt(0)==="/",u=i.substr(-1)==="/";return(i=w(i.split("/").filter(f=>!!f),!s).join("/"))||s||(i="."),i&&u&&(i+="/"),(s?"/":"")+i},x=i=>{var s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(i).slice(1);return i=s[0],s=s[1],!i&&!s?".":(s&&(s=s.substr(0,s.length-1)),i+s)},F=i=>{if(i==="/")return"/";i=C(i),i=i.replace(/\/$/,"");var s=i.lastIndexOf("/");return s===-1?i:i.substr(s+1)},re=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return i=>crypto.getRandomValues(i);hn("initRandomDevice")},de=i=>(de=re())(i);function ne(){for(var i="",s=!1,u=arguments.length-1;-1<=u&&!s;u--){if(s=0<=u?arguments[u]:"/",typeof s!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!s)return"";i=s+"/"+i,s=s.charAt(0)==="/"}return i=w(i.split("/").filter(f=>!!f),!s).join("/"),(s?"/":"")+i||"."}var we=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Me=(i,s,u)=>{var f=s+u;for(u=s;i[u]&&!(u>=f);)++u;if(16<u-s&&i.buffer&&we)return we.decode(i.subarray(s,u));for(f="";s<u;){var _=i[s++];if(_&128){var b=i[s++]&63;if((_&224)==192)f+=String.fromCharCode((_&31)<<6|b);else{var A=i[s++]&63;_=(_&240)==224?(_&15)<<12|b<<6|A:(_&7)<<18|b<<12|A<<6|i[s++]&63,65536>_?f+=String.fromCharCode(_):(_-=65536,f+=String.fromCharCode(55296|_>>10,56320|_&1023))}}else f+=String.fromCharCode(_)}return f},rt=[],We=i=>{for(var s=0,u=0;u<i.length;++u){var f=i.charCodeAt(u);127>=f?s++:2047>=f?s+=2:55296<=f&&57343>=f?(s+=4,++u):s+=3}return s},At=(i,s,u,f)=>{if(!(0<f))return 0;var _=u;f=u+f-1;for(var b=0;b<i.length;++b){var A=i.charCodeAt(b);if(55296<=A&&57343>=A){var R=i.charCodeAt(++b);A=65536+((A&1023)<<10)|R&1023}if(127>=A){if(u>=f)break;s[u++]=A}else{if(2047>=A){if(u+1>=f)break;s[u++]=192|A>>6}else{if(65535>=A){if(u+2>=f)break;s[u++]=224|A>>12}else{if(u+3>=f)break;s[u++]=240|A>>18,s[u++]=128|A>>12&63}s[u++]=128|A>>6&63}s[u++]=128|A&63}}return s[u]=0,u-_};function St(i,s){var u=Array(We(i)+1);return i=At(i,u,0,u.length),s&&(u.length=i),u}var _t=[];function ft(i,s){_t[i]={input:[],F:[],V:s},Ht(i,Ct)}var Ct={open:function(i){var s=_t[i.node.za];if(!s)throw new Z(43);i.s=s,i.seekable=!1},close:function(i){i.s.V.qa(i.s)},qa:function(i){i.s.V.qa(i.s)},read:function(i,s,u,f){if(!i.s||!i.s.V.jb)throw new Z(60);for(var _=0,b=0;b<f;b++){try{var A=i.s.V.jb(i.s)}catch{throw new Z(29)}if(A===void 0&&_===0)throw new Z(6);if(A==null)break;_++,s[u+b]=A}return _&&(i.node.timestamp=Date.now()),_},write:function(i,s,u,f){if(!i.s||!i.s.V.Oa)throw new Z(60);try{for(var _=0;_<f;_++)i.s.V.Oa(i.s,s[u+_])}catch{throw new Z(29)}return f&&(i.node.timestamp=Date.now()),_}},dn={jb:function(){e:{if(!rt.length){var i=null;if(typeof window<"u"&&typeof window.prompt=="function"?(i=window.prompt("Input: "),i!==null&&(i+=`
`)):typeof readline=="function"&&(i=readline(),i!==null&&(i+=`
`)),!i){i=null;break e}rt=St(i,!0)}i=rt.shift()}return i},Oa:function(i,s){s===null||s===10?(Ne(Me(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(Ne(Me(i.F,0)),i.F=[])},bc:function(){return{Fc:25856,Hc:5,Ec:191,Gc:35387,Dc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},cc:function(){return 0},dc:function(){return[24,80]}},fn={Oa:function(i,s){s===null||s===10?(Ke(Me(i.F,0)),i.F=[]):s!=0&&i.F.push(s)},qa:function(i){i.F&&0<i.F.length&&(Ke(Me(i.F,0)),i.F=[])}};function $t(i,s){var u=i.j?i.j.length:0;u>=s||(s=Math.max(s,u*(1048576>u?2:1.125)>>>0),u!=0&&(s=Math.max(s,256)),u=i.j,i.j=new Uint8Array(s),0<i.v&&i.j.set(u.subarray(0,i.v),0))}var le={O:null,U(){return le.createNode(null,"/",16895,0)},createNode(i,s,u,f){if((u&61440)===24576||(u&61440)===4096)throw new Z(63);return le.O||(le.O={dir:{node:{Y:le.l.Y,P:le.l.P,ka:le.l.ka,va:le.l.va,vb:le.l.vb,Bb:le.l.Bb,wb:le.l.wb,tb:le.l.tb,Ea:le.l.Ea},stream:{ba:le.m.ba}},file:{node:{Y:le.l.Y,P:le.l.P},stream:{ba:le.m.ba,read:le.m.read,write:le.m.write,pa:le.m.pa,mb:le.m.mb,ob:le.m.ob}},link:{node:{Y:le.l.Y,P:le.l.P,ma:le.l.ma},stream:{}},ab:{node:{Y:le.l.Y,P:le.l.P},stream:qt}}),u=Mi(i,s,u,f),(u.mode&61440)===16384?(u.l=le.O.dir.node,u.m=le.O.dir.stream,u.j={}):(u.mode&61440)===32768?(u.l=le.O.file.node,u.m=le.O.file.stream,u.v=0,u.j=null):(u.mode&61440)===40960?(u.l=le.O.link.node,u.m=le.O.link.stream):(u.mode&61440)===8192&&(u.l=le.O.ab.node,u.m=le.O.ab.stream),u.timestamp=Date.now(),i&&(i.j[s]=u,i.timestamp=u.timestamp),u},Kc(i){return i.j?i.j.subarray?i.j.subarray(0,i.v):new Uint8Array(i.j):new Uint8Array(0)},l:{Y(i){var s={};return s.Jc=(i.mode&61440)===8192?i.id:1,s.Mc=i.id,s.mode=i.mode,s.Oc=1,s.uid=0,s.Lc=0,s.za=i.za,(i.mode&61440)===16384?s.size=4096:(i.mode&61440)===32768?s.size=i.v:(i.mode&61440)===40960?s.size=i.link.length:s.size=0,s.Bc=new Date(i.timestamp),s.Nc=new Date(i.timestamp),s.Ic=new Date(i.timestamp),s.Jb=4096,s.Cc=Math.ceil(s.size/s.Jb),s},P(i,s){if(s.mode!==void 0&&(i.mode=s.mode),s.timestamp!==void 0&&(i.timestamp=s.timestamp),s.size!==void 0&&(s=s.size,i.v!=s))if(s==0)i.j=null,i.v=0;else{var u=i.j;i.j=new Uint8Array(s),u&&i.j.set(u.subarray(0,Math.min(s,i.v))),i.v=s}},ka(){throw ei[44]},va(i,s,u,f){return le.createNode(i,s,u,f)},vb(i,s,u){if((i.mode&61440)===16384){try{var f=wr(s,u)}catch{}if(f)for(var _ in f.j)throw new Z(55)}delete i.parent.j[i.name],i.parent.timestamp=Date.now(),i.name=u,s.j[u]=i,s.timestamp=i.parent.timestamp,i.parent=s},Bb(i,s){delete i.j[s],i.timestamp=Date.now()},wb(i,s){var u=wr(i,s),f;for(f in u.j)throw new Z(55);delete i.j[s],i.timestamp=Date.now()},tb(i){var s=[".",".."],u;for(u in i.j)i.j.hasOwnProperty(u)&&s.push(u);return s},Ea(i,s,u){return i=le.createNode(i,s,41471,0),i.link=u,i},ma(i){if((i.mode&61440)!==40960)throw new Z(28);return i.link}},m:{read(i,s,u,f,_){var b=i.node.j;if(_>=i.node.v)return 0;if(i=Math.min(i.node.v-_,f),8<i&&b.subarray)s.set(b.subarray(_,_+i),u);else for(f=0;f<i;f++)s[u+f]=b[_+f];return i},write(i,s,u,f,_,b){if(s.buffer===tt.buffer&&(b=!1),!f)return 0;if(i=i.node,i.timestamp=Date.now(),s.subarray&&(!i.j||i.j.subarray)){if(b)return i.j=s.subarray(u,u+f),i.v=f;if(i.v===0&&_===0)return i.j=s.slice(u,u+f),i.v=f;if(_+f<=i.v)return i.j.set(s.subarray(u,u+f),_),f}if($t(i,_+f),i.j.subarray&&s.subarray)i.j.set(s.subarray(u,u+f),_);else for(b=0;b<f;b++)i.j[_+b]=s[u+b];return i.v=Math.max(i.v,_+f),f},ba(i,s,u){if(u===1?s+=i.position:u===2&&(i.node.mode&61440)===32768&&(s+=i.node.v),0>s)throw new Z(28);return s},pa(i,s,u){$t(i.node,s+u),i.node.v=Math.max(i.node.v,s+u)},mb(i,s,u,f,_){if((i.node.mode&61440)!==32768)throw new Z(43);if(i=i.node.j,_&2||i.buffer!==tt.buffer){if((0<u||u+s<i.length)&&(i.subarray?i=i.subarray(u,u+s):i=Array.prototype.slice.call(i,u,u+s)),u=!0,hn(),s=void 0,!s)throw new Z(48);tt.set(i,s)}else u=!1,s=i.byteOffset;return{o:s,M:u}},ob(i,s,u,f){return le.m.write(i,s,0,f,u,!1),0}}};function Ce(i,s){var u=0;return i&&(u|=365),s&&(u|=146),u}var Vt=null,Zr={},Qn=[],Ri=1,Zn=null,ji=!0,Z=null,ei={},In=(i,s={})=>{if(i=ne(i),!i)return{path:"",node:null};if(s=Object.assign({hb:!0,Qa:0},s),8<s.Qa)throw new Z(32);i=i.split("/").filter(A=>!!A);for(var u=Vt,f="/",_=0;_<i.length;_++){var b=_===i.length-1;if(b&&s.parent)break;if(u=wr(u,i[_]),f=C(f+"/"+i[_]),u.wa&&(!b||b&&s.hb)&&(u=u.wa.root),!b||s.gb){for(b=0;(u.mode&61440)===40960;)if(u=br(f),f=ne(x(f),u),u=In(f,{Qa:s.Qa+1}).node,40<b++)throw new Z(32)}}return{path:f,node:u}},Oi=i=>{for(var s;;){if(i===i.parent)return i=i.U.nb,s?i[i.length-1]!=="/"?`${i}/${s}`:i+s:i;s=s?`${i.name}/${s}`:i.name,i=i.parent}},xi=(i,s)=>{for(var u=0,f=0;f<s.length;f++)u=(u<<5)-u+s.charCodeAt(f)|0;return(i+u>>>0)%Zn.length},wr=(i,s)=>{var u;if(u=(u=oe(i,"x"))?u:i.l.ka?0:2)throw new Z(u,i);for(u=Zn[xi(i.id,s)];u;u=u.lc){var f=u.name;if(u.parent.id===i.id&&f===s)return u}return i.l.ka(i,s)},Mi=(i,s,u,f)=>(i=new na(i,s,u,f),s=xi(i.parent.id,i.name),i.lc=Zn[s],Zn[s]=i),be=i=>{var s=["r","w","rw"][i&3];return i&512&&(s+="w"),s},oe=(i,s)=>{if(ji)return 0;if(!s.includes("r")||i.mode&292){if(s.includes("w")&&!(i.mode&146)||s.includes("x")&&!(i.mode&73))return 2}else return 2;return 0},me=(i,s)=>{try{return wr(i,s),20}catch{}return oe(i,"wx")},Qe=()=>{for(var i=0;4096>=i;i++)if(!Qn[i])return i;throw new Z(33)},Re=i=>{if(i=Qn[i],!i)throw new Z(8);return i},vt=(i,s=-1)=>(tr||(tr=function(){this.h={}},tr.prototype={},Object.defineProperties(tr.prototype,{object:{get(){return this.node},set(u){this.node=u}},flags:{get(){return this.h.flags},set(u){this.h.flags=u}},position:{get(){return this.h.position},set(u){this.h.position=u}}})),i=Object.assign(new tr,i),s==-1&&(s=Qe()),i.X=s,Qn[s]=i),qt={open:i=>{i.m=Zr[i.node.za].m,i.m.open&&i.m.open(i)},ba:()=>{throw new Z(70)}},Ht=(i,s)=>{Zr[i]={m:s}},jt=(i,s)=>{var u=s==="/",f=!s;if(u&&Vt)throw new Z(10);if(!u&&!f){var _=In(s,{hb:!1});if(s=_.path,_=_.node,_.wa)throw new Z(10);if((_.mode&61440)!==16384)throw new Z(54)}s={type:i,Qc:{},nb:s,kc:[]},i=i.U(s),i.U=s,s.root=i,u?Vt=i:_&&(_.wa=s,_.U&&_.U.kc.push(s))},ot=(i,s,u)=>{var f=In(i,{parent:!0}).node;if(i=F(i),!i||i==="."||i==="..")throw new Z(28);var _=me(f,i);if(_)throw new Z(_);if(!f.l.va)throw new Z(63);return f.l.va(f,i,s,u)},Ft=(i,s,u)=>{typeof u>"u"&&(u=s,s=438),ot(i,s|8192,u)},vn=(i,s)=>{if(!ne(i))throw new Z(44);var u=In(s,{parent:!0}).node;if(!u)throw new Z(44);s=F(s);var f=me(u,s);if(f)throw new Z(f);if(!u.l.Ea)throw new Z(63);u.l.Ea(u,s,i)},br=i=>{if(i=In(i).node,!i)throw new Z(44);if(!i.l.ma)throw new Z(28);return ne(Oi(i.parent),i.l.ma(i))},pn=(i,s,u)=>{if(i==="")throw new Z(44);if(typeof s=="string"){var f={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[s];if(typeof f>"u")throw Error(`Unknown file open mode: ${s}`);s=f}if(u=s&64?(typeof u>"u"?438:u)&4095|32768:0,typeof i=="object")var _=i;else{i=C(i);try{_=In(i,{gb:!(s&131072)}).node}catch{}}if(f=!1,s&64)if(_){if(s&128)throw new Z(20)}else _=ot(i,u,0),f=!0;if(!_)throw new Z(44);if((_.mode&61440)===8192&&(s&=-513),s&65536&&(_.mode&61440)!==16384)throw new Z(54);if(!f&&(u=_?(_.mode&61440)===40960?32:(_.mode&61440)===16384&&(be(s)!=="r"||s&512)?31:oe(_,be(s)):44))throw new Z(u);if(s&512&&!f){if(u=_,u=typeof u=="string"?In(u,{gb:!0}).node:u,!u.l.P)throw new Z(63);if((u.mode&61440)===16384)throw new Z(31);if((u.mode&61440)!==32768)throw new Z(28);if(f=oe(u,"w"))throw new Z(f);u.l.P(u,{size:0,timestamp:Date.now()})}return s&=-131713,_=vt({node:_,path:Oi(_),flags:s,seekable:!0,position:0,m:_.m,zc:[],error:!1}),_.m.open&&_.m.open(_),!m.logReadFiles||s&1||(kr||(kr={}),i in kr||(kr[i]=1)),_},er=(i,s,u)=>{if(i.X===null)throw new Z(8);if(!i.seekable||!i.m.ba)throw new Z(70);if(u!=0&&u!=1&&u!=2)throw new Z(28);i.position=i.m.ba(i,s,u),i.zc=[]},Li=()=>{Z||(Z=function(i,s){this.name="ErrnoError",this.node=s,this.pc=function(u){this.aa=u},this.pc(i),this.message="FS error"},Z.prototype=Error(),Z.prototype.constructor=Z,[44].forEach(i=>{ei[i]=new Z(i),ei[i].stack="<generic error, no stack>"}))},ti,Pn=(i,s,u)=>{i=C("/dev/"+i);var f=Ce(!!s,!!u);ni||(ni=64);var _=ni++<<8|0;Ht(_,{open:b=>{b.seekable=!1},close:()=>{u&&u.buffer&&u.buffer.length&&u(10)},read:(b,A,R,M)=>{for(var P=0,W=0;W<M;W++){try{var V=s()}catch{throw new Z(29)}if(V===void 0&&P===0)throw new Z(6);if(V==null)break;P++,A[R+W]=V}return P&&(b.node.timestamp=Date.now()),P},write:(b,A,R,M)=>{for(var P=0;P<M;P++)try{u(A[R+P])}catch{throw new Z(29)}return M&&(b.node.timestamp=Date.now()),P}}),Ft(i,f,_)},ni,gn={},tr,kr,nr=void 0;function Zt(){return nr+=4,Se[nr-4>>2]}function Ot(i){if(i===void 0)return"_unknown";i=i.replace(/[^a-zA-Z0-9_]/g,"$");var s=i.charCodeAt(0);return 48<=s&&57>=s?`_${i}`:i}function zt(i,s){return i=Ot(i),{[i]:function(){return s.apply(this,arguments)}}[i]}function Rn(){this.M=[void 0],this.ib=[]}var yt=new Rn,en=void 0;function pe(i){throw new en(i)}var tn=i=>(i||pe("Cannot use deleted val. handle = "+i),yt.get(i).value),nn=i=>{switch(i){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:return yt.pa({ub:1,value:i})}};function Uo(i){var s=Error,u=zt(i,function(f){this.name=i,this.message=f,f=Error(f).stack,f!==void 0&&(this.stack=this.toString()+`
`+f.replace(/^Error(:[^\n]*)?\n/,""))});return u.prototype=Object.create(s.prototype),u.prototype.constructor=u,u.prototype.toString=function(){return this.message===void 0?this.name:`${this.name}: ${this.message}`},u}var No=void 0,Bo=void 0;function Ze(i){for(var s="";qe[i];)s+=Bo[qe[i++]];return s}var ri=[];function Is(){for(;ri.length;){var i=ri.pop();i.g.fa=!1,i.delete()}}var ii=void 0,jn={};function Ps(i,s){for(s===void 0&&pe("ptr should not be undefined");i.A;)s=i.na(s),i=i.A;return s}var rr={};function Wo(i){i=ua(i);var s=Ze(i);return Mn(i),s}function si(i,s){var u=rr[i];return u===void 0&&pe(s+" has unknown type "+Wo(i)),u}function $i(){}var Rs=!1;function Vo(i){--i.count.value,i.count.value===0&&(i.G?i.L.W(i.G):i.u.i.W(i.o))}function qo(i,s,u){return s===u?i:u.A===void 0?null:(i=qo(i,s,u.A),i===null?null:u.Pb(i))}var Ho={};function du(i,s){return s=Ps(i,s),jn[s]}var zo=void 0;function Fi(i){throw new zo(i)}function Di(i,s){return s.u&&s.o||Fi("makeClassHandle requires ptr and ptrType"),!!s.L!=!!s.G&&Fi("Both smartPtrType and smartPtr must be specified"),s.count={value:1},Er(Object.create(i,{g:{value:s}}))}function Er(i){return typeof FinalizationRegistry>"u"?(Er=s=>s,i):(Rs=new FinalizationRegistry(s=>{Vo(s.g)}),Er=s=>{var u=s.g;return u.G&&Rs.register(s,{g:u},s),s},$i=s=>{Rs.unregister(s)},Er(i))}var Ui={};function oi(i){for(;i.length;){var s=i.pop();i.pop()(s)}}function ai(i){return this.fromWireType(Se[i>>2])}var Ar={},Ni={};function Dt(i,s,u){function f(R){R=u(R),R.length!==i.length&&Fi("Mismatched type converter count");for(var M=0;M<i.length;++M)mn(i[M],R[M])}i.forEach(function(R){Ni[R]=s});var _=Array(s.length),b=[],A=0;s.forEach((R,M)=>{rr.hasOwnProperty(R)?_[M]=rr[R]:(b.push(R),Ar.hasOwnProperty(R)||(Ar[R]=[]),Ar[R].push(()=>{_[M]=rr[R],++A,A===b.length&&f(_)}))}),b.length===0&&f(_)}function Bi(i){switch(i){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError(`Unknown type size: ${i}`)}}function fu(i,s,u={}){var f=s.name;if(i||pe(`type "${f}" must have a positive integer typeid pointer`),rr.hasOwnProperty(i)){if(u.$b)return;pe(`Cannot register type '${f}' twice`)}rr[i]=s,delete Ni[i],Ar.hasOwnProperty(i)&&(s=Ar[i],delete Ar[i],s.forEach(_=>_()))}function mn(i,s,u={}){if(!("argPackAdvance"in s))throw new TypeError("registerType registeredInstance requires argPackAdvance");fu(i,s,u)}function js(i){pe(i.g.u.i.name+" instance already deleted")}function Bn(){}function Os(i,s,u){if(i[s].B===void 0){var f=i[s];i[s]=function(){return i[s].B.hasOwnProperty(arguments.length)||pe(`Function '${u}' called with an invalid number of arguments (${arguments.length}) - expects one of (${i[s].B})!`),i[s].B[arguments.length].apply(this,arguments)},i[s].B=[],i[s].B[f.ea]=f}}function xs(i,s,u){m.hasOwnProperty(i)?((u===void 0||m[i].B!==void 0&&m[i].B[u]!==void 0)&&pe(`Cannot register public name '${i}' twice`),Os(m,i,i),m.hasOwnProperty(u)&&pe(`Cannot register multiple overloads of a function with the same number of arguments (${u})!`),m[i].B[u]=s):(m[i]=s,u!==void 0&&(m[i].Pc=u))}function vu(i,s,u,f,_,b,A,R){this.name=i,this.constructor=s,this.N=u,this.W=f,this.A=_,this.Ub=b,this.na=A,this.Pb=R,this.rb=[]}function Wi(i,s,u){for(;s!==u;)s.na||pe(`Expected null or instance of ${u.name}, got an instance of ${s.name}`),i=s.na(i),s=s.A;return i}function pu(i,s){return s===null?(this.Na&&pe(`null is not a valid ${this.name}`),0):(s.g||pe(`Cannot pass "${Ls(s)}" as a ${this.name}`),s.g.o||pe(`Cannot pass deleted object as a pointer of type ${this.name}`),Wi(s.g.o,s.g.u.i,this.i))}function gu(i,s){if(s===null){if(this.Na&&pe(`null is not a valid ${this.name}`),this.ua){var u=this.Pa();return i!==null&&i.push(this.W,u),u}return 0}if(s.g||pe(`Cannot pass "${Ls(s)}" as a ${this.name}`),s.g.o||pe(`Cannot pass deleted object as a pointer of type ${this.name}`),!this.ta&&s.g.u.ta&&pe(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`),u=Wi(s.g.o,s.g.u.i,this.i),this.ua)switch(s.g.G===void 0&&pe("Passing raw pointer to smart pointer is illegal"),this.tc){case 0:s.g.L===this?u=s.g.G:pe(`Cannot convert argument of type ${s.g.L?s.g.L.name:s.g.u.name} to parameter type ${this.name}`);break;case 1:u=s.g.G;break;case 2:if(s.g.L===this)u=s.g.G;else{var f=s.clone();u=this.oc(u,nn(function(){f.delete()})),i!==null&&i.push(this.W,u)}break;default:pe("Unsupporting sharing policy")}return u}function mu(i,s){return s===null?(this.Na&&pe(`null is not a valid ${this.name}`),0):(s.g||pe(`Cannot pass "${Ls(s)}" as a ${this.name}`),s.g.o||pe(`Cannot pass deleted object as a pointer of type ${this.name}`),s.g.u.ta&&pe(`Cannot convert argument of type ${s.g.u.name} to parameter type ${this.name}`),Wi(s.g.o,s.g.u.i,this.i))}function On(i,s,u,f){this.name=i,this.i=s,this.Na=u,this.ta=f,this.ua=!1,this.W=this.oc=this.Pa=this.sb=this.tc=this.nc=void 0,s.A!==void 0?this.toWireType=gu:(this.toWireType=f?pu:mu,this.K=null)}function Go(i,s,u){m.hasOwnProperty(i)||Fi("Replacing nonexistant public symbol"),m[i].B!==void 0&&u!==void 0?m[i].B[u]=s:(m[i]=s,m[i].ea=u)}var Vi=[],Ko=i=>{var s=Vi[i];return s||(i>=Vi.length&&(Vi.length=i+1),Vi[i]=s=Ye.get(i)),s},_u=(i,s)=>{var u=[];return function(){if(u.length=0,Object.assign(u,arguments),i.includes("j")){var f=m["dynCall_"+i];f=u&&u.length?f.apply(null,[s].concat(u)):f.call(null,s)}else f=Ko(s).apply(null,u);return f}};function wt(i,s){i=Ze(i);var u=i.includes("j")?_u(i,s):Ko(s);return typeof u!="function"&&pe(`unknown function pointer with signature ${i}: ${s}`),u}var Yo=void 0;function xn(i,s){function u(b){_[b]||rr[b]||(Ni[b]?Ni[b].forEach(u):(f.push(b),_[b]=!0))}var f=[],_={};throw s.forEach(u),new Yo(`${i}: `+f.map(Wo).join([", "]))}function qi(i,s,u,f,_){var b=s.length;2>b&&pe("argTypes array size mismatch! Must at least get return value and 'this' types!");var A=s[1]!==null&&u!==null,R=!1;for(u=1;u<s.length;++u)if(s[u]!==null&&s[u].K===void 0){R=!0;break}var M=s[0].name!=="void",P=b-2,W=Array(P),V=[],ee=[];return function(){if(arguments.length!==P&&pe(`function ${i} called with ${arguments.length} arguments, expected ${P} args!`),ee.length=0,V.length=A?2:1,V[0]=_,A){var S=s[1].toWireType(ee,this);V[1]=S}for(var B=0;B<P;++B)W[B]=s[B+2].toWireType(ee,arguments[B]),V.push(W[B]);if(B=f.apply(null,V),R)oi(ee);else for(var U=A?1:2;U<s.length;U++){var _e=U===1?S:W[U-2];s[U].K!==null&&s[U].K(_e)}return S=M?s[0].fromWireType(B):void 0,S}}function Hi(i,s){for(var u=[],f=0;f<i;f++)u.push(Pe[s+4*f>>2]);return u}function Jo(i,s,u){return i instanceof Object||pe(`${u} with invalid "this": ${i}`),i instanceof s.i.constructor||pe(`${u} incompatible with "this" of type ${i.constructor.name}`),i.g.o||pe(`cannot call emscripten binding method ${u} on deleted object`),Wi(i.g.o,i.g.u.i,s.i)}function Ms(i){i>=yt.h&&--yt.get(i).ub===0&&yt.Zb(i)}function yu(i,s,u){switch(s){case 0:return function(f){return this.fromWireType((u?tt:qe)[f])};case 1:return function(f){return this.fromWireType((u?nt:Pt)[f>>1])};case 2:return function(f){return this.fromWireType((u?Se:Pe)[f>>2])};default:throw new TypeError("Unknown integer type: "+i)}}function Ls(i){if(i===null)return"null";var s=typeof i;return s==="object"||s==="array"||s==="function"?i.toString():""+i}function wu(i,s){switch(s){case 2:return function(u){return this.fromWireType(Lt[u>>2])};case 3:return function(u){return this.fromWireType(De[u>>3])};default:throw new TypeError("Unknown float type: "+i)}}function bu(i,s,u){switch(s){case 0:return u?function(f){return tt[f]}:function(f){return qe[f]};case 1:return u?function(f){return nt[f>>1]}:function(f){return Pt[f>>1]};case 2:return u?function(f){return Se[f>>2]}:function(f){return Pe[f>>2]};default:throw new TypeError("Unknown integer type: "+i)}}var Xo=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,ku=(i,s)=>{for(var u=i>>1,f=u+s/2;!(u>=f)&&Pt[u];)++u;if(u<<=1,32<u-i&&Xo)return Xo.decode(qe.subarray(i,u));for(u="",f=0;!(f>=s/2);++f){var _=nt[i+2*f>>1];if(_==0)break;u+=String.fromCharCode(_)}return u},Eu=(i,s,u)=>{if(u===void 0&&(u=2147483647),2>u)return 0;u-=2;var f=s;u=u<2*i.length?u/2:i.length;for(var _=0;_<u;++_)nt[s>>1]=i.charCodeAt(_),s+=2;return nt[s>>1]=0,s-f},Au=i=>2*i.length,Su=(i,s)=>{for(var u=0,f="";!(u>=s/4);){var _=Se[i+4*u>>2];if(_==0)break;++u,65536<=_?(_-=65536,f+=String.fromCharCode(55296|_>>10,56320|_&1023)):f+=String.fromCharCode(_)}return f},Cu=(i,s,u)=>{if(u===void 0&&(u=2147483647),4>u)return 0;var f=s;u=f+u-4;for(var _=0;_<i.length;++_){var b=i.charCodeAt(_);if(55296<=b&&57343>=b){var A=i.charCodeAt(++_);b=65536+((b&1023)<<10)|A&1023}if(Se[s>>2]=b,s+=4,s+4>u)break}return Se[s>>2]=0,s-f},Tu=i=>{for(var s=0,u=0;u<i.length;++u){var f=i.charCodeAt(u);55296<=f&&57343>=f&&++u,s+=4}return s},Iu={};function zi(i){var s=Iu[i];return s===void 0?Ze(i):s}var Gi=[];function Pu(i){var s=Gi.length;return Gi.push(i),s}function Ru(i,s){for(var u=Array(i),f=0;f<i;++f)u[f]=si(Pe[s+4*f>>2],"parameter "+f);return u}var Qo=[],$s=[],Fs={},Zo=()=>{if(!Ds){var i={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:L||"./this.program"},s;for(s in Fs)Fs[s]===void 0?delete i[s]:i[s]=Fs[s];var u=[];for(s in i)u.push(`${s}=${i[s]}`);Ds=u}return Ds},Ds,Ki=i=>i%4===0&&(i%100!==0||i%400===0),ea=[31,29,31,30,31,30,31,31,30,31,30,31],ta=[31,28,31,30,31,30,31,31,30,31,30,31],ju=(i,s,u,f)=>{function _(S,B,U){for(S=typeof S=="number"?S.toString():S||"";S.length<B;)S=U[0]+S;return S}function b(S,B){return _(S,B,"0")}function A(S,B){function U(ke){return 0>ke?-1:0<ke?1:0}var _e;return(_e=U(S.getFullYear()-B.getFullYear()))===0&&(_e=U(S.getMonth()-B.getMonth()))===0&&(_e=U(S.getDate()-B.getDate())),_e}function R(S){switch(S.getDay()){case 0:return new Date(S.getFullYear()-1,11,29);case 1:return S;case 2:return new Date(S.getFullYear(),0,3);case 3:return new Date(S.getFullYear(),0,2);case 4:return new Date(S.getFullYear(),0,1);case 5:return new Date(S.getFullYear()-1,11,31);case 6:return new Date(S.getFullYear()-1,11,30)}}function M(S){var B=S.ca;for(S=new Date(new Date(S.da+1900,0,1).getTime());0<B;){var U=S.getMonth(),_e=(Ki(S.getFullYear())?ea:ta)[U];if(B>_e-S.getDate())B-=_e-S.getDate()+1,S.setDate(1),11>U?S.setMonth(U+1):(S.setMonth(0),S.setFullYear(S.getFullYear()+1));else{S.setDate(S.getDate()+B);break}}return U=new Date(S.getFullYear()+1,0,4),B=R(new Date(S.getFullYear(),0,4)),U=R(U),0>=A(B,S)?0>=A(U,S)?S.getFullYear()+1:S.getFullYear():S.getFullYear()-1}var P=Se[f+40>>2];f={wc:Se[f>>2],vc:Se[f+4>>2],Fa:Se[f+8>>2],Sa:Se[f+12>>2],Ga:Se[f+16>>2],da:Se[f+20>>2],R:Se[f+24>>2],ca:Se[f+28>>2],Rc:Se[f+32>>2],uc:Se[f+36>>2],xc:P&&P?Me(qe,P):""},u=u?Me(qe,u):"",P={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var W in P)u=u.replace(new RegExp(W,"g"),P[W]);var V="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ee="January February March April May June July August September October November December".split(" ");P={"%a":S=>V[S.R].substring(0,3),"%A":S=>V[S.R],"%b":S=>ee[S.Ga].substring(0,3),"%B":S=>ee[S.Ga],"%C":S=>b((S.da+1900)/100|0,2),"%d":S=>b(S.Sa,2),"%e":S=>_(S.Sa,2," "),"%g":S=>M(S).toString().substring(2),"%G":S=>M(S),"%H":S=>b(S.Fa,2),"%I":S=>(S=S.Fa,S==0?S=12:12<S&&(S-=12),b(S,2)),"%j":S=>{for(var B=0,U=0;U<=S.Ga-1;B+=(Ki(S.da+1900)?ea:ta)[U++]);return b(S.Sa+B,3)},"%m":S=>b(S.Ga+1,2),"%M":S=>b(S.vc,2),"%n":()=>`
`,"%p":S=>0<=S.Fa&&12>S.Fa?"AM":"PM","%S":S=>b(S.wc,2),"%t":()=>"	","%u":S=>S.R||7,"%U":S=>b(Math.floor((S.ca+7-S.R)/7),2),"%V":S=>{var B=Math.floor((S.ca+7-(S.R+6)%7)/7);if(2>=(S.R+371-S.ca-2)%7&&B++,B)B==53&&(U=(S.R+371-S.ca)%7,U==4||U==3&&Ki(S.da)||(B=1));else{B=52;var U=(S.R+7-S.ca-1)%7;(U==4||U==5&&Ki(S.da%400-1))&&B++}return b(B,2)},"%w":S=>S.R,"%W":S=>b(Math.floor((S.ca+7-(S.R+6)%7)/7),2),"%y":S=>(S.da+1900).toString().substring(2),"%Y":S=>S.da+1900,"%z":S=>{S=S.uc;var B=0<=S;return S=Math.abs(S)/60,(B?"+":"-")+("0000"+(S/60*100+S%60)).slice(-4)},"%Z":S=>S.xc,"%%":()=>"%"},u=u.replace(/%%/g,"\0\0");for(W in P)u.includes(W)&&(u=u.replace(new RegExp(W,"g"),P[W](f)));return u=u.replace(/\0\0/g,"%"),W=St(u,!1),W.length>s?0:(tt.set(W,i),W.length-1)};function na(i,s,u,f){i||(i=this),this.parent=i,this.U=i.U,this.wa=null,this.id=Ri++,this.name=s,this.mode=u,this.l={},this.m={},this.za=f}Object.defineProperties(na.prototype,{read:{get:function(){return(this.mode&365)===365},set:function(i){i?this.mode|=365:this.mode&=-366}},write:{get:function(){return(this.mode&146)===146},set:function(i){i?this.mode|=146:this.mode&=-147}}}),Li(),Zn=Array(4096),jt(le,"/"),ot("/tmp",16895,0),ot("/home",16895,0),ot("/home/web_user",16895,0),(()=>{ot("/dev",16895,0),Ht(259,{read:()=>0,write:(f,_,b,A)=>A}),Ft("/dev/null",259),ft(1280,dn),ft(1536,fn),Ft("/dev/tty",1280),Ft("/dev/tty1",1536);var i=new Uint8Array(1024),s=0,u=()=>(s===0&&(s=de(i).byteLength),i[--s]);Pn("random",u),Pn("urandom",u),ot("/dev/shm",16895,0),ot("/dev/shm/tmp",16895,0)})(),(()=>{ot("/proc",16895,0);var i=ot("/proc/self",16895,0);ot("/proc/self/fd",16895,0),jt({U:()=>{var s=Mi(i,"fd",16895,73);return s.l={ka:(u,f)=>{var _=Re(+f);return u={parent:null,U:{nb:"fake"},l:{ma:()=>_.path}},u.parent=u}},s}},"/proc/self/fd")})(),Object.assign(Rn.prototype,{get(i){return this.M[i]},has(i){return this.M[i]!==void 0},pa(i){var s=this.ib.pop()||this.M.length;return this.M[s]=i,s},Zb(i){this.M[i]=void 0,this.ib.push(i)}}),en=m.BindingError=class extends Error{constructor(i){super(i),this.name="BindingError"}},yt.M.push({value:void 0},{value:null},{value:!0},{value:!1}),yt.h=yt.M.length,m.count_emval_handles=function(){for(var i=0,s=yt.h;s<yt.M.length;++s)yt.M[s]!==void 0&&++i;return i},No=m.PureVirtualError=Uo("PureVirtualError");for(var ra=Array(256),Yi=0;256>Yi;++Yi)ra[Yi]=String.fromCharCode(Yi);Bo=ra,m.getInheritedInstanceCount=function(){return Object.keys(jn).length},m.getLiveInheritedInstances=function(){var i=[],s;for(s in jn)jn.hasOwnProperty(s)&&i.push(jn[s]);return i},m.flushPendingDeletes=Is,m.setDelayFunction=function(i){ii=i,ri.length&&ii&&ii(Is)},zo=m.InternalError=class extends Error{constructor(i){super(i),this.name="InternalError"}},Bn.prototype.isAliasOf=function(i){if(!(this instanceof Bn&&i instanceof Bn))return!1;var s=this.g.u.i,u=this.g.o,f=i.g.u.i;for(i=i.g.o;s.A;)u=s.na(u),s=s.A;for(;f.A;)i=f.na(i),f=f.A;return s===f&&u===i},Bn.prototype.clone=function(){if(this.g.o||js(this),this.g.ia)return this.g.count.value+=1,this;var i=Er,s=Object,u=s.create,f=Object.getPrototypeOf(this),_=this.g;return i=i(u.call(s,f,{g:{value:{count:_.count,fa:_.fa,ia:_.ia,o:_.o,u:_.u,G:_.G,L:_.L}}})),i.g.count.value+=1,i.g.fa=!1,i},Bn.prototype.delete=function(){this.g.o||js(this),this.g.fa&&!this.g.ia&&pe("Object already scheduled for deletion"),$i(this),Vo(this.g),this.g.ia||(this.g.G=void 0,this.g.o=void 0)},Bn.prototype.isDeleted=function(){return!this.g.o},Bn.prototype.deleteLater=function(){return this.g.o||js(this),this.g.fa&&!this.g.ia&&pe("Object already scheduled for deletion"),ri.push(this),ri.length===1&&ii&&ii(Is),this.g.fa=!0,this},On.prototype.Vb=function(i){return this.sb&&(i=this.sb(i)),i},On.prototype.bb=function(i){this.W&&this.W(i)},On.prototype.argPackAdvance=8,On.prototype.readValueFromPointer=ai,On.prototype.deleteObject=function(i){i!==null&&i.delete()},On.prototype.fromWireType=function(i){function s(){return this.ua?Di(this.i.N,{u:this.nc,o:u,L:this,G:i}):Di(this.i.N,{u:this,o:i})}var u=this.Vb(i);if(!u)return this.bb(i),null;var f=du(this.i,u);if(f!==void 0)return f.g.count.value===0?(f.g.o=u,f.g.G=i,f.clone()):(f=f.clone(),this.bb(i),f);if(f=this.i.Ub(u),f=Ho[f],!f)return s.call(this);f=this.ta?f.Kb:f.pointerType;var _=qo(u,this.i,f.i);return _===null?s.call(this):this.ua?Di(f.i.N,{u:f,o:_,L:this,G:i}):Di(f.i.N,{u:f,o:_})},Yo=m.UnboundTypeError=Uo("UnboundTypeError");var ia={__syscall_fcntl64:function(i,s,u){nr=u;try{var f=Re(i);switch(s){case 0:var _=Zt();return 0>_?-28:vt(f,_).X;case 1:case 2:return 0;case 3:return f.flags;case 4:return _=Zt(),f.flags|=_,0;case 5:return _=Zt(),nt[_+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Se[sa()>>2]=28,-1;default:return-28}}catch(b){if(typeof gn>"u"||b.name!=="ErrnoError")throw b;return-b.aa}},__syscall_ioctl:function(i,s,u){nr=u;try{var f=Re(i);switch(s){case 21509:return f.s?0:-59;case 21505:if(!f.s)return-59;if(f.s.V.bc){s=[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var _=Zt();Se[_>>2]=25856,Se[_+4>>2]=5,Se[_+8>>2]=191,Se[_+12>>2]=35387;for(var b=0;32>b;b++)tt[_+b+17>>0]=s[b]||0}return 0;case 21510:case 21511:case 21512:return f.s?0:-59;case 21506:case 21507:case 21508:if(!f.s)return-59;if(f.s.V.cc)for(_=Zt(),s=[],b=0;32>b;b++)s.push(tt[_+b+17>>0]);return 0;case 21519:return f.s?(_=Zt(),Se[_>>2]=0):-59;case 21520:return f.s?-28:-59;case 21531:if(_=Zt(),!f.m.ac)throw new Z(59);return f.m.ac(f,s,_);case 21523:return f.s?(f.s.V.dc&&(b=[24,80],_=Zt(),nt[_>>1]=b[0],nt[_+2>>1]=b[1]),0):-59;case 21524:return f.s?0:-59;case 21515:return f.s?0:-59;default:return-28}}catch(A){if(typeof gn>"u"||A.name!=="ErrnoError")throw A;return-A.aa}},__syscall_openat:function(i,s,u,f){nr=f;try{s=s?Me(qe,s):"";var _=s;if(_.charAt(0)==="/")s=_;else{var b=i===-100?"/":Re(i).path;if(_.length==0)throw new Z(44);s=C(b+"/"+_)}var A=f?Zt():0;return pn(s,u,A).X}catch(R){if(typeof gn>"u"||R.name!=="ErrnoError")throw R;return-R.aa}},_embind_create_inheriting_constructor:function(i,s,u){i=Ze(i),s=si(s,"wrapper"),u=tn(u);var f=[].slice,_=s.i,b=_.N,A=_.A.N,R=_.A.constructor;i=zt(i,function(){_.A.rb.forEach((function(P){if(this[P]===A[P])throw new No(`Pure virtual function ${P} must be implemented in JavaScript`)}).bind(this)),Object.defineProperty(this,"__parent",{value:b}),this.__construct.apply(this,f.call(arguments))}),b.__construct=function(){this===b&&pe("Pass correct 'this' to __construct");var P=R.implement.apply(void 0,[this].concat(f.call(arguments)));$i(P);var W=P.g;P.notifyOnDestruction(),W.ia=!0,Object.defineProperties(this,{g:{value:W}}),Er(this),P=W.o,P=Ps(_,P),jn.hasOwnProperty(P)?pe(`Tried to register registered instance: ${P}`):jn[P]=this},b.__destruct=function(){this===b&&pe("Pass correct 'this' to __destruct"),$i(this);var P=this.g.o;P=Ps(_,P),jn.hasOwnProperty(P)?delete jn[P]:pe(`Tried to unregister unregistered instance: ${P}`)},i.prototype=Object.create(b);for(var M in u)i.prototype[M]=u[M];return nn(i)},_embind_finalize_value_object:function(i){var s=Ui[i];delete Ui[i];var u=s.Pa,f=s.W,_=s.fb,b=_.map(A=>A.Yb).concat(_.map(A=>A.rc));Dt([i],b,A=>{var R={};return _.forEach((M,P)=>{var W=A[P],V=M.Wb,ee=M.Xb,S=A[P+_.length],B=M.qc,U=M.sc;R[M.Sb]={read:_e=>W.fromWireType(V(ee,_e)),write:(_e,ke)=>{var J=[];B(U,_e,S.toWireType(J,ke)),oi(J)}}}),[{name:s.name,fromWireType:function(M){var P={},W;for(W in R)P[W]=R[W].read(M);return f(M),P},toWireType:function(M,P){for(var W in R)if(!(W in P))throw new TypeError(`Missing field: "${W}"`);var V=u();for(W in R)R[W].write(V,P[W]);return M!==null&&M.push(f,V),V},argPackAdvance:8,readValueFromPointer:ai,K:f}]})},_embind_register_bigint:function(){},_embind_register_bool:function(i,s,u,f,_){var b=Bi(u);s=Ze(s),mn(i,{name:s,fromWireType:function(A){return!!A},toWireType:function(A,R){return R?f:_},argPackAdvance:8,readValueFromPointer:function(A){if(u===1)var R=tt;else if(u===2)R=nt;else if(u===4)R=Se;else throw new TypeError("Unknown boolean type size: "+s);return this.fromWireType(R[A>>b])},K:null})},_embind_register_class:function(i,s,u,f,_,b,A,R,M,P,W,V,ee){W=Ze(W),b=wt(_,b),R&&(R=wt(A,R)),P&&(P=wt(M,P)),ee=wt(V,ee);var S=Ot(W);xs(S,function(){xn(`Cannot construct ${W} due to unbound types`,[f])}),Dt([i,s,u],f?[f]:[],function(B){if(B=B[0],f)var U=B.i,_e=U.N;else _e=Bn.prototype;B=zt(S,function(){if(Object.getPrototypeOf(this)!==ke)throw new en("Use 'new' to construct "+W);if(J.$===void 0)throw new en(W+" has no accessible constructor");var pt=J.$[arguments.length];if(pt===void 0)throw new en(`Tried to invoke ctor of ${W} with invalid number of parameters (${arguments.length}) - expected (${Object.keys(J.$).toString()}) parameters instead!`);return pt.apply(this,arguments)});var ke=Object.create(_e,{constructor:{value:B}});B.prototype=ke;var J=new vu(W,B,ke,ee,U,b,R,P);J.A&&(J.A.oa===void 0&&(J.A.oa=[]),J.A.oa.push(J)),U=new On(W,J,!0,!1),_e=new On(W+"*",J,!1,!1);var ze=new On(W+" const*",J,!1,!0);return Ho[i]={pointerType:_e,Kb:ze},Go(S,B),[U,_e,ze]})},_embind_register_class_class_function:function(i,s,u,f,_,b,A){var R=Hi(u,f);s=Ze(s),b=wt(_,b),Dt([],[i],function(M){function P(){xn(`Cannot call ${W} due to unbound types`,R)}M=M[0];var W=`${M.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]);var V=M.i.constructor;return V[s]===void 0?(P.ea=u-1,V[s]=P):(Os(V,s,W),V[s].B[u-1]=P),Dt([],R,function(ee){if(ee=qi(W,[ee[0],null].concat(ee.slice(1)),null,b,A),V[s].B===void 0?(ee.ea=u-1,V[s]=ee):V[s].B[u-1]=ee,M.i.oa)for(const S of M.i.oa)S.constructor.hasOwnProperty(s)||(S.constructor[s]=ee);return[]}),[]})},_embind_register_class_class_property:function(i,s,u,f,_,b,A,R){s=Ze(s),b=wt(_,b),Dt([],[i],function(M){M=M[0];var P=`${M.name}.${s}`,W={get(){xn(`Cannot access ${P} due to unbound types`,[u])},enumerable:!0,configurable:!0};return W.set=R?()=>{xn(`Cannot access ${P} due to unbound types`,[u])}:()=>{pe(`${P} is a read-only property`)},Object.defineProperty(M.i.constructor,s,W),Dt([],[u],function(V){V=V[0];var ee={get(){return V.fromWireType(b(f))},enumerable:!0};return R&&(R=wt(A,R),ee.set=S=>{var B=[];R(f,V.toWireType(B,S)),oi(B)}),Object.defineProperty(M.i.constructor,s,ee),[]}),[]})},_embind_register_class_constructor:function(i,s,u,f,_,b){var A=Hi(s,u);_=wt(f,_),Dt([],[i],function(R){R=R[0];var M=`constructor ${R.name}`;if(R.i.$===void 0&&(R.i.$=[]),R.i.$[s-1]!==void 0)throw new en(`Cannot register multiple constructors with identical number of parameters (${s-1}) for class '${R.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return R.i.$[s-1]=()=>{xn(`Cannot construct ${R.name} due to unbound types`,A)},Dt([],A,function(P){return P.splice(1,0,null),R.i.$[s-1]=qi(M,P,null,_,b),[]}),[]})},_embind_register_class_function:function(i,s,u,f,_,b,A,R){var M=Hi(u,f);s=Ze(s),b=wt(_,b),Dt([],[i],function(P){function W(){xn(`Cannot call ${V} due to unbound types`,M)}P=P[0];var V=`${P.name}.${s}`;s.startsWith("@@")&&(s=Symbol[s.substring(2)]),R&&P.i.rb.push(s);var ee=P.i.N,S=ee[s];return S===void 0||S.B===void 0&&S.className!==P.name&&S.ea===u-2?(W.ea=u-2,W.className=P.name,ee[s]=W):(Os(ee,s,V),ee[s].B[u-2]=W),Dt([],M,function(B){return B=qi(V,B,P,b,A),ee[s].B===void 0?(B.ea=u-2,ee[s]=B):ee[s].B[u-2]=B,[]}),[]})},_embind_register_class_property:function(i,s,u,f,_,b,A,R,M,P){s=Ze(s),_=wt(f,_),Dt([],[i],function(W){W=W[0];var V=`${W.name}.${s}`,ee={get(){xn(`Cannot access ${V} due to unbound types`,[u,A])},enumerable:!0,configurable:!0};return ee.set=M?()=>{xn(`Cannot access ${V} due to unbound types`,[u,A])}:()=>{pe(V+" is a read-only property")},Object.defineProperty(W.i.N,s,ee),Dt([],M?[u,A]:[u],function(S){var B=S[0],U={get(){var ke=Jo(this,W,V+" getter");return B.fromWireType(_(b,ke))},enumerable:!0};if(M){M=wt(R,M);var _e=S[1];U.set=function(ke){var J=Jo(this,W,V+" setter"),ze=[];M(P,J,_e.toWireType(ze,ke)),oi(ze)}}return Object.defineProperty(W.i.N,s,U),[]}),[]})},_embind_register_emval:function(i,s){s=Ze(s),mn(i,{name:s,fromWireType:function(u){var f=tn(u);return Ms(u),f},toWireType:function(u,f){return nn(f)},argPackAdvance:8,readValueFromPointer:ai,K:null})},_embind_register_enum:function(i,s,u,f){function _(){}u=Bi(u),s=Ze(s),_.values={},mn(i,{name:s,constructor:_,fromWireType:function(b){return this.constructor.values[b]},toWireType:function(b,A){return A.value},argPackAdvance:8,readValueFromPointer:yu(s,u,f),K:null}),xs(s,_)},_embind_register_enum_value:function(i,s,u){var f=si(i,"enum");s=Ze(s),i=f.constructor,f=Object.create(f.constructor.prototype,{value:{value:u},constructor:{value:zt(`${f.name}_${s}`,function(){})}}),i.values[u]=f,i[s]=f},_embind_register_float:function(i,s,u){u=Bi(u),s=Ze(s),mn(i,{name:s,fromWireType:function(f){return f},toWireType:function(f,_){return _},argPackAdvance:8,readValueFromPointer:wu(s,u),K:null})},_embind_register_function:function(i,s,u,f,_,b){var A=Hi(s,u);i=Ze(i),_=wt(f,_),xs(i,function(){xn(`Cannot call ${i} due to unbound types`,A)},s-1),Dt([],A,function(R){return Go(i,qi(i,[R[0],null].concat(R.slice(1)),null,_,b),s-1),[]})},_embind_register_integer:function(i,s,u,f,_){s=Ze(s),_===-1&&(_=4294967295),_=Bi(u);var b=R=>R;if(f===0){var A=32-8*u;b=R=>R<<A>>>A}u=s.includes("unsigned")?function(R,M){return M>>>0}:function(R,M){return M},mn(i,{name:s,fromWireType:b,toWireType:u,argPackAdvance:8,readValueFromPointer:bu(s,_,f!==0),K:null})},_embind_register_memory_view:function(i,s,u){function f(b){b>>=2;var A=Pe;return new _(A.buffer,A[b+1],A[b])}var _=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][s];u=Ze(u),mn(i,{name:u,fromWireType:f,argPackAdvance:8,readValueFromPointer:f},{$b:!0})},_embind_register_std_string:function(i,s){s=Ze(s);var u=s==="std::string";mn(i,{name:s,fromWireType:function(f){var _=Pe[f>>2],b=f+4;if(u)for(var A=b,R=0;R<=_;++R){var M=b+R;if(R==_||qe[M]==0){if(A=A?Me(qe,A,M-A):"",P===void 0)var P=A;else P+="\0",P+=A;A=M+1}}else{for(P=Array(_),R=0;R<_;++R)P[R]=String.fromCharCode(qe[b+R]);P=P.join("")}return Mn(f),P},toWireType:function(f,_){_ instanceof ArrayBuffer&&(_=new Uint8Array(_));var b=typeof _=="string";b||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int8Array||pe("Cannot pass non-string to std::string");var A=u&&b?We(_):_.length,R=Us(4+A+1),M=R+4;if(Pe[R>>2]=A,u&&b)At(_,qe,M,A+1);else if(b)for(b=0;b<A;++b){var P=_.charCodeAt(b);255<P&&(Mn(M),pe("String has UTF-16 code units that do not fit in 8 bits")),qe[M+b]=P}else for(b=0;b<A;++b)qe[M+b]=_[b];return f!==null&&f.push(Mn,R),R},argPackAdvance:8,readValueFromPointer:ai,K:function(f){Mn(f)}})},_embind_register_std_wstring:function(i,s,u){if(u=Ze(u),s===2)var f=ku,_=Eu,b=Au,A=()=>Pt,R=1;else s===4&&(f=Su,_=Cu,b=Tu,A=()=>Pe,R=2);mn(i,{name:u,fromWireType:function(M){for(var P=Pe[M>>2],W=A(),V,ee=M+4,S=0;S<=P;++S){var B=M+4+S*s;(S==P||W[B>>R]==0)&&(ee=f(ee,B-ee),V===void 0?V=ee:(V+="\0",V+=ee),ee=B+s)}return Mn(M),V},toWireType:function(M,P){typeof P!="string"&&pe(`Cannot pass non-string to C++ string type ${u}`);var W=b(P),V=Us(4+W+s);return Pe[V>>2]=W>>R,_(P,V+4,W+s),M!==null&&M.push(Mn,V),V},argPackAdvance:8,readValueFromPointer:ai,K:function(M){Mn(M)}})},_embind_register_value_object:function(i,s,u,f,_,b){Ui[i]={name:Ze(s),Pa:wt(u,f),W:wt(_,b),fb:[]}},_embind_register_value_object_field:function(i,s,u,f,_,b,A,R,M,P){Ui[i].fb.push({Sb:Ze(s),Yb:u,Wb:wt(f,_),Xb:b,rc:A,qc:wt(R,M),sc:P})},_embind_register_void:function(i,s){s=Ze(s),mn(i,{fc:!0,name:s,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},_emscripten_get_now_is_monotonic:()=>!0,_emval_as:function(i,s,u){i=tn(i),s=si(s,"emval::as");var f=[],_=nn(f);return Pe[u>>2]=_,s.toWireType(f,i)},_emval_call_method:function(i,s,u,f,_){i=Gi[i],s=tn(s),u=zi(u);var b=[];return Pe[f>>2]=nn(b),i(s,u,b,_)},_emval_call_void_method:function(i,s,u,f){i=Gi[i],s=tn(s),u=zi(u),i(s,u,null,f)},_emval_decref:Ms,_emval_get_method_caller:function(i,s){var u=Ru(i,s),f=u[0];s=f.name+"_$"+u.slice(1).map(function(A){return A.name}).join("_")+"$";var _=Qo[s];if(_!==void 0)return _;var b=Array(i-1);return _=Pu((A,R,M,P)=>{for(var W=0,V=0;V<i-1;++V)b[V]=u[V+1].readValueFromPointer(P+W),W+=u[V+1].argPackAdvance;for(A=A[R].apply(A,b),V=0;V<i-1;++V)u[V+1].Nb&&u[V+1].Nb(b[V]);if(!f.fc)return f.toWireType(M,A)}),Qo[s]=_},_emval_get_module_property:function(i){return i=zi(i),nn(m[i])},_emval_get_property:function(i,s){return i=tn(i),s=tn(s),nn(i[s])},_emval_incref:function(i){4<i&&(yt.get(i).ub+=1)},_emval_new_array:function(){return nn([])},_emval_new_cstring:function(i){return nn(zi(i))},_emval_new_object:function(){return nn({})},_emval_run_destructors:function(i){var s=tn(i);oi(s),Ms(i)},_emval_set_property:function(i,s,u){i=tn(i),s=tn(s),u=tn(u),i[s]=u},_emval_take_value:function(i,s){return i=si(i,"_emval_take_value"),i=i.readValueFromPointer(s),nn(i)},abort:()=>{hn("")},emscripten_asm_const_int:(i,s,u)=>{$s.length=0;var f;for(u>>=2;f=qe[s++];)u+=f!=105&u,$s.push(f==105?Se[u]:De[u++>>1]),++u;return a[i].apply(null,$s)},emscripten_date_now:function(){return Date.now()},emscripten_get_now:()=>performance.now(),emscripten_memcpy_big:(i,s,u)=>qe.copyWithin(i,s,s+u),emscripten_resize_heap:i=>{var s=qe.length;if(i>>>=0,2147483648<i)return!1;for(var u=1;4>=u;u*=2){var f=s*(1+.2/u);f=Math.min(f,i+100663296);var _=Math;f=Math.max(i,f);e:{_=_.min.call(_,2147483648,f+(65536-f%65536)%65536)-gt.buffer.byteLength+65535>>>16;try{gt.grow(_),kt();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},environ_get:(i,s)=>{var u=0;return Zo().forEach(function(f,_){var b=s+u;for(_=Pe[i+4*_>>2]=b,b=0;b<f.length;++b)tt[_++>>0]=f.charCodeAt(b);tt[_>>0]=0,u+=f.length+1}),0},environ_sizes_get:(i,s)=>{var u=Zo();Pe[i>>2]=u.length;var f=0;return u.forEach(function(_){f+=_.length+1}),Pe[s>>2]=f,0},fd_close:function(i){try{var s=Re(i);if(s.X===null)throw new Z(8);s.Ma&&(s.Ma=null);try{s.m.close&&s.m.close(s)}catch(u){throw u}finally{Qn[s.X]=null}return s.X=null,0}catch(u){if(typeof gn>"u"||u.name!=="ErrnoError")throw u;return u.aa}},fd_read:function(i,s,u,f){try{e:{var _=Re(i);i=s;for(var b,A=s=0;A<u;A++){var R=Pe[i>>2],M=Pe[i+4>>2];i+=8;var P=_,W=R,V=M,ee=b,S=tt;if(0>V||0>ee)throw new Z(28);if(P.X===null)throw new Z(8);if((P.flags&2097155)===1)throw new Z(8);if((P.node.mode&61440)===16384)throw new Z(31);if(!P.m.read)throw new Z(28);var B=typeof ee<"u";if(!B)ee=P.position;else if(!P.seekable)throw new Z(70);var U=P.m.read(P,S,W,V,ee);B||(P.position+=U);var _e=U;if(0>_e){var ke=-1;break e}if(s+=_e,_e<M)break;typeof b<"u"&&(b+=_e)}ke=s}return Pe[f>>2]=ke,0}catch(J){if(typeof gn>"u"||J.name!=="ErrnoError")throw J;return J.aa}},fd_seek:function(i,s,u,f,_){s=u+2097152>>>0<4194305-!!s?(s>>>0)+4294967296*u:NaN;try{if(isNaN(s))return 61;var b=Re(i);return er(b,s,f),p=[b.position>>>0,(Be=b.position,1<=+Math.abs(Be)?0<Be?+Math.floor(Be/4294967296)>>>0:~~+Math.ceil((Be-+(~~Be>>>0))/4294967296)>>>0:0)],Se[_>>2]=p[0],Se[_+4>>2]=p[1],b.Ma&&s===0&&f===0&&(b.Ma=null),0}catch(A){if(typeof gn>"u"||A.name!=="ErrnoError")throw A;return A.aa}},fd_write:function(i,s,u,f){try{e:{var _=Re(i);i=s;for(var b,A=s=0;A<u;A++){var R=Pe[i>>2],M=Pe[i+4>>2];i+=8;var P=_,W=R,V=M,ee=b,S=tt;if(0>V||0>ee)throw new Z(28);if(P.X===null)throw new Z(8);if((P.flags&2097155)===0)throw new Z(8);if((P.node.mode&61440)===16384)throw new Z(31);if(!P.m.write)throw new Z(28);P.seekable&&P.flags&1024&&er(P,0,2);var B=typeof ee<"u";if(!B)ee=P.position;else if(!P.seekable)throw new Z(70);var U=P.m.write(P,S,W,V,ee,void 0);B||(P.position+=U);var _e=U;if(0>_e){var ke=-1;break e}s+=_e,typeof b<"u"&&(b+=_e)}ke=s}return Pe[f>>2]=ke,0}catch(J){if(typeof gn>"u"||J.name!=="ErrnoError")throw J;return J.aa}},strftime_l:(i,s,u,f)=>ju(i,s,u,f)};(function(){function i(u){if(Ee=u=u.exports,gt=Ee.memory,kt(),Ye=Ee.__indirect_function_table,cn.unshift(Ee.__wasm_call_ctors),mt--,m.monitorRunDependencies&&m.monitorRunDependencies(mt),mt==0&&Rt){var f=Rt;Rt=null,f()}return u}var s={env:ia,wasi_snapshot_preview1:ia};if(mt++,m.monitorRunDependencies&&m.monitorRunDependencies(mt),m.instantiateWasm)try{return m.instantiateWasm(s,i)}catch(u){Ke("Module.instantiateWasm callback failed with error: "+u),$(u)}return ve(s,function(u){i(u.instance)}).catch($),{}})();var Mn=i=>(Mn=Ee.free)(i),Us=i=>(Us=Ee.malloc)(i),sa=()=>(sa=Ee.__errno_location)(),oa=m._ma_device__on_notification_unlocked=i=>(oa=m._ma_device__on_notification_unlocked=Ee.ma_device__on_notification_unlocked)(i);m._ma_malloc_emscripten=(i,s)=>(m._ma_malloc_emscripten=Ee.ma_malloc_emscripten)(i,s),m._ma_free_emscripten=(i,s)=>(m._ma_free_emscripten=Ee.ma_free_emscripten)(i,s);var aa=m._ma_device_process_pcm_frames_capture__webaudio=(i,s,u)=>(aa=m._ma_device_process_pcm_frames_capture__webaudio=Ee.ma_device_process_pcm_frames_capture__webaudio)(i,s,u),la=m._ma_device_process_pcm_frames_playback__webaudio=(i,s,u)=>(la=m._ma_device_process_pcm_frames_playback__webaudio=Ee.ma_device_process_pcm_frames_playback__webaudio)(i,s,u),ua=i=>(ua=Ee.__getTypeName)(i);m.__embind_initialize_bindings=()=>(m.__embind_initialize_bindings=Ee._embind_initialize_bindings)(),m.dynCall_iiji=(i,s,u,f,_)=>(m.dynCall_iiji=Ee.dynCall_iiji)(i,s,u,f,_),m.dynCall_jiji=(i,s,u,f,_)=>(m.dynCall_jiji=Ee.dynCall_jiji)(i,s,u,f,_),m.dynCall_iiiji=(i,s,u,f,_,b)=>(m.dynCall_iiiji=Ee.dynCall_iiiji)(i,s,u,f,_,b),m.dynCall_iij=(i,s,u,f)=>(m.dynCall_iij=Ee.dynCall_iij)(i,s,u,f),m.dynCall_jii=(i,s,u)=>(m.dynCall_jii=Ee.dynCall_jii)(i,s,u),m.dynCall_viijii=(i,s,u,f,_,b,A)=>(m.dynCall_viijii=Ee.dynCall_viijii)(i,s,u,f,_,b,A),m.dynCall_iiiiij=(i,s,u,f,_,b,A)=>(m.dynCall_iiiiij=Ee.dynCall_iiiiij)(i,s,u,f,_,b,A),m.dynCall_iiiiijj=(i,s,u,f,_,b,A,R,M)=>(m.dynCall_iiiiijj=Ee.dynCall_iiiiijj)(i,s,u,f,_,b,A,R,M),m.dynCall_iiiiiijj=(i,s,u,f,_,b,A,R,M,P)=>(m.dynCall_iiiiiijj=Ee.dynCall_iiiiiijj)(i,s,u,f,_,b,A,R,M,P);var Ji;Rt=function i(){Ji||ca(),Ji||(Rt=i)};function ca(){function i(){if(!Ji&&(Ji=!0,m.calledRun=!0,!un)){if(m.noFSInit||ti||(ti=!0,Li(),m.stdin=m.stdin,m.stdout=m.stdout,m.stderr=m.stderr,m.stdin?Pn("stdin",m.stdin):vn("/dev/tty","/dev/stdin"),m.stdout?Pn("stdout",null,m.stdout):vn("/dev/tty","/dev/stdout"),m.stderr?Pn("stderr",null,m.stderr):vn("/dev/tty1","/dev/stderr"),pn("/dev/stdin",0),pn("/dev/stdout",1),pn("/dev/stderr",1)),ji=!1,h(cn),I(m),m.onRuntimeInitialized&&m.onRuntimeInitialized(),m.postRun)for(typeof m.postRun=="function"&&(m.postRun=[m.postRun]);m.postRun.length;){var s=m.postRun.shift();Xt.unshift(s)}h(Xt)}}if(!(0<mt)){if(m.preRun)for(typeof m.preRun=="function"&&(m.preRun=[m.preRun]);m.preRun.length;)Tn();h(Wt),0<mt||(m.setStatus?(m.setStatus("Running..."),setTimeout(function(){setTimeout(function(){m.setStatus("")},1),i()},1)):i())}}if(m.preInit)for(typeof m.preInit=="function"&&(m.preInit=[m.preInit]);0<m.preInit.length;)m.preInit.pop()();return ca(),E.ready})})();const y=g}),(c=>{c.exports=JSON.parse(`{"name":"@rive-app/canvas","version":"2.31.2","description":"Rive's canvas based web api.","main":"rive.js","homepage":"https://rive.app","repository":{"type":"git","url":"https://github.com/rive-app/rive-wasm/tree/master/js"},"keywords":["rive","animation"],"author":"Rive","contributors":["Luigi Rosso <luigi@rive.app> (https://rive.app)","Maxwell Talbot <max@rive.app> (https://rive.app)","Arthur Vivian <arthur@rive.app> (https://rive.app)","Umberto Sonnino <umberto@rive.app> (https://rive.app)","Matthew Sullivan <matt.j.sullivan@gmail.com> (mailto:matt.j.sullivan@gmail.com)"],"license":"MIT","files":["rive.js","rive.js.map","rive.wasm","rive_fallback.wasm","rive.d.ts","rive_advanced.mjs.d.ts"],"typings":"rive.d.ts","dependencies":{},"browser":{"fs":false,"path":false}}`)}),((c,d,v)=>{v.r(d),v.d(d,{Animation:()=>g.Animation});var g=v(4)}),((c,d,v)=>{v.r(d),v.d(d,{Animation:()=>g});var g=(function(){function y(k,E,m,I){this.animation=k,this.artboard=E,this.playing=I,this.loopCount=0,this.scrubTo=null,this.instance=new m.LinearAnimationInstance(k,E)}return Object.defineProperty(y.prototype,"name",{get:function(){return this.animation.name},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"time",{get:function(){return this.instance.time},set:function(k){this.instance.time=k},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"loopValue",{get:function(){return this.animation.loopValue},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"needsScrub",{get:function(){return this.scrubTo!==null},enumerable:!1,configurable:!0}),y.prototype.advance=function(k){this.scrubTo===null?this.instance.advance(k):(this.instance.time=0,this.instance.advance(this.scrubTo),this.scrubTo=null)},y.prototype.apply=function(k){this.instance.apply(k)},y.prototype.cleanup=function(){this.instance.delete()},y})()}),((c,d,v)=>{v.r(d),v.d(d,{AudioAssetWrapper:()=>k.AudioAssetWrapper,AudioWrapper:()=>k.AudioWrapper,BLANK_URL:()=>y.BLANK_URL,CustomFileAssetLoaderWrapper:()=>k.CustomFileAssetLoaderWrapper,FileAssetWrapper:()=>k.FileAssetWrapper,Finalizable:()=>k.Finalizable,FontAssetWrapper:()=>k.FontAssetWrapper,FontWrapper:()=>k.FontWrapper,ImageAssetWrapper:()=>k.ImageAssetWrapper,ImageWrapper:()=>k.ImageWrapper,finalizationRegistry:()=>k.finalizationRegistry,registerTouchInteractions:()=>g.registerTouchInteractions,sanitizeUrl:()=>y.sanitizeUrl});var g=v(6),y=v(7),k=v(8)}),((c,d,v)=>{v.r(d),v.d(d,{registerTouchInteractions:()=>k});var g=void 0,y=function(E,m){var I,$;return["touchstart","touchmove"].indexOf(E.type)>-1&&(!((I=E.touches)===null||I===void 0)&&I.length)?(m||E.preventDefault(),{clientX:E.touches[0].clientX,clientY:E.touches[0].clientY}):E.type==="touchend"&&(!(($=E.changedTouches)===null||$===void 0)&&$.length)?{clientX:E.changedTouches[0].clientX,clientY:E.changedTouches[0].clientY}:{clientX:E.clientX,clientY:E.clientY}},k=function(E){var m=E.canvas,I=E.artboard,$=E.stateMachines,O=$===void 0?[]:$,q=E.renderer,H=E.rive,N=E.fit,G=E.alignment,K=E.isTouchScrollEnabled,j=K===void 0?!1:K,L=E.layoutScaleFactor,ie=L===void 0?1:L;if(!m||!O.length||!q||!H||!I||typeof window>"u")return null;var ue=null,ae=!1,X=function(Ne){if(ae&&Ne instanceof MouseEvent){Ne.type=="mouseup"&&(ae=!1);return}ae=j&&Ne.type==="touchend"&&ue==="touchstart",ue=Ne.type;var Ke=Ne.currentTarget.getBoundingClientRect(),Ve=y(Ne,j),gt=Ve.clientX,Ee=Ve.clientY;if(!(!gt&&!Ee)){var un=gt-Ke.left,tt=Ee-Ke.top,qe=H.computeAlignment(N,G,{minX:0,minY:0,maxX:Ke.width,maxY:Ke.height},I.bounds,ie),nt=new H.Mat2D;qe.invert(nt);var Pt=new H.Vec2D(un,tt),Se=H.mapXY(nt,Pt),Pe=Se.x(),Lt=Se.y();switch(Se.delete(),nt.delete(),Pt.delete(),qe.delete(),Ne.type){case"mouseout":for(var De=0,kt=O;De<kt.length;De++){var Ye=kt[De];Ye.pointerMove(Pe,Lt)}break;case"touchmove":case"mouseover":case"mousemove":{for(var Wt=0,cn=O;Wt<cn.length;Wt++){var Ye=cn[Wt];Ye.pointerMove(Pe,Lt)}break}case"touchstart":case"mousedown":{for(var Xt=0,Tn=O;Xt<Tn.length;Xt++){var Ye=Tn[Xt];Ye.pointerDown(Pe,Lt)}break}case"touchend":case"mouseup":{for(var mt=0,Rt=O;mt<Rt.length;mt++){var Ye=Rt[mt];Ye.pointerUp(Pe,Lt)}break}}}},he=X.bind(g);return m.addEventListener("mouseover",he),m.addEventListener("mouseout",he),m.addEventListener("mousemove",he),m.addEventListener("mousedown",he),m.addEventListener("mouseup",he),m.addEventListener("touchmove",he,{passive:j}),m.addEventListener("touchstart",he,{passive:j}),m.addEventListener("touchend",he),function(){m.removeEventListener("mouseover",he),m.removeEventListener("mouseout",he),m.removeEventListener("mousemove",he),m.removeEventListener("mousedown",he),m.removeEventListener("mouseup",he),m.removeEventListener("touchmove",he),m.removeEventListener("touchstart",he),m.removeEventListener("touchend",he)}}}),((c,d,v)=>{v.r(d),v.d(d,{BLANK_URL:()=>$,sanitizeUrl:()=>H});var g=/^([^\w]*)(javascript|data|vbscript)/im,y=/&#(\w+)(^\w|;)?/g,k=/&(newline|tab);/gi,E=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,m=/^.+(:|&colon;)/gim,I=[".","/"],$="about:blank";function O(N){return I.indexOf(N[0])>-1}function q(N){var G=N.replace(E,"");return G.replace(y,function(K,j){return String.fromCharCode(j)})}function H(N){if(!N)return $;var G=q(N).replace(k,"").replace(E,"").trim();if(!G)return $;if(O(G))return G;var K=G.match(m);if(!K)return G;var j=K[0];return g.test(j)?$:G}}),((c,d,v)=>{v.r(d),v.d(d,{AudioAssetWrapper:()=>q,AudioWrapper:()=>E,CustomFileAssetLoaderWrapper:()=>I,FileAssetWrapper:()=>$,Finalizable:()=>y,FontAssetWrapper:()=>H,FontWrapper:()=>m,ImageAssetWrapper:()=>O,ImageWrapper:()=>k,finalizationRegistry:()=>K});var g=(function(){var j=function(L,ie){return j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ue,ae){ue.__proto__=ae}||function(ue,ae){for(var X in ae)Object.prototype.hasOwnProperty.call(ae,X)&&(ue[X]=ae[X])},j(L,ie)};return function(L,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Class extends value "+String(ie)+" is not a constructor or null");j(L,ie);function ue(){this.constructor=L}L.prototype=ie===null?Object.create(ie):(ue.prototype=ie.prototype,new ue)}})(),y=(function(){function j(){this.selfUnref=!1}return j})(),k=(function(j){g(L,j);function L(ie){var ue=j.call(this)||this;return ue._nativeImage=ie,ue}return Object.defineProperty(L.prototype,"nativeImage",{get:function(){return this._nativeImage},enumerable:!1,configurable:!0}),L.prototype.unref=function(){this.selfUnref&&this._nativeImage.unref()},L})(y),E=(function(j){g(L,j);function L(ie){var ue=j.call(this)||this;return ue._nativeAudio=ie,ue}return Object.defineProperty(L.prototype,"nativeAudio",{get:function(){return this._nativeAudio},enumerable:!1,configurable:!0}),L.prototype.unref=function(){this.selfUnref&&this._nativeAudio.unref()},L})(y),m=(function(j){g(L,j);function L(ie){var ue=j.call(this)||this;return ue._nativeFont=ie,ue}return Object.defineProperty(L.prototype,"nativeFont",{get:function(){return this._nativeFont},enumerable:!1,configurable:!0}),L.prototype.unref=function(){this.selfUnref&&this._nativeFont.unref()},L})(y),I=(function(){function j(L,ie){this._assetLoaderCallback=ie,this.assetLoader=new L.CustomFileAssetLoader({loadContents:this.loadContents.bind(this)})}return j.prototype.loadContents=function(L,ie){var ue;return L.isImage?ue=new O(L):L.isAudio?ue=new q(L):L.isFont&&(ue=new H(L)),this._assetLoaderCallback(ue,ie)},j})(),$=(function(){function j(L){this._nativeFileAsset=L}return j.prototype.decode=function(L){this._nativeFileAsset.decode(L)},Object.defineProperty(j.prototype,"name",{get:function(){return this._nativeFileAsset.name},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"fileExtension",{get:function(){return this._nativeFileAsset.fileExtension},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"uniqueFilename",{get:function(){return this._nativeFileAsset.uniqueFilename},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isAudio",{get:function(){return this._nativeFileAsset.isAudio},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isImage",{get:function(){return this._nativeFileAsset.isImage},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"isFont",{get:function(){return this._nativeFileAsset.isFont},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"cdnUuid",{get:function(){return this._nativeFileAsset.cdnUuid},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"nativeFileAsset",{get:function(){return this._nativeFileAsset},enumerable:!1,configurable:!0}),j})(),O=(function(j){g(L,j);function L(){return j!==null&&j.apply(this,arguments)||this}return L.prototype.setRenderImage=function(ie){this._nativeFileAsset.setRenderImage(ie.nativeImage)},L})($),q=(function(j){g(L,j);function L(){return j!==null&&j.apply(this,arguments)||this}return L.prototype.setAudioSource=function(ie){this._nativeFileAsset.setAudioSource(ie.nativeAudio)},L})($),H=(function(j){g(L,j);function L(){return j!==null&&j.apply(this,arguments)||this}return L.prototype.setFont=function(ie){this._nativeFileAsset.setFont(ie.nativeFont)},L})($),N=(function(){function j(L){}return j.prototype.register=function(L){L.selfUnref=!0},j.prototype.unregister=function(L){},j})(),G=typeof FinalizationRegistry<"u"?FinalizationRegistry:N,K=new G(function(j){j.unref()})})],r={};function o(c){var d=r[c];if(d!==void 0)return d.exports;var v=r[c]={exports:{}};return t[c](v,v.exports,o),v.exports}o.d=(c,d)=>{for(var v in d)o.o(d,v)&&!o.o(c,v)&&Object.defineProperty(c,v,{enumerable:!0,get:d[v]})},o.o=(c,d)=>Object.prototype.hasOwnProperty.call(c,d),o.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})};var l={};return(()=>{o.r(l),o.d(l,{Alignment:()=>H,DataEnum:()=>Lt,EventType:()=>X,Fit:()=>q,Layout:()=>N,LoopType:()=>he,Rive:()=>Se,RiveEventType:()=>L,RiveFile:()=>Pt,RuntimeLoader:()=>G,StateMachineInput:()=>j,StateMachineInputType:()=>K,Testing:()=>Y,ViewModel:()=>Pe,ViewModelInstance:()=>kt,ViewModelInstanceArtboard:()=>Qt,ViewModelInstanceAssetImage:()=>Xn,ViewModelInstanceBoolean:()=>Xt,ViewModelInstanceColor:()=>hn,ViewModelInstanceEnum:()=>mt,ViewModelInstanceList:()=>Rt,ViewModelInstanceNumber:()=>cn,ViewModelInstanceString:()=>Wt,ViewModelInstanceTrigger:()=>Tn,ViewModelInstanceValue:()=>Ye,decodeAudio:()=>se,decodeFont:()=>Be,decodeImage:()=>ve});var c=o(1),d=o(2),v=o(3),g=o(5),y=(function(){var p=function(a,h){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(w,C){w.__proto__=C}||function(w,C){for(var x in C)Object.prototype.hasOwnProperty.call(C,x)&&(w[x]=C[x])},p(a,h)};return function(a,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");p(a,h);function w(){this.constructor=a}a.prototype=h===null?Object.create(h):(w.prototype=h.prototype,new w)}})(),k=function(){return k=Object.assign||function(p){for(var a,h=1,w=arguments.length;h<w;h++){a=arguments[h];for(var C in a)Object.prototype.hasOwnProperty.call(a,C)&&(p[C]=a[C])}return p},k.apply(this,arguments)},E=function(p,a,h,w){function C(x){return x instanceof h?x:new h(function(F){F(x)})}return new(h||(h=Promise))(function(x,F){function re(we){try{ne(w.next(we))}catch(Me){F(Me)}}function de(we){try{ne(w.throw(we))}catch(Me){F(Me)}}function ne(we){we.done?x(we.value):C(we.value).then(re,de)}ne((w=w.apply(p,a||[])).next())})},m=function(p,a){var h={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},w,C,x,F=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return F.next=re(0),F.throw=re(1),F.return=re(2),typeof Symbol=="function"&&(F[Symbol.iterator]=function(){return this}),F;function re(ne){return function(we){return de([ne,we])}}function de(ne){if(w)throw new TypeError("Generator is already executing.");for(;F&&(F=0,ne[0]&&(h=0)),h;)try{if(w=1,C&&(x=ne[0]&2?C.return:ne[0]?C.throw||((x=C.return)&&x.call(C),0):C.next)&&!(x=x.call(C,ne[1])).done)return x;switch(C=0,x&&(ne=[ne[0]&2,x.value]),ne[0]){case 0:case 1:x=ne;break;case 4:return h.label++,{value:ne[1],done:!1};case 5:h.label++,C=ne[1],ne=[0];continue;case 7:ne=h.ops.pop(),h.trys.pop();continue;default:if(x=h.trys,!(x=x.length>0&&x[x.length-1])&&(ne[0]===6||ne[0]===2)){h=0;continue}if(ne[0]===3&&(!x||ne[1]>x[0]&&ne[1]<x[3])){h.label=ne[1];break}if(ne[0]===6&&h.label<x[1]){h.label=x[1],x=ne;break}if(x&&h.label<x[2]){h.label=x[2],h.ops.push(ne);break}x[2]&&h.ops.pop(),h.trys.pop();continue}ne=a.call(p,h)}catch(we){ne=[6,we],C=0}finally{w=x=0}if(ne[0]&5)throw ne[1];return{value:ne[0]?ne[1]:void 0,done:!0}}},I=function(p,a,h){if(h||arguments.length===2)for(var w=0,C=a.length,x;w<C;w++)(x||!(w in a))&&(x||(x=Array.prototype.slice.call(a,0,w)),x[w]=a[w]);return p.concat(x||Array.prototype.slice.call(a))},$=(function(p){y(a,p);function a(){var h=p!==null&&p.apply(this,arguments)||this;return h.isHandledError=!0,h}return a})(Error),O=function(p){return p&&p.isHandledError?p.message:"Problem loading file; may be corrupt!"},q;(function(p){p.Cover="cover",p.Contain="contain",p.Fill="fill",p.FitWidth="fitWidth",p.FitHeight="fitHeight",p.None="none",p.ScaleDown="scaleDown",p.Layout="layout"})(q||(q={}));var H;(function(p){p.Center="center",p.TopLeft="topLeft",p.TopCenter="topCenter",p.TopRight="topRight",p.CenterLeft="centerLeft",p.CenterRight="centerRight",p.BottomLeft="bottomLeft",p.BottomCenter="bottomCenter",p.BottomRight="bottomRight"})(H||(H={}));var N=(function(){function p(a){var h,w,C,x,F,re,de;this.fit=(h=a?.fit)!==null&&h!==void 0?h:q.Contain,this.alignment=(w=a?.alignment)!==null&&w!==void 0?w:H.Center,this.layoutScaleFactor=(C=a?.layoutScaleFactor)!==null&&C!==void 0?C:1,this.minX=(x=a?.minX)!==null&&x!==void 0?x:0,this.minY=(F=a?.minY)!==null&&F!==void 0?F:0,this.maxX=(re=a?.maxX)!==null&&re!==void 0?re:0,this.maxY=(de=a?.maxY)!==null&&de!==void 0?de:0}return p.new=function(a){var h=a.fit,w=a.alignment,C=a.minX,x=a.minY,F=a.maxX,re=a.maxY;return console.warn("This function is deprecated: please use `new Layout({})` instead"),new p({fit:h,alignment:w,minX:C,minY:x,maxX:F,maxY:re})},p.prototype.copyWith=function(a){var h=a.fit,w=a.alignment,C=a.layoutScaleFactor,x=a.minX,F=a.minY,re=a.maxX,de=a.maxY;return new p({fit:h??this.fit,alignment:w??this.alignment,layoutScaleFactor:C??this.layoutScaleFactor,minX:x??this.minX,minY:F??this.minY,maxX:re??this.maxX,maxY:de??this.maxY})},p.prototype.runtimeFit=function(a){if(this.cachedRuntimeFit)return this.cachedRuntimeFit;var h;return this.fit===q.Cover?h=a.Fit.cover:this.fit===q.Contain?h=a.Fit.contain:this.fit===q.Fill?h=a.Fit.fill:this.fit===q.FitWidth?h=a.Fit.fitWidth:this.fit===q.FitHeight?h=a.Fit.fitHeight:this.fit===q.ScaleDown?h=a.Fit.scaleDown:this.fit===q.Layout?h=a.Fit.layout:h=a.Fit.none,this.cachedRuntimeFit=h,h},p.prototype.runtimeAlignment=function(a){if(this.cachedRuntimeAlignment)return this.cachedRuntimeAlignment;var h;return this.alignment===H.TopLeft?h=a.Alignment.topLeft:this.alignment===H.TopCenter?h=a.Alignment.topCenter:this.alignment===H.TopRight?h=a.Alignment.topRight:this.alignment===H.CenterLeft?h=a.Alignment.centerLeft:this.alignment===H.CenterRight?h=a.Alignment.centerRight:this.alignment===H.BottomLeft?h=a.Alignment.bottomLeft:this.alignment===H.BottomCenter?h=a.Alignment.bottomCenter:this.alignment===H.BottomRight?h=a.Alignment.bottomRight:h=a.Alignment.center,this.cachedRuntimeAlignment=h,h},p})(),G=(function(){function p(){}return p.loadRuntime=function(){c.default({locateFile:function(){return p.wasmURL}}).then(function(a){var h;for(p.runtime=a;p.callBackQueue.length>0;)(h=p.callBackQueue.shift())===null||h===void 0||h(p.runtime)}).catch(function(a){var h={message:a?.message||"Unknown error",type:a?.name||"Error",wasmError:a instanceof WebAssembly.CompileError||a instanceof WebAssembly.RuntimeError,originalError:a};console.debug("Rive WASM load error details:",h);var w="https://cdn.jsdelivr.net/npm/".concat(d.name,"@").concat(d.version,"/rive_fallback.wasm");if(p.wasmURL.toLowerCase()!==w)console.warn("Failed to load WASM from ".concat(p.wasmURL," (").concat(h.message,"), trying jsdelivr as a backup")),p.setWasmUrl(w),p.loadRuntime();else{var C=["Could not load Rive WASM file from ".concat(p.wasmURL," or ").concat(w,"."),"Possible reasons:","- Network connection is down","- WebAssembly is not supported in this environment","- The WASM file is corrupted or incompatible",`
Error details:`,"- Type: ".concat(h.type),"- Message: ".concat(h.message),"- WebAssembly-specific error: ".concat(h.wasmError),`
To resolve, you may need to:`,"1. Check your network connection","2. Set a new WASM source via RuntimeLoader.setWasmUrl()","3. Call RuntimeLoader.loadRuntime() again"].join(`
`);console.error(C)}})},p.getInstance=function(a){p.isLoading||(p.isLoading=!0,p.loadRuntime()),p.runtime?a(p.runtime):p.callBackQueue.push(a)},p.awaitInstance=function(){return new Promise(function(a){return p.getInstance(function(h){return a(h)})})},p.setWasmUrl=function(a){p.wasmURL=a},p.getWasmUrl=function(){return p.wasmURL},p.isLoading=!1,p.callBackQueue=[],p.wasmURL="https://unpkg.com/".concat(d.name,"@").concat(d.version,"/rive.wasm"),p})(),K;(function(p){p[p.Number=56]="Number",p[p.Trigger=58]="Trigger",p[p.Boolean=59]="Boolean"})(K||(K={}));var j=(function(){function p(a,h){this.type=a,this.runtimeInput=h}return Object.defineProperty(p.prototype,"name",{get:function(){return this.runtimeInput.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"value",{get:function(){return this.runtimeInput.value},set:function(a){this.runtimeInput.value=a},enumerable:!1,configurable:!0}),p.prototype.fire=function(){this.type===K.Trigger&&this.runtimeInput.fire()},p.prototype.delete=function(){this.runtimeInput=null},p})(),L;(function(p){p[p.General=128]="General",p[p.OpenUrl=131]="OpenUrl"})(L||(L={}));var ie=(function(){function p(a){this.nativeArtboard=a}return p})(),ue=(function(){function p(a,h,w,C){this.stateMachine=a,this.playing=w,this.artboard=C,this.inputs=[],this.instance=new h.StateMachineInstance(a,C),this.initInputs(h)}return Object.defineProperty(p.prototype,"name",{get:function(){return this.stateMachine.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"statesChanged",{get:function(){for(var a=[],h=0;h<this.instance.stateChangedCount();h++)a.push(this.instance.stateChangedNameByIndex(h));return a},enumerable:!1,configurable:!0}),p.prototype.advance=function(a){this.instance.advance(a)},p.prototype.advanceAndApply=function(a){this.instance.advanceAndApply(a)},p.prototype.reportedEventCount=function(){return this.instance.reportedEventCount()},p.prototype.reportedEventAt=function(a){return this.instance.reportedEventAt(a)},p.prototype.initInputs=function(a){for(var h=0;h<this.instance.inputCount();h++){var w=this.instance.input(h);this.inputs.push(this.mapRuntimeInput(w,a))}},p.prototype.mapRuntimeInput=function(a,h){if(a.type===h.SMIInput.bool)return new j(K.Boolean,a.asBool());if(a.type===h.SMIInput.number)return new j(K.Number,a.asNumber());if(a.type===h.SMIInput.trigger)return new j(K.Trigger,a.asTrigger())},p.prototype.cleanup=function(){this.inputs.forEach(function(a){a.delete()}),this.inputs.length=0,this.instance.delete()},p.prototype.bindViewModelInstance=function(a){a.runtimeInstance!=null&&this.instance.bindViewModelInstance(a.runtimeInstance)},p})(),ae=(function(){function p(a,h,w,C,x){C===void 0&&(C=[]),x===void 0&&(x=[]),this.runtime=a,this.artboard=h,this.eventManager=w,this.animations=C,this.stateMachines=x}return p.prototype.add=function(a,h,w){if(w===void 0&&(w=!0),a=Et(a),a.length===0)this.animations.forEach(function(We){return We.playing=h}),this.stateMachines.forEach(function(We){return We.playing=h});else for(var C=this.animations.map(function(We){return We.name}),x=this.stateMachines.map(function(We){return We.name}),F=0;F<a.length;F++){var re=C.indexOf(a[F]),de=x.indexOf(a[F]);if(re>=0||de>=0)re>=0?this.animations[re].playing=h:this.stateMachines[de].playing=h;else{var ne=this.artboard.animationByName(a[F]);if(ne){var we=new v.Animation(ne,this.artboard,this.runtime,h);we.advance(0),we.apply(1),this.animations.push(we)}else{var Me=this.artboard.stateMachineByName(a[F]);if(Me){var rt=new ue(Me,this.runtime,h,this.artboard);this.stateMachines.push(rt)}}}}return w&&(h?this.eventManager.fire({type:X.Play,data:this.playing}):this.eventManager.fire({type:X.Pause,data:this.paused})),h?this.playing:this.paused},p.prototype.initLinearAnimations=function(a,h){for(var w=this.animations.map(function(de){return de.name}),C=0;C<a.length;C++){var x=w.indexOf(a[C]);if(x>=0)this.animations[x].playing=h;else{var F=this.artboard.animationByName(a[C]);if(F){var re=new v.Animation(F,this.artboard,this.runtime,h);re.advance(0),re.apply(1),this.animations.push(re)}else console.error("Animation with name ".concat(a[C]," not found."))}}},p.prototype.initStateMachines=function(a,h){for(var w=this.stateMachines.map(function(de){return de.name}),C=0;C<a.length;C++){var x=w.indexOf(a[C]);if(x>=0)this.stateMachines[x].playing=h;else{var F=this.artboard.stateMachineByName(a[C]);if(F){var re=new ue(F,this.runtime,h,this.artboard);this.stateMachines.push(re),h||re.advanceAndApply(0)}else console.warn("State Machine with name ".concat(a[C]," not found.")),this.initLinearAnimations([a[C]],h)}}},p.prototype.play=function(a){return this.add(a,!0)},p.prototype.pause=function(a){return this.add(a,!1)},p.prototype.scrub=function(a,h){var w=this.animations.filter(function(C){return a.includes(C.name)});return w.forEach(function(C){return C.scrubTo=h}),w.map(function(C){return C.name})},Object.defineProperty(p.prototype,"playing",{get:function(){return this.animations.filter(function(a){return a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"paused",{get:function(){return this.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}).concat(this.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}))},enumerable:!1,configurable:!0}),p.prototype.stop=function(a){var h=this;a=Et(a);var w=[];if(a.length===0)w=this.animations.map(function(F){return F.name}).concat(this.stateMachines.map(function(F){return F.name})),this.animations.forEach(function(F){return F.cleanup()}),this.stateMachines.forEach(function(F){return F.cleanup()}),this.animations.splice(0,this.animations.length),this.stateMachines.splice(0,this.stateMachines.length);else{var C=this.animations.filter(function(F){return a.includes(F.name)});C.forEach(function(F){F.cleanup(),h.animations.splice(h.animations.indexOf(F),1)});var x=this.stateMachines.filter(function(F){return a.includes(F.name)});x.forEach(function(F){F.cleanup(),h.stateMachines.splice(h.stateMachines.indexOf(F),1)}),w=C.map(function(F){return F.name}).concat(x.map(function(F){return F.name}))}return this.eventManager.fire({type:X.Stop,data:w}),w},Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animations.reduce(function(a,h){return a||h.playing},!1)||this.stateMachines.reduce(function(a,h){return a||h.playing},!1)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return!this.isPlaying&&(this.animations.length>0||this.stateMachines.length>0)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animations.length===0&&this.stateMachines.length===0},enumerable:!1,configurable:!0}),p.prototype.atLeastOne=function(a,h){h===void 0&&(h=!0);var w;return this.animations.length===0&&this.stateMachines.length===0&&(this.artboard.animationCount()>0?this.add([w=this.artboard.animationByIndex(0).name],a,h):this.artboard.stateMachineCount()>0&&this.add([w=this.artboard.stateMachineByIndex(0).name],a,h)),w},p.prototype.handleLooping=function(){for(var a=0,h=this.animations.filter(function(C){return C.playing});a<h.length;a++){var w=h[a];w.loopValue===0&&w.loopCount?(w.loopCount=0,this.stop(w.name)):w.loopValue===1&&w.loopCount?(this.eventManager.fire({type:X.Loop,data:{animation:w.name,type:he.Loop}}),w.loopCount=0):w.loopValue===2&&w.loopCount>1&&(this.eventManager.fire({type:X.Loop,data:{animation:w.name,type:he.PingPong}}),w.loopCount=0)}},p.prototype.handleStateChanges=function(){for(var a=[],h=0,w=this.stateMachines.filter(function(x){return x.playing});h<w.length;h++){var C=w[h];a.push.apply(a,C.statesChanged)}a.length>0&&this.eventManager.fire({type:X.StateChange,data:a})},p.prototype.handleAdvancing=function(a){this.eventManager.fire({type:X.Advance,data:a})},p})(),X;(function(p){p.Load="load",p.LoadError="loaderror",p.Play="play",p.Pause="pause",p.Stop="stop",p.Loop="loop",p.Draw="draw",p.Advance="advance",p.StateChange="statechange",p.RiveEvent="riveevent",p.AudioStatusChange="audiostatuschange"})(X||(X={}));var he;(function(p){p.OneShot="oneshot",p.Loop="loop",p.PingPong="pingpong"})(he||(he={}));var Ne=(function(){function p(a){a===void 0&&(a=[]),this.listeners=a}return p.prototype.getListeners=function(a){return this.listeners.filter(function(h){return h.type===a})},p.prototype.add=function(a){this.listeners.includes(a)||this.listeners.push(a)},p.prototype.remove=function(a){for(var h=0;h<this.listeners.length;h++){var w=this.listeners[h];if(w.type===a.type&&w.callback===a.callback){this.listeners.splice(h,1);break}}},p.prototype.removeAll=function(a){var h=this;a?this.listeners.filter(function(w){return w.type===a}).forEach(function(w){return h.remove(w)}):this.listeners.splice(0,this.listeners.length)},p.prototype.fire=function(a){var h=this.getListeners(a.type);h.forEach(function(w){return w.callback(a)})},p})(),Ke=(function(){function p(a){this.eventManager=a,this.queue=[]}return p.prototype.add=function(a){this.queue.push(a)},p.prototype.process=function(){for(;this.queue.length>0;){var a=this.queue.shift();a?.action&&a.action(),a?.event&&this.eventManager.fire(a.event)}},p})(),Ve;(function(p){p[p.AVAILABLE=0]="AVAILABLE",p[p.UNAVAILABLE=1]="UNAVAILABLE"})(Ve||(Ve={}));var gt=(function(p){y(a,p);function a(){var h=p!==null&&p.apply(this,arguments)||this;return h._started=!1,h._enabled=!1,h._status=Ve.UNAVAILABLE,h}return a.prototype.delay=function(h){return E(this,void 0,void 0,function(){return m(this,function(w){return[2,new Promise(function(C){return setTimeout(C,h)})]})})},a.prototype.timeout=function(){return E(this,void 0,void 0,function(){return m(this,function(h){return[2,new Promise(function(w,C){return setTimeout(C,50)})]})})},a.prototype.reportToListeners=function(){this.fire({type:X.AudioStatusChange}),this.removeAll()},a.prototype.enableAudio=function(){return E(this,void 0,void 0,function(){return m(this,function(h){return this._enabled||(this._enabled=!0,this._status=Ve.AVAILABLE,this.reportToListeners()),[2]})})},a.prototype.testAudio=function(){return E(this,void 0,void 0,function(){return m(this,function(h){switch(h.label){case 0:if(!(this._status===Ve.UNAVAILABLE&&this._audioContext!==null))return[3,4];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,Promise.race([this._audioContext.resume(),this.timeout()])];case 2:return h.sent(),this.enableAudio(),[3,4];case 3:return h.sent(),[3,4];case 4:return[2]}})})},a.prototype._establishAudio=function(){return E(this,void 0,void 0,function(){return m(this,function(h){switch(h.label){case 0:return this._started?[3,5]:(this._started=!0,typeof window>"u"?(this.enableAudio(),[3,5]):[3,1]);case 1:this._audioContext=new AudioContext,this.listenForUserAction(),h.label=2;case 2:return this._status!==Ve.UNAVAILABLE?[3,5]:[4,this.testAudio()];case 3:return h.sent(),[4,this.delay(1e3)];case 4:return h.sent(),[3,2];case 5:return[2]}})})},a.prototype.listenForUserAction=function(){var h=this,w=function(){return E(h,void 0,void 0,function(){return m(this,function(C){return this.enableAudio(),[2]})})};document.addEventListener("pointerdown",w,{once:!0})},a.prototype.establishAudio=function(){return E(this,void 0,void 0,function(){return m(this,function(h){return this._establishAudio(),[2]})})},Object.defineProperty(a.prototype,"systemVolume",{get:function(){return this._status===Ve.UNAVAILABLE?(this.testAudio(),0):1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),a})(Ne),Ee=new gt,un=(function(){function p(){}return p.prototype.observe=function(){},p.prototype.unobserve=function(){},p.prototype.disconnect=function(){},p})(),tt=globalThis.ResizeObserver||un,qe=(function(){function p(){var a=this;this._elementsMap=new Map,this._onObservedEntry=function(h){var w=a._elementsMap.get(h.target);w!==null?w.onResize(h.target.clientWidth==0||h.target.clientHeight==0):a._resizeObserver.unobserve(h.target)},this._onObserved=function(h){h.forEach(a._onObservedEntry)},this._resizeObserver=new tt(this._onObserved)}return p.prototype.add=function(a,h){var w={onResize:h,element:a};return this._elementsMap.set(a,w),this._resizeObserver.observe(a),w},p.prototype.remove=function(a){this._resizeObserver.unobserve(a.element),this._elementsMap.delete(a.element)},p})(),nt=new qe,Pt=(function(){function p(a){this.enableRiveAssetCDN=!0,this.referenceCount=0,this.destroyed=!1,this.src=a.src,this.buffer=a.buffer,a.assetLoader&&(this.assetLoader=a.assetLoader),this.enableRiveAssetCDN=typeof a.enableRiveAssetCDN=="boolean"?a.enableRiveAssetCDN:!0,this.eventManager=new Ne,a.onLoad&&this.on(X.Load,a.onLoad),a.onLoadError&&this.on(X.LoadError,a.onLoadError)}return p.prototype.initData=function(){return E(this,void 0,void 0,function(){var a,h,w,C,x;return m(this,function(F){switch(F.label){case 0:return this.src?(a=this,[4,yr(this.src)]):[3,2];case 1:a.buffer=F.sent(),F.label=2;case 2:return this.destroyed?[2]:(this.assetLoader&&(w=new g.CustomFileAssetLoaderWrapper(this.runtime,this.assetLoader),h=w.assetLoader),C=this,[4,this.runtime.load(new Uint8Array(this.buffer),h,this.enableRiveAssetCDN)]);case 3:return C.file=F.sent(),this.destroyed?((x=this.file)===null||x===void 0||x.delete(),this.file=null,[2]):(this.file!==null?this.eventManager.fire({type:X.Load,data:this}):this.fireLoadError(p.fileLoadErrorMessage),[2])}})})},p.prototype.init=function(){return E(this,void 0,void 0,function(){var a,h;return m(this,function(w){switch(w.label){case 0:if(!this.src&&!this.buffer)return this.fireLoadError(p.missingErrorMessage),[2];w.label=1;case 1:return w.trys.push([1,4,,5]),a=this,[4,G.awaitInstance()];case 2:return a.runtime=w.sent(),this.destroyed?[2]:[4,this.initData()];case 3:return w.sent(),[3,5];case 4:return h=w.sent(),this.fireLoadError(h instanceof Error?h.message:p.fileLoadErrorMessage),[3,5];case 5:return[2]}})})},p.prototype.fireLoadError=function(a){throw this.eventManager.fire({type:X.LoadError,data:a}),new Error(a)},p.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},p.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},p.prototype.cleanup=function(){var a;this.referenceCount-=1,this.referenceCount<=0&&(this.removeAllRiveEventListeners(),(a=this.file)===null||a===void 0||a.delete(),this.file=null,this.destroyed=!0)},p.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},p.prototype.getInstance=function(){if(this.file!==null)return this.referenceCount+=1,this.file},p.prototype.destroyIfUnused=function(){this.referenceCount<=0&&this.cleanup()},p.prototype.getArtboard=function(a){var h=this.file.artboardByName(a);return h!=null?new ie(h):null},p.missingErrorMessage="Rive source file or data buffer required",p.fileLoadErrorMessage="The file failed to load",p})(),Se=(function(){function p(a){var h=this,w;this.loaded=!1,this.destroyed=!1,this._observed=null,this.readyForPlaying=!1,this.artboard=null,this.eventCleanup=null,this.shouldDisableRiveListeners=!1,this.automaticallyHandleEvents=!1,this.enableRiveAssetCDN=!0,this._volume=1,this._artboardWidth=void 0,this._artboardHeight=void 0,this._devicePixelRatioUsed=1,this._hasZeroSize=!1,this._audioEventListener=null,this._boundDraw=null,this._viewModelInstance=null,this._dataEnums=null,this.durations=[],this.frameTimes=[],this.frameCount=0,this.isTouchScrollEnabled=!1,this.onCanvasResize=function(C){var x=h._hasZeroSize!==C;h._hasZeroSize=C,C?(!h._layout.maxX||!h._layout.maxY)&&h.resizeToCanvas():x&&h.resizeDrawingSurfaceToCanvas()},this.renderSecondTimer=0,this._boundDraw=this.draw.bind(this),this.canvas=a.canvas,a.canvas.constructor===HTMLCanvasElement&&(this._observed=nt.add(this.canvas,this.onCanvasResize)),this.src=a.src,this.buffer=a.buffer,this.riveFile=a.riveFile,this.layout=(w=a.layout)!==null&&w!==void 0?w:new N,this.shouldDisableRiveListeners=!!a.shouldDisableRiveListeners,this.isTouchScrollEnabled=!!a.isTouchScrollEnabled,this.automaticallyHandleEvents=!!a.automaticallyHandleEvents,this.enableRiveAssetCDN=a.enableRiveAssetCDN===void 0?!0:a.enableRiveAssetCDN,this.eventManager=new Ne,a.onLoad&&this.on(X.Load,a.onLoad),a.onLoadError&&this.on(X.LoadError,a.onLoadError),a.onPlay&&this.on(X.Play,a.onPlay),a.onPause&&this.on(X.Pause,a.onPause),a.onStop&&this.on(X.Stop,a.onStop),a.onLoop&&this.on(X.Loop,a.onLoop),a.onStateChange&&this.on(X.StateChange,a.onStateChange),a.onAdvance&&this.on(X.Advance,a.onAdvance),a.onload&&!a.onLoad&&this.on(X.Load,a.onload),a.onloaderror&&!a.onLoadError&&this.on(X.LoadError,a.onloaderror),a.onplay&&!a.onPlay&&this.on(X.Play,a.onplay),a.onpause&&!a.onPause&&this.on(X.Pause,a.onpause),a.onstop&&!a.onStop&&this.on(X.Stop,a.onstop),a.onloop&&!a.onLoop&&this.on(X.Loop,a.onloop),a.onstatechange&&!a.onStateChange&&this.on(X.StateChange,a.onstatechange),a.assetLoader&&(this.assetLoader=a.assetLoader),this.taskQueue=new Ke(this.eventManager),this.init({src:this.src,buffer:this.buffer,riveFile:this.riveFile,autoplay:a.autoplay,autoBind:a.autoBind,animations:a.animations,stateMachines:a.stateMachines,artboard:a.artboard,useOffscreenRenderer:a.useOffscreenRenderer})}return Object.defineProperty(p.prototype,"viewModelCount",{get:function(){return this.file.viewModelCount()},enumerable:!1,configurable:!0}),p.new=function(a){return console.warn("This function is deprecated: please use `new Rive({})` instead"),new p(a)},p.prototype.onSystemAudioChanged=function(){this.volume=this._volume},p.prototype.init=function(a){var h=this,w=a.src,C=a.buffer,x=a.riveFile,F=a.animations,re=a.stateMachines,de=a.artboard,ne=a.autoplay,we=ne===void 0?!1:ne,Me=a.useOffscreenRenderer,rt=Me===void 0?!1:Me,We=a.autoBind,At=We===void 0?!1:We;if(!this.destroyed){if(this.src=w,this.buffer=C,this.riveFile=x,!this.src&&!this.buffer&&!this.riveFile)throw new $(p.missingErrorMessage);var St=Et(F),_t=Et(re);this.loaded=!1,this.readyForPlaying=!1,G.awaitInstance().then(function(ft){h.destroyed||(h.runtime=ft,h.removeRiveListeners(),h.deleteRiveRenderer(),h.renderer=h.runtime.makeRenderer(h.canvas,rt),h.canvas.width||h.canvas.height||h.resizeDrawingSurfaceToCanvas(),h.initData(de,St,_t,we,At).then(function(Ct){if(Ct)return h.setupRiveListeners()}).catch(function(Ct){console.error(Ct)}))}).catch(function(ft){console.error(ft)})}},p.prototype.setupRiveListeners=function(a){var h=this;if(this.eventCleanup&&this.eventCleanup(),!this.shouldDisableRiveListeners){var w=(this.animator.stateMachines||[]).filter(function(x){return x.playing&&h.runtime.hasListeners(x.instance)}).map(function(x){return x.instance}),C=this.isTouchScrollEnabled;a&&"isTouchScrollEnabled"in a&&(C=a.isTouchScrollEnabled),this.eventCleanup=(0,g.registerTouchInteractions)({canvas:this.canvas,artboard:this.artboard,stateMachines:w,renderer:this.renderer,rive:this.runtime,fit:this._layout.runtimeFit(this.runtime),alignment:this._layout.runtimeAlignment(this.runtime),isTouchScrollEnabled:C,layoutScaleFactor:this._layout.layoutScaleFactor})}},p.prototype.removeRiveListeners=function(){this.eventCleanup&&(this.eventCleanup(),this.eventCleanup=null)},p.prototype.initializeAudio=function(){var a=this,h;Ee.status==Ve.UNAVAILABLE&&!((h=this.artboard)===null||h===void 0)&&h.hasAudio&&this._audioEventListener===null&&(this._audioEventListener={type:X.AudioStatusChange,callback:function(){return a.onSystemAudioChanged()}},Ee.add(this._audioEventListener),Ee.establishAudio())},p.prototype.initArtboardSize=function(){this.artboard&&(this._artboardWidth=this.artboard.width=this._artboardWidth||this.artboard.width,this._artboardHeight=this.artboard.height=this._artboardHeight||this.artboard.height)},p.prototype.initData=function(a,h,w,C,x){return E(this,void 0,void 0,function(){var F,re,de,ne;return m(this,function(we){switch(we.label){case 0:return we.trys.push([0,3,,4]),this.riveFile!=null?[3,2]:(F=new Pt({src:this.src,buffer:this.buffer,enableRiveAssetCDN:this.enableRiveAssetCDN,assetLoader:this.assetLoader}),this.riveFile=F,[4,F.init()]);case 1:if(we.sent(),this.destroyed)return F.destroyIfUnused(),[2,!1];we.label=2;case 2:return this.file=this.riveFile.getInstance(),this.initArtboard(a,h,w,C,x),this.initArtboardSize(),this.initializeAudio(),this.loaded=!0,this.eventManager.fire({type:X.Load,data:(ne=this.src)!==null&&ne!==void 0?ne:"buffer"}),this.readyForPlaying=!0,this.taskQueue.process(),this.drawFrame(),[2,!0];case 3:return re=we.sent(),de=O(re),console.warn(de),this.eventManager.fire({type:X.LoadError,data:de}),[2,Promise.reject(de)];case 4:return[2]}})})},p.prototype.initArtboard=function(a,h,w,C,x){if(this.file){var F=a?this.file.artboardByName(a):this.file.defaultArtboard();if(!F){var re="Invalid artboard name or no default artboard";console.warn(re),this.eventManager.fire({type:X.LoadError,data:re});return}if(this.artboard=F,F.volume=this._volume*Ee.systemVolume,this.artboard.animationCount()<1){var re="Artboard has no animations";throw this.eventManager.fire({type:X.LoadError,data:re}),re}this.animator=new ae(this.runtime,this.artboard,this.eventManager);var de;if(h.length>0||w.length>0?(de=h.concat(w),this.animator.initLinearAnimations(h,C),this.animator.initStateMachines(w,C)):de=[this.animator.atLeastOne(C,!1)],this.taskQueue.add({event:{type:C?X.Play:X.Pause,data:de}}),x){var ne=this.file.defaultArtboardViewModel(F);if(ne!==null){var we=ne.defaultInstance();if(we!==null){var Me=new kt(we,null);this.bindViewModelInstance(Me)}}}}},p.prototype.drawFrame=function(){var a,h;!((a=document?.timeline)===null||a===void 0)&&a.currentTime?this.loaded&&this.artboard&&!this.frameRequestId&&(this._boundDraw(document.timeline.currentTime),(h=this.runtime)===null||h===void 0||h.resolveAnimationFrame()):this.startRendering()},p.prototype.draw=function(a,h){var w;this.frameRequestId=null;var C=performance.now();this.lastRenderTime||(this.lastRenderTime=a),this.renderSecondTimer+=a-this.lastRenderTime,this.renderSecondTimer>5e3&&(this.renderSecondTimer=0,h?.());var x=(a-this.lastRenderTime)/1e3;this.lastRenderTime=a;for(var F=this.animator.animations.filter(function(Vt){return Vt.playing||Vt.needsScrub}).sort(function(Vt){return Vt.needsScrub?-1:1}),re=0,de=F;re<de.length;re++){var ne=de[re];ne.advance(x),ne.instance.didLoop&&(ne.loopCount+=1),ne.apply(1)}for(var we=this.animator.stateMachines.filter(function(Vt){return Vt.playing}),Me=0,rt=we;Me<rt.length;Me++){var We=rt[Me],At=We.reportedEventCount();if(At)for(var St=0;St<At;St++){var _t=We.reportedEventAt(St);if(_t)if(_t.type===L.OpenUrl){if(this.eventManager.fire({type:X.RiveEvent,data:_t}),this.automaticallyHandleEvents){var ft=document.createElement("a"),Ct=_t,dn=Ct.url,fn=Ct.target,$t=(0,g.sanitizeUrl)(dn);dn&&ft.setAttribute("href",$t),fn&&ft.setAttribute("target",fn),$t&&$t!==g.BLANK_URL&&ft.click()}}else this.eventManager.fire({type:X.RiveEvent,data:_t})}We.advanceAndApply(x)}this.animator.stateMachines.length==0&&this.artboard.advance(x);var le=this.renderer;le.clear(),le.save(),this.alignRenderer(),this._hasZeroSize||this.artboard.draw(le),le.restore(),le.flush(),this.animator.handleLooping(),this.animator.handleStateChanges(),this.animator.handleAdvancing(x),this.frameCount++;var Ce=performance.now();for(this.frameTimes.push(Ce),this.durations.push(Ce-C);this.frameTimes[0]<=Ce-1e3;)this.frameTimes.shift(),this.durations.shift();(w=this._viewModelInstance)===null||w===void 0||w.handleCallbacks(),this.animator.isPlaying?this.startRendering():this.animator.isPaused?this.lastRenderTime=0:this.animator.isStopped&&(this.lastRenderTime=0)},p.prototype.alignRenderer=function(){var a=this,h=a.renderer,w=a.runtime,C=a._layout,x=a.artboard;h.align(C.runtimeFit(w),C.runtimeAlignment(w),{minX:C.minX,minY:C.minY,maxX:C.maxX,maxY:C.maxY},x.bounds,this._devicePixelRatioUsed*C.layoutScaleFactor)},Object.defineProperty(p.prototype,"fps",{get:function(){return this.durations.length},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"frameTime",{get:function(){return this.durations.length===0?0:(this.durations.reduce(function(a,h){return a+h},0)/this.durations.length).toFixed(4)},enumerable:!1,configurable:!0}),p.prototype.cleanup=function(){var a,h;this.destroyed=!0,this.stopRendering(),this.cleanupInstances(),this._observed!==null&&nt.remove(this._observed),this.removeRiveListeners(),this.file&&((a=this.riveFile)===null||a===void 0||a.cleanup(),this.file=null),this.riveFile=null,this.deleteRiveRenderer(),this._audioEventListener!==null&&(Ee.remove(this._audioEventListener),this._audioEventListener=null),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=null,this._dataEnums=null},p.prototype.deleteRiveRenderer=function(){var a;(a=this.renderer)===null||a===void 0||a.delete(),this.renderer=null},p.prototype.cleanupInstances=function(){this.eventCleanup!==null&&this.eventCleanup(),this.stop(),this.artboard&&(this.artboard.delete(),this.artboard=null)},p.prototype.retrieveTextRun=function(a){var h;if(!a){console.warn("No text run name provided");return}if(!this.artboard){console.warn("Tried to access text run, but the Artboard is null");return}var w=this.artboard.textRun(a);if(!w){console.warn("Could not access a text run with name '".concat(a,"' in the '").concat((h=this.artboard)===null||h===void 0?void 0:h.name,"' Artboard. Note that you must rename a text run node in the Rive editor to make it queryable at runtime."));return}return w},p.prototype.getTextRunValue=function(a){var h=this.retrieveTextRun(a);return h?h.text:void 0},p.prototype.setTextRunValue=function(a,h){var w=this.retrieveTextRun(a);w&&(w.text=h)},p.prototype.play=function(a,h){var w=this;if(a=Et(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.play(a,h)}});return}this.animator.play(a),this.eventCleanup&&this.eventCleanup(),this.setupRiveListeners(),this.startRendering()},p.prototype.pause=function(a){var h=this;if(a=Et(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.pause(a)}});return}this.eventCleanup&&this.eventCleanup(),this.animator.pause(a)},p.prototype.scrub=function(a,h){var w=this;if(a=Et(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return w.scrub(a,h)}});return}this.animator.scrub(a,h||0),this.drawFrame()},p.prototype.stop=function(a){var h=this;if(a=Et(a),!this.readyForPlaying){this.taskQueue.add({action:function(){return h.stop(a)}});return}this.animator&&this.animator.stop(a),this.eventCleanup&&this.eventCleanup()},p.prototype.reset=function(a){var h,w,C=a?.artboard,x=Et(a?.animations),F=Et(a?.stateMachines),re=(h=a?.autoplay)!==null&&h!==void 0?h:!1,de=(w=a?.autoBind)!==null&&w!==void 0?w:!1;this.cleanupInstances(),this.initArtboard(C,x,F,re,de),this.taskQueue.process()},p.prototype.load=function(a){this.file=null,this.stop(),this.init(a)},Object.defineProperty(p.prototype,"layout",{get:function(){return this._layout},set:function(a){this._layout=a,(!a.maxX||!a.maxY)&&this.resizeToCanvas(),this.loaded&&!this.animator.isPlaying&&this.drawFrame()},enumerable:!1,configurable:!0}),p.prototype.resizeToCanvas=function(){this._layout=this.layout.copyWith({minX:0,minY:0,maxX:this.canvas.width,maxY:this.canvas.height})},p.prototype.resizeDrawingSurfaceToCanvas=function(a){if(this.canvas instanceof HTMLCanvasElement&&window){var h=this.canvas.getBoundingClientRect(),w=h.width,C=h.height,x=a||window.devicePixelRatio||1;if(this.devicePixelRatioUsed=x,this.canvas.width=x*w,this.canvas.height=x*C,this.resizeToCanvas(),this.drawFrame(),this.layout.fit===q.Layout){var F=this._layout.layoutScaleFactor;this.artboard.width=w/F,this.artboard.height=C/F}}},Object.defineProperty(p.prototype,"source",{get:function(){return this.src},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeArtboard",{get:function(){return this.artboard?this.artboard.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"animationNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.animationCount();h++)a.push(this.artboard.animationByIndex(h).name);return a},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"stateMachineNames",{get:function(){if(!this.loaded||!this.artboard)return[];for(var a=[],h=0;h<this.artboard.stateMachineCount();h++)a.push(this.artboard.stateMachineByIndex(h).name);return a},enumerable:!1,configurable:!0}),p.prototype.stateMachineInputs=function(a){if(this.loaded){var h=this.animator.stateMachines.find(function(w){return w.name===a});return h?.inputs}},p.prototype.retrieveInputAtPath=function(a,h){if(!a){console.warn("No input name provided for path '".concat(h,"'"));return}if(!this.artboard){console.warn("Tried to access input: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.inputByPath(a,h);if(!w){console.warn("Could not access an input with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},p.prototype.setBooleanStateAtPath=function(a,h,w){var C=this.retrieveInputAtPath(a,w);C&&(C.type===K.Boolean?C.asBool().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a boolean")))},p.prototype.setNumberStateAtPath=function(a,h,w){var C=this.retrieveInputAtPath(a,w);C&&(C.type===K.Number?C.asNumber().value=h:console.warn("Input with name: '".concat(a,"', at path:'").concat(w,"' is not a number")))},p.prototype.fireStateAtPath=function(a,h){var w=this.retrieveInputAtPath(a,h);w&&(w.type===K.Trigger?w.asTrigger().fire():console.warn("Input with name: '".concat(a,"', at path:'").concat(h,"' is not a trigger")))},p.prototype.retrieveTextAtPath=function(a,h){if(!a){console.warn("No text name provided for path '".concat(h,"'"));return}if(!h){console.warn("No path provided for text '".concat(a,"'"));return}if(!this.artboard){console.warn("Tried to access text: '".concat(a,"', at path: '").concat(h,"', but the Artboard is null"));return}var w=this.artboard.textByPath(a,h);if(!w){console.warn("Could not access text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w},p.prototype.getTextRunValueAtPath=function(a,h){var w=this.retrieveTextAtPath(a,h);if(!w){console.warn("Could not get text with name: '".concat(a,"', at path:'").concat(h,"'"));return}return w.text},p.prototype.setTextRunValueAtPath=function(a,h,w){var C=this.retrieveTextAtPath(a,w);if(!C){console.warn("Could not set text with name: '".concat(a,"', at path:'").concat(w,"'"));return}C.text=h},Object.defineProperty(p.prototype,"playingStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"playingAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedAnimationNames",{get:function(){return this.loaded?this.animator.animations.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"pausedStateMachineNames",{get:function(){return this.loaded?this.animator.stateMachines.filter(function(a){return!a.playing}).map(function(a){return a.name}):[]},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPlaying",{get:function(){return this.animator.isPlaying},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isPaused",{get:function(){return this.animator.isPaused},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"isStopped",{get:function(){return this.animator.isStopped},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"bounds",{get:function(){return this.artboard?this.artboard.bounds:void 0},enumerable:!1,configurable:!0}),p.prototype.on=function(a,h){this.eventManager.add({type:a,callback:h})},p.prototype.off=function(a,h){this.eventManager.remove({type:a,callback:h})},p.prototype.unsubscribe=function(a,h){console.warn("This function is deprecated: please use `off()` instead."),this.off(a,h)},p.prototype.removeAllRiveEventListeners=function(a){this.eventManager.removeAll(a)},p.prototype.unsubscribeAll=function(a){console.warn("This function is deprecated: please use `removeAllRiveEventListeners()` instead."),this.removeAllRiveEventListeners(a)},p.prototype.stopRendering=function(){this.loaded&&this.frameRequestId&&(this.runtime.cancelAnimationFrame?this.runtime.cancelAnimationFrame(this.frameRequestId):cancelAnimationFrame(this.frameRequestId),this.frameRequestId=null)},p.prototype.startRendering=function(){this.loaded&&this.artboard&&!this.frameRequestId&&(this.runtime.requestAnimationFrame?this.frameRequestId=this.runtime.requestAnimationFrame(this._boundDraw):this.frameRequestId=requestAnimationFrame(this._boundDraw))},p.prototype.enableFPSCounter=function(a){this.runtime.enableFPSCounter(a)},p.prototype.disableFPSCounter=function(){this.runtime.disableFPSCounter()},Object.defineProperty(p.prototype,"contents",{get:function(){if(this.loaded){for(var a={artboards:[]},h=0;h<this.file.artboardCount();h++){for(var w=this.file.artboardByIndex(h),C={name:w.name,animations:[],stateMachines:[]},x=0;x<w.animationCount();x++){var F=w.animationByIndex(x);C.animations.push(F.name)}for(var re=0;re<w.stateMachineCount();re++){for(var de=w.stateMachineByIndex(re),ne=de.name,we=new this.runtime.StateMachineInstance(de,w),Me=[],rt=0;rt<we.inputCount();rt++){var We=we.input(rt);Me.push({name:We.name,type:We.type})}C.stateMachines.push({name:ne,inputs:Me})}a.artboards.push(C)}return a}},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"volume",{get:function(){return this.artboard&&this.artboard.volume!==this._volume&&(this._volume=this.artboard.volume),this._volume},set:function(a){this._volume=a,this.artboard&&(this.artboard.volume=a*Ee.systemVolume)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardWidth",{get:function(){var a;return this.artboard?this.artboard.width:(a=this._artboardWidth)!==null&&a!==void 0?a:0},set:function(a){this._artboardWidth=a,this.artboard&&(this.artboard.width=a)},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"artboardHeight",{get:function(){var a;return this.artboard?this.artboard.height:(a=this._artboardHeight)!==null&&a!==void 0?a:0},set:function(a){this._artboardHeight=a,this.artboard&&(this.artboard.height=a)},enumerable:!1,configurable:!0}),p.prototype.resetArtboardSize=function(){this.artboard?(this.artboard.resetArtboardSize(),this._artboardWidth=this.artboard.width,this._artboardHeight=this.artboard.height):(this._artboardWidth=void 0,this._artboardHeight=void 0)},Object.defineProperty(p.prototype,"devicePixelRatioUsed",{get:function(){return this._devicePixelRatioUsed},set:function(a){this._devicePixelRatioUsed=a},enumerable:!1,configurable:!0}),p.prototype.bindViewModelInstance=function(a){var h;this.artboard&&!this.destroyed&&a&&a.runtimeInstance&&(a.internalIncrementReferenceCount(),(h=this._viewModelInstance)===null||h===void 0||h.cleanup(),this._viewModelInstance=a,this.animator.stateMachines.length>0?this.animator.stateMachines.forEach(function(w){return w.bindViewModelInstance(a)}):this.artboard.bindViewModelInstance(a.runtimeInstance))},Object.defineProperty(p.prototype,"viewModelInstance",{get:function(){return this._viewModelInstance},enumerable:!1,configurable:!0}),p.prototype.viewModelByIndex=function(a){var h=this.file.viewModelByIndex(a);return h!==null?new Pe(h):null},p.prototype.viewModelByName=function(a){var h=this.file.viewModelByName(a);return h!==null?new Pe(h):null},p.prototype.enums=function(){if(this._dataEnums===null){var a=this.file.enums();this._dataEnums=a.map(function(h){return new Lt(h)})}return this._dataEnums},p.prototype.defaultViewModel=function(){if(this.artboard){var a=this.file.defaultArtboardViewModel(this.artboard);if(a)return new Pe(a)}return null},p.prototype.getArtboard=function(a){var h,w;return(w=(h=this.riveFile)===null||h===void 0?void 0:h.getArtboard(a))!==null&&w!==void 0?w:null},p.missingErrorMessage="Rive source file or data buffer required",p.cleanupErrorMessage="Attempt to use file after calling cleanup.",p})(),Pe=(function(){function p(a){this._viewModel=a}return Object.defineProperty(p.prototype,"instanceCount",{get:function(){return this._viewModel.instanceCount},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModel.name},enumerable:!1,configurable:!0}),p.prototype.instanceByIndex=function(a){var h=this._viewModel.instanceByIndex(a);return h!==null?new kt(h,null):null},p.prototype.instanceByName=function(a){var h=this._viewModel.instanceByName(a);return h!==null?new kt(h,null):null},p.prototype.defaultInstance=function(){var a=this._viewModel.defaultInstance();return a!==null?new kt(a,null):null},p.prototype.instance=function(){var a=this._viewModel.instance();return a!==null?new kt(a,null):null},Object.defineProperty(p.prototype,"properties",{get:function(){return this._viewModel.getProperties()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"instanceNames",{get:function(){return this._viewModel.getInstanceNames()},enumerable:!1,configurable:!0}),p})(),Lt=(function(){function p(a){this._dataEnum=a}return Object.defineProperty(p.prototype,"name",{get:function(){return this._dataEnum.name},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"values",{get:function(){return this._dataEnum.values},enumerable:!1,configurable:!0}),p})(),De;(function(p){p.Number="number",p.String="string",p.Boolean="boolean",p.Color="color",p.Trigger="trigger",p.Enum="enum",p.List="list",p.Image="image",p.Artboard="artboard"})(De||(De={}));var kt=(function(){function p(a,h){this._parents=[],this._children=[],this._viewModelInstances=new Map,this._propertiesWithCallbacks=[],this._referenceCount=0,this._runtimeInstance=a,h!==null&&this._parents.push(h)}return Object.defineProperty(p.prototype,"runtimeInstance",{get:function(){return this._runtimeInstance},enumerable:!1,configurable:!0}),p.prototype.handleCallbacks=function(){this._propertiesWithCallbacks.length!==0&&(this._propertiesWithCallbacks.forEach(function(a){a.handleCallbacks()}),this._propertiesWithCallbacks.forEach(function(a){a.clearChanges()})),this._children.forEach(function(a){return a.handleCallbacks()})},p.prototype.addParent=function(a){this._parents.includes(a)||(this._parents.push(a),(this._propertiesWithCallbacks.length>0||this._children.length>0)&&a.addToViewModelCallbacks(this))},p.prototype.removeParent=function(a){var h=this._parents.indexOf(a);if(h!==-1){var w=this._parents[h];w.removeFromViewModelCallbacks(this),this._parents.splice(h,1)}},p.prototype.addToPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)||(this._propertiesWithCallbacks.push(a),this._propertiesWithCallbacks.length>0&&this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},p.prototype.removeFromPropertyCallbacks=function(a){var h=this;this._propertiesWithCallbacks.includes(a)&&(this._propertiesWithCallbacks=this._propertiesWithCallbacks.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},p.prototype.addToViewModelCallbacks=function(a){var h=this;this._children.includes(a)||(this._children.push(a),this._parents.forEach(function(w){w.addToViewModelCallbacks(h)}))},p.prototype.removeFromViewModelCallbacks=function(a){var h=this;this._children.includes(a)&&(this._children=this._children.filter(function(w){return w!==a}),this._children.length===0&&this._propertiesWithCallbacks.length===0&&this._parents.forEach(function(w){w.removeFromViewModelCallbacks(h)}))},p.prototype.clearCallbacks=function(){this._propertiesWithCallbacks.forEach(function(a){a.clearCallbacks()})},p.prototype.propertyFromPath=function(a,h){var w=a.split("/");return this.propertyFromPathSegments(w,0,h)},p.prototype.viewModelFromPathSegments=function(a,h){var w=this.internalViewModelInstance(a[h]);return w!==null?h==a.length-1?w:w.viewModelFromPathSegments(a,h++):null},p.prototype.propertyFromPathSegments=function(a,h,w){var C,x,F,re,de,ne,we,Me,rt,We,At,St,_t,ft,Ct,dn,fn,$t;if(h<a.length-1){var le=this.internalViewModelInstance(a[h]);return le!==null?le.propertyFromPathSegments(a,h+1,w):null}var Ce=null;switch(w){case De.Number:if(Ce=(x=(C=this._runtimeInstance)===null||C===void 0?void 0:C.number(a[h]))!==null&&x!==void 0?x:null,Ce!==null)return new cn(Ce,this);break;case De.String:if(Ce=(re=(F=this._runtimeInstance)===null||F===void 0?void 0:F.string(a[h]))!==null&&re!==void 0?re:null,Ce!==null)return new Wt(Ce,this);break;case De.Boolean:if(Ce=(ne=(de=this._runtimeInstance)===null||de===void 0?void 0:de.boolean(a[h]))!==null&&ne!==void 0?ne:null,Ce!==null)return new Xt(Ce,this);break;case De.Color:if(Ce=(Me=(we=this._runtimeInstance)===null||we===void 0?void 0:we.color(a[h]))!==null&&Me!==void 0?Me:null,Ce!==null)return new hn(Ce,this);break;case De.Trigger:if(Ce=(We=(rt=this._runtimeInstance)===null||rt===void 0?void 0:rt.trigger(a[h]))!==null&&We!==void 0?We:null,Ce!==null)return new Tn(Ce,this);break;case De.Enum:if(Ce=(St=(At=this._runtimeInstance)===null||At===void 0?void 0:At.enum(a[h]))!==null&&St!==void 0?St:null,Ce!==null)return new mt(Ce,this);break;case De.List:if(Ce=(ft=(_t=this._runtimeInstance)===null||_t===void 0?void 0:_t.list(a[h]))!==null&&ft!==void 0?ft:null,Ce!==null)return new Rt(Ce,this);break;case De.Image:if(Ce=(dn=(Ct=this._runtimeInstance)===null||Ct===void 0?void 0:Ct.image(a[h]))!==null&&dn!==void 0?dn:null,Ce!==null)return new Xn(Ce,this);break;case De.Artboard:if(Ce=($t=(fn=this._runtimeInstance)===null||fn===void 0?void 0:fn.artboard(a[h]))!==null&&$t!==void 0?$t:null,Ce!==null)return new Qt(Ce,this);break}return null},p.prototype.internalViewModelInstance=function(a){var h;if(this._viewModelInstances.has(a))return this._viewModelInstances.get(a);var w=(h=this._runtimeInstance)===null||h===void 0?void 0:h.viewModel(a);if(w!==null){var C=new p(w,this);return C.internalIncrementReferenceCount(),this._viewModelInstances.set(a,C),C}return null},p.prototype.number=function(a){var h=this.propertyFromPath(a,De.Number);return h},p.prototype.string=function(a){var h=this.propertyFromPath(a,De.String);return h},p.prototype.boolean=function(a){var h=this.propertyFromPath(a,De.Boolean);return h},p.prototype.color=function(a){var h=this.propertyFromPath(a,De.Color);return h},p.prototype.trigger=function(a){var h=this.propertyFromPath(a,De.Trigger);return h},p.prototype.enum=function(a){var h=this.propertyFromPath(a,De.Enum);return h},p.prototype.list=function(a){var h=this.propertyFromPath(a,De.List);return h},p.prototype.image=function(a){var h=this.propertyFromPath(a,De.Image);return h},p.prototype.artboard=function(a){var h=this.propertyFromPath(a,De.Artboard);return h},p.prototype.viewModel=function(a){var h=a.split("/"),w=h.length>1?this.viewModelFromPathSegments(h.slice(0,h.length-1),0):this;return w!=null?w.internalViewModelInstance(h[h.length-1]):null},p.prototype.internalReplaceViewModel=function(a,h){var w;if(h.runtimeInstance!==null){var C=((w=this._runtimeInstance)===null||w===void 0?void 0:w.replaceViewModel(a,h.runtimeInstance))||!1;if(C){h.internalIncrementReferenceCount();var x=this.internalViewModelInstance(a);x!==null&&(x.removeParent(this),this._children.includes(x)&&(this._children=this._children.filter(function(F){return F!==x})),x.cleanup()),this._viewModelInstances.set(a,h),h.addParent(this)}return C}return!1},p.prototype.replaceViewModel=function(a,h){var w,C=a.split("/"),x=C.length>1?this.viewModelFromPathSegments(C.slice(0,C.length-1),0):this;return(w=x?.internalReplaceViewModel(C[C.length-1],h))!==null&&w!==void 0?w:!1},p.prototype.incrementReferenceCount=function(){var a;this._referenceCount++,(a=this._runtimeInstance)===null||a===void 0||a.incrementReferenceCount()},p.prototype.decrementReferenceCount=function(){var a;this._referenceCount--,(a=this._runtimeInstance)===null||a===void 0||a.decrementReferenceCount()},Object.defineProperty(p.prototype,"properties",{get:function(){var a;return((a=this._runtimeInstance)===null||a===void 0?void 0:a.getProperties().map(function(h){return k({},h)}))||[]},enumerable:!1,configurable:!0}),p.prototype.internalIncrementReferenceCount=function(){this._referenceCount++},p.prototype.cleanup=function(){var a=this;if(this._referenceCount--,this._referenceCount<=0){this._runtimeInstance=null,this.clearCallbacks(),this._propertiesWithCallbacks=[],this._viewModelInstances.forEach(function(C){C.cleanup()}),this._viewModelInstances.clear();var h=I([],this._children,!0);this._children.length=0;var w=I([],this._parents,!0);this._parents.length=0,h.forEach(function(C){C.removeParent(a)}),w.forEach(function(C){C.removeFromViewModelCallbacks(a)})}},p})(),Ye=(function(){function p(a,h){this.callbacks=[],this._viewModelInstanceValue=a,this._parentViewModel=h}return p.prototype.on=function(a){this.callbacks.length===0&&this._viewModelInstanceValue.clearChanges(),this.callbacks.includes(a)||(this.callbacks.push(a),this._parentViewModel.addToPropertyCallbacks(this))},p.prototype.off=function(a){a?this.callbacks=this.callbacks.filter(function(h){return h!==a}):this.callbacks.length=0,this.callbacks.length===0&&this._parentViewModel.removeFromPropertyCallbacks(this)},p.prototype.internalHandleCallback=function(a){},p.prototype.handleCallbacks=function(){var a=this;this._viewModelInstanceValue.hasChanged&&this.callbacks.forEach(function(h){a.internalHandleCallback(h)})},p.prototype.clearChanges=function(){this._viewModelInstanceValue.clearChanges()},p.prototype.clearCallbacks=function(){this.callbacks.length=0},Object.defineProperty(p.prototype,"name",{get:function(){return this._viewModelInstanceValue.name},enumerable:!1,configurable:!0}),p})(),Wt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ye),cn=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ye),Xt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ye),Tn=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return a.prototype.trigger=function(){return this._viewModelInstanceValue.trigger()},a.prototype.internalHandleCallback=function(h){h()},a})(Ye),mt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"valueIndex",{get:function(){return this._viewModelInstanceValue.valueIndex},set:function(h){this._viewModelInstanceValue.valueIndex=h},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"values",{get:function(){return this._viewModelInstanceValue.values},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ye),Rt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"length",{get:function(){return this._viewModelInstanceValue.size},enumerable:!1,configurable:!0}),a.prototype.addInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.addInstance(h.runtimeInstance),h.addParent(this._parentViewModel))},a.prototype.addInstanceAt=function(h,w){return h.runtimeInstance!=null&&this._viewModelInstanceValue.addInstanceAt(h.runtimeInstance,w)?(h.addParent(this._parentViewModel),!0):!1},a.prototype.removeInstance=function(h){h.runtimeInstance!=null&&(this._viewModelInstanceValue.removeInstance(h.runtimeInstance),h.removeParent(this._parentViewModel))},a.prototype.removeInstanceAt=function(h){this._viewModelInstanceValue.removeInstanceAt(h)},a.prototype.instanceAt=function(h){var w=this._viewModelInstanceValue.instanceAt(h);if(w!=null){var C=new kt(w,this._parentViewModel);return C}return null},a.prototype.swap=function(h,w){this._viewModelInstanceValue.swap(h,w)},a.prototype.internalHandleCallback=function(h){h()},a})(Ye),hn=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{get:function(){return this._viewModelInstanceValue.value},set:function(h){this._viewModelInstanceValue.value=h},enumerable:!1,configurable:!0}),a.prototype.rgb=function(h,w,C){this._viewModelInstanceValue.rgb(h,w,C)},a.prototype.rgba=function(h,w,C,x){this._viewModelInstanceValue.argb(x,h,w,C)},a.prototype.argb=function(h,w,C,x){this._viewModelInstanceValue.argb(h,w,C,x)},a.prototype.alpha=function(h){this._viewModelInstanceValue.alpha(h)},a.prototype.opacity=function(h){this._viewModelInstanceValue.alpha(Math.round(Math.max(0,Math.min(1,h))*255))},a.prototype.internalHandleCallback=function(h){h(this.value)},a})(Ye),Xn=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeImage)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Ye),Qt=(function(p){y(a,p);function a(h,w){return p.call(this,h,w)||this}return Object.defineProperty(a.prototype,"value",{set:function(h){var w;this._viewModelInstanceValue.value((w=h?.nativeArtboard)!==null&&w!==void 0?w:null)},enumerable:!1,configurable:!0}),a.prototype.internalHandleCallback=function(h){h()},a})(Ye),yr=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return m(this,function(C){switch(C.label){case 0:return a=new Request(p),[4,fetch(a)];case 1:return h=C.sent(),[4,h.arrayBuffer()];case 2:return w=C.sent(),[2,w]}})})},Et=function(p){return typeof p=="string"?[p]:p instanceof Array?p:[]},Y={EventManager:Ne,TaskQueueManager:Ke},se=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return m(this,function(C){switch(C.label){case 0:return a=new Promise(function(x){return G.getInstance(function(F){F.decodeAudio(p,x)})}),[4,a];case 1:return h=C.sent(),w=new g.AudioWrapper(h),g.finalizationRegistry.register(w,h),[2,w]}})})},ve=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return m(this,function(C){switch(C.label){case 0:return a=new Promise(function(x){return G.getInstance(function(F){F.decodeImage(p,x)})}),[4,a];case 1:return h=C.sent(),w=new g.ImageWrapper(h),g.finalizationRegistry.register(w,h),[2,w]}})})},Be=function(p){return E(void 0,void 0,void 0,function(){var a,h,w;return m(this,function(C){switch(C.label){case 0:return a=new Promise(function(x){return G.getInstance(function(F){F.decodeFont(p,x)})}),[4,a];case 1:return h=C.sent(),w=new g.FontWrapper(h),g.finalizationRegistry.register(w,h),[2,w]}})})}})(),l})())})(ss)),ss.exports}var ih=rh();const fs="dracula",vs="https://vycjpmuyscfygstjjied.supabase.co";var sh=Ae('<div class="rive-wrapper svelte-nkuq4r"><canvas width="250" height="500" class="svelte-nkuq4r"></canvas></div>');function La(n,e){Si(e,!0);let t=Xe(void 0);xo(()=>{if(!T(t))return;const l=new ih.Rive({src:`${vs}/storage/v1/object/public/${fs}/${e.fileName}`,canvas:T(t),autoplay:!0,stateMachines:"SM1"});return()=>{l.cleanup()}});var r=sh(),o=z(r);Yc(o,l=>fe(t,l),()=>T(t)),ce(n,r),Ci()}function oh(n,e){T(e)?.nextDialogueId&&xt.goToDialogue(T(e).nextDialogueId)}var ah=Ae('<img alt="BG" class="background-image svelte-ik8jti"/>'),lh=Ae('<div class="background-media svelte-ik8jti"><!></div>'),uh=Ae('<img alt="Char" class="character-image svelte-ik8jti"/>'),ch=Ae('<div class="character-media svelte-ik8jti"><!></div>'),hh=(n,e,t)=>e(T(t)),dh=Ae('<button class="option-button svelte-ik8jti"> </button>'),fh=Ae('<div class="options-container svelte-ik8jti"></div>'),vh=Ae('<div class="next-container svelte-ik8jti"><button class="next-button svelte-ik8jti">Далее...</button></div>'),ph=Ae('<div class="dialogue-container svelte-ik8jti"><!> <!> <div class="dialogue-content svelte-ik8jti"><div class="dialogue-text svelte-ik8jti"> </div> <!></div></div>'),gh=Ae("<p> </p>");function Gl(n,e){Si(e,!0);const t=Dr(()=>e.dialogue||xt.findDialogue(xt.currentDialogueId));hs(()=>{T(t)?.onEnter&&xt.runActions(T(t).onEnter)});function r(g){if(g.actions&&xt.runActions(g.actions),g.miniGame){console.log("Запуск мини-игры:",g.miniGame.id),xt.goToDialogue(g.miniGame.onWinDialogueId);return}g.nextDialogueId&&xt.goToDialogue(g.nextDialogueId)}function o(g){return g.visibleIf&&g.visibleIf.hasItem?xt.hasItem(g.visibleIf.hasItem):!0}var l=Fn(),c=an(l);{var d=g=>{var y=ph(),k=z(y);{var E=K=>{var j=lh(),L=z(j);{var ie=ae=>{var X=Fn(),he=an(X);Ia(he,()=>T(t).backgroundImage,Ne=>{La(Ne,{get fileName(){return T(t).backgroundImage}})}),ce(ae,X)},ue=ae=>{var X=ah();et(()=>Ra(X,"src",`${vs}/storage/v1/object/public/${fs}/${T(t).backgroundImage}`)),ce(ae,X)};it(L,ae=>{T(t).backgroundImage.endsWith(".riv")?ae(ie):ae(ue,!1)})}ce(K,j)};it(k,K=>{T(t).backgroundImage&&K(E)})}var m=te(k,2);{var I=K=>{var j=ch(),L=z(j);{var ie=ae=>{var X=Fn(),he=an(X);Ia(he,()=>T(t).characterImage,Ne=>{La(Ne,{get fileName(){return T(t).characterImage}})}),ce(ae,X)},ue=ae=>{var X=uh();et(()=>Ra(X,"src",`${vs}/storage/v1/object/public/${fs}/${T(t).characterImage}`)),ce(ae,X)};it(L,ae=>{T(t).characterImage.endsWith(".riv")?ae(ie):ae(ue,!1)})}ce(K,j)};it(m,K=>{T(t).characterImage&&K(I)})}var $=te(m,2),O=z($),q=z(O),H=te(O,2);{var N=K=>{var j=fh();Ut(j,21,()=>T(t).options,L=>L.text,(L,ie)=>{var ue=Fn(),ae=an(ue);{var X=he=>{var Ne=dh();Ne.__click=[hh,r,ie];var Ke=z(Ne);et(()=>Je(Ke,T(ie).text)),ce(he,Ne)};it(ae,he=>{o(T(ie))&&he(X)})}ce(L,ue)}),ce(K,j)},G=K=>{var j=Fn(),L=an(j);{var ie=ue=>{var ae=vh(),X=z(ae);X.__click=[oh,t],ce(ue,ae)};it(L,ue=>{T(t).nextDialogueId&&ue(ie)},!0)}ce(K,j)};it(H,K=>{T(t).options&&T(t).options.length>0?K(N):K(G,!1)})}et(()=>Je(q,T(t).text)),ce(g,y)},v=g=>{var y=gh(),k=z(y);et(()=>Je(k,`Диалог не найден (ID: ${xt.currentDialogueId??""})`)),ce(g,y)};it(c,g=>{T(t)?g(d):g(v,!1)})}ce(n,l),Ci()}Vl(["click"]);var mh=Ae('<div class="loading svelte-fgmugb"><p>🔄 Загрузка истории...</p></div>'),_h=Ae('<div class="error svelte-fgmugb"> </div>'),yh=Ae('<div class="dialogues-container svelte-fgmugb"><!></div>'),wh=Ae('<div class="app svelte-fgmugb"><!></div>');function bh(n,e){Si(e,!1);let t=`${vs}/storage/v1/object/public/${fs}/dracula_story_v2.json`;xo(async()=>{console.log("Загружаем историю из:",t),await xt.loadStory(t)}),Jc();var r=wh(),o=z(r);{var l=d=>{var v=mh();ce(d,v)},c=d=>{var v=Fn(),g=an(v);{var y=E=>{var m=_h(),I=z(m);et(()=>Je(I,`⚠️ ${xt.error??""}`)),ce(E,m)},k=E=>{var m=yh(),I=z(m);{var $=O=>{Gl(O,{})};it(I,O=>{xt.storyData&&O($)})}ce(E,m)};it(g,E=>{xt.error?E(y):E(k,!1)},!0)}ce(d,v)};it(o,d=>{xt.isLoading?d(l):d(c,!1)})}ce(n,r),Ci()}const kh="modulepreload",Eh=function(n,e){return new URL(n,e).href},$a={},Ii=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let g=function(y){return Promise.all(y.map(k=>Promise.resolve(k).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};const c=document.getElementsByTagName("link"),d=document.querySelector("meta[property=csp-nonce]"),v=d?.nonce||d?.getAttribute("nonce");o=g(t.map(y=>{if(y=Eh(y,r),y in $a)return;$a[y]=!0;const k=y.endsWith(".css"),E=k?'[rel="stylesheet"]':"";if(!!r)for(let $=c.length-1;$>=0;$--){const O=c[$];if(O.href===y&&(!k||O.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${y}"]${E}`))return;const I=document.createElement("link");if(I.rel=k?"stylesheet":kh,k||(I.as="script"),I.crossOrigin="",I.href=y,v&&I.setAttribute("nonce",v),document.head.appendChild(I),k)return new Promise(($,O)=>{I.addEventListener("load",$),I.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return o.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},Ah=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ii(async()=>{const{default:r}=await Promise.resolve().then(()=>Qr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Mo extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Sh extends Mo{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Fa extends Mo{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Da extends Mo{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var so;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(so||(so={}));var Ch=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};class Th{constructor(e,{headers:t={},customFetch:r,region:o=so.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=Ah(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return Ch(this,void 0,void 0,function*(){try{const{headers:o,method:l,body:c}=t;let d={},{region:v}=t;v||(v=this.region);const g=new URL(`${this.url}/${e}`);v&&v!=="any"&&(d["x-region"]=v,g.searchParams.set("forceFunctionRegion",v));let y;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",y=c):typeof c=="string"?(d["Content-Type"]="text/plain",y=c):typeof FormData<"u"&&c instanceof FormData?y=c:(d["Content-Type"]="application/json",y=JSON.stringify(c)));const k=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:y}).catch($=>{throw new Sh($)}),E=k.headers.get("x-relay-error");if(E&&E==="true")throw new Fa(k);if(!k.ok)throw new Da(k);let m=((r=k.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),I;return m==="application/json"?I=yield k.json():m==="application/octet-stream"?I=yield k.blob():m==="text/event-stream"?I=k:m==="multipart/form-data"?I=yield k.formData():I=yield k.text(),{data:I,error:null,response:k}}catch(o){return{data:null,error:o,response:o instanceof Da||o instanceof Fa?o.context:void 0}}})}}var ht={},Ir={},Pr={},Rr={},jr={},Or={},Ih=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},zr=Ih();const Ph=zr.fetch,Kl=zr.fetch.bind(zr),Yl=zr.Headers,Rh=zr.Request,jh=zr.Response,Qr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Yl,Request:Rh,Response:jh,default:Kl,fetch:Ph},Symbol.toStringTag,{value:"Module"})),Oh=th(Qr);var Qi={},Ua;function Jl(){if(Ua)return Qi;Ua=1,Object.defineProperty(Qi,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Qi.default=n,Qi}var Na;function Xl(){if(Na)return Or;Na=1;var n=Or&&Or.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Or,"__esModule",{value:!0});const e=n(Oh),t=n(Jl());class r{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let v=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var y,k,E,m;let I=null,$=null,O=null,q=g.status,H=g.statusText;if(g.ok){if(this.method!=="HEAD"){const j=await g.text();j===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?$=j:$=JSON.parse(j))}const G=(k=this.headers.get("Prefer"))===null||k===void 0?void 0:k.match(/count=(exact|planned|estimated)/),K=(E=g.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");G&&K&&K.length>1&&(O=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray($)&&($.length>1?(I={code:"PGRST116",details:`Results contain ${$.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},$=null,O=null,q=406,H="Not Acceptable"):$.length===1?$=$[0]:$=null)}else{const G=await g.text();try{I=JSON.parse(G),Array.isArray(I)&&g.status===404&&($=[],I=null,q=200,H="OK")}catch{g.status===404&&G===""?(q=204,H="No Content"):I={message:G}}if(I&&this.isMaybeSingle&&(!((m=I?.details)===null||m===void 0)&&m.includes("0 rows"))&&(I=null,q=200,H="OK"),I&&this.shouldThrowOnError)throw new t.default(I)}return{error:I,data:$,count:O,status:q,statusText:H}});return this.shouldThrowOnError||(v=v.catch(g=>{var y,k,E;return{error:{message:`${(y=g?.name)!==null&&y!==void 0?y:"FetchError"}: ${g?.message}`,details:`${(k=g?.stack)!==null&&k!==void 0?k:""}`,hint:"",code:`${(E=g?.code)!==null&&E!==void 0?E:""}`},data:null,count:null,status:0,statusText:""}})),v.then(l,c)}returns(){return this}overrideTypes(){return this}}return Or.default=r,Or}var Ba;function Ql(){if(Ba)return jr;Ba=1;var n=jr&&jr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jr,"__esModule",{value:!0});const e=n(Xl());class t extends e.default{select(o){let l=!1;const c=(o??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:v=d}={}){const g=v?`${v}.order`:"order",y=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${y?`${y},`:""}${o}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${o}`),this}range(o,l,{foreignTable:c,referencedTable:d=c}={}){const v=typeof d>"u"?"offset":`${d}.offset`,g=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(v,`${o}`),this.url.searchParams.set(g,`${l-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:v=!1,format:g="text"}={}){var y;const k=[o?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,v?"wal":null].filter(Boolean).join("|"),E=(y=this.headers.get("Accept"))!==null&&y!==void 0?y:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${E}"; options=${k};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return jr.default=t,jr}var Wa;function Lo(){if(Wa)return Rr;Wa=1;var n=Rr&&Rr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rr,"__esModule",{value:!0});const e=n(Ql());class t extends e.default{eq(o,l){return this.url.searchParams.append(o,`eq.${l}`),this}neq(o,l){return this.url.searchParams.append(o,`neq.${l}`),this}gt(o,l){return this.url.searchParams.append(o,`gt.${l}`),this}gte(o,l){return this.url.searchParams.append(o,`gte.${l}`),this}lt(o,l){return this.url.searchParams.append(o,`lt.${l}`),this}lte(o,l){return this.url.searchParams.append(o,`lte.${l}`),this}like(o,l){return this.url.searchParams.append(o,`like.${l}`),this}likeAllOf(o,l){return this.url.searchParams.append(o,`like(all).{${l.join(",")}}`),this}likeAnyOf(o,l){return this.url.searchParams.append(o,`like(any).{${l.join(",")}}`),this}ilike(o,l){return this.url.searchParams.append(o,`ilike.${l}`),this}ilikeAllOf(o,l){return this.url.searchParams.append(o,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(o,l){return this.url.searchParams.append(o,`ilike(any).{${l.join(",")}}`),this}is(o,l){return this.url.searchParams.append(o,`is.${l}`),this}in(o,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(o,`in.(${c})`),this}contains(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cs.{${l.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(l)}`),this}containedBy(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cd.{${l.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(l)}`),this}rangeGt(o,l){return this.url.searchParams.append(o,`sr.${l}`),this}rangeGte(o,l){return this.url.searchParams.append(o,`nxl.${l}`),this}rangeLt(o,l){return this.url.searchParams.append(o,`sl.${l}`),this}rangeLte(o,l){return this.url.searchParams.append(o,`nxr.${l}`),this}rangeAdjacent(o,l){return this.url.searchParams.append(o,`adj.${l}`),this}overlaps(o,l){return typeof l=="string"?this.url.searchParams.append(o,`ov.${l}`):this.url.searchParams.append(o,`ov.{${l.join(",")}}`),this}textSearch(o,l,{config:c,type:d}={}){let v="";d==="plain"?v="pl":d==="phrase"?v="ph":d==="websearch"&&(v="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(o,`${v}fts${g}.${l}`),this}match(o){return Object.entries(o).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(o,l,c){return this.url.searchParams.append(o,`not.${l}.${c}`),this}or(o,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${o})`),this}filter(o,l,c){return this.url.searchParams.append(o,`${l}.${c}`),this}}return Rr.default=t,Rr}var Va;function Zl(){if(Va)return Pr;Va=1;var n=Pr&&Pr.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Pr,"__esModule",{value:!0});const e=n(Lo());class t{constructor(o,{headers:l={},schema:c,fetch:d}){this.url=o,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(o,{head:l=!1,count:c}={}){const d=l?"HEAD":"GET";let v=!1;const g=(o??"*").split("").map(y=>/\s/.test(y)&&!v?"":(y==='"'&&(v=!v),y)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:l,defaultToNull:c=!0}={}){var d;const v="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const g=o.reduce((y,k)=>y.concat(Object.keys(k)),[]);if(g.length>0){const y=[...new Set(g)].map(k=>`"${k}"`);this.url.searchParams.set("columns",y.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(o,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:v=!0}={}){var g;const y="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),v||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const k=o.reduce((E,m)=>E.concat(Object.keys(m)),[]);if(k.length>0){const E=[...new Set(k)].map(m=>`"${m}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:y,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(o,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:o}={}){var l;const c="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return Pr.default=t,Pr}var qa;function xh(){if(qa)return Ir;qa=1;var n=Ir&&Ir.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ir,"__esModule",{value:!0});const e=n(Zl()),t=n(Lo());class r{constructor(l,{headers:c={},schema:d,fetch:v}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=v}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:v=!1,count:g}={}){var y;let k;const E=new URL(`${this.url}/rpc/${l}`);let m;d||v?(k=d?"HEAD":"GET",Object.entries(c).filter(([$,O])=>O!==void 0).map(([$,O])=>[$,Array.isArray(O)?`{${O.join(",")}}`:`${O}`]).forEach(([$,O])=>{E.searchParams.append($,O)})):(k="POST",m=c);const I=new Headers(this.headers);return g&&I.set("Prefer",`count=${g}`),new t.default({method:k,url:E,headers:I,schema:this.schemaName,body:m,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}}return Ir.default=r,Ir}var Ha;function Mh(){if(Ha)return ht;Ha=1;var n=ht&&ht.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(ht,"__esModule",{value:!0}),ht.PostgrestError=ht.PostgrestBuilder=ht.PostgrestTransformBuilder=ht.PostgrestFilterBuilder=ht.PostgrestQueryBuilder=ht.PostgrestClient=void 0;const e=n(xh());ht.PostgrestClient=e.default;const t=n(Zl());ht.PostgrestQueryBuilder=t.default;const r=n(Lo());ht.PostgrestFilterBuilder=r.default;const o=n(Ql());ht.PostgrestTransformBuilder=o.default;const l=n(Xl());ht.PostgrestBuilder=l.default;const c=n(Jl());return ht.PostgrestError=c.default,ht.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default},ht}var Lh=Mh();const $h=eh(Lh),{PostgrestClient:Fh,PostgrestQueryBuilder:vv,PostgrestFilterBuilder:pv,PostgrestTransformBuilder:gv,PostgrestBuilder:mv,PostgrestError:_v}=$h;class Dh{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Uh="2.15.1",Nh=`realtime-js/${Uh}`,Bh="1.0.0",oo=1e4,Wh=1e3,Vh=100;var pi;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(pi||(pi={}));var at;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(at||(at={}));var on;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(on||(on={}));var ao;(function(n){n.websocket="websocket"})(ao||(ao={}));var hr;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(hr||(hr={}));class qh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const d=r.decode(e.slice(c,c+o));c=c+o;const v=r.decode(e.slice(c,c+l));c=c+l;const g=JSON.parse(r.decode(e.slice(c,e.byteLength)));return{ref:null,topic:d,event:v,payload:g}}}class eu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var He;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(He||(He={}));const za=(n,e,t={})=>{var r;const o=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((l,c)=>(l[c]=Hh(c,n,e,o),l),{})},Hh=(n,e,t,r)=>{const o=e.find(d=>d.name===n),l=o?.type,c=t[n];return l&&!r.includes(l)?tu(l,c):lo(c)},tu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Yh(e,t)}switch(n){case He.bool:return zh(e);case He.float4:case He.float8:case He.int2:case He.int4:case He.int8:case He.numeric:case He.oid:return Gh(e);case He.json:case He.jsonb:return Kh(e);case He.timestamp:return Jh(e);case He.abstime:case He.date:case He.daterange:case He.int4range:case He.int8range:case He.money:case He.reltime:case He.text:case He.time:case He.timestamptz:case He.timetz:case He.tsrange:case He.tstzrange:return lo(e);default:return lo(e)}},lo=n=>n,zh=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Gh=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Kh=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Yh=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>tu(e,d))}return n},Jh=n=>typeof n=="string"?n.replace(" ","T"):n,nu=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Hs{constructor(e,t,r={},o=oo){this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ga;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ga||(Ga={}));class gi{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=gi.syncState(this.state,o,l,c),this.pendingDiffs.forEach(v=>{this.state=gi.syncDiff(this.state,v,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(r.diff,{},o=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=gi.syncDiff(this.state,o,l,c),d())}),this.onJoin((o,l,c)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:c})}),this.onLeave((o,l,c)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const l=this.cloneDeep(e),c=this.transformState(t),d={},v={};return this.map(l,(g,y)=>{c[g]||(v[g]=y)}),this.map(c,(g,y)=>{const k=l[g];if(k){const E=y.map(O=>O.presence_ref),m=k.map(O=>O.presence_ref),I=y.filter(O=>m.indexOf(O.presence_ref)<0),$=k.filter(O=>E.indexOf(O.presence_ref)<0);I.length>0&&(d[g]=I),$.length>0&&(v[g]=$)}else d[g]=y}),this.syncDiff(l,{joins:d,leaves:v},r,o)}static syncDiff(e,t,r,o){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(l,(d,v)=>{var g;const y=(g=e[d])!==null&&g!==void 0?g:[];if(e[d]=this.cloneDeep(v),y.length>0){const k=e[d].map(m=>m.presence_ref),E=y.filter(m=>k.indexOf(m.presence_ref)<0);e[d].unshift(...E)}r(d,y,v)}),this.map(c,(d,v)=>{let g=e[d];if(!g)return;const y=v.map(k=>k.presence_ref);g=g.filter(k=>y.indexOf(k.presence_ref)<0),e[d]=g,o(d,g,v),g.length===0&&delete e[d]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return"metas"in o?t[r]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[r]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ka;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Ka||(Ka={}));var mi;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(mi||(mi={}));var $n;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})($n||($n={}));class $o{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=at.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Hs(this,on.join,this.params,this.timeout),this.rejoinTimer=new eu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=at.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=at.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this._on(on.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new gi(this),this.broadcastEndpointURL=nu(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==at.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,v=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(E=>E.filter))!==null&&o!==void 0?o:[],g=!!this.bindings[mi.PRESENCE]&&this.bindings[mi.PRESENCE].length>0,y={},k={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:v,private:d};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(E=>e?.($n.CHANNEL_ERROR,E)),this._onClose(()=>e?.($n.CLOSED)),this.updateJoinPayload(Object.assign({config:k},y)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:E})=>{var m;if(this.socket.setAuth(),E===void 0){e?.($n.SUBSCRIBED);return}else{const I=this.bindings.postgres_changes,$=(m=I?.length)!==null&&m!==void 0?m:0,O=[];for(let q=0;q<$;q++){const H=I[q],{filter:{event:N,schema:G,table:K,filter:j}}=H,L=E&&E[q];if(L&&L.event===N&&L.schema===G&&L.table===K&&L.filter===j)O.push(Object.assign(Object.assign({},H),{id:L.id}));else{this.unsubscribe(),this.state=at.errored,e?.($n.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=O,e&&e($n.SUBSCRIBED);return}}).receive("error",E=>{this.state=at.errored,e?.($n.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{e?.($n.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===at.joined&&e===mi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,v={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,v,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=g.body)===null||o===void 0?void 0:o.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,v;const g=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((v=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||v===void 0)&&v.ack)&&l("ok"),g.receive("ok",()=>l("ok")),g.receive("error",()=>l("error")),g.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=at.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(on.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Hs(this,on.leave,{},e),r.receive("ok",()=>{t(),o("ok")}).receive("timeout",()=>{t(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=at.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const o=new AbortController,l=setTimeout(()=>o.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(l),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Hs(this,e,t,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Vh){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,l;const c=e.toLocaleLowerCase(),{close:d,error:v,leave:g,join:y}=on;if(r&&[d,v,g,y].indexOf(c)>=0&&r!==this._joinRef())return;let E=this._onMessage(c,t,r);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(m=>{var I,$,O;return((I=m.filter)===null||I===void 0?void 0:I.event)==="*"||((O=($=m.filter)===null||$===void 0?void 0:$.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===c}).map(m=>m.callback(E,r)):(l=this.bindings[c])===null||l===void 0||l.filter(m=>{var I,$,O,q,H,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in m){const G=m.id,K=(I=m.filter)===null||I===void 0?void 0:I.event;return G&&(($=t.ids)===null||$===void 0?void 0:$.includes(G))&&(K==="*"||K?.toLocaleLowerCase()===((O=t.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const G=(H=(q=m?.filter)===null||q===void 0?void 0:q.event)===null||H===void 0?void 0:H.toLocaleLowerCase();return G==="*"||G===((N=t?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===c}).map(m=>{if(typeof E=="object"&&"ids"in E){const I=E.data,{schema:$,table:O,commit_timestamp:q,type:H,errors:N}=I;E=Object.assign(Object.assign({},{schema:$,table:O,commit_timestamp:q,eventType:H,new:{},old:{},errors:N}),this._getPayloadRecords(I))}m.callback(E,r)})}_isClosed(){return this.state===at.closed}_isJoined(){return this.state===at.joined}_isJoining(){return this.state===at.joining}_isLeaving(){return this.state===at.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const o=e.toLocaleLowerCase(),l={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&$o.isEqual(o.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(on.close,{},e)}_onError(e){this._on(on.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=at.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=za(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=za(e.columns,e.old_record)),t}}const Ya=()=>{},Zi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Xh=[1e3,2e3,5e3,1e4],Qh=1e4,Zh=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ed{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=oo,this.transport=null,this.heartbeatIntervalMs=Zi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ya,this.ref=0,this.reconnectTimer=null,this.logger=Ya,this.conn=null,this.sendBuffer=[],this.serializer=new qh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let l;return o?l=o:typeof fetch>"u"?l=(...c)=>Ii(async()=>{const{default:d}=await Promise.resolve().then(()=>Qr);return{default:d}},void 0,import.meta.url).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${ao.websocket}`,this.httpEndpoint=nu(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dh.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Bh}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case pi.connecting:return hr.Connecting;case pi.open:return hr.Open;case pi.closing:return hr.Closing;default:return hr.Closed}}isConnected(){return this.connectionState()===hr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(l=>l.topic===r);if(o)return o;{const l=new $o(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:r,payload:o,ref:l}=e,c=()=>{this.encode(e,d=>{var v;(v=this.conn)===null||v===void 0||v.send(d)})};this.log("push",`${t} ${r} (${l})`,o),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Wh,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Zi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:l,ref:c}=t,d=c?`(${c})`:"",v=l.status||"";this.log("receive",`${v} ${r} ${o} ${d}`.trim(),l),this.channels.filter(g=>g._isMember(r)).forEach(g=>g._trigger(o,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(on.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${r}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([Zh],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const o={access_token:t,version:Nh};t&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(on.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new eu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Zi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,o,l,c,d,v,g;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:oo,this.heartbeatIntervalMs=(o=e?.heartbeatIntervalMs)!==null&&o!==void 0?o:Zi.HEARTBEAT_INTERVAL,this.worker=(l=e?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e?.accessToken)!==null&&c!==void 0?c:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(y=>Xh[y-1]||Qh),this.encode=(v=e?.encode)!==null&&v!==void 0?v:((y,k)=>k(JSON.stringify(y))),this.decode=(g=e?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Fo extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function lt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class td extends Fo{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class uo extends Fo{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var nd=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};const ru=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ii(async()=>{const{default:r}=await Promise.resolve().then(()=>Qr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},rd=()=>nd(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ii(()=>Promise.resolve().then(()=>Qr),void 0,import.meta.url)).Response:Response}),co=n=>{if(Array.isArray(n))return n.map(t=>co(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const o=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[o]=co(r)}),e},id=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var _r=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};const zs=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),sd=(n,e,t)=>_r(void 0,void 0,void 0,function*(){const r=yield rd();n instanceof r&&!t?.noResolveJson?n.json().then(o=>{const l=n.status||500,c=o?.statusCode||l+"";e(new td(zs(o),l,c))}).catch(o=>{e(new uo(zs(o),o))}):e(new uo(zs(n),n))}),od=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"||!r?o:(id(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(r)):o.body=r,e?.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),t))};function Pi(n,e,t,r,o,l){return _r(this,void 0,void 0,function*(){return new Promise((c,d)=>{n(t,od(e,r,o,l)).then(v=>{if(!v.ok)throw v;return r?.noResolveJson?v:v.json()}).then(v=>c(v)).catch(v=>sd(v,d,r))})})}function ps(n,e,t,r){return _r(this,void 0,void 0,function*(){return Pi(n,"GET",e,t,r)})}function kn(n,e,t,r,o){return _r(this,void 0,void 0,function*(){return Pi(n,"POST",e,r,o,t)})}function ho(n,e,t,r,o){return _r(this,void 0,void 0,function*(){return Pi(n,"PUT",e,r,o,t)})}function ad(n,e,t,r){return _r(this,void 0,void 0,function*(){return Pi(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function iu(n,e,t,r,o){return _r(this,void 0,void 0,function*(){return Pi(n,"DELETE",e,r,o,t)})}var Tt=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};const ld={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ja={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ud{constructor(e,t={},r,o){this.url=e,this.headers=t,this.bucketId=r,this.fetch=ru(o)}uploadOrUpdate(e,t,r,o){return Tt(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Ja),o);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const v=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),v&&l.append("metadata",this.encodeMetadata(v)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),v&&l.append("metadata",this.encodeMetadata(v))):(l=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,v&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(v)))),o?.headers&&(d=Object.assign(Object.assign({},d),o.headers));const g=this._removeEmptyFolders(t),y=this._getFinalPath(g),k=yield(e=="PUT"?ho:kn)(this.fetch,`${this.url}/object/${y}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:k.Id,fullPath:k.Key},error:null}}catch(l){if(lt(l))return{data:null,error:l};throw l}})}upload(e,t,r){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return Tt(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",t);try{let v;const g=Object.assign({upsert:Ja.upsert},o),y=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&r instanceof Blob?(v=new FormData,v.append("cacheControl",g.cacheControl),v.append("",r)):typeof FormData<"u"&&r instanceof FormData?(v=r,v.append("cacheControl",g.cacheControl)):(v=r,y["cache-control"]=`max-age=${g.cacheControl}`,y["content-type"]=g.contentType);const k=yield ho(this.fetch,d.toString(),v,{headers:y});return{data:{path:l,fullPath:k.Key},error:null}}catch(v){if(lt(v))return{data:null,error:v};throw v}})}createSignedUploadUrl(e,t){return Tt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);t?.upsert&&(o["x-upsert"]="true");const l=yield kn(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Fo("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:d},error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}update(e,t,r){return Tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Tt(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}copy(e,t,r){return Tt(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return Tt(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),l=yield kn(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return Tt(this,void 0,void 0,function*(){try{const o=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}download(e,t){return Tt(this,void 0,void 0,function*(){const o=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const d=this._getFinalPath(e);return{data:yield(yield ps(this.fetch,`${this.url}/${o}/${d}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(lt(d))return{data:null,error:d};throw d}})}info(e){return Tt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield ps(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:co(r),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}exists(e){return Tt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield ad(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(lt(r)&&r instanceof uo){const o=r.originalError;if([400,404].includes(o?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&o.push(l);const d=typeof t?.transform<"u"?"render/image":"object",v=this.transformOptsToQueryString(t?.transform||{});v!==""&&o.push(v);let g=o.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${r}${g}`)}}}remove(e){return Tt(this,void 0,void 0,function*(){try{return{data:yield iu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}list(e,t,r){return Tt(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},ld),t),{prefix:e||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(lt(o))return{data:null,error:o};throw o}})}listV2(e,t){return Tt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const cd="2.11.0",hd={"X-Client-Info":`storage-js/${cd}`};var xr=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};class dd{constructor(e,t={},r,o){const l=new URL(e);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},hd),t),this.fetch=ru(r)}listBuckets(){return xr(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(lt(e))return{data:null,error:e};throw e}})}getBucket(e){return xr(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return xr(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return xr(this,void 0,void 0,function*(){try{return{data:yield ho(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(lt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return xr(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return xr(this,void 0,void 0,function*(){try{return{data:yield iu(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(lt(t))return{data:null,error:t};throw t}})}}class fd extends dd{constructor(e,t={},r,o){super(e,t,r,o)}from(e){return new ud(this.url,this.headers,e,this.fetch)}}const vd="2.56.0";let di="";typeof Deno<"u"?di="deno":typeof document<"u"?di="web":typeof navigator<"u"&&navigator.product==="ReactNative"?di="react-native":di="node";const pd={"X-Client-Info":`supabase-js-${di}/${vd}`},gd={headers:pd},md={schema:"public"},_d={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yd={};var wd=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};const bd=n=>{let e;return n?e=n:typeof fetch>"u"?e=Kl:e=fetch,(...t)=>e(...t)},kd=()=>typeof Headers>"u"?Yl:Headers,Ed=(n,e,t)=>{const r=bd(t),o=kd();return(l,c)=>wd(void 0,void 0,void 0,function*(){var d;const v=(d=yield e())!==null&&d!==void 0?d:n;let g=new o(c?.headers);return g.has("apikey")||g.set("apikey",n),g.has("Authorization")||g.set("Authorization",`Bearer ${v}`),r(l,Object.assign(Object.assign({},c),{headers:g}))})};var Ad=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};function Sd(n){return n.endsWith("/")?n:n+"/"}function Cd(n,e){var t,r;const{db:o,auth:l,realtime:c,global:d}=n,{db:v,auth:g,realtime:y,global:k}=e,E={db:Object.assign(Object.assign({},v),o),auth:Object.assign(Object.assign({},g),l),realtime:Object.assign(Object.assign({},y),c),storage:{},global:Object.assign(Object.assign(Object.assign({},k),d),{headers:Object.assign(Object.assign({},(t=k?.headers)!==null&&t!==void 0?t:{}),(r=d?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Ad(this,void 0,void 0,function*(){return""})};return n.accessToken?E.accessToken=n.accessToken:delete E.accessToken,E}const su="2.71.1",Ur=30*1e3,fo=3,Gs=fo*Ur,Td="http://localhost:9999",Id="supabase.auth.token",Pd={"X-Client-Info":`gotrue-js/${su}`},vo="X-Supabase-Api-Version",ou={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Rd=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jd=600*1e3;class Do extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function ge(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Od extends Do{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function xd(n){return ge(n)&&n.name==="AuthApiError"}class au extends Do{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Jn extends Do{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class Vn extends Jn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Md(n){return ge(n)&&n.name==="AuthSessionMissingError"}class es extends Jn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ts extends Jn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ns extends Jn{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ld(n){return ge(n)&&n.name==="AuthImplicitGrantRedirectError"}class Xa extends Jn{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class po extends Jn{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ks(n){return ge(n)&&n.name==="AuthRetryableFetchError"}class Qa extends Jn{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class go extends Jn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const gs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Za=` 	
\r=`.split(""),$d=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Za.length;e+=1)n[Za[e].charCodeAt(0)]=-2;for(let e=0;e<gs.length;e+=1)n[gs[e].charCodeAt(0)]=e;return n})();function el(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(gs[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(gs[r]),e.queuedBits-=6}}function lu(n,e,t){const r=$d[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function tl(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=c=>{Ud(c,r,t)};for(let c=0;c<n.length;c+=1)lu(n.charCodeAt(c),o,l);return e.join("")}function Fd(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function Dd(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|o)+65536,t+=1}Fd(r,e)}}function Ud(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Nd(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<n.length;o+=1)lu(n.charCodeAt(o),t,r);return new Uint8Array(e)}function Bd(n){const e=[];return Dd(n,t=>e.push(t)),new Uint8Array(e)}function Wd(n){const e=[],t={queue:0,queuedBits:0},r=o=>{e.push(o)};return n.forEach(o=>el(o,t,r)),el(null,t,r),e.join("")}function Vd(n){return Math.round(Date.now()/1e3)+n}function qd(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const sn=()=>typeof window<"u"&&typeof document<"u",ar={tested:!1,writable:!1},uu=()=>{if(!sn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ar.tested)return ar.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),ar.tested=!0,ar.writable=!0}catch{ar.tested=!0,ar.writable=!1}return ar.writable};function Hd(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,l)=>{e[l]=o})}catch{}return t.searchParams.forEach((r,o)=>{e[o]=r}),e}const cu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ii(async()=>{const{default:r}=await Promise.resolve().then(()=>Qr);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},zd=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",Nr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},lr=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Wn=async(n,e)=>{await n.removeItem(e)};class Ts{constructor(){this.promise=new Ts.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ts.promiseConstructor=Promise;function Ys(n){const e=n.split(".");if(e.length!==3)throw new go("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Rd.test(e[r]))throw new go("JWT not in base64url format");return{header:JSON.parse(tl(e[0])),payload:JSON.parse(tl(e[1])),signature:Nd(e[2]),raw:{header:e[0],payload:e[1]}}}async function Gd(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Kd(n,e){return new Promise((r,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){r(c);return}}catch(c){if(!e(l,c)){o(c);return}}})()})}function Yd(n){return("0"+n.toString(16)).substr(-2)}function Jd(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let o="";for(let l=0;l<56;l++)o+=t.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,Yd).join("")}async function Xd(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function Qd(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Xd(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Mr(n,e,t=!1){const r=Jd();let o=r;t&&(o+="/PASSWORD_RECOVERY"),await Nr(n,`${e}-code-verifier`,o);const l=await Qd(r);return[l,r===l?"plain":"s256"]}const Zd=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ef(n){const e=n.headers.get(vo);if(!e||!e.match(Zd))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function tf(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function nf(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const rf=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lr(n){if(!rf.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Js(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function nl(n){return JSON.parse(JSON.stringify(n))}var sf=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};const ur=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),of=[502,503,504];async function rl(n){var e;if(!zd(n))throw new po(ur(n),0);if(of.includes(n.status))throw new po(ur(n),n.status);let t;try{t=await n.json()}catch(l){throw new au(ur(l),l)}let r;const o=ef(n);if(o&&o.getTime()>=ou["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Qa(ur(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Vn}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Qa(ur(t),n.status,t.weak_password.reasons);throw new Od(ur(t),n.status||500,r)}const af=(n,e,t,r)=>{const o={method:n,headers:e?.headers||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),t))};async function Te(n,e,t,r){var o;const l=Object.assign({},r?.headers);l[vo]||(l[vo]=ou["2024-01-01"].name),r?.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(o=r?.query)!==null&&o!==void 0?o:{};r?.redirectTo&&(c.redirect_to=r.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",v=await lf(n,e,t+d,{headers:l,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(v):{data:Object.assign({},v),error:null}}async function lf(n,e,t,r,o,l){const c=af(e,r,o,l);let d;try{d=await n(t,Object.assign({},c))}catch(v){throw console.error(v),new po(ur(v),0)}if(d.ok||await rl(d),r?.noResolveJson)return d;try{return await d.json()}catch(v){await rl(v)}}function Ln(n){var e;let t=null;df(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=Vd(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function il(n){const e=Ln(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function qn(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function uf(n){return{data:n,error:null}}function cf(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:l}=n,c=sf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:l},v=Object.assign({},c);return{data:{properties:d,user:v},error:null}}function hf(n){return n}function df(n){return n.access_token&&n.refresh_token&&n.expires_in}const Xs=["global","local","others"];var ff=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};class vf{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=cu(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Xs[0]){if(Xs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Xs.join(", ")}`);try{return await Te(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Te(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:qn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=ff(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=r?.newEmail,delete o.newEmail),await Te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:cf,redirectTo:t?.redirectTo})}catch(t){if(ge(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Te(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:qn})}catch(t){if(ge(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,l,c,d,v;try{const g={nextPage:null,lastPage:0,total:0},y=await Te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:hf});if(y.error)throw y.error;const k=await y.json(),E=(c=y.headers.get("x-total-count"))!==null&&c!==void 0?c:0,m=(v=(d=y.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&v!==void 0?v:[];return m.length>0&&(m.forEach(I=>{const $=parseInt(I.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(I.split(";")[1].split("=")[1]);g[`${O}Page`]=$}),g.total=parseInt(E)),{data:Object.assign(Object.assign({},k),g),error:null}}catch(g){if(ge(g))return{data:{users:[]},error:g};throw g}}async getUserById(e){Lr(e);try{return await Te(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:qn})}catch(t){if(ge(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Lr(e);try{return await Te(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:qn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Lr(e);try{return await Te(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:qn})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Lr(e.userId);try{const{data:t,error:r}=await Te(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:r}}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Lr(e.userId),Lr(e.id);try{return{data:await Te(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}}}function sl(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function pf(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $r={debug:!!(globalThis&&uu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hu extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gf extends hu{}async function mf(n,e,t){$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),$r.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,o.name);try{return await t()}finally{$r.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,o.name)}}else{if(e===0)throw $r.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new gf(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if($r.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}pf();const _f={url:Td,storageKey:Id,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Pd,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ol(n,e,t){return await t()}const Fr={};class ki{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ki.nextInstanceID,ki.nextInstanceID+=1,this.instanceID>0&&sn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},_f),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new vf({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=cu(o.fetch),this.lock=o.lock||ol,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:sn()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=mf:this.lock=ol,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:uu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sl(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=sl(this.memoryStorage)),sn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=Fr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Fr[this.storageKey]=Object.assign(Object.assign({},Fr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Fr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Fr[this.storageKey]=Object.assign(Object.assign({},Fr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${su}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Hd(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),sn()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:l}=await this._getSessionFromURL(t,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),Ld(l)){const v=(e=l.details)===null||e===void 0?void 0:e.code;if(v==="identity_already_exists"||v==="identity_not_found"||v==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=o;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ge(t)?{error:t}:{error:new au("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const l=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Ln}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const v=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(l){if(ge(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(e){var t,r,o;try{let l;if("email"in e){const{email:y,password:k,options:E}=e;let m=null,I=null;this.flowType==="pkce"&&([m,I]=await Mr(this.storage,this.storageKey)),l=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E?.emailRedirectTo,body:{email:y,password:k,data:(t=E?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E?.captchaToken},code_challenge:m,code_challenge_method:I},xform:Ln})}else if("phone"in e){const{phone:y,password:k,options:E}=e;l=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:k,data:(r=E?.data)!==null&&r!==void 0?r:{},channel:(o=E?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:E?.captchaToken}},xform:Ln})}else throw new ts("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const v=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(l){if(ge(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:d}=e;t=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:il})}else if("phone"in e){const{phone:l,password:c,options:d}=e;t=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:il})}else throw new ts("You must provide either an email or phone number and a password");const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new es}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,o,l,c,d,v,g,y,k,E,m;let I,$;if("message"in e)I=e.message,$=e.signature;else{const{chain:O,wallet:q,statement:H,options:N}=e;let G;if(sn())if(typeof q=="object")G=q;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))G=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof q!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");G=q}const K=new URL((t=N?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in G&&G.signIn){const j=await G.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),H?{statement:H}:null));let L;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")L=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)L=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)I=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),$=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in G)||typeof G.signMessage!="function"||!("publicKey"in G)||typeof G!="object"||!G.publicKey||!("toBase58"in G.publicKey)||typeof G.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");I=[`${K.host} wants you to sign in with your Solana account:`,G.publicKey.toBase58(),...H?["",H,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(o=(r=N?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=N?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((d=N?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((v=N?.signInWithSolana)===null||v===void 0)&&v.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((g=N?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((k=(y=N?.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||k===void 0)&&k.length?["Resources",...N.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const j=await G.signMessage(new TextEncoder().encode(I),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");$=j}}try{const{data:O,error:q}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:I,signature:Wd($)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Ln});if(q)throw q;return!O||!O.session||!O.user?{data:{user:null,session:null},error:new es}:(O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),{data:Object.assign({},O),error:q})}catch(O){if(ge(O))return{data:{user:null,session:null},error:O};throw O}}async _exchangeCodeForSession(e){const t=await lr(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(t??"").split("/");try{const{data:l,error:c}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Ln});if(await Wn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new es}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:c})}catch(l){if(ge(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:l,nonce:c}=e,d=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ln}),{data:v,error:g}=d;return g?{data:{user:null,session:null},error:g}:!v||!v.session||!v.user?{data:{user:null,session:null},error:new es}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:v,error:g})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,l,c;try{if("email"in e){const{email:d,options:v}=e;let g=null,y=null;this.flowType==="pkce"&&([g,y]=await Mr(this.storage,this.storageKey));const{error:k}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=v?.data)!==null&&t!==void 0?t:{},create_user:(r=v?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},code_challenge:g,code_challenge_method:y},redirectTo:v?.emailRedirectTo});return{data:{user:null,session:null},error:k}}if("phone"in e){const{phone:d,options:v}=e,{data:g,error:y}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(o=v?.data)!==null&&o!==void 0?o:{},create_user:(l=v?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:v?.captchaToken},channel:(c=v?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:y}}throw new ts("You must provide either an email or phone number.")}catch(d){if(ge(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(e){var t,r;try{let o,l;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:d}=await Te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:Ln});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const v=c.session,g=c.user;return v?.access_token&&(await this._saveSession(v),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",v)),{data:{user:g,session:v},error:null}}catch(o){if(ge(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await Mr(this.storage,this.storageKey)),await Te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:uf})}catch(l){if(ge(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Vn;const{error:o}=await Te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(ge(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:l}=e,{error:c}=await Te(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:r,type:o,options:l}=e,{data:c,error:d}=await Te(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:d}}throw new ts("You must provide either an email or phone number and a type")}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await lr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Gs:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await lr(this.userStorage,this.storageKey+"-user");c?.user?e.user=c.user:e.user=Js()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(v,g,y)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(v,g,y))})}return{data:{session:e},error:null}}const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:qn}):await this._useSession(async t=>{var r,o,l;const{data:c,error:d}=t;if(d)throw d;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Vn}:await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:qn})})}catch(t){if(ge(t))return Md(t)&&(await this._removeSession(),await Wn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:o,error:l}=r;if(l)throw l;if(!o.session)throw new Vn;const c=o.session;let d=null,v=null;this.flowType==="pkce"&&e.email!=null&&([d,v]=await Mr(this.storage,this.storageKey));const{data:g,error:y}=await Te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:v}),jwt:c.access_token,xform:qn});if(y)throw y;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(ge(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Vn;const t=Date.now()/1e3;let r=t,o=!0,l=null;const{payload:c}=Ys(e.access_token);if(c.exp&&(r=c.exp,o=r<=t),o){const{session:d,error:v}=await this._callRefreshToken(e.refresh_token);if(v)return{data:{user:null,session:null},error:v};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:v}=await this._getUser(e.access_token);if(v)throw v;l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(ge(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:d}=t;if(d)throw d;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new Vn;const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ge(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!sn())throw new ns("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ns(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Xa("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ns("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Xa("No code detected.");const{data:H,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const G=new URL(window.location.href);return G.searchParams.delete("code"),window.history.replaceState(window.history.state,"",G.toString()),{data:{session:H.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:l,refresh_token:c,expires_in:d,expires_at:v,token_type:g}=e;if(!l||!d||!c||!g)throw new ns("No session defined in URL");const y=Math.round(Date.now()/1e3),k=parseInt(d);let E=y+k;v&&(E=parseInt(v));const m=E-y;m*1e3<=Ur&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${k}s`);const I=E-k;y-I>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",I,E,y):y-I<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",I,E,y);const{data:$,error:O}=await this._getUser(l);if(O)throw O;const q={provider_token:r,provider_refresh_token:o,access_token:l,expires_in:k,expires_at:E,refresh_token:c,token_type:g,user:$.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:q,redirectType:e.type},error:null}}catch(r){if(ge(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await lr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:o,error:l}=t;if(l)return{error:l};const c=(r=o.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(xd(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return e!=="others"&&(await this._removeSession(),await Wn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=qd(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:l},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Mr(this.storage,this.storageKey,!0));try{return await Te(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(ge(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ge(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async l=>{var c,d,v,g,y;const{data:k,error:E}=l;if(E)throw E;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(v=e.options)===null||v===void 0?void 0:v.queryParams,skipBrowserRedirect:!0});return await Te(this.fetch,"GET",m,{headers:this.headers,jwt:(y=(g=k.session)===null||g===void 0?void 0:g.access_token)!==null&&y!==void 0?y:void 0})});if(o)throw o;return sn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(ge(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:l,error:c}=t;if(c)throw c;return await Te(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await Kd(async o=>(o>0&&await Gd(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await Te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ln})),(o,l)=>{const c=200*Math.pow(2,o);return l&&Ks(l)&&Date.now()+c-r<Ur})}catch(r){if(this._debug(t,"error",r),ge(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),sn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await lr(this.storage,this.storageKey);if(o&&this.userStorage){let c=await lr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:o.user},await Nr(this.userStorage,this.storageKey+"-user",c)),o.user=(e=c?.user)!==null&&e!==void 0?e:Js()}else if(o&&!o.user&&!o.user){const c=await lr(this.storage,this.storageKey+"-user");c&&c?.user?(o.user=c.user,await Wn(this.storage,this.storageKey+"-user"),await Nr(this.storage,this.storageKey,o)):o.user=Js()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const l=((t=o.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Gs;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${Gs}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:c}=await this._callRefreshToken(o.refresh_token);c&&(console.error(c),Ks(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(o.access_token);!d&&c?.user?(o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Vn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Ts;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Vn;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(o,"error",l),ge(l)){const c={session:null,error:l};return Ks(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,t)}catch(v){l.push(v)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await Nr(this.userStorage,this.storageKey+"-user",{user:t.user});const o=Object.assign({},t);delete o.user;const l=nl(o);await Nr(this.storage,this.storageKey,l)}else{const o=nl(t);await Nr(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Wn(this.storage,this.storageKey),await Wn(this.storage,this.storageKey+"-code-verifier"),await Wn(this.storage,this.storageKey+"-user"),this.userStorage&&await Wn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&sn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ur);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/Ur);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Ur}ms, refresh threshold is ${fo} ticks`),o<=fo&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof hu)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!sn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await Mr(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});o.push(d.toString())}if(r?.queryParams){const l=new URLSearchParams(r.queryParams);o.push(l.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:l}=t;return l?{data:null,error:l}:await Te(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:l,error:c}=t;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:v,error:g}=await Te(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(r=l?.session)===null||r===void 0?void 0:r.access_token});return g?{data:null,error:g}:(e.factorType==="totp"&&(!((o=v?.totp)===null||o===void 0)&&o.qr_code)&&(v.totp.qr_code=`data:image/svg+xml;utf-8,${v.totp.qr_code}`),{data:v,error:null})})}catch(t){if(ge(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:d}=await Te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(t){if(ge(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:l}=t;return l?{data:null,error:l}:await Te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(ge(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=e?.factors||[],o=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:o,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:l}=e;if(l)return{data:null,error:l};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=Ys(o.access_token);let d=null;c.aal&&(d=c.aal);let v=d;((r=(t=o.user.factors)===null||t===void 0?void 0:t.filter(k=>k.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(v="aal2");const y=c.amr||[];return{data:{currentLevel:d,nextLevel:v,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(d=>d.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(d=>d.kid===e),r&&this.jwks_cached_at+jd>o)return r;const{data:l,error:c}=await Te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,r=l.keys.find(d=>d.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:m,error:I}=await this.getSession();if(I||!m.session)return{data:null,error:I};r=m.session.access_token}const{header:o,payload:l,signature:c,raw:{header:d,payload:v}}=Ys(r);t?.allowExpired||tf(l.exp);const g=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:l,header:o,signature:c},error:null}}const y=nf(o.alg),k=await crypto.subtle.importKey("jwk",g,y,!0,["verify"]);if(!await crypto.subtle.verify(y,k,c,Bd(`${d}.${v}`)))throw new go("Invalid JWT signature");return{data:{claims:l,header:o,signature:c},error:null}}catch(r){if(ge(r))return{data:null,error:r};throw r}}}ki.nextInstanceID=0;const yf=ki;class wf extends yf{constructor(e){super(e)}}var bf=function(n,e,t,r){function o(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(y){try{g(r.next(y))}catch(k){c(k)}}function v(y){try{g(r.throw(y))}catch(k){c(k)}}function g(y){y.done?l(y.value):o(y.value).then(d,v)}g((r=r.apply(n,e||[])).next())})};class kf{constructor(e,t,r){var o,l,c;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=Sd(e),v=new URL(d);this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const g=`sb-${v.hostname.split(".")[0]}-auth-token`,y={db:md,realtime:yd,auth:Object.assign(Object.assign({},_d),{storageKey:g}),global:gd},k=Cd(r??{},y);this.storageKey=(o=k.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(l=k.global.headers)!==null&&l!==void 0?l:{},k.accessToken?(this.accessToken=k.accessToken,this.auth=new Proxy({},{get:(E,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=k.auth)!==null&&c!==void 0?c:{},this.headers,k.global.fetch),this.fetch=Ed(t,this._getAccessToken.bind(this),k.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},k.realtime)),this.rest=new Fh(new URL("rest/v1",v).href,{headers:this.headers,schema:k.db.schema,fetch:this.fetch}),this.storage=new fd(this.storageUrl.href,this.headers,this.fetch,r?.storage),k.accessToken||this._listenForAuthEvents()}get functions(){return new Th(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return bf(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,storageKey:l,flowType:c,lock:d,debug:v},g,y){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new wf({url:this.authUrl.href,headers:Object.assign(Object.assign({},k),g),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,flowType:c,lock:d,debug:v,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ed(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ef=(n,e,t)=>new kf(n,e,t);function Af(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Af()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Sf="https://vycjpmuyscfygstjjied.supabase.co",Cf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ5Y2pwbXV5c2NmeWdzdGpqaWVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDcyMTQxMDcsImV4cCI6MjA2Mjc5MDEwN30.3t3wUSpe8n0PHPscRQx5vu_fX9B5_d0bEOJMvwLPYAQ",dr="dracula",fr=Ef(Sf,Cf,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"Content-Type":"application/json"}}});async function Tf(n,e,t,r){const o=prompt("Введите имя файла истории:","new_story.json");if(!o)return;const l={meta:{version:"3.0",title:"New Story"},chapters:[{id:"ch1",title:"Глава 1: Начало"}],dialogues:[{id:"start",chapterId:"ch1",text:"Начало новой истории...",options:[]}]},c=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),{error:d}=await fr.storage.from(dr).upload(o,c);d?fe(e,{type:"error",text:"Ошибка создания: "+d.message},!0):(await t(),await r(o))}async function If(n,e,t,r){if(!T(e))return;fe(t,{type:"loading",text:"Сохранение..."},!0);const o=new Blob([JSON.stringify(T(e),null,2)],{type:"application/json"}),{error:l}=await fr.storage.from(dr).upload(T(r),o,{upsert:!0});fe(t,{type:l?"error":"success",text:l?"Ошибка сохранения":"Сохранено!"},!0)}async function Pf(n,e,t){const r=n.target;if(!r.files||r.files.length===0)return;const o=r.files[0];fe(e,{type:"loading",text:"Загрузка файла..."},!0);const{error:l}=await fr.storage.from(dr).upload(o.name,o,{upsert:!0});l?fe(e,{type:"error",text:"Ошибка загрузки"},!0):(fe(e,{type:"success",text:"Файл загружен"},!0),await t())}function Rf(n,e,t){if(!T(e))return;T(e).chapters||(T(e).chapters=[]);const r="ch_"+Date.now();T(e).chapters.push({id:r,title:"Новая глава"}),fe(t,r)}function jf(n,e,t,r){if(!T(e)||!T(t))return;const o="d_"+Date.now();T(e).dialogues.push({id:o,chapterId:T(t),text:"Новый текст...",options:[]}),fe(r,o)}var Of=(n,e)=>e(n.target.value),xf=Ae("<option> </option>"),Mf=(n,e,t)=>fe(e,T(t).id,!0),Lf=Ae("<div> </div>"),$f=(n,e,t)=>fe(e,T(t).id,!0),Ff=Ae('<div><span class="id-badge svelte-1kvo8mb"> </span> <span class="preview-text svelte-1kvo8mb"> </span></div>'),Df=Ae("<div> </div>"),Uf=Ae("<option> </option>"),Nf=Ae("<option> </option>"),Bf=Ae("<option> </option>"),Wf=Ae("<option> </option>"),Vf=(n,e,t)=>e(T(t)),qf=Ae("<option> </option>"),Hf=Ae('<div class="mini-game-edit"><label class="svelte-1kvo8mb">Мини-игра ID: <input type="text" class="input small svelte-1kvo8mb"/></label></div>'),zf=Ae('<div class="option-details svelte-1kvo8mb"><div class="form-group svelte-1kvo8mb"><label class="svelte-1kvo8mb">Текст кнопки</label> <input type="text" class="input svelte-1kvo8mb"/></div> <div class="form-row svelte-1kvo8mb"><div class="form-group full-width svelte-1kvo8mb"><label class="svelte-1kvo8mb">Переход к диалогу</label> <select class="input select svelte-1kvo8mb"><option>-- Конец ветки --</option><!></select></div></div> <div class="form-group svelte-1kvo8mb"><label class="checkbox-row svelte-1kvo8mb"><input type="checkbox"/> Отключить кнопку</label></div> <!></div>'),Gf=Ae('<div><div class="option-header svelte-1kvo8mb"><span> </span> <button class="btn-icon danger svelte-1kvo8mb">×</button></div> <!></div>'),Kf=Ae("<option> </option>"),Yf=(n,e,t)=>e(T(t).nextDialogueId),Jf=Ae('<div><span class="link-type svelte-1kvo8mb">Auto:</span> <span class="link-id svelte-1kvo8mb"> </span> <button class="btn-link svelte-1kvo8mb">Перейти →</button> <span class="link-target svelte-1kvo8mb"> </span></div>'),Xf=Ae('<div class="link-row empty svelte-1kvo8mb">Нет автоперехода</div>'),Qf=(n,e,t)=>e(T(t).nextDialogueId),Zf=Ae('<div><span class="link-type svelte-1kvo8mb">Opt:</span> <span class="link-id svelte-1kvo8mb"> </span> <button class="btn-link svelte-1kvo8mb">Перейти →</button> <span class="link-target svelte-1kvo8mb"> </span></div>'),ev=Ae('<div class="link-row empty svelte-1kvo8mb">Никто не ссылается на этот диалог</div>'),tv=(n,e,t)=>e(T(t).id),nv=Ae('<div class="link-row svelte-1kvo8mb"><span class="link-id svelte-1kvo8mb"> </span> <button class="btn-link svelte-1kvo8mb">← Перейти</button> <span class="link-target svelte-1kvo8mb"> </span></div>'),rv=(n,e,t)=>e(T(t).id),iv=Ae('<div class="dialogue-form svelte-1kvo8mb"><div class="form-group svelte-1kvo8mb"><label class="svelte-1kvo8mb">ID диалога</label> <input type="text" class="input svelte-1kvo8mb"/></div> <div class="form-group svelte-1kvo8mb"><label class="svelte-1kvo8mb">Текст</label> <textarea class="textarea svelte-1kvo8mb" rows="3"></textarea></div> <div class="media-section svelte-1kvo8mb"><h4 class="svelte-1kvo8mb">Медиа ресурсы</h4> <div class="form-group svelte-1kvo8mb"><label class="svelte-1kvo8mb">Фон (Background)</label> <div class="input-group svelte-1kvo8mb"><select class="input select svelte-1kvo8mb"><option>-- Нет фона --</option><!><!></select> <label class="btn-file svelte-1kvo8mb">Загрузить <input type="file" accept="image/*,.riv" hidden/></label></div></div> <div class="form-group svelte-1kvo8mb"><label class="svelte-1kvo8mb">Персонаж (Character)</label> <div class="input-group svelte-1kvo8mb"><select class="input select svelte-1kvo8mb"><option>-- Нет персонажа --</option><!><!></select></div></div></div> <div class="options-section svelte-1kvo8mb"><div class="section-header svelte-1kvo8mb"><h4 class="svelte-1kvo8mb">Варианты ответов</h4> <button class="btn small svelte-1kvo8mb">+ Добавить</button></div> <!></div> <div class="links-section svelte-1kvo8mb"><h4 class="svelte-1kvo8mb">Авто-переход</h4> <select class="input select svelte-1kvo8mb"><option>-- Нет автоперехода --</option><!></select></div> <div class="infographic-section svelte-1kvo8mb"><h4 class="svelte-1kvo8mb">Связи и переходы</h4> <div class="info-block svelte-1kvo8mb"><div class="info-title svelte-1kvo8mb">👉 Куда ведет:</div> <!> <!></div> <div class="info-block secondary svelte-1kvo8mb"><div class="info-title svelte-1kvo8mb">👈 Откуда ведут:</div> <!></div></div> <div class="form-actions svelte-1kvo8mb"><button class="btn danger svelte-1kvo8mb">Удалить сцену</button></div></div>'),sv=Ae('<div class="empty-state svelte-1kvo8mb">Выберите сцену или создайте новую</div>'),ov=(n,e)=>fe(e,null),av=Ae('<div class="empty-preview svelte-1kvo8mb">Выберите сцену</div>'),lv=Ae('<div class="editor-container svelte-1kvo8mb"><header class="toolbar svelte-1kvo8mb"><div class="logo svelte-1kvo8mb"><h2 class="svelte-1kvo8mb">Story Editor v3</h2></div> <div class="stories-control svelte-1kvo8mb"><select class="story-select svelte-1kvo8mb"></select> <button class="btn primary small svelte-1kvo8mb">+ Новая</button> <button class="btn success small svelte-1kvo8mb">💾 Сохранить</button> <button class="btn small svelte-1kvo8mb">📋 Копия</button></div></header> <div class="main-workspace svelte-1kvo8mb"><aside class="sidebar svelte-1kvo8mb"><div class="sidebar-section svelte-1kvo8mb"><div class="section-header svelte-1kvo8mb"><h3>Главы</h3> <button class="btn-icon svelte-1kvo8mb" title="Добавить главу">+</button></div> <div class="chapter-list svelte-1kvo8mb"></div></div> <div class="sidebar-section flex-1 svelte-1kvo8mb"><div class="section-header svelte-1kvo8mb"><h3> </h3> <button class="btn-icon svelte-1kvo8mb" title="Добавить сцену">+</button></div> <div class="dialogue-list svelte-1kvo8mb"></div></div> <div class="status-box svelte-1kvo8mb"><!></div></aside> <main class="editor-area svelte-1kvo8mb"><!></main> <aside class="preview-panel svelte-1kvo8mb"><div class="preview-header svelte-1kvo8mb"><h3 class="svelte-1kvo8mb">Предпросмотр</h3> <button class="btn-link small svelte-1kvo8mb">Сбросить редакт. опций</button></div> <div class="preview-wrapper svelte-1kvo8mb"><!></div></aside></div></div>');function uv(n,e){Si(e,!0);let t=Xe(An({meta:{version:"3.0",title:"Untitled"},chapters:[],dialogues:[]})),r=Xe(null),o=Xe(null),l=Xe(null),c=Xe(An([])),d=Xe(An({type:"",text:""})),v=Xe(An([])),g=Xe("dracula_story.json");xo(async()=>{await y(),await E(T(g)),await m()});async function y(){const{data:Y,error:se}=await fr.storage.from(dr).list("",{search:".json"});!se&&Y&&fe(v,Y.map(ve=>ve.name).filter(ve=>ve!==".emptyFolderPlaceholder"),!0)}async function k(){if(!T(t))return;const Y=T(g).replace(".json",""),se=new Date().getTime();let ve=`${Y}_copy_${se}.json`;ve=ve.trim();const Be=prompt("Введите имя для копии:",ve);if(!Be)return;ve=Be.trim(),ve.endsWith(".json")||(ve+=".json"),fe(d,{type:"loading",text:"Создание копии..."},!0);const p=new Blob([JSON.stringify(T(t),null,2)],{type:"application/json"}),{error:a}=await fr.storage.from(dr).upload(ve,p,{upsert:!0,contentType:"application/json"});a?(console.error("Supabase Error:",a),fe(d,{type:"error",text:`Ошибка копии: ${a.message}`},!0)):(await y(),fe(d,{type:"success",text:"Копия сохранена!"},!0))}async function E(Y){fe(d,{type:"loading",text:"Загрузка..."},!0),fe(g,Y,!0);try{const{data:se,error:ve}=await fr.storage.from(dr).download(Y);if(ve)throw ve;const Be=JSON.parse(await se.text());Be.chapters||(Be.chapters=[{id:"main",title:"Основная история"}],Be.dialogues&&Be.dialogues.forEach(p=>{p.chapterId||(p.chapterId="main")}),Be.meta={...Be.meta,version:"3.0 (Migrated)"}),fe(t,Be,!0),T(t).chapters&&T(t).chapters.length>0?fe(r,T(t).chapters[0].id,!0):(T(t).chapters=[{id:"default",title:"Default"}],fe(r,"default")),T(t).dialogues&&T(t).dialogues.length>0?fe(o,T(t).dialogues[0].id,!0):fe(o,null),fe(d,{type:"success",text:"Загружено!"},!0)}catch(se){console.error(se),fe(d,{type:"error",text:"Ошибка загрузки: "+se.message},!0)}}async function m(){const{data:Y}=await fr.storage.from(dr).list();Y&&fe(c,Y.filter(se=>se.name!==".emptyFolderPlaceholder"&&!se.name.endsWith(".json")),!0)}function I(Y){Y.options||(Y.options=[]),Y.options.push({text:"Новый вариант",disabled:!1}),fe(l,Y.options.length-1)}function $(Y){confirm("Удалить диалог "+Y+"?")&&T(t)&&(T(t).dialogues=T(t).dialogues.filter(se=>se.id!==Y),T(t).dialogues.forEach(se=>{se.nextDialogueId===Y&&(se.nextDialogueId=""),se.options&&se.options.forEach(ve=>{ve.nextDialogueId===Y&&(ve.nextDialogueId="")})}),T(o)===Y&&fe(o,null))}let O=Dr(()=>T(t)?.dialogues.find(Y=>Y.id===T(o))),q=Dr(()=>T(t)?T(t).dialogues.filter(Y=>Y.chapterId===T(r)):[]),H=Dr(()=>T(c).filter(Y=>Y.name.match(/\.(png|jpg|jpeg|webp|gif)$/i))),N=Dr(()=>T(c).filter(Y=>Y.name.endsWith(".riv")));function G(Y){const se=T(t)?.dialogues.find(ve=>ve.id===Y);se&&(fe(r,se.chapterId,!0),fe(o,Y,!0))}let K=Dr(()=>()=>!T(t)||!T(o)?[]:T(t).dialogues.filter(Y=>Y.nextDialogueId===T(o)?!0:Y.options?Y.options.some(se=>se.nextDialogueId===T(o)):!1));function j(Y){if(!Y||!T(t))return"Нет";const se=T(t).dialogues.find(ve=>ve.id===Y);return se?se.text.substring(0,40)+"...":`❌ Не найден: ${Y}`}var L=lv(),ie=z(L),ue=te(z(ie),2),ae=z(ue);ae.__change=[Of,E],Ut(ae,21,()=>T(v),wn,(Y,se)=>{var ve=xf(),Be=z(ve),p={};et(()=>{Je(Be,T(se)),p!==(p=T(se))&&(ve.value=(ve.__value=T(se))??"")}),ce(Y,ve)});var X=te(ae,2);X.__click=[Tf,d,y,E];var he=te(X,2);he.__click=[If,t,d,g];var Ne=te(he,2);Ne.__click=k;var Ke=te(ie,2),Ve=z(Ke),gt=z(Ve),Ee=z(gt),un=te(z(Ee),2);un.__click=[Rf,t,r];var tt=te(Ee,2);Ut(tt,21,()=>T(t)?.chapters||[],Y=>Y.id,(Y,se)=>{var ve=Lf();ve.__click=[Mf,r,se];var Be=z(ve);et(()=>{Tr(ve,1,`chapter-item ${T(r)===T(se).id?"active":""}`,"svelte-1kvo8mb"),Je(Be,T(se).title)}),ce(Y,ve)});var qe=te(gt,2),nt=z(qe),Pt=z(nt),Se=z(Pt),Pe=te(Pt,2);Pe.__click=[jf,t,r,o];var Lt=te(nt,2);Ut(Lt,21,()=>T(q),Y=>Y.id,(Y,se)=>{var ve=Ff();ve.__click=[$f,o,se];var Be=z(ve),p=z(Be),a=te(Be,2),h=z(a);et(w=>{Tr(ve,1,`dialogue-item ${T(o)===T(se).id?"active":""}`,"svelte-1kvo8mb"),Je(p,T(se).id),Je(h,`${w??""}...`)},[()=>T(se).text.substring(0,25)]),ce(Y,ve)});var De=te(qe,2),kt=z(De);{var Ye=Y=>{var se=Df(),ve=z(se);et(()=>{Tr(se,1,`alert ${T(d).type??""}`,"svelte-1kvo8mb"),Je(ve,T(d).text)}),ce(Y,se)};it(kt,Y=>{T(d).text&&Y(Ye)})}var Wt=te(Ve,2),cn=z(Wt);{var Xt=Y=>{var se=iv(),ve=z(se),Be=te(z(ve),2),p=te(ve,2),a=te(z(p),2),h=te(p,2),w=te(z(h),2),C=te(z(w),2),x=z(C),F=z(x);F.value=F.__value="";var re=te(F);Ut(re,17,()=>T(H),wn,(be,oe)=>{var me=Uf(),Qe=z(me),Re={};et(()=>{Je(Qe,T(oe).name),Re!==(Re=T(oe).name)&&(me.value=(me.__value=T(oe).name)??"")}),ce(be,me)});var de=te(re);Ut(de,17,()=>T(N),wn,(be,oe)=>{var me=Nf(),Qe=z(me),Re={};et(()=>{Je(Qe,`${T(oe).name??""} (Rive)`),Re!==(Re=T(oe).name)&&(me.value=(me.__value=T(oe).name)??"")}),ce(be,me)});var ne=te(x,2),we=te(z(ne));we.__change=[Pf,d,m];var Me=te(w,2),rt=te(z(Me),2),We=z(rt),At=z(We);At.value=At.__value="";var St=te(At);Ut(St,17,()=>T(H),wn,(be,oe)=>{var me=Bf(),Qe=z(me),Re={};et(()=>{Je(Qe,T(oe).name),Re!==(Re=T(oe).name)&&(me.value=(me.__value=T(oe).name)??"")}),ce(be,me)});var _t=te(St);Ut(_t,17,()=>T(N),wn,(be,oe)=>{var me=Wf(),Qe=z(me),Re={};et(()=>{Je(Qe,`${T(oe).name??""} (Rive)`),Re!==(Re=T(oe).name)&&(me.value=(me.__value=T(oe).name)??"")}),ce(be,me)});var ft=te(h,2),Ct=z(ft),dn=te(z(Ct),2);dn.__click=[Vf,I,O];var fn=te(Ct,2);Ut(fn,17,()=>T(O).options||[],wn,(be,oe,me)=>{var Qe=Gf(),Re=z(Qe);Re.__click=()=>fe(l,me,!0);var vt=z(Re),qt=z(vt),Ht=te(vt,2);Ht.__click=()=>T(O).options.splice(me,1);var jt=te(Re,2);{var ot=Ft=>{var vn=zf(),br=z(vn),pn=te(z(br),2),er=te(br,2),Li=z(er),ti=te(z(Li),2),Pn=z(ti);Pn.value=Pn.__value="";var ni=te(Pn);Ut(ni,17,()=>T(t).dialogues,wn,(Ot,zt)=>{var Rn=qf(),yt=z(Rn),en={};et(pe=>{Je(yt,`${T(zt).id??""}: ${pe??""}...`),en!==(en=T(zt).id)&&(Rn.value=(Rn.__value=T(zt).id)??"")},[()=>T(zt).text.substring(0,30)]),ce(Ot,Rn)});var gn=te(er,2),tr=z(gn),kr=z(tr),nr=te(gn,2);{var Zt=Ot=>{var zt=Hf(),Rn=z(zt),yt=te(z(Rn));Xi(yt,()=>T(oe).miniGame.id,en=>T(oe).miniGame.id=en),ce(Ot,zt)};it(nr,Ot=>{T(oe).miniGame&&Ot(Zt)})}Xi(pn,()=>T(oe).text,Ot=>T(oe).text=Ot),ci(ti,()=>T(oe).nextDialogueId,Ot=>T(oe).nextDialogueId=Ot),Kc(kr,()=>T(oe).disabled,Ot=>T(oe).disabled=Ot),ce(Ft,vn)};it(jt,Ft=>{T(l)===me&&Ft(ot)})}et(()=>{Tr(Qe,1,`option-card ${T(l)===me?"editing":""}`,"svelte-1kvo8mb"),Je(qt,`#${me+1} ${T(oe).text??""}`)}),ce(be,Qe)});var $t=te(ft,2),le=te(z($t),2),Ce=z(le);Ce.value=Ce.__value="";var Vt=te(Ce);Ut(Vt,17,()=>T(t).dialogues,wn,(be,oe)=>{var me=Kf(),Qe=z(me),Re={};et(vt=>{Je(Qe,`${T(oe).id??""}: ${vt??""}...`),Re!==(Re=T(oe).id)&&(me.value=(me.__value=T(oe).id)??"")},[()=>T(oe).text.substring(0,30)]),ce(be,me)});var Zr=te($t,2),Qn=te(z(Zr),2),Ri=te(z(Qn),2);{var Zn=be=>{var oe=Jf();let me;var Qe=te(z(oe),2),Re=z(Qe),vt=te(Qe,2);vt.__click=[Yf,G,O];var qt=te(vt,2),Ht=z(qt);et((jt,ot)=>{me=Tr(oe,1,"link-row svelte-1kvo8mb",null,me,jt),Je(Re,T(O).nextDialogueId),Je(Ht,`"${ot??""}"`)},[()=>({danger:!T(t).dialogues.find(jt=>jt.id===T(O).nextDialogueId)}),()=>j(T(O).nextDialogueId)]),ce(be,oe)},ji=be=>{var oe=Xf();ce(be,oe)};it(Ri,be=>{T(O).nextDialogueId?be(Zn):be(ji,!1)})}var Z=te(Ri,2);Ut(Z,17,()=>T(O).options||[],wn,(be,oe)=>{var me=Fn(),Qe=an(me);{var Re=vt=>{var qt=Zf();let Ht;var jt=te(z(qt),2),ot=z(jt),Ft=te(jt,2);Ft.__click=[Qf,G,oe];var vn=te(Ft,2),br=z(vn);et((pn,er)=>{Ht=Tr(qt,1,"link-row svelte-1kvo8mb",null,Ht,pn),Je(ot,T(oe).nextDialogueId),Je(br,`"${er??""}"`)},[()=>({danger:!T(t).dialogues.find(pn=>pn.id===T(oe).nextDialogueId)}),()=>j(T(oe).nextDialogueId)]),ce(vt,qt)};it(Qe,vt=>{T(oe).nextDialogueId&&vt(Re)})}ce(be,me)});var ei=te(Qn,2),In=te(z(ei),2);{var Oi=be=>{var oe=ev();ce(be,oe)},xi=be=>{var oe=Fn(),me=an(oe);Ut(me,17,()=>T(K)(),wn,(Qe,Re)=>{var vt=nv(),qt=z(vt),Ht=z(qt),jt=te(qt,2);jt.__click=[tv,G,Re];var ot=te(jt,2),Ft=z(ot);et(vn=>{Je(Ht,T(Re).id),Je(Ft,`${vn??""}...`)},[()=>T(Re).text.substring(0,30)]),ce(Qe,vt)}),ce(be,oe)};it(In,be=>{T(K)().length===0?be(Oi):be(xi,!1)})}var wr=te(Zr,2),Mi=z(wr);Mi.__click=[rv,$,O],Xi(Be,()=>T(O).id,be=>T(O).id=be),Xi(a,()=>T(O).text,be=>T(O).text=be),ci(x,()=>T(O).backgroundImage,be=>T(O).backgroundImage=be),ci(We,()=>T(O).characterImage,be=>T(O).characterImage=be),ci(le,()=>T(O).nextDialogueId,be=>T(O).nextDialogueId=be),ce(Y,se)},Tn=Y=>{var se=sv();ce(Y,se)};it(cn,Y=>{T(O)?Y(Xt):Y(Tn,!1)})}var mt=te(Wt,2),Rt=z(mt),hn=te(z(Rt),2);hn.__click=[ov,l];var Xn=te(Rt,2),Qt=z(Xn);{var yr=Y=>{Gl(Y,{get dialogue(){return T(O)},index:0})},Et=Y=>{var se=av();ce(Y,se)};it(Qt,Y=>{T(O)?Y(yr):Y(Et,!1)})}et(()=>{Je(Se,`Сцены (${T(q).length??""})`),Pe.disabled=!T(r)}),ci(ae,()=>T(g),Y=>fe(g,Y)),ce(n,L),Ci()}Vl(["change","click"]);var cv=Ae('<button style="position:fixed; top:10px; right:500px; z-index:9999;">Закрыть редактор</button> <!>',1),hv=Ae('<button style="position:fixed; bottom:10px; right:10px; z-index:9999;">Редактор</button> <!>',1);function dv(n){let e=Xe(!1);var t=Fn(),r=an(t);{var o=c=>{var d=cv(),v=an(d),g=te(v,2);uv(g,{}),Ca("click",v,()=>fe(e,!1)),ce(c,d)},l=c=>{var d=hv(),v=an(d),g=te(v,2);bh(g,{}),Ca("click",v,()=>fe(e,!0)),ce(c,d)};it(r,c=>{T(e)?c(o):c(l,!1)})}ce(n,t)}Fc(dv,{target:document.getElementById("app")});
